require=function o(r,s,c){function d(t,e){if(!s[t]){if(!r[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(h)return h(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var i=s[t]={exports:{}};r[t][0].call(i.exports,function(e){return d(r[t][1][e]||e)},i,i.exports,o,r,s,c)}return s[t].exports}for(var h="function"==typeof require&&require,e=0;e<c.length;e++)d(c[e]);return d}({1:[function(e,t,a){var n,i,o=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}(function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}})();var d,h=[],l=!1,u=-1;function m(){l&&d&&(l=!1,d.length?h=d.concat(h):u=-1,h.length&&p())}function p(){if(!l){var e=c(m);l=!0;for(var t=h.length;t;){for(d=h,h=[];++u<t;)d&&d[u].run();u=-1,t=h.length}d=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];h.push(new g(e,t)),1!==h.length||l||c(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=f,o.addListener=f,o.once=f,o.off=f,o.removeListener=f,o.removeAllListeners=f,o.emit=f,o.prependListener=f,o.prependOnceListener=f,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},{}],AMapPanel:[function(e,t,a){"use strict";cc._RF.push(t,"1b99cTs08pHdZzc6H6LO+ei","AMapPanel");var f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{mapLayer:cc.Node,play_up_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,up_player:cc.Node,left_player:cc.Node,distanceLine:cc.Node,distanceNode:cc.Node,distanceLine1:cc.Node,distanceNode1:cc.Node,hint:cc.Node,playerArray:[]},onLoad:function(){},showPlayers:function(){this.distanceData={},this.playerArray=[],3==GameData.joiners.length?(this.showLayer(!0),this.showPlayer("up",this.up_player),this.showPlayer("left",this.left_player),this.up_player.tag=0,this.left_player.tag=1,this.getLocation(),this.twoCondition()):4==GameData.joiners.length&&(this.showLayer(!1),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.play_right_player.tag=0,this.play_up_player.tag=1,this.play_left_player.tag=2,this.getLocation(),this.threeCondition())},showPlayer:function(e,t){var a=GameData.getPlayerByPos(e);null!=a?(cc.find("name",t).getComponent(cc.Label).string="IP : "+a.remoteAddr,this.setHeadIcon(a.headimgurl,t),this.playerArray.push(a)):t.active=!1},setHeadIcon:function(e,n){null==e||""==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){if(!e&&t){var a=cc.find("headMask/head",n);a.getComponent(cc.Sprite).spriteFrame=null,a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}})},getLocation:function(){for(var e=0;e<this.playerArray.length;e++){var t=this.playerArray[e].uid,a=this.playerArray[e].posInfo;if(0!=a.latPos||0!=a.longPos){this.distanceData[t]||(this.distanceData[t]={},this.distanceData[t].playlist={});for(var n=0;n<this.playerArray.length;n++){var i=this.playerArray[n].uid,o=this.playerArray[n].posInfo;i!=t&&(0==o.latPos&&0==o.longPos||this.distanceData[t].playlist[i]||(this.distanceData[t].playlist[i]=getDistance(a.latPos,a.longPos,o.latPos,o.longPos)))}}}},twoCondition:function(){WriteLog("距离列表1: this.distanceData = "+JSON.stringify(this.distanceData));for(var e=0;e<this.playerArray.length;e++){var t=cc.find("Line1",this.distanceLine1),a=cc.find("distance1",this.distanceNode1),n=cc.find("two/playerInfo",this.mapLayer),i=this.playerArray[e].uid;if(this.distanceData[i])for(var o=0;o<this.playerArray.length;o++){var r=this.playerArray[o].uid;if(r!=i){var s=this.distanceData[i].playlist;if(0<Object.keys(s).length)for(var c in s)if(c==r)if(WriteLog("..............................typeof(playList[nextUid]) = "+f(s[r])),1e3<=s[r]){var d=s[r]/1e3;d=d.toFixed(2),a.getComponent(cc.Label).string=d+"km"}else if(s[r]<=50){a.getComponent(cc.Label).string=s[r]+"m",a.color=new cc.Color(255,0,0),t.getChildByName("Line").active=!1,t.getChildByName("redLine").active=!0;for(var h=0;h<this.playerArray.length;h++){l=n.getChildByTag(h);this.headImage(l,!0)}}else a.getComponent(cc.Label).string=s[r]+"m"}}else{a.getComponent(cc.Label).string="距离未确定",a.color=new cc.Color(255,0,0),t.getChildByName("Line").active=!1,t.getChildByName("redLine").active=!0;var l=n.getChildByTag(e),u=cc.find("misLocation",l);cc.find("misLabel",l).active=!0,u.active=!0,this.headImage(l,!0)}}var m,p,g;if(m=n.getChildByTag(0),g=cc.find("name",m).getComponent("cc.Label").string,p=n.getChildByTag(1),g==cc.find("name",p).getComponent("cc.Label").string){for(e=0;e<this.playerArray.length;e++){l=n.getChildByTag(e);this.headImage(l,!0),cc.find("name",l).color=new cc.Color(255,0,0)}GameData.danger=!0}},threeCondition:function(){WriteLog("距离列表2: this.distanceData = "+JSON.stringify(this.distanceData));for(var e=0;e<this.playerArray.length;e++){var t,a,n,i,o,r=cc.find("Line"+e,this.distanceLine),s=cc.find("distance"+e,this.distanceNode),c=cc.find("three/playerInfo",this.mapLayer),d=this.playerArray[e].uid;if(this.distanceData[d])for(var h=0;h<this.playerArray.length;h++){var l=this.playerArray[h].uid;if(l!=d){var u=this.distanceData[d].playlist;console.log("playList = "+JSON.stringify(u));C=void 0,D=void 0;if(0<Object.keys(u).length)for(var m in u)if(m==l){var p;if(2==e)if(0==h)if(1e3<=u[l])p=(p=u[l]/1e3).toFixed(2),s.getComponent(cc.Label).string=p+"km";else u[l]<=50&&(s.color=new cc.Color(255,0,0),r.getChildByName("Line").active=!1,r.getChildByName("redLine").active=!0),s.getComponent(cc.Label).string=u[l]+"m";else if(C=cc.find("Line1",this.distanceLine),D=cc.find("distance1",this.distanceNode),1e3<=u[l])p=(p=u[l]/1e3).toFixed(2),D.getComponent(cc.Label).string=p+"km";else u[l]<=50&&(D.color=new cc.Color(255,0,0),C.getChildByName("Line").active=!1,C.getChildByName("redLine").active=!0),D.getComponent(cc.Label).string=u[l]+"m";else if(h==e+1)if(1e3<=u[l])p=(p=u[l]/1e3).toFixed(2),s.getComponent(cc.Label).string=p+"km";else u[l]<=50&&(s.color=new cc.Color(255,0,0),r.getChildByName("Line").active=!1,r.getChildByName("redLine").active=!0),s.getComponent(cc.Label).string=u[l]+"m";else if(C=cc.find("Line"+h,this.distanceLine),D=cc.find("distance"+h,this.distanceNode),1e3<=u[l])p=(p=u[l]/1e3).toFixed(2),D.getComponent(cc.Label).string=p+"km";else u[l]<=50&&(D.color=new cc.Color(255,0,0),C.getChildByName("Line").active=!1,C.getChildByName("redLine").active=!0),D.getComponent(cc.Label).string=u[l]+"m";if(u[l]<=50){var g=c.getChildByTag(e),f=c.getChildByTag(h);this.headImage(g,!0),this.headImage(f,!0)}}}}else{s.getComponent(cc.Label).string="距离未确定",s.color=new cc.Color(255,0,0),r.getChildByName("Line").active=!1,r.getChildByName("redLine").active=!0;var y=c.getChildByTag(e),v=cc.find("misLocation",y);if(cc.find("misLabel",y).active=!0,v.active=!0,this.headImage(y,!0),0==e){var C=cc.find("Line2",this.distanceLine);(D=cc.find("distance2",this.distanceNode)).getComponent(cc.Label).string="距离未确定",D.color=new cc.Color(255,0,0),C.getChildByName("Line").active=!1,C.getChildByName("redLine").active=!0}else{var D,C=cc.find("Line"+(e-1),this.distanceLine);(D=cc.find("distance"+(e-1),this.distanceNode)).getComponent(cc.Label).string="距离未确定",D.color=new cc.Color(255,0,0),C.getChildByName("Line").active=!1,C.getChildByName("redLine").active=!0}}2==e?(t=c.getChildByTag(e),n=cc.find("name",t).getComponent("cc.Label").string,a=c.getChildByTag(0)):(t=c.getChildByTag(e),n=cc.find("name",t).getComponent("cc.Label").string,a=c.getChildByTag(e+1)),n==cc.find("name",a).getComponent("cc.Label").string&&(this.headImage(t,!0),this.headImage(a,!0),i=cc.find("name",t),o=cc.find("name",a),i.color=new cc.Color(255,0,0),o.color=new cc.Color(255,0,0),GameData.danger=!0)}},showLayer:function(e){var t=cc.find("two",this.mapLayer),a=cc.find("three",this.mapLayer);t.active=e,a.active=!e},headImage:function(e,t){var a=cc.find("headBg",e),n=cc.find("headBg1",e);a.active=t,n.active=!t},closeClick:function(e){n.instance.playAudioOther("button"),this.mapLayer.active=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],AgreePanel:[function(e,t,a){"use strict";cc._RF.push(t,"cb5c1qykSlLrp3TMkMvUToV","AgreePanel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onClose:function(){closeView(this.node.name)}}),cc._RF.pop()},{}],ButtonCD:[function(e,t,a){"use strict";cc._RF.push(t,"dd685eHL2JIwKKeUCjNI0Cu","ButtonCD"),cc.Class({extends:cc.Component,properties:{delay:2},onLoad:function(){this.button=this.node.getComponent(cc.Button),this.node.on(cc.Node.EventType.TOUCH_END,this.onClickHandler,this)},onClickHandler:function(){var t=this;cc.log("button interactable false"),this.button.interactable=!1,this.scheduleOnce(function(e){cc.log("button interactable true"),t.button.interactable=!0},2)}}),cc._RF.pop()},{}],CardButton:[function(e,t,a){"use strict";cc._RF.push(t,"2fa7444OqREkrVNZSI8nPHS","CardButton");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{cardId:0,index:0,btn:cc.Button},onLoad:function(){this.setTouchOn(),this.is_move=!1,this.initPosition=this.node.parent.position,this.first_move_position=0},setTouchOn:function(){this.btn.node.interactable=!0,this.btn.node.on(cc.Node.EventType.TOUCH_START,this.onBtnStart,this),this.btn.node.on(cc.Node.EventType.TOUCH_MOVE,this.onBtnMove,this),this.btn.node.on(cc.Node.EventType.TOUCH_END,this.onBtnEnd,this),this.btn.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onBtnCancel,this)},getCardId:function(){return this.cardId},setCardId:function(e){this.cardId=e},getIndex:function(){return this.index},setIndex:function(e){this.index=e},cardRestoration:function(){this.node.parent.setPosition(this.initPosition)},onBtnStart:function(e){if(n.instance.playAudioOther("card_click"),GameData.game.turn==GameData.player.uid){var t=e.touch.getLocation();this.first_move_position=t,sendEvent("onCardBtnStart",{card:this.getCardId(),index:this.getIndex(),position:t})}},onBtnMove:function(e){if(GameData.game.turn==GameData.player.uid){var t=e.touch.getLocation(),a=this.node.parent;(20<=Math.abs(t.x-this.first_move_position.x)||20<=Math.abs(t.y-this.first_move_position.y))&&(this.is_move=!0),1==this.is_move&&a.setPosition(a.parent.convertToNodeSpaceAR(t)),sendEvent("onCardBtnMove",{card:this.getCardId(),index:this.getIndex(),position:t})}},onBtnEnd:function(e){if(GameData.game.turn==GameData.player.uid){var t=e.touch.getLocation(),a=this.node.parent,n=0;1==this.is_move&&(n=a.getPositionY()<100?-1:1),this.is_move=!1,sendEvent("onCardBtnEnd",{card:this.getCardId(),index:this.getIndex(),position:t,type:n})}},onBtnCancel:function(e){GameData.game.turn==GameData.player.uid&&(this.cardRestoration(),sendEvent("onCardBtnCancel",{card:this.getCardId(),index:this.getIndex()}))},onBtnClicked:function(e){n.instance.playAudioOther("card_click"),GameData.game.turn==GameData.player.uid&&sendEvent("onHandCardClicked",{card:this.cardId,index:this.index})}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],CardRef:[function(e,t,a){"use strict";cc._RF.push(t,"525e4JjEmVGHKmJ1Iy5T9Dv","CardRef"),cc.Class({extends:cc.Component,properties:{cardFaces:{default:[],type:cc.SpriteFrame}},getSpriteFrame:function(e){return e<=31?this.cardFaces[e-1]:41==e?this.cardFaces[31]:51==e?this.cardFaces[32]:61==e?this.cardFaces[33]:71==e?this.cardFaces[34]:81==e?this.cardFaces[35]:91==e?this.cardFaces[36]:null},onLoad:function(){}}),cc._RF.pop()},{}],Card:[function(e,t,a){"use strict";cc._RF.push(t,"0b240cv8k9NbZoLQBFLRrIP","Card"),cc.Class({extends:cc.Component,properties:{index:0,id:0},onLoad:function(){}}),cc._RF.pop()},{}],ChatPanel:[function(e,t,a){"use strict";cc._RF.push(t,"ac6a6E1pe9FTbm7Bb7gE7ss","ChatPanel");var i=e("tdkRoomData"),o=e("gameDefine"),c=e("SoundMngr");cc.Class({extends:cc.Component,properties:{emoChatContainer:cc.Node,chatAnimationPrefab:cc.Prefab,fastVoiceItem:cc.Node},onLoad:function(){this.chatInput=cc.find("allPanel/EditBox",this.node).getComponent(cc.EditBox),this.sendButton=cc.find("allPanel/sendButton",this.node),this.chatInput.string="";for(var e=0;e<16;e++){var t=cc.instantiate(this.chatAnimationPrefab);this.emoChatContainer.addChild(t),t.x=e%6*140-350,t.y=-60-150*parseInt(e/6);var a=t.getComponent(cc.Animation);if(e<16){var n=a.getClips()[e].name;t.name=n,a.play(n),t.on(cc.Node.EventType.TOUCH_END,this.onEmoClick,this)}}this.initFastVoiceItems(),cc.log("GameData.client.gameType = "+GameData.client.gameType),GameData.client.gameType===o.GameType.Game_niu_niu||GameData.client.gameType===o.GameType.Game_TDK||GameData.client.gameType===o.GameType.Game_Niu_Niu_10||GameData.client.gameType===o.GameType.Game_Poker_ZJH?this.NN_selectEmoAndWord(0,1):this.selectEmoAndWord(0,1)},initFastVoiceItems:function(){var e=["嘛钱不钱的，乐呵乐呵得了。","哎呀，出错牌了。","怒了啊，怒了啊。","今儿运气不错啊，没少赢。","楞嘛神儿！快点吧，花都谢了。","我要加油了啊。","这牌打的没谁了，谢了啊。","还让不让人活了，我要发威了","今儿输的太多了，太点背了。","土豪，咱们做朋友吧。","等下哈，我考虑考虑出嘛。","不好意思啊。"],t=["card_K_1","card_K_2","card_K_3","card_K_4","card_K_5","card_K_6","card_K_7","card_K_8","card_K_9","card_K_10","card_K_11","card_K_12"];GameData.client.gameType==o.GameType.Game_Poker_DDZ&&(e=["大家好，很高兴见到各位！","和你合作真是太愉快了。","快点儿啊！都等得我花都谢了。","你的牌打得也忒儿好咧！","不要吵了，专心玩游戏吧。","又断线了， 网络怎么这么差啊。","各位真不好意思，我要离开一会儿。","不要走，决战到天亮。","你是MM，还是GG","我们交个朋友吧，能不能告诉我你的联系方法呀。","再见了，我会想念大家的。"],t=["Chat_0","Chat_1","Chat_2","Chat_3","Chat_4","Chat_5","Chat_6","Chat_7","Chat_8","Chat_9","Chat_10"]),GameData.client.gameType==o.GameType.Game_Poker_TianjinDDZ&&(e=["大家好，很高兴见到各位！","和你合作真是太愉快了。","快点儿啊！都等得我花都谢了。","你的牌打得也忒儿好咧！","不要吵了，专心玩游戏吧。","又断线了， 网络怎么这么差啊。","各位真不好意思，我要离开一会儿。","不要走，决战到天亮。","你是MM，还是GG","我们交个朋友吧，能不能告诉我你的联系方法呀。","再见了，我会想念大家的。"],t=["Chat_0","Chat_1","Chat_2","Chat_3","Chat_4","Chat_5","Chat_6","Chat_7","Chat_8","Chat_9","Chat_10"]),GameData.client.gameType==o.GameType.Game_Poker_paodekuai&&(e=["大家好，很高兴见到各位！","和你合作真是太愉快了。","快点儿啊！都等得我花都谢了。","你的牌打得也忒儿好咧！","不要吵了，专心玩游戏吧。","又断线了， 网络怎么这么差啊。","各位真不好意思，我要离开一会儿。","不要走，决战到天亮。","你是MM，还是GG","我们交个朋友吧，能不能告诉我你的联系方法呀。","再见了，我会想念大家的。"],t=["Chat_0","Chat_1","Chat_2","Chat_3","Chat_4","Chat_5","Chat_6","Chat_7","Chat_8","Chat_9","Chat_10"]),GameData.client.gameType==o.GameType.Game_niu_niu&&(e=["大家好，很高兴见到各位","初来乍到，请大家手下留情","快点吧，花开花谢好几回了","别拼了，没牛就是没牛","不好意思，又赢了","底裤都要输光了咯","我先走了，后会有期","怎么又是你坐庄啊","从天堂到地狱，我路过人间"],t=["voice_0","voice_1","voice_2","voice_3","voice_4","voice_5","voice_6","voice_7","voice_8"]),GameData.client.gameType==o.GameType.Game_Poker_ZJH&&(e=["三十年河东三十年河西","宝宝委屈但宝宝不说","不要欺负我","上天啊，赐我一把好牌吧","同志们，敢不敢火拼一把","禁止跟我比牌","快点下注，别磨磨蹭蹭的","闷到底，看牌是小狗","你敢下我就敢跟，别以为我会怕你","你怎么那么爱看牌"],t=["voice_1","voice_2","voice_3","voice_4","voice_5","voice_6","voice_7","voice_8","voice_9","voice_10"]),GameData.client.gameType==o.GameType.Game_Niu_Niu_10&&(e=["大家好，很高兴见到各位","初来乍到，请大家手下留情","快点吧，花开花谢好几回了","别拼了，没牛就是没牛","不好意思，又赢了","底裤都要输光了咯","我先走了，后会有期","怎么又是你坐庄啊","从天堂到地狱，我路过人间"],t=["voice_0","voice_1","voice_2","voice_3","voice_4","voice_5","voice_6","voice_7","voice_8"]),GameData.client.gameType==o.GameType.Game_TDK&&(1==i.getPlayerSexByUid(GameData.player.uid)?(e=["走着瞧","你这牌打的太让人无语了","呵呵，没了吧","看你打牌可真费劲","你沙愣的，我们还是朋友","眼瞅都下班了，你快点呗"],t=["chat_01","chat_02","chat_03","chat_04","chat_05","chat_06"]):(e=["小样的你给我等着","拜托有你这样玩牌的吗","哈哈，没了吧","快点吧，牌在你手上都下崽了","朋友，看你打牌可真费劲","喂，你还在不在"],t=["chat_11","chat_12","chat_13","chat_14","chat_15","chat_16"])),GameData.client.gameType!=o.GameType.Game_MJ_HuaDian&&GameData.client.gameType!=o.GameType.Game_Mj_CC&&GameData.client.gameType!=o.GameType.Game_Mj_Heb||(e=["赢的我都过意不去了！","我掐指一算，你这是要点炮呀！","等会，我寻思寻思！","能不能行啦！赶紧的！","城市套路深！我想回农村！","老铁醒醒，该你出牌了。"],t=["card_K_1","card_K_2","card_K_3","card_K_4","card_K_5","card_K_6"]);for(var a=0;a<e.length;a++){var n=cc.instantiate(this.fastVoiceItem);n.parent=this.fastVoiceItem.parent,n.x=this.fastVoiceItem.x,n.y=this.fastVoiceItem.y-61*a,cc.find("Label",n).getComponent(cc.Label).string=e[a],n.getComponent("FastVoiceButton").sound=t[a]}this.fastVoiceItem.getParent().height=this.fastVoiceItem.parent.childrenCount*this.fastVoiceItem.height,this.fastVoiceItem.active=!1},onEmoClick:function(e){c.instance.playAudioOther("button"),cc.log("on emo click : "+e.target.name);var t=e.target.name;ChatHandler.getInstance().requestChat("emo",t,function(e){}),this.onClose()},onDestroy:function(){},onSendButton:function(){c.instance.playAudioOther("button"),""!=this.chatInput.string&&(ChatHandler.getInstance().requestChat("word",this.chatInput.string,function(e){}),this.chatInput.string="",this.onClose())},selectEmoAndWord:function(e,t){c.instance.playAudioOther("button");var a=cc.find("allPanel/emoScrollView",this.node),n=cc.find("allPanel/wordScrollView",this.node),i=cc.find("allPanel/switchToggle/wordBtn",this.node),o=cc.find("allPanel/switchToggle/emoBtn",this.node),r=cc.find("allPanel/switchToggle/wordBtn_stop",this.node),s=cc.find("allPanel/switchToggle/emoBtn_stop",this.node);1==t?(i.active=!0,s.active=!0,n.active=!0,o.active=!1,r.active=!1,a.active=!1):2==t&&(i.active=!1,s.active=!1,n.active=!1,o.active=!0,r.active=!0,a.active=!0)},NN_selectEmoAndWord:function(e,t){c.instance.playAudioOther("button");var a=cc.find("allPanel/emoScrollView",this.node),n=cc.find("allPanel/wordScrollView",this.node),i=cc.find("allPanel/wordSprite",this.node),o=cc.find("allPanel/emoSprite",this.node),r=cc.find("allPanel/wordButton",this.node),s=cc.find("allPanel/emoButton",this.node);1==t?(i.active=!0,s.active=!0,n.active=!0,o.active=!1,r.active=!1,a.active=!1):2==t&&(i.active=!1,s.active=!1,n.active=!1,o.active=!0,r.active=!0,a.active=!0)},onClose:function(){c.instance.playAudioOther("button");for(var e=0;e<this.emoChatContainer.childrenCount;e++){var t=this.emoChatContainer.children[e].getComponent(cc.Animation),a=t.getClips()[e].name;t.stop(a)}closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",tdkRoomData:"tdkRoomData"}],CompetitionDetail:[function(e,t,a){"use strict";cc._RF.push(t,"4895fxaTONI9YpkvRZSOZsg","CompetitionDetail");e("gameDefine");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{gameName:cc.Label},onLoad:function(){},initUI:function(e){this.gameName.string=this.getGameName(e)},close:function(){closeView(this.node.name)},getGameName:function(e){return n.getServerConfig().fight[e].name}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine"}],CompetitionRecord:[function(e,t,a){"use strict";cc._RF.push(t,"8ab70AQ/ZVNor0kcLBrWvJm","CompetitionRecord"),cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,scrollViewItem:cc.Node,content:cc.Node},onLoad:function(){},close:function(){closeView(this.node.name)},initUI:function(){}}),cc._RF.pop()},{}],"DDZ-ReplayCardController":[function(e,t,a){"use strict";cc._RF.push(t,"237ce2RBZBHPICdOjPhGb5a","DDZ-ReplayCardController"),cc.Class({extends:cc.Component,properties:{uid:0,handPokers:cc.Node,disPokers:cc.Node,headNode:cc.Node,headPrefab:cc.Prefab,headComponent:null,direction:"right",handPokerList:[],disPokerList:[]},getList:function(){return{uid:this.uid,hand:this.handPokerList,dis:this.disPokerList}},onLoad:function(){this.joinermax=Object.keys(ReplayData.players).length},showHead:function(e,t){this.getHeadComponent().setName(e),this.getHeadComponent().setHeadIcon(t)},showPlayerIdentity:function(e,t){this.getHeadComponent().showPlayerIdentity(e,t)},getLiuGuang:function(e){},setCoin:function(e){this.getHeadComponent().setCoin(e)},setNamePositionByDir:function(e){this.getHeadComponent().setNamePositionByDir(e)},getHeadComponent:function(){if(null==this.headComponent){var e=cc.instantiate(this.headPrefab);e.parent=this.headNode,this.headComponent=e.getComponent("DDZ-playerTemplate")}return this.headComponent},discard:function(e){if(cc.log("cards:"+e),this.hideDisCard(),null!=e){this.handCardListRemove(e);for(var t=0;t<e.length;t++)this.disPokerList.push(e[t]);this.doHandCard(),this.showDisCard(e)}else cc.log("ReplayCardController,can not discard the card, the card is null or length is not 1")},showDisCard:function(e){cc.log("discards:"+e);for(var t=0;t<e.length;t++){var a="dis_"+t,n=this.disPokers.getChildByName(a);n.active=!0,this.showCardContent(n,e[t])}},hideDisCard:function(){for(var e in this.disPokers.children)this.disPokers.children[e].active=!1},doHandCard:function(){var e=this.handPokerList.length;for(var t in this.handPokerSort(this.handPokerList),this.handPokers.children)this.handPokers.children[t].active=!1;var a=Math.ceil(this.handPokers.childrenCount/2)-Math.ceil(e/2);if("down"==this.handPokers.parent.name.substring(6))for(var n=0;n<e;n++){var i="hand_"+(n+a);null!=(o=this.handPokers.getChildByName(i))?(o.active=!0,this.showCardContent(o,this.handPokerList[n])):cc.error("can not find the card node, name is "+i)}else for(n=0;n<e;n++){var o;i="hand_"+n;null!=(o=this.handPokers.getChildByName(i))?(o.active=!0,this.showCardContent(o,this.handPokerList[n])):cc.error("can not find the card node, name is "+i)}},showCardContent:function(e,t){e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},handCardListRemove:function(e){for(var t=this.handPokerList.length,a=0;a<t;a++)for(var n=0;n<e.length;n++)this.handPokerList[a]==e[n]&&(this.handPokerList.splice(a,1),this.handCardListRemove(e))},showHandCard:function(e){if(this.handPokerList=[],null!=e){for(var t=0;t<e.length;t++){var a=e[t];this.handPokerList.push(a)}this.doHandCard()}else cc.error("cardList is null")},addHolePoker:function(e){this.showHandCard(e)},handPokerSort:function(){for(var e=[],t=[],a=0;a<this.handPokerList.length;a++)t[a]=this.handPokerList[a]%100;t.sort(function(e,t){return e-t});for(a=0;a<this.handPokerList.length;a++)for(var n=0;n<t.length;n++)if(this.handPokerList[a]%100==t[n]){e[n]=this.handPokerList[a],this.handPokerList[a]=0,t[n]=0;break}return this.handPokerList=e,this.handPokerList}}),cc._RF.pop()},{}],"DDZ-ReplayMain":[function(e,t,a){"use strict";cc._RF.push(t,"d0fa43MczhHpYav4aNMb3dB","DDZ-ReplayMain");e("SoundMngr");var c=e("gameDefine");cc.Class({extends:cc.Component,properties:{playerCardNodes:{default:[],type:[cc.Node]},playerDownNode:cc.Node,playerRightNode:cc.Node,playerLeftNode:cc.Node,otherNode:cc.Node,holePokerNode:cc.Node,multipleNode:cc.Node,chuaiIcon_right:cc.Node,chuaiIcon_left:cc.Node,tiIcon_right:cc.Node,tiIcon_left:cc.Node,stopBtn:cc.Button,playBtn:cc.Button,exitBtn:cc.Button,quick_btn:cc.Button,overBtn:cc.Button,_actionIndex:-1,_playerCardList:[],_effectController:null,roomNum:cc.Label,runSum:cc.Label,detain:cc.Label,ruleLabel:cc.Label},onLoad:function(){this.initNum=1,this.stopBtn.node.active=!1,this.playBtn.node.active=!0,this.ruleLabel.string=getRuleStrDDZ(ReplayRoomData.opts),registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("tjddz-onGameStart",this,this.showTableLayer),registEvent("onServerNotice",this,handlerServerNotice),scheduleLamp(this),this.detain_left=0,this.detain_right=0,(this.detain_down=0)<ReplayRoomData.opts.detain?(this.detain.node.active=!0,null==ReplayData.game.opts.detain?this.detain.string="押底：0":this.detain.string="押底："+ReplayData.game.opts.startDetain):this.detain.node.active=!1},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTableLayer),registEvent("onServerNotice",this,handlerServerNotice)},onEnable:function(){cc.director.getScheduler().setTimeScale(1),this.roomNum.getComponent(cc.Label).string=ReplayRoomData.roomid,this.initStopPanel();for(var e=0;e<this.playerCardNodes.length;e++){var t=cc.find("cardHand",this.playerCardNodes[e]),a=cc.find("cardDis",this.playerCardNodes[e]);this.hideChildNode(t),this.hideChildNode(a)}for(e=0;e<this._playerCardList.length;e++){var n=this._playerCardList[e],i=this.getScore(n.uid);n.setCoin(i)}this.schedule(this.runAction,1)},showTableLayer:function(){GameData.client.gameType==c.GameType.Game_Mj_Tianjin?cc.director.loadScene("table"):GameData.client.gameType==c.GameType.Game_Poker_DDZ?cc.director.loadScene("table-DDZ"):GameData.client.gameType==c.GameType.Game_Poker_TianjinDDZ&&cc.director.loadScene("table-TJDDZ")},runAction:function(){this.runNextAction()},initData:function(){cc.log("replayDataJson: ",JSON.stringify(replayDataJson)),ReplayData=JSON.parse(replayDataJson)},initStopPanel:function(){var t=this;this.stopBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(1),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.playBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(0),t.stopBtn.node.active=!0,t.playBtn.node.active=!1}),this.exitBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){ReplayDataCenter.openRoundPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")}),this.quick_btn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(2),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.overBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){t.overBtnClick()})},onClose:function(){ReplayDataCenter.openReplayPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")},overBtnClick:function(){this.unschedule(this.runAction);for(var e=this._actionIndex+1;e<ReplayData.game.actions.length;e++){var t=ReplayData.game.actions[e],a=t.uid,n=t.action,i=t.card;cc.log(e,a,n,i)}var o;for(var r in ReplayDataCenter.resultCard=this.getAllCards(),ReplayData.game.actions)if("over"==ReplayData.game.actions[r].action){o=ReplayData.game.actions[r];break}if(null!=o.data.dissovlt){createMoveMessage("房间已解散");var s=this;this.scheduleOnce(function(){s.onClose()},1)}else openView("DDZ-replayResult",c.GameType.Game_Poker_DDZ)},showCardContent:function(e,t){e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},getScore:function(e){for(var t,a=0;a<ReplayRoomData.players.length;a++)ReplayData.id==ReplayRoomData.players[a].id&&(t=a);var n=0;if(0!=t)for(a=0;a<t;a++)n+=ReplayRoomData.players[a].score[e];return n},runNextAction:function(){if(this._actionIndex++,cc.log("ReplayData: ",JSON),this._actionIndex<ReplayData.game.actions.length){var e=ReplayData.game.actions[this._actionIndex],t=e.uid,a=e.action,n=e.card;cc.log(this._actionIndex,t,a,n),this.whoDoSomething(e)}else if(this._actionIndex==ReplayData.game.actions.length){cc.log("replay over");this._actionIndex;for(var i=0;i<this._playerCardList.length;i++){var o=this._playerCardList[i],r=this.getScore(o.uid);r+=ReplayData.scores[o.uid],o.setCoin(r)}this.lastTime=2,this.schedule(this.updateLastTime,1)}else this.unschedule(this.runAction)},updateLastTime:function(){if(this.lastTime--,this.lastTime<=0){var e;for(var t in ReplayDataCenter.resultCard=this.getAllCards(),ReplayData.game.actions)if("over"==ReplayData.game.actions[t].action){e=ReplayData.game.actions[t];break}if(null!=e.data.dissovlt){createMoveMessage("房间已解散");var a=this;this.scheduleOnce(function(){a.onClose()},1)}else openView("DDZ-replayResult",c.GameType.Game_Poker_DDZ);this.unschedule(this.updateLastTime)}},getAllCards:function(){for(var e=[],t=0;t<this.playerCardNodes.length;t++){var a=this.playerCardNodes[t];e.push(a.getComponent("DDZ-ReplayCardController").getList())}return e},setHeadScore:function(e,t){var a=0,n=this.getPosByUid(e);for(var i in"down"==n?a=this.detain_down+=t:"right"==n?a=this.detain_right+=t:"left"==n&&(a=this.detain_left+=t),ReplayData.game.opts.startScore)e==i&&(a+=ReplayData.game.opts.startScore[i]);return a},initHeadScore:function(){for(var e=0;e<this._playerCardList.length;e++){var t=this._playerCardList[e],a=0;for(var n in ReplayData.game.opts.startScore)if(n==t.uid){a=ReplayData.game.opts.startScore[n],t.setCoin(a);break}}},showDetain:function(e){for(var t=0;t<this._playerCardList.length;t++){var a=this._playerCardList[t],n=0;for(var i in e.score)if(i==a.uid){n=this.setHeadScore(i,e.score[i]),a.setCoin(n);break}}var o=Math.abs(this.detain_down+this.detain_left+this.detain_right);o+=ReplayData.game.opts.startDetain,this.detain.string="押底："+o},showHandCards:function(e){this._playerCardList=[],cc.log("data:"+JSON.stringify(e));var t,a=e.card;if(1==otherReplay[0]){for(var n=0;n<ReplayRoomData.players.length;n++)if(ReplayRoomData.players[n]){t=n;break}}else for(n=0;n<ReplayRoomData.players.length;n++)if(ReplayRoomData.players[n].uid==GameData.player.uid){t=n;break}var i,o;if(i=ReplayRoomData.players,null!=(o=t)&&null!=o){var r=[];this.playerNum=ReplayData.players.length,4==this.playerNum||(3==this.playerNum?(0==o&&(r=[0,1,2]),1==o&&(r=[1,2,0]),2==o&&(r=[2,0,1])):this.playerNum);for(var s=0;s<r.length;s++){var c=r[s],d=a[c];if(null!=this.playerCardNodes&&0<this.playerCardNodes.length&&null!=this.playerCardNodes[s]){var h=this.playerCardNodes[s].getComponent("DDZ-ReplayCardController");h.showHandCard(d.card);var l=a[c].uid,u=i[c].name,m=i[c].headimgurl;h.uid=l,h.showHead(u+"",m),1==s&&h.setNamePositionByDir("right"),this._playerCardList.push(h)}}1==this.initNum&&(this.initHeadScore(),this.initNum++)}},tiChuaiAction:function(e){var t=cc.callFunc(function(){e.active=!0},this),a=cc.callFunc(function(){e.active=!1},this),n=cc.delayTime(1),i=cc.sequence(t,n,a);e.parent.runAction(i)},showPlayerTiChuai:function(e,t,a,n){1==n.num&&a==t?"right"==e?(cc.log("showPlayerTiChuai pos right"),this.tiChuaiAction(this.chuaiIcon_right)):"left"==e&&(cc.log("showPlayerTiChuai pos left"),this.tiChuaiAction(this.chuaiIcon_left)):1==n.num&&a!=t&&("right"==e?(cc.log("showPlayerTiChuai dizhu pos right"),this.tiChuaiAction(this.tiIcon_right)):"left"==e&&(cc.log("showPlayerTiChuai dizhu pos left"),this.tiChuaiAction(this.tiIcon_left)))},showKicking:function(e){cc.log("showKicking");var t=this.getPosByUid(e.uid);this.showPlayerTiChuai(t,ReplayData.game.opts.dizhu,e.uid,e)},showHeadTiChuai:function(e,t,a,n){var i=e.getChildByName("TablePlayerTemplate"),o=cc.find("tiChuaiNode",i);if(1==n.num&&a!=t){var r=cc.find("tiIcon",o);r.active=!0,e==this.playerRightNode&&(r.x=-67)}else if(1==n.num&&a==t){var s=cc.find("chuaiIcon",o);s.active=!0,e==this.playerRightNode&&(s.x=-67)}},showPlayerKicking:function(e){cc.log("showPlayerKicking");var t=this.getPosByUid(e.uid);"down"==t?this.showHeadTiChuai(this.playerDownNode,ReplayData.game.opts.dizhu,e.uid,e):"right"==t&&this.showHeadTiChuai(this.playerRightNode,ReplayData.game.opts.dizhu,e.uid,e),"left"==t&&this.showHeadTiChuai(this.playerLeftNode,ReplayData.game.opts.dizhu,e.uid,e)},getPosByUid:function(e){var t;if(1==otherReplay[0]){for(var a=0;a<ReplayRoomData.players.length;a++)if(ReplayRoomData.players[a]){t=a;break}}else for(a=0;a<ReplayRoomData.players.length;a++)if(ReplayRoomData.players[a].uid==GameData.player.uid){t=a;break}var n,i=[];0==(n=t)&&(i=[0,1,2]),1==n&&(i=[1,2,0]),2==n&&(i=[2,0,1]);var o=["down","right","left"];for(a=0;a<i.length;a++)if(this._playerCardList[a].uid==e)return o[a]},whoDoSomething:function(e){this.runSum.getComponent(cc.Label).string="进度: "+this._actionIndex+"/"+(ReplayData.game.actions.length-1),cc.log("data = "+JSON.stringify(e));var t=this.getCardController(e.uid);if("deal"==e.action&&(this._handPokers=[],this._handPokers=e.card,this.showHandCards(e),1<this._actionIndex&&createMoveMessage("无人叫分,重新发牌")),"holePokers"==e.action){var a=[];for(var n in this._handPokers)e.uid==this._handPokers[n].uid&&(a=this._handPokers[n].card);var i=e.card.concat(a);t.addHolePoker(i);var o=cc.find("jiaofenSps",this.otherNode);this.hideChildNode(o),this.showHolePoker(e),this.showMultiple(1),this.showPlayerIdentity(e)}"jiaofen"==e.action?this.showJiaofen(e):"detain"==e.action?this.showDetain(e):"startTi"==e.action||"startChuai"==e.action?(this.showKicking(e),this.showPlayerKicking(e)):"discard"==e.action?(this.hideOtherNode(e),t.discard(e.card),cc.log("data.multiple:"+e.multiple+JSON.stringify(e)),this.changeMultiple(e.multiple)):"pass"==e.action?(t.hideDisCard(),this.showPass(e)):"over"==e.action&&(cc.log("over:"+JSON.stringify(e)),this.changeMultiple(e.data.boomNum))},showHolePoker:function(e){cc.log("data.cards:"+e.card);var t=0;for(var a in this.holePokerNode.children)this.showCardContent(this.holePokerNode.children[a],e.card[t]),t++},showJiaofen:function(e){for(var t=0;t<this._playerCardList.length;t++)this._playerCardList[t].uid==e.uid?this.showJiaofenText(t,e.num):this.hideJiaofenText(t)},showJiaofenText:function(e,t){var a=cc.find("jiaofenSps/jiaofen"+e,this.otherNode),n="";switch(t){case 1:n="resources/ddz/UI/common/artword/artword_1fen.png";break;case 2:n="resources/ddz/UI/common/artword/artword_2fen.png";break;case 3:n="resources/ddz/UI/common/artword/artword_3fen.png";break;case 4:n="resources/ddz/UI/common/artword/artword_bujiao.png"}var i=cc.textureCache.addImage(cc.url.raw(n));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),a.active=!0},hideJiaofenText:function(e){cc.find("jiaofenSps/jiaofen"+e,this.otherNode).active=!1},showPass:function(e){for(var t=0;t<this._playerCardList.length;t++)e.uid==this._playerCardList[t].uid?this.showPassText(t):this.hidePassText(t)},showPassText:function(e){cc.find("buchuNodes/buchuLb"+e,this.otherNode).active=!0},hidePassText:function(e){cc.find("buchuNodes/buchuLb"+e,this.otherNode).active=!1},showMultiple:function(e){this.showChildNode(this.multipleNode),this.changeMultiple(e)},changeMultiple:function(e){cc.log("num:"+e),cc.find("multipleNum",this.multipleNode).getComponent(cc.Label).string=e},hideOtherNode:function(e){for(var t=0;t<this._playerCardList.length;t++)e.uid==this._playerCardList[t].uid&&this.hidePassText(t)},showPlayerIdentity:function(e){for(var t=this.getCardController(e.uid),a=0;a<this._playerCardList.length;a++)t.uid==ReplayData.game.opts.dizhu&&t.uid==this._playerCardList[a].uid?this._playerCardList[a].showPlayerIdentity(!0,1):this._playerCardList[a].showPlayerIdentity(!0,2)},removeDisFromLast:function(e){var t=ReplayData.game.actions[this._actionIndex-1].uid;this.getCardController(t).removeDisCard(e)},getAnimationIndex:function(e){for(var t="",a=0;a<this.playerCardNodes.length;a++){var n=this.playerCardNodes[a].getComponent("DDZ-ReplayCardController");4==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="right":2==a?t="up":3==a&&(t="left")):3==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="up":2==a&&(t="left")):2==this.playerNum&&n.uid==e&&(0==a?t="down":1==a&&(t="up"))}return t},hideChildNode:function(e){for(var t in e.children)e.children[t].active=!1},showChildNode:function(e){for(var t in e.children)e.children[t].active=!0},cardActionAnimation:function(e,t){},getCardController:function(e){for(var t=0;t<this._playerCardList.length;t++){var a=this._playerCardList[t];if(a.uid==e)return a}return null},ruleClick:function(){},isRuleBtn:function(){},onShowPlayIntrClick:function(){},showPlayIntroduce:function(e){}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"DDZ-ReplayResultPanel":[function(e,t,a){"use strict";cc._RF.push(t,"57f80JCasNMDJx4BgY/2tXt","DDZ-ReplayResultPanel"),cc.Class({extends:cc.Component,properties:{resultIcon:cc.Node,roomID:cc.Label,createtime:cc.Label,roundData:cc.Label,isMark:0,font:{default:[],type:[cc.Font]}},onLoad:function(){this.onShow()},onClose:function(e){ReplayDataCenter.openReplayPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")},onShow:function(){for(var e in this.tiChuaiData=[],ReplayData.game.actions)"startTi"!=ReplayData.game.actions[e].action&&"startChuai"!=ReplayData.game.actions[e].action||this.tiChuaiData.push(ReplayData.game.actions[e]);for(var t=0;t<ReplayData.players.length;t++)this.showCards(t),this.showPlayer(t),this.showScore(t),this.showDetail(t);this.showRoundInfo(),this.showResultIcon(),this.showDetain()},showResultIcon:function(){var e;if(1==otherReplay[0]){for(var t in ReplayRoomData.players)if(t){e=ReplayRoomData.players[t].uid;break}}else e=GameData.player.uid;var a,n=ReplayData.scores[e],i="";0<n?(i="resources/ddz/UI/result/woyingle.png",a=cc.textureCache.addImage(cc.url.raw(i)),this.resultIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)):n<0&&(i="resources/ddz/UI/result/shibaile.png",a=cc.textureCache.addImage(cc.url.raw(i)),this.resultIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a))},showRoundInfo:function(){this.roomID.string="房号："+ReplayData.room;var e=getTimeStr(ReplayRoomData.createtime);this.createtime.string=e[0]+"/"+e[1]+"/"+e[2]+"  "+e[3]+":"+e[4]+":"+e[5];var t=0;if(null!=ReplayRoomData.games)for(var a=0;a<ReplayRoomData.games.length;a++)ReplayData.id==ReplayRoomData.games[a].id&&(t=a+1);else if(null!=ReplayRoomData.record)for(a=0;a<ReplayRoomData.record.length;a++)ReplayData.id==ReplayRoomData.record[a].id&&(t=a+1);this.roundData.string="第"+t+"局"},showDetail:function(e){},showPlayer:function(e){var t=ReplayData.players[e],a=cc.find("player_"+(e+1)+"/headNode/playerID",this.node),n=cc.find("player_"+(e+1)+"/headNode/name",this.node),i=cc.find("player_"+(e+1)+"/headNode/head",this.node),o=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=o,a.getComponent(cc.Label).string=t.uid,this.showPlayerIdentity(t,e),this.showMultiple(t,e),null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showCards:function(e){for(var t,a=ReplayData.players[e],n=cc.find("player_"+(e+1),this.node),i=cc.find("cardsNoe",n),o=a.uid,r=0;r<ReplayData.game.cards.length;r++)if(ReplayData.game.cards[r].uid==o){t=ReplayData.game.cards[r].cards;break}for(var r in i.children)i.children[r].active=!1;for(var s=0;s<t.length;s++){var c=i.getChildByName("card_"+s);c.active=!0,this.showCardContent(c,t[s])}},showPlayerIdentity:function(e,t){var a=cc.find("player_"+(t+1)+"/headNode/identity_icon",this.node),n="";n=e.uid==ReplayData.game.opts.dizhu?"resources/ddz/UI/common/icon/dizhu_icon.png":"resources/ddz/UI/common/icon/nongmin_icon.png";var i=cc.textureCache.addImage(cc.url.raw(n));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)},showDetain:function(){if(0<ReplayRoomData.opts.detain){var e,t=cc.find("panel/detain/label",this.node);for(var a in ReplayData.game.actions)"over"==ReplayData.game.actions[a].action&&(e=ReplayData.game.actions[a]);t.getComponent(cc.Label).string="押底:"+e.data.detain,t.parent.active=!0}else{(t=cc.find("panel/detain/label",this.node)).parent.active=!1}},showMultiple:function(e,t){var a,n=cc.find("player_"+(t+1)+"/difen/label",this.node),i=cc.find("player_"+(t+1)+"/beishu/label",this.node);for(var o in cc.log("ReplayData:"+JSON.stringify(ReplayData.game.actions)),ReplayData.game.actions)if("over"==ReplayData.game.actions[o].action){a=ReplayData.game.actions[o];break}n.getComponent(cc.Label).string=a.data.remainFen,i.getComponent(cc.Label).string=a.data.boomNum,n.parent.y=210,i.parent.y=162;var r=cc.find("player_"+(t+1)+"/shouDi/label",this.node),s=cc.find("player_"+(t+1)+"/kuiDi/label",this.node);r.parent.active=!1,s.parent.active=!1,0<ReplayRoomData.opts.detain&&this.showDetainScore(n,i,e,t,a),1==ReplayRoomData.opts.kicking&&this.showPlayerTiChuai(t)},showDetainScore:function(e,t,a,n,i){if(cc.log("showDetainScore"),1==i.data.flag)a.uid==ReplayData.game.opts.dizhu&&i.data.detainData<0?(e.parent.y=239,t.parent.y=209,(o=cc.find("player_"+(n+1)+"/shouDi/label",this.node)).getComponent(cc.Label).string=i.data.detainInfo[a.uid],o.parent.active=!0,o.parent.y=141,(r=cc.find("player_"+(n+1)+"/kuiDi/label",this.node)).getComponent(cc.Label).string=-i.data.detainData,r.parent.active=!0,r.parent.y=176):(e.parent.y=226,t.parent.y=190,(o=cc.find("player_"+(n+1)+"/shouDi/label",this.node)).getComponent(cc.Label).string=i.data.detainInfo[a.uid],o.parent.active=!0,o.parent.y=155);else if(null==i.data.flag){var o;if(a.uid==ReplayData.game.opts.dizhu)if(0<i.data.detainInfo)e.parent.y=226,t.parent.y=190,(o=cc.find("player_"+(n+1)+"/shouDi/label",this.node)).getComponent(cc.Label).string=i.data.detainInfo,o.parent.active=!0,o.parent.y=155;else if(i.data.detainInfo<0){var r;e.parent.y=226,t.parent.y=190,(r=cc.find("player_"+(n+1)+"/kuiDi/label",this.node)).getComponent(cc.Label).string=-i.data.detainInfo,r.parent.active=!0,r.parent.y=155}}},showPlayerTiChuai:function(e){for(var t=ReplayData.players[e].uid,a=0;a<this.tiChuaiData.length;a++){if(this.tiChuaiData[a].uid==t&&t!=ReplayData.game.opts.dizhu){if(1==this.tiChuaiData[a].num)cc.find("player_"+(e+1)+"/tiIcon",this.node).active=!0}else if(this.tiChuaiData[a].uid==t&&t==ReplayData.game.opts.dizhu){if(1==this.tiChuaiData[a].num)cc.find("player_"+(e+1)+"/chuaiIcon",this.node).active=!0}}},showCardContent:function(e,t){e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},showScore:function(e){var t=ReplayData.players[e].uid,a=cc.find("player_"+(e+1)+"/field_num1",this.node);0<ReplayData.scores[t]?(a.getComponent("cc.Label").font=this.font[0],a.getComponent("cc.Label").string="+"+ReplayData.scores[t]):(ReplayData.scores[t]<0?a.getComponent("cc.Label").font=this.font[1]:a.getComponent("cc.Label").font=this.font[2],a.getComponent("cc.Label").string=ReplayData.scores[t])},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{}],"DDZ-coinEnd":[function(e,t,a){"use strict";cc._RF.push(t,"27f69QL1llCqI/C+ianfLn0","DDZ-coinEnd");var s=e("roomHandler"),n=e("matchHandler"),c=e("gameDefine");cc.Class({extends:cc.Component,properties:{coinEndNode:cc.Node,coinEndLayer:cc.Node,resultIcon:cc.Node,Player:cc.Node,buttonNode:cc.Node},onLoad:function(){registEvent("coinEndEvent",this,this.onCoinEndEventHandler)},onDestroy:function(){unregistEvent("coinEndEvent",this,this.onCoinEndEventHandler)},onEnable:function(){this.onCoinEndEventHandler()},onCoinEndEventHandler:function(){this.updateUIShow()},onShow:function(){this.uiAction(),this.updateUIShow()},uiAction:function(){this.coinEndNode.active=!0,this.coinEndLayer.scale=.6;var e=cc.scaleTo(.2,1.2),t=cc.scaleTo(.2,.9),a=cc.scaleTo(.1,1);this.coinEndLayer.stopAllActions(),this.coinEndLayer.runAction(cc.sequence(e,t,a).easing(cc.easeIn(3)))},updateUIShow:function(){if(null!=GameData.room.opts){if(GameData.room.opts.joinermax){this.hideNodeChild(this.resultIcon);for(var e=0;e<GameData.room.opts.joinermax;e++)this.showPlayer(e),this.showMultiple(e),this.showScore(e),this.showDouble(e)}this.showButtonNode()}},setName:function(e){return isChinese(e)?getShortStr(e,5):getShortStr(e,10)},setHeadImg:function(e,a){null==e||e.length<=0||null==a||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showPlayer:function(e){var t=GameData.joiners[e];if(null!=t){var a=cc.find("player_"+(e+1),this.Player),n=cc.find("name",a),i=cc.find("head",a),o=cc.find("identityIcon",a);t.uid==GameDataDDZ.game.dizhuUid?o.active=!0:t.uid!=GameData.game.dizhuUid&&(o.active=!1),GameData.player.uid==t.uid?n.color=new cc.Color(255,229,124):n.color=new cc.Color(123,253,255),n.getComponent(cc.Label).string=this.setName(t.name),this.setHeadImg(t.headimgurl,i)}},showMultiple:function(e){if(null!=GameData.joiners[e]){var t=cc.find("player_"+(e+1),this.Player);cc.find("multiple",t).getComponent(cc.Label).string=GameDataDDZ.resultData.boomNum}},showDouble:function(e){var t=GameData.joiners[e];if(null!=t){var a=t.uid,n=cc.find("player_"+(e+1),this.Player);if(!GameDataDDZ.isEmptyObject(GameDataDDZ.kicking))for(var i in GameDataDDZ.kicking.kicking)if(i==a&&a!=GameDataDDZ.kicking.dizhu){var o=cc.find("doubleIcon",n);1==GameDataDDZ.kicking.kicking[i]?o.active=!0:o.active=!1}else if(i==a&&a==GameDataDDZ.kicking.dizhu){o=cc.find("doubleIcon",n);1==GameDataDDZ.kicking.kicking[i]?o.active=!0:o.active=!1}}},showScore:function(e){var t=GameData.joiners[e];if(null!=t){var a=t.uid,n=cc.find("player_"+(e+1),this.Player),i=cc.find("score",n),o=0;if(c.currencyType.Currency_Coin==GameData.room.opts.currencyType){var r=s.getCoinData();r&&r.coins&&r.coins[a]&&(o=r.coins[a])}else GameDataDDZ.resultData.score&&(o=GameDataDDZ.resultData.score[a]);if(0<o){if(i.color=new cc.Color(255,229,124),i.getComponent(cc.Label).string="+"+o,a==GameData.player.uid)cc.find("winIcon",this.resultIcon).active=!0}else if(o<0){if(i.color=new cc.Color(123,253,255),i.getComponent(cc.Label).string=o,a==GameData.player.uid)cc.find("loseIcon",this.resultIcon).active=!0}else{if(i.color=new cc.Color(132,255,123),i.getComponent(cc.Label).string=o,a==GameData.player.uid)cc.find("dogfallIcon",this.resultIcon).active=!0}}},showButtonNode:function(){null!=GameData.room.opts&&(c.currencyType.Currency_Coin==GameData.room.opts.currencyType?(cc.find("continBtn2",this.buttonNode).active=!1,cc.find("continBtn",this.buttonNode).active=!0,cc.find("backBtn",this.buttonNode).active=!0):(cc.find("continBtn2",this.buttonNode).active=!0,cc.find("continBtn",this.buttonNode).active=!1,cc.find("backBtn",this.buttonNode).active=!1))},showTimer:function(){var e=cc.find("continBtn",this.buttonNode),t=cc.find("time",e),a=6,n=this;this.schedule(function e(){a--,t.getComponent(cc.Label).string="（"+a+"）",a<=0&&(n.unschedule(e),n.btnBackOnClicked())},1)},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},onSelectGameClick:function(e,t){inCD(1e3)||(t==c.currencyType.Currency_Card?(GameData.roomClose?(this.coinEndNode.active=!1,this.node.getComponent("DDZ-roomMain").showSummaryLayer()):(DDZHandler.getInstance().requestReady(function(e){}),this.coinEndNode.active=!1,GameDataDDZ.game.dizhuUid=0,sendEvent("initTableNode")),GameDataDDZ.clearObject(GameDataDDZ.kicking)):t==c.currencyType.Currency_Coin&&(n.selectGameType=GameData.room.opts.gameType,n.selectGameLv=GameData.room.opts.scorelv,n.signup(),GameDataDDZ.game.dizhuUid=0,sendEvent("initTableNode")))},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")}}),cc._RF.pop()},{gameDefine:"gameDefine",matchHandler:"matchHandler",roomHandler:"roomHandler"}],"DDZ-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"5e7d7x5FwNFj4ahxAtX84LG","DDZ-createRoom");e("roomHandler");var s=e("configMgr"),c=e("gameDefine");cc.Class({extends:cc.Component,properties:{round6:cc.Toggle,round10:cc.Toggle,round20:cc.Toggle,fanshu2:cc.Toggle,fanshu3:cc.Toggle,fanshu4:cc.Toggle,wuxianfan:cc.Toggle,payNode:cc.Node,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,timesNode:cc.Node,times1:cc.Toggle,times2:cc.Toggle,times5:cc.Toggle,scoreNode:cc.Node,score1:cc.Toggle,score2:cc.Toggle,score3:cc.Toggle,limitLabel:cc.Label,jiaofen:cc.Toggle,lzJiaofen:cc.Toggle,bwJiaofen:cc.Toggle,detain1:cc.Toggle,detain2:cc.Toggle,detain3:cc.Toggle,detain4:cc.Toggle,spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]},fullMark:{default:null,type:cc.Toggle},suppress:{default:null,type:cc.Toggle},tiChuai:{default:null,type:cc.Toggle},fourAndTow:{default:null,type:cc.Toggle}},onLoad:function(){this.refreshUI(),this.modeType=1,this.spendData=void 0},getModeType:function(){return this.modeType},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(c.GameType.Game_Poker_DDZ);var e={gameType:c.GameType.Game_Poker_DDZ,playType:GameDataDDZ.createRoomOpts.playType,roundMax:GameDataDDZ.createRoomOpts.roundMax,roundRule:GameDataDDZ.createRoomOpts.roundMax,roundType:GameDataDDZ.createRoomOpts.roundType,fanshu:GameDataDDZ.createRoomOpts.fanshu,joinermax:3,clubId:0,roomType:0,costType:GameDataDDZ.createRoomOpts.costType,score:GameDataDDZ.createRoomOpts.score,times:GameDataDDZ.createRoomOpts.times,jiaofenType:GameDataDDZ.createRoomOpts.jiaofenType,fullMark:GameDataDDZ.createRoomOpts.fullMark,suppress:GameDataDDZ.createRoomOpts.suppress,kicking:GameDataDDZ.createRoomOpts.kicking,detain:GameDataDDZ.createRoomOpts.detain,fourFlag:GameDataDDZ.createRoomOpts.fourFlag,scorelv:GameDataDDZ.createRoomOpts.score,currencyType:null,settleType:null},t=s.getModeType();return null==t||null==t.Game_Poker_DDZ||(e.currencyType=t.Game_Poker_DDZ.CurrencyType,e.settleType=t.Game_Poker_DDZ.SettleType),e},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..ddz");var e="",t="",a=s.getModeType();if(null!=a&&null!=a.Game_Poker_DDZ){var n=s.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Poker_DDZ.CurrencyType,this.modeType){case c.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[c.GameType.Game_Poker_DDZ];break;case c.currencyType.Currency_Coin:e="金",this.spendData=n.roomCoin[c.GameType.Game_Poker_DDZ]}if(this.spendData)for(var i,o=0;o<Object.keys(this.spendData).length;o++){var r=0;this.modeType==c.currencyType.Currency_Card?(0===o?i=this.spendData[6].cost:1===o?i=this.spendData[10].cost:2===o&&(i=this.spendData[20].cost),r=i[3].final,this.pay2.isChecked,this.spendUI[o].string="（"+e+"*"+r+t+"）"):(r=(i=this.spendData[o].cost)[3].final,t="/局",this.spendUI[o].string=""),this.drowArray[o].active=0==r}else cc.log("..spendData is undefined")}}},selectRoomType:function(e,t){},saveRuleFromUI:function(){this.round6.isChecked?(GameDataDDZ.createRoomOpts.roundMax=6,GameDataDDZ.createRoomOpts.roundType=c.roundType.round):this.round10.isChecked?(GameDataDDZ.createRoomOpts.roundMax=10,GameDataDDZ.createRoomOpts.roundType=c.roundType.round):this.round20.isChecked&&(GameDataDDZ.createRoomOpts.roundMax=20,GameDataDDZ.createRoomOpts.roundType=c.roundType.round),this.fanshu2.isChecked?GameDataDDZ.createRoomOpts.fanshu=2:this.fanshu3.isChecked?GameDataDDZ.createRoomOpts.fanshu=3:this.fanshu4.isChecked?GameDataDDZ.createRoomOpts.fanshu=4:this.wuxianfan.isChecked&&(GameDataDDZ.createRoomOpts.fanshu=15),this.pay1.isChecked?GameDataDDZ.createRoomOpts.costType=1:this.pay2.isChecked?GameDataDDZ.createRoomOpts.costType=2:this.pay3.isChecked&&(GameDataDDZ.createRoomOpts.costType=3),this.jiaofen.isChecked?GameDataDDZ.createRoomOpts.jiaofenType=1:this.lzJiaofen.isChecked?GameDataDDZ.createRoomOpts.jiaofenType=2:this.bwJiaofen.isChecked&&(GameDataDDZ.createRoomOpts.jiaofenType=3),this.detain1.isChecked?GameDataDDZ.createRoomOpts.detain=1:this.detain2.isChecked?GameDataDDZ.createRoomOpts.detain=2:this.detain3.isChecked?GameDataDDZ.createRoomOpts.detain=3:this.detain4.isChecked&&(GameDataDDZ.createRoomOpts.detain=0),this.fullMark.isChecked?GameDataDDZ.createRoomOpts.fullMark=!0:GameDataDDZ.createRoomOpts.fullMark=!1,this.suppress.isChecked?GameDataDDZ.createRoomOpts.suppress=!0:GameDataDDZ.createRoomOpts.suppress=!1,this.tiChuai.isChecked?GameDataDDZ.createRoomOpts.kicking=!0:GameDataDDZ.createRoomOpts.kicking=!1,this.fourAndTow.isChecked?GameDataDDZ.createRoomOpts.fourFlag=!0:GameDataDDZ.createRoomOpts.fourFlag=!1,this.score1.isChecked?GameDataDDZ.createRoomOpts.score=0:this.score2.isChecked?GameDataDDZ.createRoomOpts.score=1:this.score3.isChecked&&(GameDataDDZ.createRoomOpts.score=2),GameDataDDZ.saveCreateRoomOpts()},selectRoundRuleClick:function(e,t){if(null!=t){switch(t){case 6:this.round6.isChecked=!0,this.round10.isChecked=!1,this.round20.isChecked=!1;break;case 10:this.round10.isChecked=!0,this.round6.isChecked=!1,this.round20.isChecked=!1;break;case 20:this.round20.isChecked=!0,this.round6.isChecked=!1,this.round10.isChecked=!1}this.round6.isChecked?GameDataDDZ.createRoomOpts.roundMax=6:this.round10.isChecked?GameDataDDZ.createRoomOpts.roundMax=10:this.round20.isChecked&&(GameDataDDZ.createRoomOpts.roundMax=20),this.showSpendUI(),this.refreshTimesScore()}},selectTimesClick:function(e,t){if(null!=t){switch(t){case 1:this.times1.isChecked=!0,this.times2.isChecked=!1,this.times5.isChecked=!1;break;case 10:this.times2.isChecked=!0,this.times1.isChecked=!1,this.times5.isChecked=!1;break;case 20:this.times5.isChecked=!0,this.times2.isChecked=!1,this.times1.isChecked=!1}this.times1.isChecked?GameDataDDZ.createRoomOpts.times=1:this.times2.isChecked?GameDataDDZ.createRoomOpts.times=2:this.times5.isChecked&&(GameDataDDZ.createRoomOpts.times=5),this.showSpendUI(),this.refreshTimesScore()}},refreshUI:function(){this.round6.isChecked=6==GameDataDDZ.createRoomOpts.roundMax,this.round10.isChecked=10==GameDataDDZ.createRoomOpts.roundMax,this.round20.isChecked=20==GameDataDDZ.createRoomOpts.roundMax,this.fanshu2.isChecked=2==GameDataDDZ.createRoomOpts.fanshu,this.fanshu3.isChecked=3==GameDataDDZ.createRoomOpts.fanshu,this.fanshu4.isChecked=4==GameDataDDZ.createRoomOpts.fanshu,this.wuxianfan.isChecked=15==GameDataDDZ.createRoomOpts.fanshu,this.pay1.isChecked=1==GameDataDDZ.createRoomOpts.costType,this.pay2.isChecked=2==GameDataDDZ.createRoomOpts.costType,this.pay3.isChecked=3==GameDataDDZ.createRoomOpts.costType,this.jiaofen.isChecked=1==GameDataDDZ.createRoomOpts.jiaofenType,this.lzJiaofen.isChecked=2==GameDataDDZ.createRoomOpts.jiaofenType,this.bwJiaofen.isChecked=3==GameDataDDZ.createRoomOpts.jiaofenType,this.detain1.isChecked=1==GameDataDDZ.createRoomOpts.detain,this.detain2.isChecked=2==GameDataDDZ.createRoomOpts.detain,this.detain3.isChecked=3==GameDataDDZ.createRoomOpts.detain,this.detain4.isChecked=0==GameDataDDZ.createRoomOpts.detain,this.fullMark.isChecked=1==GameDataDDZ.createRoomOpts.fullMark,this.suppress.isChecked=1==GameDataDDZ.createRoomOpts.suppress,this.tiChuai.isChecked=1==GameDataDDZ.createRoomOpts.kicking,this.fourAndTow.isChecked=1==GameDataDDZ.createRoomOpts.fourFlag,this.score1.isChecked=0==GameDataDDZ.createRoomOpts.score,this.score2.isChecked=1==GameDataDDZ.createRoomOpts.score,this.score3.isChecked=2==GameDataDDZ.createRoomOpts.score,this.showSpendUI(),this.refreshTimesScore()},refreshTimesScore:function(){if(this.modeType==c.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)return this.timesNode.active=!1,this.scoreNode.active=!1,void(this.payNode.active=!0);this.scoreNode.active=!0,this.timesNode.active=!1,this.payNode.active=!1;var e=0;switch(GameDataDDZ.createRoomOpts.roundMax){case 6:e=0;break;case 10:e=1;break;case 20:e=2}var t=this.spendData[e].cost[3],a=this.spendData[e].enter[3];null==GameDataDDZ.createRoomOpts.times&&(GameDataDDZ.createRoomOpts.times=1),this.score1.isChecked?GameDataDDZ.createRoomOpts.score=0:this.score2.isChecked?GameDataDDZ.createRoomOpts.score=1:this.score3.isChecked&&(GameDataDDZ.createRoomOpts.score=2);var n=cc.find("label",this.score1.node),i=cc.find("label",this.score2.node),o=cc.find("label",this.score3.node);n.getComponent(cc.Label).string="初级场：台费"+t[0]+" 进入条件≥"+a[0]+" 倍数 100",i.getComponent(cc.Label).string="中级场：台费"+t[1]+" 进入条件≥"+a[1]+" 倍数 200",o.getComponent(cc.Label).string="高级场：台费"+t[2]+" 进入条件≥"+a[2]+" 倍数 500"}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"DDZ-home":[function(e,t,a){"use strict";cc._RF.push(t,"4fd30yg15pLNrsAGA4PxWYg","DDZ-home");var n=e("roomHandler"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{layer_join:cc.Node,layer_ddz:cc.Node,head_node:cc.Node,head_name:cc.Label,head_identify_num:cc.Label,head_money_num:cc.Label,head_gold_num:cc.Label,head_friend_num:cc.Label,roomcard_num:cc.Label,create_btn:cc.Button,join_btn:cc.Button,back_btn:cc.Button,fangkaAdd:cc.Button,pay1_club:cc.Toggle,pay2_club:cc.Toggle,pay3_club:cc.Toggle,pay4_club:cc.Toggle,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,maskBtn:cc.Node,selectClubBtn:cc.Button,addBtn:cc.Button,clubName:cc.Label,diamondsNum:cc.Label,agentBtn:cc.Node,room_number:cc.String,room_number_bg:cc.Sprite,playerTemplate:cc.Prefab,paoMadengLabel:cc.Label,_paoMadengX:0,hintNode:cc.Node,activeBtnNode:cc.Node,activeRedPoint:cc.Node},onShiSanShui:function(){cc.director.loadScene("SSSHome")},onLoad:function(){if(this.room_number="",this.roomcard_num.string=GameData.player.card,GameData.player.club&&0<Object.keys(GameData.player.club).length&&(null!=GameData.playerCurrClubId&&null!=GameData.playerCurrClubId||(GameData.playerCurrClubId=GameData.getClubDataByIndex(0).club_id),0!=Object.keys(GameData.player.club).length)){if(null==GameData.getClubDataByClubId(GameData.playerCurrClubId))return;this.clubName.string=GameData.getClubDataByClubId(GameData.playerCurrClubId).clubName,this.diamondsNum.string=GameData.getClubDataByClubId(GameData.playerCurrClubId).diamond}isChinese(GameData.player.name)?this.head_name.string=getShortStr(GameData.player.name,5):this.head_name.string=getShortStr(GameData.player.name,10),this.head_identify_num.string=GameData.player.uid,this.head_money_num.string=GameData.player.money;var e=cc.instantiate(this.playerTemplate);e.getComponent("playerTemplate").setPlayer(GameData.player),e.getComponent("playerTemplate").setName(""),e.getComponent("playerTemplate").setIsPlayerIcon(!1),e.getComponent("playerTemplate").setHeadIcon(GameData.player.headimgurl),this.head_node.addChild(e),this.runPaoMadeng(),null==GameData.player.roomid||0==GameData.player.roomid?(this.create_btn.node.active=!0,this.back_btn.node.active=!1):(this.create_btn.node.active=!1,this.back_btn.node.active=!0),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("openScore",this,this.showTableLayer),registEvent("cardChange",this,this.roomcardRefresh),registEvent("refreshUIClubData",this,this.clubDataRefresh),registEvent("refreshUIClubInvite",this,this.showHint),registEvent("refreshCreateOrBackBtn",this,this.refreshCreateOrBackBtn),registEvent("refreshActivityRedPoint",this,this.refreshActivityRedPoint),ReplayDataCenter.openRoundPanel&&(ReplayDataCenter.openRoundPanel=!1,openView("RecordPanel")),ReplayDataCenter.openReplayPanel&&openView("RoundPanel"),this.refreshRuleUI()},onEnable:function(){i.instance.playMusic("sound/wait"),GameData.player.agentFlag||sendEvent("refreshActivityRedPoint"),startLocation()},showTableLayer:function(){cc.director.loadScene("table")},showHint:function(){0<GameData.player.clubInvite.length?this.hintNode.active=!0:this.hintNode.active=!1},fangkaAddCBack:function(e){openView("kefuweixin")},roomcardRefresh:function(){this.roomcard_num.string=GameData.player.card},clubDataRefresh:function(){if(console.log("GameData.playerCurrClubId  "+GameData.playerCurrClubId),GameData.player.club&&0<Object.keys(GameData.player.club).length){if(null!=GameData.playerCurrClubId&&null!=GameData.playerCurrClubId||(GameData.playerCurrClubId=GameData.getClubDataByIndex(0).club_id),0!=Object.keys(GameData.player.club).length){if(console.log("GameData.playerCurrClubId  "+GameData.playerCurrClubId),null==GameData.getClubDataByClubId(GameData.playerCurrClubId))return;this.clubName.string=GameData.getClubDataByClubId(GameData.playerCurrClubId).clubName,this.diamondsNum.string=GameData.getClubDataByClubId(GameData.playerCurrClubId).diamond}this.refreshAgentRoomBtn()}},refreshCreateOrBackBtn:function(){null==GameData.player.roomid||0==GameData.player.roomid?(this.create_btn.node.active=!0,this.back_btn.node.active=!1):(this.create_btn.node.active=!1,this.back_btn.node.active=!0)},refreshActivityRedPoint:function(){this.activeRedPoint.active=!0},backBtnClicked:function(e){n.enterMjRoom(GameData.player.roomid)},joinBtnClicked:function(e){null==GameData.player.roomid||GameData.player.roomid<=0?(this.showNumber(),this.layer_join.active=!0):(console.log("GameData.player.roomid----"+GameData.player.roomid),createMessageBox("您已在房间中,不能加入别的房间,是否返回房间?",function(){n.enterMjRoom(GameData.player.roomid)},function(){})),this.layer_join.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})},backToHome:function(e){this.layer_join.active=!1,this.layer_ddz.active=!1},createDdz:function(e){this.layer_ddz.active=!0},refreshRuleUI:function(){GameData.player.club&&0<Object.keys(GameData.player.club).length&&this.refreshAgentRoomBtn()},enterNumber:function(e,t){this.room_number.length<6&&(this.room_number+=t,this.showNumber(),6<=this.room_number.length&&n.enterMjRoom(this.room_number))},deleteNumber:function(e){this.room_number=this.room_number.substring(0,this.room_number.length-1),this.showNumber()},resetNumber:function(e){this.room_number="",this.showNumber()},showNumber:function(){for(var e=1;e<=this.room_number.length;e++){var t=this.room_number.substr(e-1,1);(a=cc.find("panel/enterNode/roomLabel_"+e,this.layer_join).getComponent("cc.Label")).string=t,a.node.active=!0}for(e=6;e>this.room_number.length;e--){var a;(a=cc.find("panel/enterNode/roomLabel_"+e,this.layer_join)).active=!1}},enterRoom:function(e){""!==this.room_number&&n.enterMjRoom(this.room_number)},runPaoMadeng:function(){this._paoMadengX=this.paoMadengLabel.node.x,GameData.configData.paomadengIndex=0,this.gotoPaoMadeng(),this.schedule(this.gotoPaoMadeng,10)},gotoPaoMadeng:function(){if(GameData.configData.paomadeng){this.paoMadengLabel.string=GameData.configData.paomadeng[GameData.configData.paomadengIndex].content,this.paoMadengLabel.node.x=this._paoMadengX;var e=cc.moveTo(10,cc.p(this._paoMadengX-570-this.paoMadengLabel.node.width,this.paoMadengLabel.node.y));this.paoMadengLabel.node.runAction(e),GameData.configData.paomadengIndex++,GameData.configData.paomadengIndex==GameData.configData.paomadeng.length&&(GameData.configData.paomadengIndex=0)}},openPlayIntro:function(e){openView("PlayIntroPanel")},openRecordPanel:function(e){openView("RecordPanel")},openSettingsPanel:function(e){cc.director.loadScene("table")},openNoticePanel:function(){},shareBtnClick:function(){openView("SharePanel")},selectClubClick:function(){openView("selectclubPanel")},joinClubClick:function(){openView("joinclubIDPanel")},agentRoomClick:function(){},showUIClub:function(){},refreshAgentRoomBtn:function(){}}),cc._RF.pop()},{SoundMngr:"SoundMngr",roomHandler:"roomHandler"}],"DDZ-playerTemplate":[function(e,t,a){"use strict";cc._RF.push(t,"1752fsPEM1E+Iqg5fnRBdVQ","DDZ-playerTemplate");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headBtn:cc.Button,headIcon:cc.Sprite,zhuangIcon:cc.Sprite,zhuangNumIcon:cc.Sprite,nameLabel:cc.Label,score:cc.Label,tiChuaiNode:cc.Node,fonts:{default:[],type:cc.Font},uid:0,_player:null},onLoad:function(){},setPlayer:function(e){this._player=e,this.uid=this._player.uid},setName:function(e){this.nameLabel.string=getShortStr(e,4)},setHeadIcon:function(e){if(!(null==e||""==e||e.length<=0)){var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.headIcon.spriteFrame=new cc.SpriteFrame(t))})}},showPlayerIdentity:function(e,t){if(this.setIsPlayerIcon(e),1==t){var a=cc.textureCache.addImage(cc.url.raw("resources/ddz/UI/common/icon/dizhu_icon.png"));this.zhuangIcon.spriteFrame=new cc.SpriteFrame(a)}else 2==t&&(this.zhuangIcon.spriteFrame=null)},setIsPlayerIcon:function(e){this.zhuangIcon.node.active=e},setNamePositionByDir:function(e){if("right"==e){this.nameLabel.node.x=-50,this.score.node.x=-50,this.nameLabel.HorizontalAlign=3,this.nameLabel.node.anchorX=1,this.score.HorizontalAlign=3,this.score.node.anchorX=1;var t=cc.find("bg",this.node);t.scaleX=-1,t.x=-30}},showZhuangNum:function(e,t){},enableHeadBtn:function(e){this.headBtn.node.active=e},onHeadBtnClicked:function(e){if("home"==cc.director.getScene().name)createPlayerInfoPanel(this._player);else{var a=this,t=n.getRoomData();t&&t.opts&&t.opts.gameType&&openPlayerInfoView(t.opts.gameType,function(e){if(e){var t=e.getComponent("uiRoomPlayerInfo");t&&t.onShow(a._player)}})}},setCoin:function(e,t){var a=cc.find("score",this.node),n="";0<e?(n="+"+e,a.getComponent("cc.Label").font=this.fonts[0]):e<0?(n=e,a.getComponent("cc.Label").font=this.fonts[1]):0==e&&(n=e,a.getComponent("cc.Label").font=this.fonts[2]),a.getComponent(cc.Label).string=n},setGold:function(e){var t=cc.find("score",this.node),a=0;null!=e&&(a=e),t.getComponent(cc.Label).font=null,t.color=new cc.Color(255,229,124),9999<a?(a/=1e4,t.getComponent(cc.Label).string=a+"万"):t.getComponent(cc.Label).string=a},getLiuGuang:function(e){cc.find("liuguang",this.node).active=e}}),cc._RF.pop()},{roomHandler:"roomHandler"}],"DDZ-poker":[function(e,t,a){"use strict";cc._RF.push(t,"a3dbbsTQntJwaLr0NhEA5Lt","DDZ-poker");var g={straights:{level:1,colorFormat:!1,numFormat:[1,2,3,4,5,6,7,8,9,10,11,12],allowedLength:[5,6,7,8,9,10,11,12],notAllowedCard:[15]}},i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{pokerParent:{default:null,type:cc.Node},cardMask:{default:null,type:cc.Prefab}},onLoad:function(){for(var e in this.cards=this.pokerParent.children,this.pokerParent.children)this.cardInitY=this.cards[e].y;this.touchedCards=[],this.selectedCards=[],this.addTouchEvent()},start:function(){},onDestroy:function(){},addTouchEvent:function(){this.pokerParent.on(cc.Node.EventType.TOUCH_START,function(e){console.log("pokerParent TOUCH_START");var t=e.target;this.touchStartLocation=this.cards[0].convertTouchToNodeSpace(e);for(var a=0,n=0;n<this.cards.length;n++){if(this.cards[n].name==t.name){a=n;break}}if("handLayout"==t.name)return this.firstTouchedCard=void 0,void this.clearTouchedCards();var i={index:a,card:t};cc.log("card.active:"+t.active,t.name),this.firstTouchedCard=i,this.pushTouchedCards(i.index,i.card)},this),this.pokerParent.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(console.log("pokerParent TOUCH_MOVE"),this.clearTouchedCards(),null!=this.firstTouchedCard){this.pushTouchedCards(this.firstTouchedCard.index,this.firstTouchedCard.card);for(var t=this.cards[0].convertTouchToNodeSpace(e),a=(t.x,t.y,this.touchStartLocation),n=0;n<this.cards.length;n++){var i,o,r=this.cards[n],s=r.x+20;a.x<t.x?(i=a.x,o=t.x):(i=t.x,o=a.x),i<=s&&s<=o&&r.active&&this.pushTouchedCards(n,r)}}},this),this.pokerParent.on(cc.Node.EventType.TOUCH_END,function(e){console.log("pokerParent TOUCH_END"),this.doSelectCard()},this),this.pokerParent.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("pokerParent TOUCH_CANCEL"),this.doSelectCard()},this);for(var a=0;a<this.cards.length;a++){var n=this.cards;(function(e){var t=n[a];t.on(cc.Node.EventType.TOUCH_START,function(e){console.log("card TOUCH_START")},t),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("card TOUCH_MOVE")},t),t.on(cc.Node.EventType.TOUCH_END,function(e){console.log("card TOUCH_END"),t.active&&i.instance.playOtherAudioPoker("click",null)},t),t.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("card TOUCH_CANCEL"),t.active&&i.instance.playOtherAudioPoker("click",null)},t)})()}},pushTouchedCards:function(e,t){var a={index:e,name:t.name,isSelected:t.y!=this.cardInitY};this.touchedCards.find(function(e){return e.name==t.name?e:null})||(this.touchedCards.push(a),this.addCardMask(t))},clearTouchedCards:function(){for(var e=0;e<this.touchedCards.length;e++){var t=this.touchedCards[e].index;this.cards[t].removeChildByTag(100)}this.touchedCards=[]},contain:function(e,t){return e.toString()==t.toString()},doSelectCard:function(){this.selectedCards=[],this.pokerTypeArry=[],this.shunziArry=[];for(var e=[],t=!0,a=0;a<this.touchedCards.length;a++){var n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;this.pokerTypeArry.push(i),e.push(i%100)}for(var o=0;o<this.pokerTypeArry.length;o++)for(var r=0;r<this.pokerTypeArry.length;r++)r!=o&&this.pokerTypeArry[r]%100==this.pokerTypeArry[o]%100&&this.pokerTypeArry.splice(r,1);var s=this.getCardsType(this.pokerTypeArry);if(s){var c=[];for(o=0;o<this.pokerTypeArry.length;o++)c.push(this.pokerTypeArry[o]%100),c.push(this.pokerTypeArry[o]%100);c.sort(function(e,t){return e-t}),e.sort(function(e,t){return e-t}),this.contain(c,e)&&(t=!1)}if(t&&"straights"==s)for(o=0;o<this.pokerTypeArry.length;o++){var d=!0;for(r=0;r<this.shunziArry.length;r++)this.pokerTypeArry[o]%100==this.shunziArry[r]%100&&(d=!1);d&&this.shunziArry.push(this.pokerTypeArry[o])}for(a=0;a<this.touchedCards.length;a++){var h;n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;cc.log("card:"+h.name);for(o=0;o<this.shunziArry.length;o++)i==this.shunziArry[o]&&(n.isSelected?h.y=h.y-30:h.y=h.y+30);0==this.shunziArry.length&&(n.isSelected?h.y=h.y-30:h.y=h.y+30)}this.clearTouchedCards(),this.showSelectedCards()},addCardMask:function(e){var t=cc.instantiate(this.cardMask);t.setTag(100),t.setPosition(cc.p(0,0)),e.addChild(t)},showSelectedCards:function(){this.selectedCards=[];for(var e=0;e<this.cards.length;e++){var t=this.cards[e];t.y!=this.cardInitY&&this.selectedCards.push(t.name)}sendEvent("ddz-disPokerArry",this.selectedCards)},getCardsType:function(e){for(var t in g){for(var a=g[t],n=!1,i=0;i<a.allowedLength.length;i++)a.allowedLength[i]==e.length&&(n=!0);if(n){var o=this.createSortedCardNumbers(e);cc.log("numbers = "+o);var r=!0;if(a.notAllowedCard)for(i=0;i<o.length;i++)for(var s=0;s<a.notAllowedCard.length;s++)o[i]==a.notAllowedCard[s]&&(r=!1);var c=0,d=0;if("aircraft"==t.substring(0,t.length-1)||"aircraft"==t)for(i=0;i<e.length;i++)115==e[i]||215==e[i]||315==e[i]||415==e[i]?c++:114!=e[i]&&214!=e[i]&&314!=e[i]&&414!=e[i]||d++,3==c&&3==d&&(r=!1);if(r){var h=!0,l=a.numFormat,u=null,m=[];for(s=0;s<o.length;s++)for(var p=0;p<o.length;p++)p!=s&&o[p]==o[s]&&o.splice(p,1);o.sort(function(e,t){return e-t}),cc.log("numbers = "+o);for(i=0;i<o.length;i++)if(0!=l[i])if(l[i]<0)if(m[-l[i]]){if(m[-l[i]]!=o[i]){h=!1;break}}else m[-l[i]]=o[i];else if(null==u)u=o[i]-l[i];else if(u!=o[i]-l[i]){h=!1;break}if(h&&5<=o.length)return t}}}return!1},createSortedCardNumbers:function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a]%100;return t}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"DDZ-roomDissolve":[function(e,t,a){"use strict";cc._RF.push(t,"508b9DsuZ5E/bRHuk8foPBu","DDZ-roomDissolve");var n=e("roomHandler"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&GameData.client.gameType==i.GameType.Game_Poker_DDZ&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("ddz-onGameAllScore",this,this.showAllScore)},initHeaderUI:function(){for(var e=0;e<GameData.room.opts.joinermax-1;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+(e+2),t.x=this.headerNode.x+200*(e+1)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){a.uid;var n=a.headimgurl;if(this.showHeaderIcon(t,n),this.showHeaderName(t,a.name),2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("DDZ-roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("DDZ-roomMain").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(0==GameData.room.opts.detain?this.node.getComponent("DDZ-roomMain").showSummaryLayer():0<GameData.room.opts.detain&&registEvent("ddz-onGameAllScore",this,this.showAllScore),this.unschedule(this.updateLastTime))},showAllScore:function(){this.node.getComponent("DDZ-roomMain").showSummaryLayer()},requestDissolve:function(){n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("DDZ-roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],"DDZ-roomMain":[function(e,t,a){"use strict";cc._RF.push(t,"aaa42yxaQVNxZnROf2N0Pam","DDZ-roomMain");var n=e("SoundMngr"),o=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},coinEndLayer:cc.Node,resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onServerNotice",this,handlerServerNotice),registEvent("coinEnd",this,this.showCoinEndLayer),scheduleLamp(this),GameDataDDZ.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1;var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.touch.getLocation(),a=this.convertToNodeSpace(t),n={x:this.getContentSize().width/2,y:this.getContentSize().height/2};cc.pDistance(a,n)>this.getContentSize().width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),o.roomType.Room_Match!=GameData.room.opts.roomType?this.talkBtn.node.active=!0:this.talkBtn.node.active=!1,GameDataDDZ.game.initcards?this.showTableUI(!0):this.showTableUI(!1)},onDestroy:function(){unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onServerNotice",this,handlerServerNotice),unregistEvent("coinEnd",this,this.showCoinEndLayer),GameData.initGameData(),GameDataDDZ.initRoomData()},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("ddz/sound/ddz_bg"),o.currencyType.Currency_Coin==GameData.room.opts.currencyType&&(this.uiWaitLayer.active=!1)},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("ddz/sound/ddz_bg")},showCoinEndLayer:function(e){var t=e.detail;void 0===t&&(t=0);var a=this;this.scheduleOnce(function(){var e=this.node.getComponent("DDZ-coinEnd");e&&e.onShow(),a.uiWaitLayer.active=!1},t)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showSettingLayer:function(e,t){1==t?openView("DDZ-SettingsPanel",o.GameType.Game_Poker_DDZ):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,GameData.realNum=0,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||openView("ChatPanel")},YVShortRecordCallback:function(){this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)},AnimationDelayTime:function(e){this._AnimationDelayTime=e.detail}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"DDZ-roomSummary":[function(e,t,a){"use strict";cc._RF.push(t,"477a7VYp7ZAV7BMQAd14PXV","DDZ-roomSummary");e("configMgr");var l=e("gameDefine"),u=e("roomHandler");cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font},lostNode:{default:null,type:cc.Node}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),this.hideLostNode();for(var e=0;e<GameData.joiners.length;e++)this.showPlayer(GameData.joiners[e],e+1)},hideLostNode:function(){for(var e in this.lostNode.children)this.lostNode.children[e].active=!1},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(e,t){if(e){GameData.room.opts.joinermax;var a=cc.find("player_"+t+"/name",this.panel),n=cc.find("player_"+t+"/field_text1",this.panel),i=cc.find("player_"+t+"/field_num1",this.panel),o=cc.find("player_"+t+"/head",this.panel),r=cc.find("player_"+t+"/playerID",this.panel),s=(cc.find("player_"+t,this.panel),cc.find("player_"+t+"/maxScore",this.panel)),c=cc.find("player_"+t+"/maxBobm",this.panel);cc.find("bg",this.panel).getContentSize().width,cc.find("player_"+t+"/biankuang",this.panel).getContentSize().width;cc.find("player_"+t+"/owner",this.panel).active=GameData.room.creator==e.uid,isChinese(e.name)?a.getComponent("cc.Label").string=getShortStr(e.name,5):a.getComponent("cc.Label").string=getShortStr(e.name,9),r.getComponent("cc.Label").string="ID:"+e.uid,GameDataDDZ.roomsummaryData&&0!=Object.keys(GameDataDDZ.roomsummaryData).length&&(0!=Object.keys(GameDataDDZ.roomsummaryData.maxFen).length&&(s.getComponent("cc.Label").string="单局最高分:"+GameDataDDZ.roomsummaryData.maxFen[e.uid]),0!=Object.keys(GameDataDDZ.roomsummaryData.maxBoom).length&&(c.getComponent("cc.Label").string="打出炸弹数:"+GameDataDDZ.roomsummaryData.maxBoom[e.uid])),this.loadHeadImg(e.headimgurl,o),cc.find("player_"+t+"/win",this.panel).active=!1;var d=0;if(l.currencyType.Currency_Coin==GameData.room.opts.currencyType){n.active=!1;var h=u.getCoinData();h&&h.coins&&h.coins[e.uid]&&(d=h.coins[e.uid])}else if(null!=GameDataDDZ.roomsummaryData.score){d=GameDataDDZ.roomsummaryData.score[e.uid];GameDataDDZ.roomsummaryData.score[function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&GameDataDDZ.roomsummaryData.score[GameData.joiners[t].uid]>GameDataDDZ.roomsummaryData.score[e]&&(e=GameData.joiners[t].uid);return e}()],GameDataDDZ.roomsummaryData.score[e.uid]}if(null==d&&(d=0),0<d?(i.getComponent("cc.Label").string="+"+d,i.getComponent("cc.Label").font=this.fonts[1]):d<0?(i.getComponent("cc.Label").string=d,i.getComponent("cc.Label").font=this.fonts[0]):(i.getComponent("cc.Label").string=d,i.getComponent("cc.Label").font=this.fonts[2]),GameData.room.creator==e.uid)cc.find("player_"+t+"/owner",this.panel).active=!0}},loadHeadImg:function(e,a){null==e||e.length<=0||null==a||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))})},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"DDZ-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"f0817zHk/BKx6/ZA8c686Nt","DDZ-roomWait");var y=e("SoundMngr"),s=e("roomHandler"),c=e("configMgr"),d=e("gameDefine");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomZh:cc.Label,roomNum:cc.Label,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,btnRule:cc.Button,lostInfo:[],readyBtn:cc.Node,detain:{default:null,type:cc.Label},maskNode:cc.Node,QiangDiZhuNode:cc.Node,jiaofenNode:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(),registEvent("onRoomInfo",this,this.showPlayers),registEvent("ddz-onReady",this,this.onReady),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("ddz-onDiZhu",this,this.onDiZhuHandler),registEvent("initTableNode",this,this.showPlayers),registEvent("onPrepareInfo",this,this.onPrepareInfo),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("ddz-onGameAllScore",this,this.onGameAllScoreHandler),registEvent("ddz-onGameStart",this,this.onGameStartHandler),registEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("HideReadyNode",this,this.HideReadyNode),registEvent("AnimationDelayTime",this,this.onGameScoreHandler),registEvent("ddz-showKicking",this,this.showKicking),registEvent("ddz-deputeInfo",this,this.showDeputeInfo),registEvent("dynChat",this,this.dynChatHandler),DDZHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation(),d.currencyType.Currency_Coin==GameData.room.opts.currencyType&&this.hideAllReadyStatus()},onEnable:function(){this.readyNode.active=!GameDataDDZ.game.gameStart,GameData.game.onRoomReadyInfo.data&&sendEvent("onRoomReadyInfo",GameData.game.onRoomReadyInfo.data)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("ddz-onReady",this,this.onReady),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("ddz-onDiZhu",this,this.onDiZhuHandler),unregistEvent("initTableNode",this,this.showPlayers),unregistEvent("onPrepareInfo",this,this.onPrepareInfo),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("ddz-onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("ddz-onGameStart",this,this.onGameStartHandler),unregistEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),unregistEvent("ddz-onGameScore",this,this.onGameScoreHandler),unregistEvent("yunwaUploaded",this,this.onYunwaUploaded),unregistEvent("HideReadyNode",this,this.HideReadyNode),unregistEvent("AnimationDelayTime",this,this.onGameScoreHandler),unregistEvent("ddz-showKicking",this,this.showKicking),unregistEvent("ddz-deputeInfo",this,this.showDeputeInfo),unregistEvent("dynChat",this,this.dynChatHandler)},onReady:function(){GameDataDDZ.clearObject(GameDataDDZ.kicking),sendEvent("initTableNode"),DDZHandler.getInstance().requestReady()},onDiZhuHandler:function(){this.playQiangDiZhuAnimation()},onGameScoreHandler:function(e){var t=e.detail,a=this;this.scheduleOnce(function(){a.readyNode.active=!0},t)},HideReadyNode:function(){this.readyNode.active=!1},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("DDZ-playerTemplate"),n=a.uid;if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameDataDDZ.allScores[n]?0:GameDataDDZ.allScores[n];a.setCoin(i,1)}}null!=GameDataDDZ.roomsummaryData.gameFlag&&sendEvent("initTableNode"),this.showDetainScore(),this.hideLostNode()},onYunwaUploaded:function(e){var t=e.detail;ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("DDZ-playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioPokerChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("DDZ-playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return cc.p(0,0)},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showDetain:function(){0<GameData.room.opts.detain?(this.detain.node.active=!0,this.detain.string="押底 : 0"):0==GameData.room.opts.detain&&(this.detain.node.active=!1)},showDetainScore:function(){null!=GameDataDDZ.roomsummaryData.detain?this.detain.string="押底 : "+GameDataDDZ.roomsummaryData.detain:this.showDetain()},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},hideLostNode:function(){for(var e in this.lostNode.children)this.lostNode.children[e].active=!1},hideAllReadyStatus:function(){cc.find("ready_hand_left",this.readyNode).active=!1,cc.find("readying_left",this.readyNode).active=!1,cc.find("ready_hand_right",this.readyNode).active=!1,cc.find("readying_right",this.readyNode).active=!1,cc.find("ready_hand_down",this.readyNode).active=!1,cc.find("readying_down",this.readyNode).active=!1},onPrepareInfo:function(e){for(var t in this.hideAllReadyStatus(),this.readyNode.active=!0,this.hideTiChuai(),GameDataDDZ.game.onRoomReadyInfo)if(1==GameDataDDZ.game.onRoomReadyInfo[t]){var a=GameDataDDZ.getPosByUid(t);this.showReadyIcon(a,!0,!1)}this.onRoomReadyInfoHandler(e)},showPlayers:function(){this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;this.deleteRoomBtn.active=e,this.quitRoomBtn.x=e?107:6,this.node.getComponent("DDZ-roomtable").showRoomRule(),this.connectRecurrence()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){},showPlayer:function(e,t){var a=t.getChildByName("uiPlayerNode");null==a&&((a=cc.instantiate(this.playerTemplate)).name="uiPlayerNode",t.addChild(a));var n=GameData.getPlayerByPos(e);if(null!=n){if(t.active=!0,a.active=!0,a.getComponent("DDZ-playerTemplate").setPlayer(n),a.getComponent("DDZ-playerTemplate").setName(n.name),a.getComponent("DDZ-playerTemplate").setHeadIcon(n.headimgurl),a.getComponent("DDZ-playerTemplate").setNamePositionByDir(e),a.getComponent("DDZ-playerTemplate").setIsPlayerIcon(!1),0!=GameDataDDZ.game.dizhuUid)GameDataDDZ.game.dizhuUid==n.uid?a.getComponent("DDZ-playerTemplate").showPlayerIdentity(!0,1):a.getComponent("DDZ-playerTemplate").showPlayerIdentity(!0,2);if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType)a.getComponent("DDZ-playerTemplate").setGold(n.coin);else{var i=0;null!=GameDataDDZ.roomsummaryData.score&&(i=null==GameDataDDZ.roomsummaryData.score[n.uid]?0:GameDataDDZ.roomsummaryData.score[n.uid]),a.getComponent("DDZ-playerTemplate").setCoin(i,1)}this.headers.push(a),a.setTag(n.uid),2==n.status&&this.showReadyIcon(e,!1,!1);var o=s.isPlayerOnline(n.uid),r=cc.find("Disconnect",a);cc.find("lost_"+e,this.lostNode).active=!o,r.active=!o}else t.active=!1,this.showReadyIcon(e,!1,!1)},hideTiChuai:function(){for(var e=0;e<this.headers.length;e++){var t=cc.find("tiChuaiNode",this.headers[e]),a=cc.find("tiIcon",t),n=cc.find("chuaiIcon",t);a.active=!1,n.active=!1}},showPlayerTiChuai:function(e,t,a){var n=e.getChildByName("TablePlayerTemplate"),i=cc.find("tiChuaiNode",n);if(1==GameDataDDZ.kicking.kicking[a]&&a!=t){var o=cc.find("tiIcon",i);o.active=!0,e==this.play_right_player&&(o.x=-67)}else if(1==GameDataDDZ.kicking.kicking[a]&&a==t){var r=cc.find("chuaiIcon",i);r.active=!0,e==this.play_right_player&&(r.x=-67)}},showKicking:function(){if(!GameDataDDZ.isEmptyObject(GameDataDDZ.kicking))for(var e in GameDataDDZ.kicking.kicking){var t=GameDataDDZ.getPosByUid(e);"down"==t?this.showPlayerTiChuai(this.play_down_player,GameDataDDZ.kicking.dizhu,e):"right"==t&&this.showPlayerTiChuai(this.play_right_player,GameDataDDZ.kicking.dizhu,e),"left"==t&&this.showPlayerTiChuai(this.play_left_player,GameDataDDZ.kicking.dizhu,e)}},showDeputeInfo:function(){for(var e in GameDataDDZ.deputeInfo)0==GameDataDDZ.deputeInfo[e]?this.showTrusteeship(e,!1):1==GameDataDDZ.deputeInfo[e]&&this.showTrusteeship(e,!0)},showTrusteeship:function(e,t){for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("DDZ-playerTemplate").uid==e)return void(cc.find("trusteeship",n).active=t)}},connectRecurrence:function(){this.showKicking(),this.showDetainScore()},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("DDZ-playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameDataDDZ.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;a.uid!=i||0==a.uid?(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0):(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1)}cc.find("lost_"+e,this.lostNode).active=n}},setRoomNum:function(){1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000",GameData.room.opts.roomType==d.roomType.Room_Match&&(this.roomZh.node.opacity=90,this.roomNum.node.opacity=90)},backBtnClicked:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):DDZHandler.getInstance().quitMjRoom(GameData.room.id)},wxInviteBtnClicked:function(){var e="经典斗地主 房间号:"+GameData.room.id,t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="",t="",a="玩法:";if(a+=["房主付,","AA制,","赢家付,","代开房付费,",""][GameData.room.opts.costType-1],a+=["赢家叫分,","轮庄叫分,","霸王叫分,"][GameData.room.opts.jiaofenType-1],a+="押底:"+["不押,","1分,","2分,","3分,"][GameData.room.opts.detain],GameData.room.opts.currencyType==d.currencyType.Currency_Coin){e="金币场 ";var n=c.getServerConfig();if(n&&n.roomCoin){var i=n.roomCoin[d.GameType.Game_Poker_DDZ];if(i){var o=0;switch(GameData.room.opts.roundMax){case 6:o=0;break;case 10:o=1;break;case 20:o=2}if(i[o]){var r=i[o].enter[GameData.room.opts.joinermax];r&&(t="进入条件："+r[GameData.room.opts.scorelv])}}}}1==GameData.room.opts.suppress&&(a+="憋三家,"),1==GameData.room.opts.kicking&&(a+="带踢踹,"),1==GameData.room.opts.fourFlag?a+="四带2对,":1==GameData.room.opts.fullMark&&(a+="两王或4个2叫满,");var s=e+t+(a+="局数:"+GameData.room.opts.roundMax+"局,")+"请您快速加入对局."+(15==GameData.room.opts.fanshu?"无限番":GameData.room.opts.fanshu+"番");return console.log("des = "+s),s},onShareResult:function(){wxShareTimeline("经典斗地主","我在经典斗地主等你!")},onShareFriend:function(){wxShareWeb("经典斗地主","我在经典斗地主等你!")},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){s.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):s.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyInviteKey:function(){if(0<GameData.room.id){var e="经典斗地主,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},onCopyRoomInfo:function(){},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){this.readyNode.active=!GameDataDDZ.game.gameStart,this.hideAllReadyStatus()},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1},playQiangDiZhuAnimation:function(){if(GameDataDDZ.game.flag){this.QiangDiZhuNode.position=cc.p(0,0),this.QiangDiZhuNode.active=!0;var n=this,e=this.QiangDiZhuNode.getComponent(dragonBones.ArmatureDisplay);e.playAnimation("qiangdizhu",1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){var e=n.getHeadPositionOnUid(GameDataDDZ.game.dizhuUid),t=cc.moveTo(.5,cc.p(e.x,e.y+45)),a=cc.callFunc(function(){n.jiaofenNode.active=!1,n.QiangDiZhuNode.active=!1,n.showPlayers()});n.QiangDiZhuNode.stopAllActions(),n.QiangDiZhuNode.runAction(cc.sequence(t,a))},this)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"DDZ-roomtable":[function(e,t,a){"use strict";cc._RF.push(t,"d32db7ko4RLopjHl3Y1G46Z","DDZ-roomtable");var o=e("SoundMngr"),n=(e("errorCode"),e("roomHandler")),u=(e("configMgr"),e("gameDefine"));cc.Class({extends:cc.Component,properties:{play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,ruleLb:cc.Label,coinEndLayer:cc.Node,handCardLayOut:cc.Node,cardsNode:cc.Node,actionLayer:cc.Node,jiaofenNode:cc.Node,HoleCardsNode:cc.Node,clockNodes:cc.Node,buchuNodes:cc.Node,warningNode:cc.Node,multipleNode:cc.Node,_countdown_index:0,_currClockNodes:cc.Node,lastRoundLabel:cc.Label,dragonAnimations:cc.Node,winAnimation:cc.Node,loseAnimation:cc.Node,planeNode:cc.Node,chuntianNode:cc.Node,bobmAinmation:cc.Node,huojianAinmation:cc.Node,maskbg:cc.Node,dizhuSign:cc.Prefab,tiBtnNode:cc.Node,tiIcon_right:cc.Node,undouble_right:cc.Node,tiIcon_left:cc.Node,undouble_left:cc.Node,tiIcon_down:cc.Node,undouble_down:cc.Node,passNode:cc.Node,noTrustNode:cc.Node,trustBtn:cc.Node,handCardMask:cc.Node,waitJiaoFen:cc.Node,waitDouble:cc.Node,_effcetFlag:!1,_currTime:null},onLoad:function(){for(var e in this.initData(),this.initUI(),this.registListenr(),this.handCardLayOut.children)this.defaultPokerY=this.handCardLayOut.children[e].y;GameDataDDZ.game.initcards&&(this.cardsNode.active=!0,this._dealEnd=!0,this.onShow()),null!=GameDataDDZ.currJiaofenPlayerData&&this.showJiaoFenNode(),this.showTiChuai(),GameDataDDZ.game.gameStartDizhu&&(this.showDizhuInfo(),this.showObtainNode(),this.showDisPoker(),this.showBuchuNode(),this.showCardNum(),this.showDeputeInfo()),this.connectRecurrence()},registListenr:function(){registEvent("ddz-onGameScore",this,this.onGameScoreHandler),registEvent("ddz-onShowObtainNode",this,this.onShowObtainHandler),registEvent("ddz-showDisPoker",this,this.onShowDisPokerHandler),registEvent("ddz-showWatch",this,this.onShowWatchHandler),registEvent("ddz-onDiZhu",this,this.onShowDizhuInfoHandler),registEvent("ddz-jiaoFencb",this,this.onJiaoFenCBHandler),registEvent("ddz-startTi",this,this.showTiChuai),registEvent("ddz-showKicking",this,this.showKicking),registEvent("onPrepareInfo",this,this.onPrepareInfo),registEvent("ddz-onGameInfo",this,this.onShow),registEvent("ddz-initCardHand",this,this.initCardHand),registEvent("ddz-initCardHandNum",this,this.showCardNum),registEvent("ddz-initCardHands",this,this.onShow),registEvent("ddz-onGameStart",this,this.handleGameStart),registEvent("ddz-onJiaoFen",this,this.showJiaoFenNode),registEvent("initTableNode",this,this.initTableNode),registEvent("ddz-onDiscardType",this,this.showDisCardType),registEvent("ddz-disPokerArry",this,this.setDisPokerArry),registEvent("ddz-passcb",this,this.playPassEffect),registEvent("ddz-hintCard",this,this.showHintCard),registEvent("onShowSummary",this,this.stopClockMusic),registEvent("ddz-reconnectionInfo",this,this.reconnectionInfo),registEvent("ddz-deputeInfo",this,this.showDeputeInfo);var e=this;this.maskbg.on(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()}),this.trustBtn.on(cc.Node.EventType.TOUCH_END,this.onTrustBtnTouchEnd)},onDestroy:function(){unregistEvent("ddz-onGameScore",this,this.onGameScoreHandler),unregistEvent("ddz-onShowObtainNode",this,this.onShowObtainHandler),unregistEvent("ddz-showDisPoker",this,this.onShowDisPokerHandler),unregistEvent("ddz-showWatch",this,this.onShowWatchHandler),unregistEvent("ddz-onDiZhu",this,this.onShowDizhuInfoHandler),unregistEvent("ddz-jiaoFencb",this,this.onJiaoFenCBHandler),unregistEvent("ddz-startTi",this,this.showTiChuai),unregistEvent("ddz-showKicking",this,this.showKicking),unregistEvent("onPrepareInfo",this,this.onPrepareInfo),unregistEvent("ddz-onGameInfo",this,this.onShow),unregistEvent("ddz-initCardHand",this,this.initCardHand),unregistEvent("ddz-initCardHandNum",this,this.showCardNum),unregistEvent("ddz-initCardHands",this,this.onShow),unregistEvent("ddz-onGameStart",this,this.handleGameStart),unregistEvent("ddz-onJiaoFen",this,this.showJiaoFenNode),unregistEvent("initTableNode",this,this.initTableNode),unregistEvent("ddz-onDiscardType",this,this.showDisCardType),unregistEvent("ddz-disPokerArry",this,this.setDisPokerArry),unregistEvent("ddz-passcb",this,this.playPassEffect),unregistEvent("ddz-hintCard",this,this.showHintCard),unregistEvent("onShowSummary",this,this.stopClockMusic),unregistEvent("ddz-reconnectionInfo",this,this.reconnectionInfo),unregistEvent("ddz-deputeInfo",this,this.showDeputeInfo);var e=this;this.maskbg.off(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()}),this.trustBtn.off(cc.Node.EventType.TOUCH_END,this.onTrustBtnTouchEnd)},onEnable:function(){this._countdown_index=15,this.showKicking(),this.initCardHand()},initData:function(){this._dealActionIndex=1,this._cardHandPosArr=[],this._angularArr=[],this._dealEnd=!1,this.disCardArry=[],this.disPokerArry=[],this._dragonAnimtaionNum=1,this._buJiao=0,this._trusteeshipFlag=!1,GameDataDDZ.kicking={}},initUI:function(){this.cardsNode.active=!1,this.jiaofenNode.active=!1,this.trustBtn.active=!1,this.waitJiaoFen.active=!1,this.waitDouble.active=!1,this.showRoomRule(),this.hideDisCards(),this.setDisCardBtnStatus(),this.hideIsDoubleFlag()},initTableNode:function(){this.initData(),this.initUI();var e=cc.find("lastpokerNum",this.play_layer_left),t=cc.find("lastpokerNum",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideDisCards(),this.hideHandCards();var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a),this.actionLayer.active=!1,this.hideNodeChild(this.clockNodes),this.hideNodeChild(this.multipleNode),GameDataDDZ.game.dizhuUid=0,this.chuntianNode.active=!1,this.winAnimation.active=!1,this.loseAnimation.active=!1,this.planeNode.active=!1,this.bobmAinmation.active=!1,this.huojianAinmation.active=!1,this.trustBtn.active=!1,this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.stopClockMusic()},onShowWatchHandler:function(){this.showWatch(),this.showKicking(),this.showTiChuai()},onJiaoFenCBHandler:function(e){this.playJiaofenEffect(e),this.showJiaofenText()},onShowDizhuInfoHandler:function(){this.showDizhuInfo()},onShowDisPokerHandler:function(e){this.hideIsDoubleFlag(),this.disPoker(e)},onShowObtainHandler:function(){this.waitDouble.active=!1,this.showObtainNode()},onGameScoreHandler:function(){this.showWinNode();var e=this.showGameEndAction();void 0===e&&(e=0);this.scheduleOnce(function(){sendEvent("coinEnd")},e)},showRoomRule:function(){this.ruleLb.string=this.getRuleStr()},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},handleGameStart:function(){this.coinEndLayer.active=!1,this.cardsNode.active=!0,this.hideHoleCards()},onPrepareInfo:function(){null!=GameDataDDZ.game.onRoomReadyInfo&&GameDataDDZ.game.onRoomReadyInfo[GameData.player.uid]},initCardHand:function(){null!=GameDataDDZ.getMyHandCards()&&(GameDataDDZ.getMyHandCards().length==GameDataDDZ.handCardSize&&1==GameDataDDZ.deal&&(this._firstInit=!0),this.onShow())},onShow:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.showCards(),this.cardsNode.active=!0,this.HoleCardsNode.active=!0,this.lastRoundLabel.string="局数:"+GameData.room.roundNum+"/"+GameData.room.opts.roundMax,GameData.room.opts.roomType==u.roomType.Room_Match&&(this.lastRoundLabel.node.opacity=90)},showCards:function(){var e=GameData.getPlayerByPos("down");e&&GameDataDDZ.cards[e.uid]?(this._firstInit?this.dealActionMngr():this.showMyHandCards(e,this.play_layer_down),this.play_layer_down.active=!0):this.play_layer_down.active=!1},showCardNum:function(){var e=GameData.getPlayerByPos("right");e&&GameDataDDZ.cards[e.uid]?(this.showOtherHandCards(e,this.play_layer_right),this.play_layer_right.active=!0):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("left"))&&GameDataDDZ.cards[e.uid]?(this.showOtherHandCards(e,this.play_layer_left),this.play_layer_left.active=!0):this.play_layer_left.active=!1,this.showWarningNode()},dealActionMngr:function(){this._firstInit=!1,this._dealActionIndex=1;var e=cc.find("cardHand/handLayout",this.play_layer_down);null!=e&&(this.hideNodeChild(e),this.schedule(this.dealAction,.2))},dealAction:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);if(null!=e){var t=GameDataDDZ.getMyHandCards();if(null!=t){var a=t.length;void 0===this._dealActionIndex&&(this._dealActionIndex=1);var n=0;n=0<this._dealActionIndex%2?26.5+53*parseInt(this._dealActionIndex/2)+503.5:503.5+53*parseInt(this._dealActionIndex/2);for(var i=0;i<this._dealActionIndex;i++){var o=cc.find("hand_"+i,e);o.active=!0,o.x=n-53*i,this.removeDizhuSign(o),this.showCardContent(o,t[i])}if(this._dealActionIndex++,this._dealActionIndex>a){var r=this;this.unschedule(this.dealAction),this.scheduleOnce(function(){r._dealEnd=!0,r.handCardRestoration();var e=GameData.getPlayerByPos("down");r.showMyHandCards(e,r.play_layer_down),GameDataDDZ.curWatchData.gameStatus==GameDataDDZ.roomStatus.JIAOFEN&&r.showJiaoFenNode()},1)}}}},showTiChuai:function(){GameDataDDZ.tiFlag&&GameDataDDZ.kicking.kicking&&null==GameDataDDZ.kicking.kicking[GameData.player.uid]&&GameDataDDZ.roomStatus.TICHUAI==GameDataDDZ.curWatchData.gameStatus&&(this.tiBtnNode.active=!0,this.waitDouble.active=!1)},tiChuaiAction:function(e){var t=cc.callFunc(function(){e.active=!0},this),a=(cc.callFunc(function(){e.active=!1},this),cc.delayTime(1),cc.sequence(t));e.parent.stopAllActions(),e.parent.runAction(a)},showKicking:function(){if(GameDataDDZ.curWatchData.gameStatus==GameDataDDZ.roomStatus.TICHUAI){var e={right:this.tiIcon_right,left:this.tiIcon_left,down:this.tiIcon_down},t={right:this.undouble_right,left:this.undouble_left,down:this.undouble_down};for(var a in void 0===GameDataDDZ.kicking.kicking&&(GameDataDDZ.kicking.kicking={}),GameDataDDZ.kicking.kicking){var n=GameDataDDZ.kicking.kicking[a];if(null!=n){var i=GameDataDDZ.getPosByUid(a);if(null!=i){a==GameData.player.uid&&(this.tiBtnNode.active=!1);var o=void 0;1==n?o=e[i]:0==n&&(o=t[i]),null!=o&&this.tiChuaiAction(o)}}}var r=!0;GameDataDDZ.kicking.kicking[GameData.player.uid]?Object.keys(GameDataDDZ.kicking.kicking).length<=3&&(r=!0):GameDataDDZ.tiFlag&&(r=!1),this.waitDouble.active=r,cc.log("..waitDouble:"+r)}},showMyHandCards:function(e,t){this.resetPokerPos();var a=GameDataDDZ.getMyHandCards();if(null!=a){var n=cc.find("cardHand/handLayout",t);for(var i in n.children)n.children[i].active=!1;for(var o=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),r=0;r<a.length;r++){var s=cc.find("cardHand/handLayout/hand_"+(o+r),t);s.active=!0,e.uid==GameDataDDZ.game.dizhuUid?this.addDizhuSign(s):this.removeDizhuSign(s),this.showCardContent(s,a[r])}}},showOtherHandCards:function(e,t){if(e){var a=e.uid,n=GameDataDDZ.getHandCardNum(a),i=cc.find("lastpokerNum/pokerNum",t);i.active=!0,i.getComponent(cc.Label).string=n,cc.find("cardHand/hand_0",t).active=!0}},showCardContent:function(e,t){if(0!=t){var a=e.getComponent("Card");null!=a&&(a.id=t),e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/ddz/UI/pokers/poker_"+t+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)}},showPokerBack:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)this.showCardContent(e.children[t],"back"),e.children[t].active=!1},showWatch:function(){this.stopClockMusic();for(var e=0;e<GameDataDDZ.curWatchData.uid.length;e++)this.showClock(GameDataDDZ.curWatchData.uid[e])},reconnectionInfo:function(){this._dealEnd=!0,this.showJiaoFenNode()},showJiaoFenNode:function(){var e=GameDataDDZ.currJiaofenPlayerData.uid,t=GameDataDDZ.currJiaofenPlayerData.maxNum;if(GameDataDDZ.game.isJiaofenAgain&&(this._dealEnd=!1,GameDataDDZ.game.isJiaofenAgain=!GameDataDDZ.game.isJiaofenAgain,1==this._buJiao&&createMoveMessage("无人叫地主,重新发牌"),this._buJiao++),0!=this._dealEnd){this.actionLayer.active=!1;var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a);for(var n=1;n<5;n++){cc.find("btn"+n,this.jiaofenNode).getComponent(cc.Button).interactable=!0}if(GameData.player.uid==e)for(this.jiaofenNode.active=!0,this.waitJiaoFen.active=!1;0<t;t--){cc.find("btn"+t,this.jiaofenNode).getComponent(cc.Button).interactable=!1}else this.jiaofenNode.active=!1,this.waitJiaoFen.active=!0;this.disabledJiaoFenBtn(),this.stopClockMusic(),this.showClocks(e),this.showJiaofenText()}},disabledJiaoFenBtn:function(){if(null!=GameDataDDZ.currJiaofenPlayerData)if(null!=GameDataDDZ.currJiaofenPlayerData.fullMark){for(var e=1;e<=4;e++){cc.find("btn"+e,this.jiaofenNode).getComponent(cc.Button).interactable=!1}cc.find("btn3",this.jiaofenNode).getComponent(cc.Button).interactable=!0}else if(null!=GameDataDDZ.currJiaofenPlayerData.suppress){for(e=1;e<=3;e++){cc.find("btn"+e,this.jiaofenNode).getComponent(cc.Button).interactable=!1}cc.find("btn3",this.jiaofenNode).getComponent(cc.Button).interactable=!0}},showJiaofenText:function(){var e=cc.find("jiaofenSps",this.cardsNode);if(null!=e){e.active=!0;for(var t=["right","left","down"],a=0;a<t.length;a++){var n=t[a],i=cc.find("jiaofenSps/"+n+"Sp",this.cardsNode);if(null!=i){i.active=!1;var o=GameData.getPlayerByPos(n);if(null!=o){var r=GameDataDDZ.getJiaofenNum(o.uid);if(null!=r){i.active=!0;var s=cc.textureCache.addImage(cc.url.raw(this.getJiaofenImg(r)));i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)}}}}}},selectScroe:function(e,t){switch(parseInt(t)){case 1:DDZHandler.getInstance().requestSelectScore(1,function(e){});break;case 2:DDZHandler.getInstance().requestSelectScore(2,function(e){});break;case 3:DDZHandler.getInstance().requestSelectScore(3,function(e){});break;case 4:DDZHandler.getInstance().requestSelectScore(4,function(e){})}this.jiaofenNode.active=!1,this._buJiao=1},playJiaofenEffect:function(e){var t=e.detail.uid,a=e.detail.num,n=GameData.getPlayerSexByUid(t),i="";switch(a){case 1:i="yifen";break;case 2:i="liangfen";break;case 3:i="sanfen";break;case 4:i="bujiao"}o.instance.playOtherAudioPoker(i,n)},showDizhuInfo:function(){var e=GameDataDDZ.gameStartData.cards,t=GameDataDDZ.gameStartData.multiple;this.showHoleCards(e);var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a),this.changeMultiple(t),this.waitJiaoFen.active=!1},hideHoleCards:function(){var e=cc.find("cards",this.HoleCardsNode);for(var t in e.children)this.showHoleCardContent(e.children[t],"back")},showHoleCards:function(a){var n=this;if(null!=a){for(var i=cc.find("cards",this.HoleCardsNode),o=this,e=function(e){var t=cc.find("dipai_card"+e,i);r=cc.scaleTo(.25,0,.5),s=cc.scaleTo(.25,.45,.5),t.runAction(cc.sequence(r,s)),n.scheduleOnce(function(){o.showHoleCardContent(t,a[e])},.3)},t=0;t<i.childrenCount;t++){var r,s;e(t)}this.jiaofenNode.active=!1}},showHoleCardContent:function(e,t){e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},showDeputeInfo:function(){for(var e in GameDataDDZ.deputeInfo){var t=GameDataDDZ.getPosByUid(e),a=cc.find("actions",this.cardsNode);if(0==GameDataDDZ.deputeInfo[e])switch(t){case"down":this.handCardMask.off(cc.Node.EventType.TOUCH_START,function(){}),this.trustBtn.on(cc.Node.EventType.TOUCH_END,this.onTrustBtnTouchEnd),this.handCardMask.active=!1,this.noTrustNode.active=!1,this._trusteeshipFlag=!1,sendEvent("ddz-onShowObtainNode")}else if(1==GameDataDDZ.deputeInfo[e])switch(t){case"down":this.handCardMask.on(cc.Node.EventType.TOUCH_START,function(){}),this.trustBtn.off(cc.Node.EventType.TOUCH_END,this.onTrustBtnTouchEnd),a.active=!1,this.handCardMask.active=!0,this.noTrustNode.active=!0,this._trusteeshipFlag=!0}}},easeCubicActionTimer:function(e){e.opacity=e.opacity-51},easeCubicAction:function(t){var a=0,n=this;this.schedule(function e(){a++,n.easeCubicActionTimer(t),5<=a&&(t.active=!1,t.opacity=255,n.unschedule(e))},.1)},showObtainNode:function(){u.roomType.Room_Match==GameData.room.opts.roomType?this.trustBtn.active=!0:this.trustBtn.active=!1,this.disCardArry=[];var e=GameDataDDZ.currObtainPlayerData.uid,t=GameDataDDZ.currObtainPlayerData.flag,a=GameDataDDZ.currObtainPlayerData.hintFlag;this._effcetFlag=t;var n=cc.find("actions",this.cardsNode),i=cc.find("actions/btnPass",this.cardsNode),o=cc.find("actions/btnTishi",this.cardsNode),r=cc.find("actions/btnDisCard",this.cardsNode);if(GameData.player.uid==e){if(n.active=!0,t){if(i.active=!0,o.active=!0,r.active=!0,!a){o.active=!1,r.active=!1,this.passNode.active=!0;var s=this;this.scheduleOnce(function(){s.easeCubicAction(s.passNode)},1)}}else i.active=!1,o.active=!1,a&&(r.active=!0);1==this._trusteeshipFlag&&(n.active=!1)}else n.active=!1;this.stopClockMusic(),this.showClocks(e);var c,d=GameData.tablePos[e];switch(d){case"down":c=cc.find("layer_down/cardDis",this.cardsNode);break;case"right":c=cc.find("layer_right/cardDis",this.cardsNode);break;case"left":c=cc.find("layer_left/cardDis",this.cardsNode);break;case"up":c=cc.find("layer_up/cardDis",this.cardsNode)}this.hidePassNode(d),null!=c&&this.hideNodeChild(c);var h=GameDataDDZ.getMyHandCards().length;if(!i.active&&!o.active&&1==h)for(var l in this.handCardLayOut.children)1==this.handCardLayOut.children[l].active&&GameData.player.uid==e&&this.handCardLayOut.children[l].y==this.defaultPokerY&&(this.handCardLayOut.children[l].y+=30,this.disPokerArry.push(this.handCardLayOut.children[l]));this.setDisCardBtnStatus()},hidePassNode:function(e){switch(e){case"down":cc.find("buchuLb0",this.buchuNodes).active=!1;break;case"right":cc.find("buchuLb1",this.buchuNodes).active=!1;break;case"left":cc.find("buchuLb2",this.buchuNodes).active=!1}},onDisCardClick:function(){var e,t=cc.find("cardHand/handLayout",this.play_layer_down);for(e in this.disCardArry=[],this.disPokerArry){var a=this.disPokerArry[e].getComponent("Card").id;this.disCardArry.push(a)}DDZHandler.getInstance().requestOnDisCard(this.disCardArry,function(e){});var n=0;for(e in t.children)t.children[e].y==this.defaultPokerY&&n++;0<n&&0==this.disCardArry.length&&createMoveMessage("请选择要出的牌!")},onPassCardClick:function(){var t=cc.find("actions",this.cardsNode);t.active=!1;var a=e("errorCode");DDZHandler.getInstance().requestOnPassCard(function(e){e.result!=a.Success&&(t.active=!0)}),this.resetPokerPos()},onHintClick:function(){DDZHandler.getInstance().requestOnHintCard(GameData.player.uid,function(e){})},playPassEffect:function(e){var t=e.detail.uid,a=GameData.getPlayerSexByUid(t);o.instance.playOtherAudioPoker("buyao",a),this.showBuchuNode()},showBuchuNode:function(){var e=GameData.getPlayerByPos("down"),t=GameDataDDZ.getDisPoker(e.uid),a=cc.find("buchuLb0",this.buchuNodes);this.showbuchuStr(e,a,t),e=GameData.getPlayerByPos("right"),t=GameDataDDZ.getDisPoker(e.uid),a=cc.find("buchuLb1",this.buchuNodes),this.showbuchuStr(e,a,t),e=GameData.getPlayerByPos("left"),t=GameDataDDZ.getDisPoker(e.uid),a=cc.find("buchuLb2",this.buchuNodes),this.showbuchuStr(e,a,t)},showbuchuStr:function(e,t,a){null!=a&&(0==a[0]?t.active=!0:0==a.length&&(t.active=!1))},disPoker:function(e){var t=e.detail.uid,a=GameDataDDZ.getHandCardNum(t);if(a<=2){var n=GameData.getPlayerSexByUid(t);this.scheduleOnce(function(){o.instance.playOtherAudioPoker("baojing"+a,n)},1)}this.showDisPoker()},showDisPoker:function(){var e=GameData.getPlayerByPos("down"),t=GameDataDDZ.getDisPoker(e.uid);e&&GameDataDDZ.cards[e.uid]?(this.play_layer_down.active=!0,this.showPokerCards(e,this.play_layer_down,t)):this.play_layer_down.active=!1,e=GameData.getPlayerByPos("right"),t=GameDataDDZ.getDisPoker(e.uid),e&&GameDataDDZ.cards[e.uid]?(this.play_layer_right.active=!0,this.showPokerCards(e,this.play_layer_right,t)):this.play_layer_right.active=!1,e=GameData.getPlayerByPos("left"),t=GameDataDDZ.getDisPoker(e.uid),e&&GameDataDDZ.cards[e.uid]?(this.play_layer_left.active=!0,this.showPokerCards(e,this.play_layer_left,t)):this.play_layer_left.active=!1},showPokerCards:function(e,t,a){GameDataDDZ.currObtainPlayerData.uid;var n=cc.find("cardDis",t);if(null!=a)if(this.hideNodeChild(n),t==this.play_layer_down)for(var i=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),o=0;o<a.length;o++){var r=cc.find("dis_"+(i+o),n);0==a[0]?r.active=!1:r.active=!0,e.uid==GameDataDDZ.game.dizhuUid?this.addDizhuSign(r,"dis"):this.removeDizhuSign(r),this.showCardContent(r,a[o])}else for(var s=0;s<a.length;s++){r=cc.find("dis_"+s,n);0==a[0]?r.active=!1:r.active=!0,e.uid==GameDataDDZ.game.dizhuUid?this.addDizhuSign(r,"dis"):this.removeDizhuSign(r),this.showCardContent(r,a[s])}},showClocks:function(e){if(null!=e){var t=GameData.getPlayerByPos("down"),a=cc.find("cloock0",this.clockNodes);this.showClockContent(t,a,e),t=GameData.getPlayerByPos("right"),a=cc.find("cloock1",this.clockNodes),this.showClockContent(t,a,e),t=GameData.getPlayerByPos("left"),a=cc.find("cloock2",this.clockNodes),this.showClockContent(t,a,e)}},showClock:function(e){if(null!=e){var t=GameData.getPlayerByPos("down"),a=cc.find("cloock0",this.clockNodes);this.showClockContent(t,a,e)}},showClockContent:function(e,t,a){null!=GameDataDDZ.curWatchData.time?0!=Math.floor(GameDataDDZ.curWatchData.time/1e3)&&(this._countdown_index=Math.floor(GameDataDDZ.curWatchData.time/1e3)):this._countdown_index=15,e.uid==a&&(t.active=!0,this.PLayerUID=a,this._currClockNodes=t,this.runCountDown(),this.startCoundDown())},startCoundDown:function(){this.schedule(this.runCountDown,1)},runCountDown:function(){if(this.showCountDown(this._countdown_index),this._countdown_index<1)u.roomType.Room_Match==GameData.room.opts.roomType?(this.stopClockMusic(),this.unschedule(this.runCountDown)):this._countdown_index=15;else{var e=cc.blink(.5,3);3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&(this._currClockNodes.runAction(e),o.instance.playAudioOther("countdown")),this._countdown_index--}},showCountDown:function(e){var t=e;e<10&&0<e?t="0"+e:0==e&&(t=0),cc.find("timeLb",this._currClockNodes).getComponent(cc.Label).string=t},hideDisCards:function(){var e=cc.find("cardDis",this.play_layer_down),t=cc.find("cardDis",this.play_layer_left),a=cc.find("cardDis",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},hideHandCards:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down),t=cc.find("cardHand",this.play_layer_left),a=cc.find("cardHand",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},showSurplusPoker:function(){for(var e=0;e<GameData.joiners.length;e++){switch(GameDataDDZ.getPosByUid(GameData.joiners[e].uid)){case"left":var t=cc.find("cardDis",this.play_layer_left);this.showSurplusCards(t,GameData.joiners[e].uid);break;case"right":var a=cc.find("cardDis",this.play_layer_right);this.showSurplusCards(a,GameData.joiners[e].uid)}}},showSurplusCards:function(e,t){var a=GameDataDDZ.getHandCards(t);if(null!=a)for(var n=0;n<a.length;n++){var i=cc.find("dis_"+n,e);i.active=!0,i.getComponent(cc.Sprite).spriteFrame=null;var o="resources/ddz/UI/pokers/poker_"+a[n]+".png",r=cc.textureCache.addImage(cc.url.raw(o));i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(r)}},showWinNode:function(e){this._dealEnd=!1,this.passNode.active=!1,this.noTrustNode.active=!1,this.handCardMask.active=!1,this.actionLayer.active=!1,this.stopClockMusic(),this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.showSurplusPoker(),sendEvent("HideReadyNode")},playGameEndSound:function(){var e=0;if(u.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=n.getCoinData();if(!t||!t.coin)return;e=t.coin[GameData.player.uid]}else e=GameDataDDZ.resultData.score[GameData.player.uid];0<e?o.instance.playOtherAudioPoker("shengli",null):o.instance.playOtherAudioPoker("shibai",null)},showGameEndAction:function(){var e=GameData.getPlayerByPos("down");return e&&GameDataDDZ.cards[e.uid]?this.play_layer_down.active=!0:this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameDataDDZ.cards[e.uid]?this.play_layer_right.active=!0:this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("left"))&&GameDataDDZ.cards[e.uid]?this.play_layer_left.active=!0:this.play_layer_left.active=!1,this.playGameEndSound(),this.showWinnerAnimation()},showWinnerAnimation:function(){if(GameDataDDZ.resultData.chuntian){var t=this;return this.scheduleOnce(function(){t.chuntianNode.active=!0;var e=t.chuntianNode.getComponent(dragonBones.ArmatureDisplay);e.playAnimation("newAnimation",1),e.addEventListener(dragonBones.EventObject.COMPLETE,function(){t.chuntianNode.active=!1},this),o.instance.playOtherAudioPoker("chuntian",null)},1.5*this._dragonAnimtaionNum+1),1.5*this._dragonAnimtaionNum+3}return 3},getJiaofenImg:function(e){var t="";switch(parseInt(e)){case 1:t="resources/ddz/UI/common/artword/artword_1fen.png";break;case 2:t="resources/ddz/UI/common/artword/artword_2fen.png";break;case 3:t="resources/ddz/UI/common/artword/artword_3fen.png";break;case 4:t="resources/ddz/UI/common/artword/artword_bujiao.png"}return t},showWarningNode:function(e){var t,a=GameData.getPlayerByPos("down");a&&GameDataDDZ.cards[a.uid]&&(t=cc.find("warning0",this.warningNode),this.showWarningContent(a.uid,t)),(a=GameData.getPlayerByPos("right"))&&GameDataDDZ.cards[a.uid]&&(t=cc.find("warning1",this.warningNode),this.showWarningContent(a.uid,t)),(a=GameData.getPlayerByPos("left"))&&GameDataDDZ.cards[a.uid]&&(t=cc.find("warning2",this.warningNode),this.showWarningContent(a.uid,t))},showWarningContent:function(e,t){GameDataDDZ.getHandCardNum(e)<=2?(t.active=!0,t.getComponent(cc.Animation).play("warningAnimation")):t.active=!1},showDisCardType:function(e){var t=e.detail.type,a=e.detail.multiple;this._dragonAnimtaionNum=0;var n=GameData.getPlayerSexByUid(e.detail.uid);o.instance.playAudioPokerDisType(e,n,this._effcetFlag),o.instance.playOtherAudioPoker("discard",null),"aircraft"!=t.substring(0,t.length-1)&&"aircraft"!=t&&"tribletraights"!=t||(o.instance.playOtherAudioPoker("plane",null),this._dragonAnimtaionNum++,this.DDZplayAnimation(this.planeNode)),"bomb"==t&&(this._dragonAnimtaionNum++,o.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.bobmAinmation)),"jokerBomb"==t&&(this._dragonAnimtaionNum++,o.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.huojianAinmation)),this.changeMultiple(a)},changeMultiple:function(e){if(null!=e){var t=cc.find("multipleNum",this.multipleNode);this.showNodeChild(this.multipleNode),t.getComponent(cc.Label).string="X"+e}},showNodeChild:function(e){for(var t in e.children)e.children[t].active=!0},setDisPokerArry:function(e){var t=e.detail;this.disPokerArry=[];for(var a=0;a<t.length;a++){var n=t[a];for(var i in this.handCardLayOut.children)n==this.handCardLayOut.children[i].name&&1==this.handCardLayOut.children[i].active&&this.disPokerArry.push(this.handCardLayOut.children[i])}this.setDisCardBtnStatus()},DDZplayAnimation:function(e){e.active=!0;var t=e.getComponent(dragonBones.ArmatureDisplay);t.playAnimation("newAnimation",1),t.addEventListener(dragonBones.EventObject.COMPLETE,function(){e.active=!1},this)},resetPokerPos:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.disPokerArry.splice(0,this.disPokerArry.length),this.setDisCardBtnStatus()},DoubleClick:function(){var e=(new Date).getTime();e-this._currTime<500&&(this.resetPokerPos(),this.disPokerArry=[]),this._currTime=e,this.setDisCardBtnStatus()},showHintCard:function(e){var t=e.detail.cards;e.detail.uid;this.disPokerArry=[];var a=cc.find("layer_down/cardHand/handLayout",this.cardsNode);for(var n in a.children)a.children[n].y=this.defaultPokerY;for(var n in a.children)for(var i=a.children[n].getComponent("Card"),o=0;o<t.length;o++)i.id==t[o]&&1==a.children[n].active&&(a.children[n].y+=30,this.disPokerArry.push(a.children[n]));this.setDisCardBtnStatus()},stopClockMusic:function(){this.unschedule(this.runCountDown),this.hideNodeChild(this.clockNodes)},getRuleStr:function(){if(GameData.room.opts)return getRuleStrDDZ(GameData.room.opts)},addDizhuSign:function(e,t){var a=cc.instantiate(this.dizhuSign);"dis"==t&&a.setPosition(cc.p(-40,45)),e.addChild(a)},removeDizhuSign:function(e){e.removeAllChildren(!0)},connectRecurrence:function(){var e=!1;GameData.room.opts&&(e=!0),e&&1==GameData.room.opts.kicking&&this.connectTiChuai()},connectTiChuai:function(){if(!GameDataDDZ.isEmptyObject(GameData.joinContact)&&!GameDataDDZ.isEmptyObject(GameDataDDZ.kicking)&&GameData.joinContact.uid==GameData.player.uid){for(var e in GameDataDDZ.kicking.kicking)if(e==GameData.player.uid)return void(this.tiBtnNode.active=!1);if(GameDataDDZ.game.dizhuUid==GameData.player.uid){if(2==GameDataDDZ.objectLen(GameDataDDZ.kicking.kicking)){this.showWatch();for(var e in GameDataDDZ.kicking.kicking)0==GameDataDDZ.kicking.kicking[e]&&0}}else this.showWatch(),this.tiBtnNode.active=!0}},onTiBtnChecked:function(e,t){this.tiBtnNode.active=!1,this.stopClockMusic(),DDZHandler.getInstance().requestTiChuai(t,function(e){})},onTrustBtnTouchEnd:function(){DDZHandler.getInstance().requestDepute()},onNoTrustBtnChecked:function(e,t){2==t&&(this.noTrustNode.active=!1),DDZHandler.getInstance().requestDepute()},setDisCardBtnStatus:function(){var e=!1;0<this.disPokerArry.length&&(e=!0),cc.find("btnDisCard",this.actionLayer).getComponent("cc.Button").interactable=e},handCardRestoration:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);if(null!=e)for(var t=0,a=19;0<=a;a--){var n=cc.find("hand_"+a,e);n&&(n.x=53*t,t++)}},hideIsDoubleFlag:function(){this.tiIcon_right.active=!1,this.tiIcon_left.active=!1,this.tiIcon_down.active=!1,this.undouble_left.active=!1,this.undouble_right.active=!1,this.undouble_down.active=!1}});cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",roomHandler:"roomHandler"}],DisCard:[function(e,t,a){"use strict";cc._RF.push(t,"3bb2cZiklBCKLjPxvFiYdqL","DisCard"),cc.Class({extends:cc.Component,properties:{icon:cc.Sprite},onLoad:function(){},setIcon:function(e){var t=this.getCardRef();null!=t&&(this.icon.spriteFrame=t.getSpriteFrame(e),this.icon.node.active=!0)},getCardRef:function(){return null==this._cardRef&&(this._cardRef=this.node.getComponent("CardRef")),this._cardRef}}),cc._RF.pop()},{}],EveryDayShare:[function(e,t,a){"use strict";cc._RF.push(t,"f6adfEgKUhCmahQ2wLuttdY","EveryDayShare");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{shareImage:cc.Node},onLoad:function(){this.shareImage.active=!1},cancel:function(){n.instance.playAudioOther("button"),closeView(this.node.name)},shareContent:function(){this.shareImage.active=!0,inCD(3e3)||(n.instance.playAudioOther("button"),screenShoot(wxShareTexture))}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],FastVoiceButton:[function(e,t,a){"use strict";cc._RF.push(t,"b5d8732LyFM07PsqFfJkzps","FastVoiceButton");e("gameDefine");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{sound:"null",parent:cc.Node},onLoad:function(){},onClick:function(){n.instance.playAudioOther("button");var e=cc.find("Label",this.node).getComponent(cc.Label).string;ChatHandler.getInstance().requestChat("fast",{sound:this.sound,content:e},function(e){}),this.parent.getComponent("ChatPanel").onClose()}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],HandCard:[function(e,t,a){"use strict";cc._RF.push(t,"5c44b4plwdFpJQOFrIED/IU","HandCard"),cc.Class({extends:cc.Component,properties:{bottom:cc.Sprite,icon:cc.Sprite,huier:cc.Node,cardId:0,_cardRef:null},onLoad:function(){this.showHuier(!1)},setIcon:function(e){var t=this.getCardRef();null!=t&&(this.icon.spriteFrame=t.getSpriteFrame(e),this.icon.node.active=!0)},showHuier:function(e){this.huier.active=e},setBottom:function(e){var t=cc.textureCache.addImage(cc.url.raw(e));this.bottom.spriteFrame=new cc.SpriteFrame(t)},getCardRef:function(){return null==this._cardRef&&(this._cardRef=this.node.getComponent("CardRef")),this._cardRef}}),cc._RF.pop()},{}],HideComponent:[function(e,t,a){"use strict";cc._RF.push(t,"577caR31SxH85wNQAo/OCz9","HideComponent"),cc.Class({extends:cc.Component,properties:{delay:3},onLoad:function(){},show:function(e){this.node.active=!0,this.unschedule(this.gotoHide),this.scheduleOnce(this.gotoHide,e)},gotoHide:function(){this.node.active=!1}}),cc._RF.pop()},{}],LanguagerManager:[function(e,t,a){"use strict";cc._RF.push(t,"13853RE+l9KmrtpYJnOg+WI","LanguagerManager"),cc._RF.pop()},{}],MoveMessage:[function(e,t,a){"use strict";cc._RF.push(t,"80b1ck2bNJJV6HubwhnNSrs","MoveMessage");e("errorCode");var i=e("codeString");cc.Class({extends:cc.Component,properties:{},onLoad:function(){var e=cc.moveBy(2,cc.p(0,40));this.node.runAction(e);var t=this;this.scheduleOnce(function(e){t.node.destroy()},2)},setContent:function(e,t){var a=e,n=cc.find("Label",this.node);t&&i&&(a=i[t]),n&&(n.getComponent(cc.Label).string=a)}}),cc._RF.pop()},{codeString:"codeString",errorCode:"errorCode"}],"NN-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"b7030d6PnhKqpIckMfxosFD","NN-createRoom");e("roomHandler");var o=e("gameDefine"),r=e("configMgr");cc.Class({extends:cc.Component,properties:{spend:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.spendData=void 0,this.refreshNiuNiuUI()},createRoom:function(){this.saveNiuNiuRule(),profileNiuNiu.saveCreateRoomOpts(),GameData.setGameType(o.GameType.Game_niu_niu);var e=profileNiuNiu.createRoomOpts,t=r.getModeType();return null==t||null==t.Game_niu_niu||(e.currencyType=t.Game_niu_niu.CurrencyType,e.settleType=t.Game_niu_niu.SettleType),e},saveNiuNiuRule:function(){for(var e=this.node,t=[cc.find("/round/ToggleGroup/round10",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round20",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round30",e).getComponent(cc.Toggle)],a=10,n=0;n<t.length;n++)t[n].isChecked&&(a=10*(n+1));profileNiuNiu.createRoomOpts.roundMax=a,profileNiuNiu.createRoomOpts.roundRule=a/10;var i=0,o=[cc.find("/bossType/ToggleGroup/boss1",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss2",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss3",e).getComponent(cc.Toggle)];for(n=0;n<o.length;n++)o[n].isChecked&&(i=n+1);profileNiuNiu.createRoomOpts.bossType=i;var r=0,s=[cc.find("/baseScore/toggleGroup/score1",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score2",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score5",e).getComponent(cc.Toggle)];for(n=0;n<s.length;n++)s[n].isChecked&&(r=this.getScoreBeseNum(s[n].node));profileNiuNiu.createRoomOpts.scoreBase=r;var c=0,d=[cc.find("/multipleType/ToggleGroup/multiple1",e).getComponent(cc.Toggle),cc.find("/multipleType/ToggleGroup/multiple2",e).getComponent(cc.Toggle)];for(n=0;n<d.length;n++)d[n].isChecked&&(c=n);profileNiuNiu.createRoomOpts.multipleType=c;var h=0,l=[cc.find("/rule_roomPay/toggleGroup/roomOwner",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/AA",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/winPlayer",e).getComponent(cc.Toggle)];for(n=0;n<l.length;n++)l[n].isChecked&&(h=n+1);profileNiuNiu.createRoomOpts.costType=h,profileNiuNiu.createRoomOpts.joinermax=6,profileNiuNiu.createRoomOpts.gameType=5,this.showSpendUI()},refreshNiuNiuUI:function(){for(var e=this.node,t=[cc.find("/round/ToggleGroup/round10",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round20",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round30",e).getComponent(cc.Toggle)],a=0;a<t.length;a++)t[a].isChecked=a+1==profileNiuNiu.createRoomOpts.roundMax/10;var n=[cc.find("/bossType/ToggleGroup/boss1",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss2",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss3",e).getComponent(cc.Toggle)];for(a=0;a<n.length;a++)n[a].isChecked=a+1==profileNiuNiu.createRoomOpts.bossType;var i=[cc.find("/baseScore/toggleGroup/score1",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score2",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score5",e).getComponent(cc.Toggle)];for(a=0;a<i.length;a++)i[a].isChecked=this.getScoreBeseNum(i[a].node)==profileNiuNiu.createRoomOpts.scoreBase;var o=[cc.find("/multipleType/ToggleGroup/multiple1",e).getComponent(cc.Toggle),cc.find("/multipleType/ToggleGroup/multiple2",e).getComponent(cc.Toggle)];for(a=0;a<o.length;a++)o[a].isChecked=a==profileNiuNiu.createRoomOpts.multipleType;3<profileNiuNiu.createRoomOpts.costType&&(profileNiuNiu.createRoomOpts.costType=1);var r=[cc.find("/rule_roomPay/toggleGroup/roomOwner",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/AA",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/winPlayer",e).getComponent(cc.Toggle)];for(a=0;a<r.length;a++)r[a].isChecked=a+1==profileNiuNiu.createRoomOpts.costType;this.showSpendUI()},showSpendUI:function(){cc.log("..mode..niuniu6");var e="",t=r.getModeType();if(null!=t&&null!=t.Game_niu_niu){var a=r.getServerConfig();if(null!=a){switch(this.modeType=t.Game_niu_niu.CurrencyType,this.modeType){case o.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[o.GameType.Game_niu_niu];break;case o.currencyType.Currency_Coin:e="金",this.spendData=a.roomCoin[o.GameType.Game_niu_niu]}if(this.spendData)for(var n=0;n<Object.keys(this.spendData).length;n++){var i=0;this.modeType==o.currencyType.Currency_Card?(i=this.spendData[n+1].cost[6].final,this.spend[n].string="（"+e+"*"+i+"）"):(i=this.spendData[n].cost[6].final,"/局",this.spend[n].string=""),this.drowArray[n].active=0==i}else cc.log("..spendData is undefined")}}},getScoreBeseNum:function(e){var t=e.name,a=t.substring(5,t.length);return parseInt(a)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],NoticePanel:[function(e,t,a){"use strict";cc._RF.push(t,"4aa3cD0EOlMdbnzK17vK/4D","NoticePanel");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{hdBtn:cc.Node,hdLb:cc.Node,ggBtn:cc.Node,ggLb:cc.Node,hdScrollNode:cc.Node,hdBtnScrollNode:cc.Node,ggScrollNode:cc.Node,ggBtnScrollNode:cc.Node,hdBtnItem:cc.Node,ggBtnItem:cc.Node,toptitle:cc.Label,redPoint:cc.Node,activeArry:{default:[],type:[cc.Prefab]},GgArry:{default:[],type:[cc.Prefab]},HdContentArry:[],GgContentArry:[],HdBtnsArry:[],GgBtnsArry:[],hdCurrIndex:1,GgCurrIndex:1},onLoad:function(){this.initData(),this.initUI(),this.registerListener()},initData:function(){this.HdContentArry=[],this.GgContentArry=[],this.HdBtnsArry=[],this.GgBtnsArry=[],this.hdCurrIndex=1,this.GgCurrIndex=1,this.topHdTitle=["绑定代理","资料补全"],this.topGgTitle=["公告"]},initUI:function(){this.initHdUI(),this.initGgUI()},registerListener:function(){registEvent("closeAgentBind",this,this.closeAgentBind)},onDestroy:function(){unregistEvent("closeAgentBind",this,this.closeAgentBind)},initHdUI:function(){if(this.HdscrollContent=cc.find("view/content",this.hdScrollNode),!GameData.player.agentFlag){var e=cc.instantiate(this.activeArry[0]);e.setTag(9999),this.HdscrollContent.addChild(e),this.HdContentArry.push(e)}for(var t=0;t<this.HdContentArry.length;t++){var a=cc.instantiate(this.hdBtnItem);a.active=!0,a.parent=this.hdBtnItem.parent,a.name="btns"+(t+2),a.setTag(t+1),a.y=this.hdBtnItem.y-this.hdBtnItem.height*t,cc.log("item.y "+a.y),cc.log("item.tag "+a.tag),this.initSelectBtnsItem(a,t+1),this.HdBtnsArry.push(a)}0==this.HdContentArry.length&&this.showDefaultData(1)},initGgUI:function(){this.GgscrollContent=cc.find("view/content",this.ggScrollNode);var e=cc.instantiate(this.GgArry[0]);this.GgscrollContent.addChild(e),this.GgContentArry.push(e)},initSelectBtnsItem:function(e,t){var a=cc.find("btn1",e),n=cc.find("btn2",e);2==t&&(a.active=!0,n.active=!1),a.setTag(t),a.on(cc.Node.EventType.TOUCH_END,this.selectHdBtnIndex,this)},refreshUI:function(e){1==this.selectPageType&&(this.redPoint.active=!1),console.log("type = "+e),1==e?this.refreshHdUI():this.refreshGgUI()},refreshHdUI:function(){0==this.HdContentArry.length&&this.showDefaultData(1);for(var e=0;e<this.HdBtnsArry.length;e++){this.HdBtnsArry[e].y=this.hdBtnItem.y-this.hdBtnItem.height*e;var t=cc.find("btn1",this.HdBtnsArry[e]),a=cc.find("btn2",this.HdBtnsArry[e]);this.hdCurrIndex==this.HdBtnsArry[e].tag?(t.active=!1,a.active=!0):(t.active=!0,a.active=!1)}for(e=0;e<this.HdContentArry.length;e++)this.hdCurrIndex==e+1?this.HdContentArry[e].active=!0:this.HdContentArry[e].active=!1},refreshGgUI:function(){0==this.GgContentArry.length&&this.showDefaultData(2),0<this.HdContentArry.length&&this.showRedPoint()},selectUIType:function(e,t){n.instance.playAudioOther("button");var a=!1;1==t&&(a=!0),this.hdLb.active=a,this.hdBtn.active=!a,this.ggLb.active=!a,this.ggBtn.active=a,this.selectPageType=1==a?1:2,this.showHdAbout(a),this.showGgAbout(!a),this.refreshUI(t)},selectHdBtnIndex:function(e){n.instance.playAudioOther("button");var t=e.target.tag;this.hdCurrIndex=t,this.refreshHdUI()},showDefaultData:function(e){1==e?this.hdBtnItem.active=!1:this.ggBtnItem.active=!1},showHdAbout:function(e){this.hdScrollNode.active=e,this.hdBtnScrollNode.active=e},showGgAbout:function(e){this.ggScrollNode.active=e,this.ggBtnScrollNode.active=e},changeTopTitle:function(e){this.toptitle.string=e},closeAgentBind:function(){this.HdscrollContent.removeChildByTag(9999,!0),this.hdBtnItem.parent.removeChildByTag(1,!0),this.HdContentArry.shift(),this.HdBtnsArry.shift(),this.hdCurrIndex=1,this.refreshHdUI()},showRedPoint:function(){1!=this.selectPageType&&(this.redPoint.active=!0)},close:function(){n.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"PDK-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"099b4iwrIJIh6S7ucvtYE0f","PDK-createRoom");e("roomHandler");var r=e("configMgr"),s=e("gameDefine");cc.Class({extends:cc.Component,properties:{round6:cc.Toggle,round10:cc.Toggle,round20:cc.Toggle,renShu3:cc.Toggle,renShu2:cc.Toggle,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,times1:cc.Toggle,times10:cc.Toggle,times20:cc.Toggle,times50:cc.Toggle,scoreNode:cc.Node,score1:cc.Toggle,score2:cc.Toggle,score3:cc.Toggle,guan:{default:null,type:cc.Toggle},buGuan:{default:null,type:cc.Toggle},hearts3:{default:null,type:cc.Toggle},spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.refreshUI(),this.modeType=1,this.spendData=void 0},getModeType:function(){return this.modeType},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(s.GameType.Game_Poker_paodekuai);var e={gameType:s.GameType.Game_Poker_paodekuai,roomType:0,passFlag:GameDataPDK.createRoomOpts.playType,roundMax:GameDataPDK.createRoomOpts.roundMax,roundRule:GameDataPDK.createRoomOpts.roundMax,joinermax:GameDataPDK.createRoomOpts.joinermax,roundType:1,clubId:0,costType:GameDataPDK.createRoomOpts.costType,score:GameDataPDK.createRoomOpts.score,times:GameDataPDK.createRoomOpts.times,zhuangType:GameDataPDK.createRoomOpts.zhuangType,currencyType:null,settleType:null},t=r.getModeType();return null==t||null==t.Game_Poker_paodekuai||(e.currencyType=t.Game_Poker_paodekuai.CurrencyType,e.settleType=t.Game_Poker_paodekuai.SettleType),e},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..pdk");var e="",t=r.getModeType();if(null!=t&&null!=t.Game_Poker_paodekuai){var a=r.getServerConfig();if(null!=a){switch(this.modeType=t.Game_Poker_paodekuai.CurrencyType,this.modeType){case s.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[s.GameType.Game_Poker_paodekuai];break;case s.currencyType.Currency_Coin:e="金币",this.spendData=a.roomCoin[s.GameType.Game_Poker_paodekuai]}if(this.spendData)for(var n=0;n<Object.keys(this.spendData).length;n++){var i=0;if(this.modeType==s.currencyType.Currency_Card){var o;0===n?o=this.spendData[10].cost:1===n?o=this.spendData[20].cost:2===n&&(o=this.spendData[30].cost);i=o[3].final,this.pay2.isChecked}else i=this.spendData[n].cost;this.drowArray[n].active=0==i,this.spendUI[n].string="（"+e+"*"+i+"）"}else cc.log("..spendData is undefined")}}},selectRoomType:function(e,t){},saveRuleFromUI:function(){this.round6.isChecked?GameDataPDK.createRoomOpts.roundMax=10:this.round10.isChecked?GameDataPDK.createRoomOpts.roundMax=20:this.round20.isChecked&&(GameDataPDK.createRoomOpts.roundMax=30),this.renShu3.isChecked?GameDataPDK.createRoomOpts.joinermax=3:this.renShu2.isChecked&&(GameDataPDK.createRoomOpts.joinermax=2),this.pay1.isChecked?GameDataPDK.createRoomOpts.costType=1:this.pay2.isChecked?GameDataPDK.createRoomOpts.costType=2:this.pay3.isChecked&&(GameDataPDK.createRoomOpts.costType=3),this.guan.isChecked?GameDataPDK.createRoomOpts.playType=1:this.buGuan.isChecked&&(GameDataPDK.createRoomOpts.playType=2),this.hearts3.isChecked?GameDataPDK.createRoomOpts.zhuangType=!0:GameDataPDK.createRoomOpts.zhuangType=!1,GameDataPDK.saveCreateRoomOpts()},selectRoundRuleClick:function(e,t){if(null!=t){switch(t){case 10:this.round6.isChecked=!0,this.round10.isChecked=!1,this.round20.isChecked=!1;break;case 20:this.round10.isChecked=!0,this.round6.isChecked=!1,this.round20.isChecked=!1;break;case 30:this.round20.isChecked=!0,this.round6.isChecked=!1,this.round10.isChecked=!1}this.round6.isChecked?GameDataPDK.createRoomOpts.roundMax=10:this.round10.isChecked?GameDataPDK.createRoomOpts.roundMax=20:this.round20.isChecked&&(GameDataPDK.createRoomOpts.roundMax=30),this.refreshTimesScore()}},selectTimesClick:function(e,t){if(null!=t){switch(t){case 1:this.times1.isChecked=!0,this.times10.isChecked=!1,this.times20.isChecked=!1,this.times50.isChecked=!1;break;case 10:this.times10.isChecked=!0,this.times1.isChecked=!1,this.times20.isChecked=!1,this.times50.isChecked=!1;break;case 20:this.times20.isChecked=!0,this.times10.isChecked=!1,this.times1.isChecked=!1,this.times50.isChecked=!1;break;case 50:this.times50.isChecked=!0,this.times10.isChecked=!1,this.times20.isChecked=!1,this.times1.isChecked=!1}this.times1.isChecked?GameDataPDK.createRoomOpts.times=1:this.times10.isChecked?GameDataPDK.createRoomOpts.times=10:this.times20.isChecked?GameDataPDK.createRoomOpts.times=20:this.times50.isChecked&&(GameDataPDK.createRoomOpts.times=50),this.refreshTimesScore()}},refreshUI:function(){this.round6.isChecked=10==GameDataPDK.createRoomOpts.roundMax,this.round10.isChecked=20==GameDataPDK.createRoomOpts.roundMax,this.round20.isChecked=30==GameDataPDK.createRoomOpts.roundMax,this.renShu3.isChecked=3==GameDataPDK.createRoomOpts.joinermax,this.renShu2.isChecked=2==GameDataPDK.createRoomOpts.joinermax,this.pay1.isChecked=1==GameDataPDK.createRoomOpts.costType,this.pay2.isChecked=2==GameDataPDK.createRoomOpts.costType,this.pay3.isChecked=3==GameDataPDK.createRoomOpts.costType,this.guan.isChecked=1==GameDataPDK.createRoomOpts.playType,this.buGuan.isChecked=2==GameDataPDK.createRoomOpts.playType,this.hearts3.isChecked=1==GameDataPDK.createRoomOpts.zhuangType,this.showSpendUI(),1==this.renShu2.isChecked&&(this.hearts3.isChecked=!1,this.hearts3.node.active=!1),this.score1.isChecked=!0,this.score2.isChecked=!1,this.score3.isChecked=!1,this.refreshTimesScore()},refreshTimesScore:function(){if(this.modeType==s.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)this.scoreNode.active=!1;else{this.scoreNode.active=!0;var e=0;switch(GameDataPDK.createRoomOpts.roundMax){case 10:e=0;break;case 20:e=1;break;case 30:e=2}var t=this.spendData[e].enter,a=cc.find("label",this.score1.node),n=cc.find("label",this.score2.node),i=cc.find("label",this.score3.node);null==GameDataPDK.createRoomOpts.times&&(GameDataPDK.createRoomOpts.times=1),a.getComponent(cc.Label).string="≥"+GameDataPDK.createRoomOpts.times*parseInt(t[0]),n.getComponent(cc.Label).string="≥"+GameDataPDK.createRoomOpts.times*parseInt(t[1]),i.getComponent(cc.Label).string="≥"+GameDataPDK.createRoomOpts.times*parseInt(t[2]),this.score1.isChecked?GameDataPDK.createRoomOpts.score=GameDataPDK.createRoomOpts.times*parseInt(t[0]):this.score2.isChecked?GameDataPDK.createRoomOpts.score=GameDataPDK.createRoomOpts.times*parseInt(t[1]):this.score3.isChecked&&(GameDataPDK.createRoomOpts.score=GameDataPDK.createRoomOpts.times*parseInt(t[2]))}},onRenShu2Clicked:function(){this.hearts3.isChecked=!1,cc.find("checkmark",this.hearts3.node).active=!1,this.hearts3.interactable=!1,this.hearts3.node.active=!1},onRenShu3Clicked:function(){this.hearts3.interactable=!0,this.hearts3.node.active=!0}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"PDK-handler":[function(e,t,a){"use strict";cc._RF.push(t,"87e848gxYhGXpYVPn/isrTr","PDK-handler");var n=e("errorCode"),i={};(t.exports=i).quitRoom=function(e){RoomHandler.quitRoom(e)},i.quitRoom=function(e){RoomHandler.quitRoom(e)},i.deleteRoom=function(e,t){RoomHandler.deleteRoom(e,t)},i.requestReady=function(e){GameNet.getInstance().request("room.roomHandler.ready",{},function(e){})},i.requestSelectScore=function(e,t){GameNet.getInstance().request("room.pokerPdkHandler.jiaofen",{num:e},function(e){t(e)})},i.requestTiChuai=function(e,t){GameNet.getInstance().request("room.pokerPdkHandler.tichuai",{num:e},function(e){t(e)})},i.requestOnPassCard=function(t){GameNet.getInstance().request("room.pokerPdkHandler.pass",{},function(e){t(e)})},i.requestOnHintCard=function(t){GameNet.getInstance().request("room.pokerPdkHandler.hint",{},function(e){e.result!=n.NotHavePokerDis?t(e):createMoveMessage("没有大过上家的牌")})},i.requestOnDisCard=function(e,t){GameNet.getInstance().request("room.pokerPdkHandler.discard",{cards:e},function(e){e.result==n.NotPokerDis?createMoveMessage("大不过上家的牌"):e.result==n.HandPatternsError?createMoveMessage("出牌牌形错误"):e.result==n.MaxCardPut?createMoveMessage("下家报单，必须出最大的单牌"):e.result==n.NotHaveThreePoker&&createMoveMessage("出牌组合不含有红桃三"),t(e)})},cc._RF.pop()},{errorCode:"errorCode"}],"PDK-poker":[function(e,t,a){"use strict";cc._RF.push(t,"250680cCGhCQIDziK/F2x8m","PDK-poker");var g={straights:{level:1,colorFormat:!1,numFormat:[1,2,3,4,5,6,7,8,9,10,11,12],allowedLength:[5,6,7,8,9,10,11,12],notAllowedCard:[15]}},i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{pokerParent:{default:null,type:cc.Node},cardMask:{default:null,type:cc.Prefab}},onLoad:function(){for(var e in this.cards=this.pokerParent.children,this.pokerParent.children)this.cardInitY=this.cards[e].y;this.touchedCards=[],this.selectedCards=[],this.addTouchEvent()},start:function(){},onDestroy:function(){},addTouchEvent:function(){this.pokerParent.on(cc.Node.EventType.TOUCH_START,function(e){console.log("pokerParent TOUCH_START");var t=e.target;this.touchStartLocation=this.cards[0].convertTouchToNodeSpace(e);for(var a=0,n=0;n<this.cards.length;n++){if(this.cards[n].name==t.name){a=n;break}}if("handLayout"==t.name)return this.firstTouchedCard=void 0,void this.clearTouchedCards();var i={index:a,card:t};cc.log("card.active:"+t.active,t.name),this.firstTouchedCard=i,this.pushTouchedCards(i.index,i.card)},this),this.pokerParent.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(console.log("pokerParent TOUCH_MOVE"),this.clearTouchedCards(),null!=this.firstTouchedCard){this.pushTouchedCards(this.firstTouchedCard.index,this.firstTouchedCard.card);for(var t=this.cards[0].convertTouchToNodeSpace(e),a=(t.x,t.y,this.touchStartLocation),n=0;n<this.cards.length;n++){var i,o,r=this.cards[n],s=r.x+20;a.x<t.x?(i=a.x,o=t.x):(i=t.x,o=a.x),i<=s&&s<=o&&r.active&&this.pushTouchedCards(n,r)}}},this),this.pokerParent.on(cc.Node.EventType.TOUCH_END,function(e){console.log("pokerParent TOUCH_END"),this.doSelectCard()},this),this.pokerParent.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("pokerParent TOUCH_CANCEL"),this.doSelectCard()},this);for(var a=0;a<this.cards.length;a++){var n=this.cards;(function(e){var t=n[a];t.on(cc.Node.EventType.TOUCH_START,function(e){console.log("card TOUCH_START")},t),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("card TOUCH_MOVE")},t),t.on(cc.Node.EventType.TOUCH_END,function(e){console.log("card TOUCH_END"),t.active&&i.instance.playOtherAudioPoker("click",null)},t),t.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("card TOUCH_CANCEL"),t.active&&i.instance.playOtherAudioPoker("click",null)},t)})()}},pushTouchedCards:function(e,t){var a={index:e,name:t.name,isSelected:t.y!=this.cardInitY};this.touchedCards.find(function(e){return e.name==t.name?e:null})||(this.touchedCards.push(a),this.addCardMask(t))},clearTouchedCards:function(){for(var e=0;e<this.touchedCards.length;e++){var t=this.touchedCards[e].index;this.cards[t].removeChildByTag(100)}this.touchedCards=[]},doSelectCard:function(){this.selectedCards=[],this.pokerTypeArry=[],this.shunziArry=[];for(var e=[],t=!0,a=0;a<this.touchedCards.length;a++){var n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;this.pokerTypeArry.push(i),e.push(i%100)}for(var o=0;o<this.pokerTypeArry.length;o++)for(var r=0;r<this.pokerTypeArry.length;r++)r!=o&&this.pokerTypeArry[r]%100==this.pokerTypeArry[o]%100&&this.pokerTypeArry.splice(r,1);console.log("1111111111111111```"+this.pokerTypeArry);var s=this.getCardsType(this.pokerTypeArry);if(console.log("1111111111111111```"+s),s){var c=[];for(o=0;o<this.pokerTypeArry.length;o++)c.push(this.pokerTypeArry[o]%100),c.push(this.pokerTypeArry[o]%100);c.sort(function(e,t){return e-t}),e.sort(function(e,t){return e-t}),this.contain(c,e)&&(t=!1)}if(t&&"straights"==s)for(o=0;o<this.pokerTypeArry.length;o++){var d=!0;for(r=0;r<this.shunziArry.length;r++)this.pokerTypeArry[o]%100==this.shunziArry[r]%100&&(d=!1);d&&this.shunziArry.push(this.pokerTypeArry[o])}for(a=0;a<this.touchedCards.length;a++){var h;n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;cc.log("card:"+h.name);for(o=0;o<this.shunziArry.length;o++)i==this.shunziArry[o]&&(n.isSelected?h.y=h.y-30:h.y=h.y+30);0==this.shunziArry.length&&(n.isSelected?h.y=h.y-30:h.y=h.y+30)}this.clearTouchedCards(),this.showSelectedCards()},addCardMask:function(e){var t=cc.instantiate(this.cardMask);t.setTag(100),t.setPosition(cc.p(0,0)),e.addChild(t)},showSelectedCards:function(){this.selectedCards=[];for(var e=0;e<this.cards.length;e++){var t=this.cards[e];t.y!=this.cardInitY&&this.selectedCards.push(t.name)}sendEvent("pdk-disPokerArry",this.selectedCards)},contain:function(e,t){return e.toString()==t.toString()},getCardsType:function(e){for(var t in g){for(var a=g[t],n=!1,i=0;i<a.allowedLength.length;i++)a.allowedLength[i]==e.length&&(n=!0);if(n){var o=this.createSortedCardNumbers(e);cc.log("numbers = "+o);var r=!0;if(a.notAllowedCard)for(i=0;i<o.length;i++)for(var s=0;s<a.notAllowedCard.length;s++)o[i]==a.notAllowedCard[s]&&(r=!1);var c=0,d=0;if("aircraft"==t.substring(0,t.length-1)||"aircraft"==t)for(i=0;i<e.length;i++)115==e[i]||215==e[i]||315==e[i]||415==e[i]?c++:114!=e[i]&&214!=e[i]&&314!=e[i]&&414!=e[i]||d++,3==c&&3==d&&(r=!1);if(r){var h=!0,l=a.numFormat,u=null,m=[];for(s=0;s<o.length;s++)for(var p=0;p<o.length;p++)p!=s&&o[p]==o[s]&&o.splice(p,1);o.sort(function(e,t){return e-t}),cc.log("numbers = "+o);for(i=0;i<o.length;i++)if(0!=l[i])if(l[i]<0)if(m[-l[i]]){if(m[-l[i]]!=o[i]){h=!1;break}}else m[-l[i]]=o[i];else if(null==u)u=o[i]-l[i];else if(u!=o[i]-l[i]){h=!1;break}if(h&&5<=o.length)return t}}}return!1},createSortedCardNumbers:function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a]%100;return t}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"PDK-roomDissolve":[function(e,t,a){"use strict";cc._RF.push(t,"378b8taE7FEbrGN07GKWBuk","PDK-roomDissolve");var s=e("roomHandler"),n=e("gameDefine");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&GameData.client.gameType==n.GameType.Game_Poker_paodekuai&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){var e=!1;if(GameData.room.opts&&(e=!0),e)for(var t=0;t<GameData.room.opts.joinermax-1;t++){var a=cc.instantiate(this.headerNode);a.parent=this.headerNode.parent,a.name="header_"+(t+2),a.x=this.headerNode.x+200*(t+1)}},showPlayers:function(){var e=!1;if(GameData.room.opts&&(e=!0),e&&GameData.room.opts.joinermax)for(var t=0;t<GameData.room.opts.joinermax;t++){var a=t+1,n=GameData.joiners[t];if(null!=n){var i=n.uid,o=n.headimgurl;this.showHeaderIcon(a,o),this.showHeaderName(a,n.name);var r=s.isPlayerOnline(i);cc.find("header_"+a+"/lost",this.headerNode.parent).active=!r}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("PDK-roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("PDK-roomMain").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("PDK-roomMain").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){s.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("PDK-roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){s.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){s.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(s.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],"PDK-roomHandler":[function(e,t,a){"use strict";cc._RF.push(t,"e3957NLmZNEm67cT7GTm7Uu","PDK-roomHandler");var n={allScores:{},roomsummaryData:{},openScore:0,recordInfo:[],currJiaofenPlayerData:{},gameStartData:{},currObtainPlayerData:{},lastDisPokerUid:0,hideDisCard:{},deal:!1,tiFlag:!1,chuaiFlag:!1,kicking:{},currtiChuaiPlayerData:[],handCardSize:17,handCardSizeMax:20,game:{roundType:0,roundNum:0,roundmax:0,turn:0,lastdisUid:0,lastdisCard:0,winnerUid:0,dizhuUid:0,gangOver:0,gameStart:!1,gameStartDizhu:!1,initcards:!1,onRoomDissolve:{},onRoomDissolveResult:{},onRoomDisbandTimer:{},onRoomReadyInfo:{},isJiaofenAgain:!1},cards:{},resultData:{},createRoomOpts:{}};(t.exports=n).initCreateRoomOpts=function(){var e=cc.sys.localStorage.getItem("DDZcreateRoomOpts");null==e?(n.createRoomOpts={},n.createRoomOpts.roomTypes=1,n.createRoomOpts.playType=0,n.createRoomOpts.roundMax=6,n.createRoomOpts.fanshu=2,n.createRoomOpts.costType=1,n.createRoomOpts.jiaofenType=1,n.createRoomOpts.mud=!1,n.createRoomOpts.kicking=!1,n.createRoomOpts.times=1,n.createRoomOpts.score=1):n.createRoomOpts=JSON.parse(e)},n.saveCreateRoomOpts=function(){null!=n.createRoomOpts&&null!=n.createRoomOpts&&cc.sys.localStorage.setItem("DDZcreateRoomOpts",JSON.stringify(n.createRoomOpts))},n.getJiaofenNum=function(e){return n.cards[e].jiaofenNum},n.getDisPoker=function(e){return n.cards[e].discards},n.getHandCards=function(e){return n.cards[e].hand},n.getMyHandCards=function(){if(null!=n.cards[GameData.player.uid])return n.cards[GameData.player.uid].hand},n.getHandCardNum=function(e){return n.cards[e].handnum},n.setPosition=function(){var e;GameData.tablePos={};var t=GameData.getPlayerIndex(GameData.player.uid);if(null!=GameData.room.opts){if(4==GameData.room.opts.joinermax){0==t?e=["down","right","up","left"]:1==t?e=["left","down","right","up"]:2==t?e=["up","left","down","right"]:3==t&&(e=["right","up","left","down"]);for(var a=0;a<GameData.joiners.length;a++)GameData.joiners[a]&&(GameData.tablePos[GameData.joiners[a].uid]=e[a])}else if(3==GameData.room.opts.joinermax){0==t?e=["down","right","left"]:1==t?e=["left","down","right"]:2==t&&(e=["right","left","down"]);for(a=0;a<GameData.joiners.length;a++)GameData.joiners[a]&&(GameData.tablePos[GameData.joiners[a].uid]=e[a])}else if(2==GameData.room.opts.joinermax){0==t?e=["down","up"]:1==t&&(e=["up","down"]);for(a=0;a<GameData.joiners.length;a++)GameData.joiners[a]&&(GameData.tablePos[GameData.joiners[a].uid]=e[a])}cc.log("table pos:"+JSON.stringify(GameData.tablePos))}},n.getPosByUid=function(e){return GameData.tablePos[e]},n.isEmptyObject=function(e){for(var t in e)return!1;return!0},n.objectLen=function(e){var t=0;for(var a in e)t++;return t},n.clearObject=function(e){for(var t in e)delete e[t];return!!n.isEmptyObject(e)},n.registMessage=function(){GameNet.getInstance().setCallBack("tjddz-hideCard",function(e){WriteLog("tjddz-hideCard: ",e),n.hideDisCard=e,sendEvent("tjddz-hideCard",e)}),GameNet.getInstance().setCallBack("tjddz-startChuai",function(e){WriteLog("do event tjddz-startChuai  "+JSON.stringify(e)),n.chuaiFlag=!0,sendEvent("tjddz-startChuai",e)}),GameNet.getInstance().setCallBack("tjddz-startTi",function(e){WriteLog("do event tjddz-startTi  "+JSON.stringify(e)),n.tiFlag=!0,sendEvent("tjddz-startTi",e)}),GameNet.getInstance().setCallBack("tjddz-showKicking",function(e){WriteLog("do event tjddz-showKicking  "+JSON.stringify(e)),n.kicking=e,sendEvent("tjddz-showKicking",e)}),GameNet.getInstance().setCallBack("tjddz-onGameInfo",function(e){WriteLog("do event tjddz-onGameInfo  "+JSON.stringify(e)),n.game.initcards=!0,n.deal=!1,sendEvent("tjddz-onGameInfo",e)}),GameNet.getInstance().setCallBack("tjddz-initCardHandNum",function(e){WriteLog("do event tjddz-initCardHandNum  "+JSON.stringify(e)),n.cards[e.uid]=void 0===n.cards[e.uid]?{}:n.cards[e.uid],n.cards[e.uid].handnum=e.num,sendEvent("tjddz-initCardHandNum")}),GameNet.getInstance().setCallBack("tjddz-initCardHand",function(e){WriteLog("do event tjddz-initCardHand  "+JSON.stringify(e)),n.cards[e.uid]=void 0===n.cards[e.uid]?{}:n.cards[e.uid],n.cards[e.uid].hand=e.hand,sendEvent("tjddz-initCardHand")}),GameNet.getInstance().setCallBack("tjddz-onGameStart",function(e){WriteLog("do event tjddz-onGameStart  "+JSON.stringify(e)),n.initGameData(),n.game.gameStart=!0,n.deal=!0,sendEvent("tjddz-onGameStart")}),GameNet.getInstance().setCallBack("tjddz-onGameScore",function(e){WriteLog("do event tjddz-onGameScore  "+JSON.stringify(e)),n.resultData=e,n.game.gameStart=!1,n.tiFlag=!1,n.chuaiFlag=!1,sendEvent("tjddz-onGameScore",e)}),GameNet.getInstance().setCallBack("tjddz-onGameAllScore",function(e){WriteLog("do event tjddz-onGameAllScore  "+JSON.stringify(e)),n.allScores=e.score,n.roomsummaryData=e,sendEvent("tjddz-onGameAllScore",e)}),GameNet.getInstance().setCallBack("tjddz-onFirstJiaoFen",function(e){WriteLog("sercerMsg  tjddz-onFirstJiaoFen :"+JSON.stringify(e)),n.game.isJiaofenAgain=e.flag,n.currJiaofenPlayerData=e,sendEvent("tjddz-onJiaoFen",e)}),GameNet.getInstance().setCallBack("tjddz-showWatch",function(e){WriteLog("sercerMsg  tjddz-showWatch :"+JSON.stringify(e)),n.currtiChuaiPlayerData=e,sendEvent("tjddz-showWatch",e)}),GameNet.getInstance().setCallBack("tjddz-nextJiaoFen",function(e){for(var t in WriteLog("sercerMsg  tjddz-nextJiaoFen :"+JSON.stringify(e)),e.allJiaoFen)n.cards[t].jiaofenNum=e.allJiaoFen[t];n.currJiaofenPlayerData=e,sendEvent("tjddz-onJiaoFen",e)}),GameNet.getInstance().setCallBack("tjddz-reconnectionInfo",function(e){if(WriteLog("sercerMsg  tjddz-reconnectionInfo :"+JSON.stringify(e)),"jiaofen"==e.type)for(var t in(n.currJiaofenPlayerData=e).allJiaoFen)n.cards[t].jiaofenNum=e.allJiaoFen[t]}),GameNet.getInstance().setCallBack("tjddz-openScore",function(e){WriteLog("do event tjddz-openScore  "+JSON.stringify(e)),n.openScore=e.open,sendEvent("tjddz-openScore",e)}),GameNet.getInstance().setCallBack("tjddz-onDiZhu",function(e){WriteLog("sercerMsg  tjddz-onDiZhu  :"+JSON.stringify(e)),n.game.dizhuUid=e.dizhuUid,n.gameStartData=e,n.game.gameStartDizhu=!0,sendEvent("tjddz-onDiZhu",e)}),GameNet.getInstance().setCallBack("tjddz-disCardUid",function(e){WriteLog("sercerMsg  tjddz-disCardUid  :"+JSON.stringify(e)),n.currObtainPlayerData=e,sendEvent("tjddz-onShowObtainNode",e)}),GameNet.getInstance().setCallBack("tjddz-initCardHandNums",function(e){WriteLog("do event tjddz-initCardHandNums  "+JSON.stringify(e)),n.cards[e.uid].handnum=e.num,cc.log("initCardHandNums"+JSON.stringify(n.cards[e.uid])),sendEvent("tjddz-initCardHandNums")}),GameNet.getInstance().setCallBack("tjddz-showDisPoker",function(e){WriteLog("sercerMsg  tjddz-showDisPoker  :"+JSON.stringify(e)),n.cards[e.uid]=void 0===n.cards[e.uid]?{}:n.cards[e.uid],n.cards[e.uid].discards=e.cards,sendEvent("tjddz-showDisPoker",e)}),GameNet.getInstance().setCallBack("tjddz-initCardHands",function(e){WriteLog("do event tjddz-initCardHands  "+JSON.stringify(e)),n.cards[e.uid]=void 0===n.cards[e.uid]?{}:n.cards[e.uid],n.cards[e.uid].hand=e.hand,sendEvent("tjddz-initCardHands",e)}),GameNet.getInstance().setCallBack("tjddz-cardWarning",function(e){WriteLog("do event tjddz-cardWarning  "+JSON.stringify(e)),sendEvent("tjddz-cardWarning",e)}),GameNet.getInstance().setCallBack("tjddz-onDiscardType",function(e){WriteLog("do event tjddz-onDiscardType  "+JSON.stringify(e)),n.lastDisPokerUid=e.uid,sendEvent("tjddz-onDiscardType",e)}),GameNet.getInstance().setCallBack("tjddz-jiaoFencb",function(e){WriteLog("do event tjddz-jiaoFencb  "+JSON.stringify(e)),sendEvent("tjddz-jiaoFencb",e)}),GameNet.getInstance().setCallBack("tjddz-passcb",function(e){WriteLog("do event tjddz-passcb  "+JSON.stringify(e)),n.cards[e.uid].discards=e.cards,n.cards[e.nextUid].discards=e.nextCards,sendEvent("tjddz-passcb",e)}),GameNet.getInstance().setCallBack("tjddz-hintCard",function(e){WriteLog("do event tjddz-hintCard  "+JSON.stringify(e)),sendEvent("tjddz-hintCard",e)}),GameNet.getInstance().setCallBack("tjddz-BackTable",function(e){WriteLog("do event tjddz-BackTable  "+JSON.stringify(e)),n.game.initcards=!0})},cc._RF.pop()},{}],"PDK-roomMain":[function(e,t,a){"use strict";cc._RF.push(t,"f5bb4hFPK9B8LymfJNnDZV3","PDK-roomMain");var n=e("SoundMngr"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){registEvent("pdk-onGameStart",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("AnimationDelayTime",this,this.showResultLayer),registEvent("onServerNotice",this,handlerServerNotice),scheduleLamp(this),GameDataPDK.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,1==GameDataPDK.openScore&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(1e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToNodeSpace(t),n={x:this.getContentSize().width/2,y:this.getContentSize().height/2};cc.pDistance(a,n)>this.getContentSize().width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.showTableUI(!0)},onDestroy:function(){unregistEvent("pdk-onGameStart",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("AnimationDelayTime",this,this.showResultLayer),unregistEvent("onServerNotice",this,handlerServerNotice),GameData.initGameData(),GameDataPDK.initRoomData()},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("pdk/sound/bgm1")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("pdk/sound/bgm1")},showResultLayer:function(e){var t=e.detail,a=this;this.scheduleOnce(function(){a.showResultDirectly()},t)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&GameData.joinContact.uid==GameData.player.uid?GameData.contact=!1:(GameData.contact=!1,GameData.realNum++),this.node.getComponent("PDK-roomResult").onShow()},showSettingLayer:function(e,t){1==t?openView("DDZ-SettingsPanel",i.GameType.Game_Poker_TianjinDDZ):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,GameData.realNum=0,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)},AnimationDelayTime:function(e){this._AnimationDelayTime=e.detail}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"PDK-roomResult":[function(e,t,a){"use strict";cc._RF.push(t,"c2508OhVShP77Zqm8rYRx/1","PDK-roomResult");var n=e("PDK-handler");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,resultIcon:cc.Sprite,isMark:0,roomid:cc.Label,createTime:cc.Label,roundNum:cc.Label,fonts:{default:[],type:cc.Font}},onLoad:function(){},onDestroy:function(){},onShow:function(){if(GameData.room.opts.joinermax){for(var e=0;e<GameData.room.opts.joinermax;e++)this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e),this.showPoker(e);this.showResultIcon(),this.showRoomDetail()}},initResultLayer:function(){if(!GameDataPDK.isEmptyObject(GameDataPDK.game.onRoomReadyInfo))for(var e in GameDataPDK.game.onRoomReadyInfo)if(1==GameDataPDK.game.onRoomReadyInfo[e]&&e==GameData.player.uid){this.resultLayer.active=!1;break}},showName:function(e,t){isChinese(t)?e.string=getShortStr(t,4):isChinese(t)||(e.string=getShortStr(t,8))},showPlayer:function(e){var a=GameData.joiners[e];cc.find("panel/player_"+(e+1),this.resultLayer).active=!0;var t=cc.find("panel/player_"+(e+1)+"/headNode/playerID",this.resultLayer),n=cc.find("panel/player_"+(e+1)+"/headNode/name",this.resultLayer),i=cc.find("panel/player_"+(e+1)+"/headNode/head",this.resultLayer),o=cc.find("panel/player_"+(e+1)+"/headNode/identity_icon",this.resultLayer);this.showName(n.getComponent(cc.Label),a.name),t.getComponent(cc.Label).string="ID:"+a.uid,a.uid==GameData.room.creator?o.active=!0:o.active=!1,null!=a.headimgurl&&""!=a.headimgurl&&cc.loader.load({url:a.headimgurl,type:"png"},function(e,t){!e&&t&&(cc.log("result:"+a.headimgurl),i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("panel/player_"+(e+1)+"/residue/label",this.resultLayer),n=cc.find("panel/player_"+(e+1)+"/boomNum/label",this.resultLayer);for(var i in a.getComponent(cc.Label).string=GameDataPDK.cards[t.uid].handnum+"张",GameDataPDK.resultData.boom)if(t.uid==i){n.getComponent(cc.Label).string=GameDataPDK.resultData.boom[i];break}},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("panel/player_"+(e+1)+"/field_num1",this.resultLayer);GameDataPDK.resultData.score&&(0<GameDataPDK.resultData.score[t]?(a.getComponent("cc.Label").font=this.fonts[0],a.getComponent("cc.Label").string="+"+GameDataPDK.resultData.score[t]):0==GameDataPDK.resultData.score[t]?(a.getComponent("cc.Label").font=this.fonts[2],a.getComponent("cc.Label").string="+"+GameDataPDK.resultData.score[t]):(a.getComponent("cc.Label").font=this.fonts[1],a.getComponent("cc.Label").string=GameDataPDK.resultData.score[t]))},showWinIcon:function(e){var t=GameData.joiners[e],a=cc.find("panel/player_"+(e+1)+"/resultIcon",this.resultLayer),n="";if(t.uid==GameDataPDK.resultData.winner)n="resources/pdk/sheng.png";else for(var i in GameDataPDK.resultData.guanmen)if(t.uid==i){n="resources/pdk/guanmen.png";break}a.active=!0,a.getComponent(cc.Sprite).spriteFrame=null;var o=cc.textureCache.addImage(cc.url.raw(n));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showPoker:function(e){var t=cc.find("panel/player_"+(e+1)+"/cardsNoe",this.resultLayer);for(var a in t.children)t.children[a].active=!1;var n=GameData.joiners[e].uid,i=GameDataPDK.getHandCards(n);if(null!=i.length)for(var o=0;o<i.length;o++){var r=cc.find("card_"+o,t);r.active=!0,r.getComponent(cc.Sprite).spriteFrame=null;var s="resources/ddz/UI/pokers/poker_"+i[o]+".png",c=cc.textureCache.addImage(cc.url.raw(s));r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(c)}},showResultIcon:function(){var e=GameDataPDK.resultData.score[GameData.player.uid],t="";0<e?t="resources/ddz/UI/result/woyingle.png":e<0?t="resources/ddz/UI/result/shibaile.png":0==e&&(t="resources/pdk/pingjubiaoti.png"),this.resultIcon.getComponent(cc.Sprite).spriteFrame=null;var a=cc.textureCache.addImage(cc.url.raw(t));this.resultIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)},showRoomDetail:function(){this.roomid.string="房间号:"+GameData.room.id,this.createTime.string=getDate(GameData.room.createtime),this.roundNum.string="第 "+GameData.room.roundNum+"/"+GameData.room.opts.roundMax+" 局"},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("PDK-roomMain").showSummaryLayer()):(n.requestReady(function(e){}),this.resultLayer.active=!1,GameDataPDK.game.zhuangUid=0,sendEvent("pdk-onGameStart"),sendEvent("initTableNode")),GameDataPDK.clearObject(GameDataPDK.kicking)},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{"PDK-handler":"PDK-handler"}],"PDK-roomSummary":[function(e,t,a){"use strict";cc._RF.push(t,"bb77dCuLYJNLKCNLjY5wF4x","PDK-roomSummary"),cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font},lostNode:{default:null,type:cc.Node}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),this.hideLostNode();for(var e=0;e<GameData.joiners.length;e++)this.showPlayer(GameData.joiners[e],e+1)},hideLostNode:function(){for(var e in this.lostNode.children)this.lostNode.children[e].active=!1},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(a,e){if(a){GameData.room.opts.joinermax;cc.find("player_"+e,this.panel).active=!0;var t=cc.find("player_"+e+"/name",this.panel),n=cc.find("player_"+e+"/field_num1",this.panel),i=cc.find("player_"+e+"/head",this.panel),o=cc.find("player_"+e+"/playerID",this.panel),r=(cc.find("player_"+e,this.panel),cc.find("player_"+e+"/maxScore",this.panel)),s=cc.find("player_"+e+"/maxBobm",this.panel);cc.find("bg",this.panel).getContentSize().width,cc.find("player_"+e+"/biankuang",this.panel).getContentSize().width;if(cc.find("player_"+e+"/owner",this.panel).active=GameData.room.creator==a.uid,isChinese(a.name)?t.getComponent("cc.Label").string=getShortStr(a.name,5):t.getComponent("cc.Label").string=getShortStr(a.name,9),o.getComponent("cc.Label").string="ID:"+a.uid,GameDataPDK.roomsummaryData&&0!=Object.keys(GameDataPDK.roomsummaryData).length&&(0!=Object.keys(GameDataPDK.roomsummaryData.maxFen).length&&(r.getComponent("cc.Label").string="单局最高分:"+GameDataPDK.roomsummaryData.maxFen[a.uid]),0!=Object.keys(GameDataPDK.roomsummaryData.maxBoom).length&&(s.getComponent("cc.Label").string="打出炸弹数:"+GameDataPDK.roomsummaryData.maxBoom[a.uid])),null!=a.headimgurl&&""!=a.headimgurl&&0<a.headimgurl.length&&cc.loader.load({url:a.headimgurl,type:"png"},function(e,t){!e&&t&&(cc.log("player.headimgurl:"+a.headimgurl),i.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),null!=GameDataPDK.roomsummaryData.score){var c=GameDataPDK.roomsummaryData.score[a.uid];if(cc.log("..score:"+c),0<c?(n.getComponent("cc.Label").string="+"+c,n.getComponent("cc.Label").font=this.fonts[1]):c<0?(n.getComponent("cc.Label").string=c,n.getComponent("cc.Label").font=this.fonts[0]):(n.getComponent("cc.Label").string=c,n.getComponent("cc.Label").font=this.fonts[2]),GameData.room.creator==a.uid)cc.find("player_"+e+"/owner",this.panel).active=!0;var d=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&GameDataPDK.roomsummaryData.score[GameData.joiners[t].uid]>GameDataPDK.roomsummaryData.score[e]&&(e=GameData.joiners[t].uid);return e};cc.find("player_"+e+"/win",this.panel);if(GameDataPDK.roomsummaryData.score[d()]==GameDataPDK.roomsummaryData.score[a.uid])cc.find("player_"+e+"/win",this.panel).active=0<GameDataPDK.roomsummaryData.score[d()]}}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{}],"PDK-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"17b6dvGOcFLVL3aFBoXWcgV","PDK-roomWait");var y=e("SoundMngr"),s=e("roomHandler"),n=e("PDK-handler");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,btnRule:cc.Button,lostInfo:[],readyBtn:cc.Node,rotateCard:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){WriteLog("TJDDZ-roomWait onLoad"),this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomInfo",this,this.showPlayers),registEvent("pdk-onReady",this,this.onReady),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("rotateAction",this,this.rotateAction),registEvent("initTableNode",this,this.showPlayers),registEvent("onPrepareInfo",this,this.onPrepareInfo),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("pdk-onGameAllScore",this,this.onGameAllScoreHandler),registEvent("pdk-onGameStart",this,this.onGameStartHandler),registEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("HideReadyNode",this,this.HideReadyNode),registEvent("AnimationDelayTime",this,this.onGameScoreHandler),registEvent("pdk-showKicking",this,this.showKicking),registEvent("dynChat",this,this.dynChatHandler),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation(),n.requestReady()},onEnable:function(){this.readyNode.active=!GameDataPDK.game.gameStart,GameData.game.onRoomReadyInfo.data},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("pdk-onReady",this,this.onReady),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("rotateAction",this,this.rotateAction),unregistEvent("initTableNode",this,this.showPlayers),unregistEvent("onPrepareInfo",this,this.onPrepareInfo),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("pdk-onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("pdk-onGameStart",this,this.onGameStartHandler),unregistEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),unregistEvent("pdk-onGameScore",this,this.onGameScoreHandler),unregistEvent("yunwaUploaded",this,this.onYunwaUploaded),unregistEvent("HideReadyNode",this,this.HideReadyNode),unregistEvent("AnimationDelayTime",this,this.onGameScoreHandler),unregistEvent("pdk-showKicking",this,this.showKicking),unregistEvent("dynChat",this,this.dynChatHandler)},onReady:function(){GameDataPDK.clearObject(GameDataPDK.kicking),sendEvent("initTableNode"),n.requestReady()},onGameScoreHandler:function(e){var t=e.detail,a=this;this.scheduleOnce(function(){a.readyNode.active=!0},t)},HideReadyNode:function(){this.readyNode.active=!1},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("DDZ-playerTemplate"),n=a.uid,i=null==GameDataPDK.allScores[n]?0:GameDataPDK.allScores[n];a.setCoin(i,1)}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("DDZ-playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioPokerChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;cc.log("animationName:"+g),c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("DDZ-playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},rotateAction:function(){var e=GameDataPDK.getPosByUid(GameDataPDK.game.zhuangUid);if("left"==e)this.runRotateCard(this.play_left_player);else if("right"==e)this.runRotateCard(this.play_right_player);else if("down"==e){this.rotateCard.active=!0;var t=cc.moveTo(1,cc.p(0,-254)),a=this,n=cc.callFunc(function(){a.easeCubicAction(a.rotateCard)},this),i=cc.delayTime(1.5),o=cc.sequence(i,t,n);this.rotateCard.runAction(o)}},runRotateCard:function(e){this.rotateCard.active=!0;var t=e.getPosition(),a=cc.rotateTo(1,1080),n=cc.scaleTo(1,.3),i=cc.moveTo(1,cc.p(t.x,t.y)),o=cc.spawn(a,n,i),r=this,s=cc.callFunc(function(){r.rotateCard.active=!1,r.rotateCard.x=0,r.rotateCard.y=0,r.rotateCard.scaleX=1,r.rotateCard.scaleY=1,sendEvent("showFirstCard"),sendEvent("runFlipAction")},this),c=cc.delayTime(1.5),d=cc.sequence(c,o,s);this.rotateCard.runAction(d)},scaleRotateCard:function(e){this.scaleEffectsOfNode(this.rotateCard,1.3,1.3,1,1,.4,function(){}),1<=e&&this.unschedule(this.scaleRotateCard)},scaleEffectsOfNode:function(e,t,a,n,i,o,r){var s=cc.scaleTo(o,t,a),c=cc.scaleTo(o,n,i),d=cc.callFunc(r,this),h=cc.sequence(d,s,c);e.runAction(h)},easeCubicActionTimer:function(e){e.opacity=e.opacity-51},easeCubicAction:function(t){var a=0,n=this;this.schedule(function e(){a++,n.easeCubicActionTimer(t),5<=a&&(t.active=!1,t.x=0,t.y=0,t.opacity=255,n.unschedule(e),sendEvent("runFlipAction"))},.1)},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},hideAllReadyStatus:function(){cc.find("ready_hand_left",this.readyNode).active=!1,cc.find("readying_left",this.readyNode).active=!1,cc.find("ready_hand_right",this.readyNode).active=!1,cc.find("readying_right",this.readyNode).active=!1,cc.find("ready_hand_down",this.readyNode).active=!1,cc.find("readying_down",this.readyNode).active=!1},onPrepareInfo:function(e){for(var t in this.hideAllReadyStatus(),this.readyNode.active=!0,this.hideTiChuai(),GameDataPDK.game.onRoomReadyInfo)if(1==GameDataPDK.game.onRoomReadyInfo[t]){var a=GameDataPDK.getPosByUid(t);this.showReadyIcon(a,!0,!1)}this.onRoomReadyInfoHandler(e)},showPlayers:function(){WriteLog("showPlayers"),this.headers=[];var e=["down","right","left"],t=[this.play_down_player,this.play_right_player,this.play_left_player];t.push(this.play_down_player),t.push(this.play_right_player),t.push(this.play_left_player);for(var a=0;a<GameData.room.opts.joinermax;a++)this.showPlayer(e[a],t[a]);this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var n=GameData.room.creator==GameData.player.uid;this.deleteRoomBtn.active=n,this.quitRoomBtn.x=n?107:6,this.connectRecurrence()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){},showPlayer:function(e,t){WriteLog("showPlayer"),t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);cc.log("playerNode:",n),n.getComponent("DDZ-playerTemplate").setPlayer(a),n.getComponent("DDZ-playerTemplate").setName(a.name),n.getComponent("DDZ-playerTemplate").setHeadIcon(a.headimgurl),n.getComponent("DDZ-playerTemplate").setNamePositionByDir(e);var i=0;null!=GameDataPDK.roomsummaryData.score&&(i=null==GameDataPDK.roomsummaryData.score[a.uid]?0:GameDataPDK.roomsummaryData.score[a.uid]),n.getComponent("DDZ-playerTemplate").setCoin(i,1),n.getComponent("DDZ-playerTemplate").setIsPlayerIcon(!1),n.getComponent("DDZ-playerTemplate").showPlayerIdentity(!1,0),t.addChild(n),t.active=!0,this.headers.push(n),n.setTag(a.uid),2==a.status&&this.showReadyIcon(e,!1,!1);var o=s.isPlayerOnline(a.uid),r=cc.find("Disconnect",n);cc.find("lost_"+e,this.lostNode).active=!o,r.active=!o}else t.active=!1,this.showReadyIcon(e,!1,!1)},hideTiChuai:function(){for(var e=0;e<this.headers.length;e++){var t=cc.find("tiChuaiNode",this.headers[e]),a=cc.find("tiIcon",t),n=cc.find("chuaiIcon",t);a.active=!1,n.active=!1}},showPlayerTiChuai:function(e,t,a){var n=e.getChildByName("TablePlayerTemplate"),i=cc.find("tiChuaiNode",n);if(1==GameDataPDK.kicking.kicking[a]&&a!=t){var o=cc.find("tiIcon",i);o.active=!0,e==this.play_right_player&&(o.x=-67)}else if(1==GameDataPDK.kicking.kicking[a]&&a==t){var r=cc.find("chuaiIcon",i);r.active=!0,e==this.play_right_player&&(r.x=-67)}},showKicking:function(){for(var e in GameDataPDK.kicking.kicking){var t=GameDataPDK.getPosByUid(e);"down"==t?this.showPlayerTiChuai(this.play_down_player,GameDataPDK.kicking.dizhu,e):"right"==t&&this.showPlayerTiChuai(this.play_right_player,GameDataPDK.kicking.dizhu,e),"left"==t&&this.showPlayerTiChuai(this.play_left_player,GameDataPDK.kicking.dizhu,e)}},connectRecurrence:function(){this.showKicking()},onRoomReadyInfoHandler:function(e){for(var t=["down","right","left"],a=0;a<GameData.room.opts.joinermax;a++)this.gotoShowReady(t[a],e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showPlayers()}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("DDZ-playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)):(3==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameDataPDK.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;a.uid!=i||0==a.uid?(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0):(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1)}cc.log("direction :"+e+n),cc.find("lost_"+e,this.lostNode).active=n}},setRoomNum:function(){cc.log("setRoomNum: ",JSON.stringify(GameData.room));1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitMjRoom(GameData.room.id)},wxInviteBtnClicked:function(){var e="跑得快 房间号:"+GameData.room.id,t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="玩法:";e+=["房主付,","AA制,","赢家付,","代开房付费,",""][GameData.room.opts.costType-1],1==GameData.room.opts.passFlag?e+="必须管,":2==GameData.room.opts.passFlag&&(e+="可不管,"),1==GameData.room.opts.zhuangType&&(e+="红桃3先出,"),e+="局数:"+GameData.room.opts.roundMax+",";return(e+="人数:"+GameData.room.opts.joinermax)+",请您快速加入对局."},onShareResult:function(){wxShareTimeline("跑得快","我在跑得快等你!")},onShareFriend:function(){wxShareWeb("跑得快","我在跑得快等你!")},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){s.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):s.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyInviteKey:function(){if(0<GameData.room.id){var e="跑得快,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},onCopyRoomInfo:function(){},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){this.readyNode.active=!GameDataPDK.game.gameStart,this.hideAllReadyStatus()},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{"PDK-handler":"PDK-handler",SoundMngr:"SoundMngr",roomHandler:"roomHandler"}],"PDK-roomtable":[function(e,t,a){"use strict";cc._RF.push(t,"942f6hjUrJJuqwRCukXjWk6","PDK-roomtable");var s=e("SoundMngr"),i=e("PDK-handler");cc.Class({extends:cc.Component,properties:{play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,ruleLb:cc.Label,handCardLayOut:cc.Node,cardsNode:cc.Node,actionLayer:cc.Node,jiaofenNode:cc.Node,HoleCardsNode:cc.Node,clockNodes:cc.Node,buchuNodes:cc.Node,warningNode:cc.Node,multipleNode:cc.Node,_countdown_index:0,_currClockNodes:cc.Node,lastRoundLabel:cc.Label,dragonAnimations:cc.Node,winAnimation:cc.Node,loseAnimation:cc.Node,planeNode:cc.Node,chuntianNode:cc.Node,bobmAinmation:cc.Node,huojianAinmation:cc.Node,_effcetFlag:!1,maskNode:cc.Node,_currTime:null,dizhuSign:{default:null,type:cc.Prefab},tiBtnNode:{default:null,type:cc.Node},chuaiBtnNode:{default:null,type:cc.Node},chuaiIcon_right:{default:null,type:cc.Node},chuaiIcon_left:{default:null,type:cc.Node},tiIcon_right:{default:null,type:cc.Node},tiIcon_left:{default:null,type:cc.Node},passNode:{default:null,type:cc.Node}},onLoad:function(){for(var e in WriteLog("PDK-roomtable onLoad"),this.initData(),this.initUI(),this.registListenr(),this.handCardLayOut.children)this.defaultPokerY=this.handCardLayOut.children[e].y;GameDataPDK.game.initcards&&(this.cardsNode.active=!0,this._dealEnd=!0,this.onShow()),GameDataPDK.game.gameStartZhuang&&(this.showObtainNode(),this.showDisPoker(),this.showBuchuNode(),this.reconneShowWarning()),this.connectRecurrence()},registListenr:function(){registEvent("onPrepareInfo",this,this.showRoomRule),registEvent("pdk-onGameInfo",this,this.onShow),registEvent("showFirstCard",this,this.showZhuangInfo),registEvent("pdk-initCardHands",this,this.onShow),registEvent("pdk-initCardHand",this,this.initCardHand),registEvent("pdk-initCardHandNum",this,this.showCardNum),registEvent("pdk-initCardHandNums",this,this.showCardNum),registEvent("pdk-onGameStart",this,this.handleGameStart),registEvent("pdk-onShowObtainNode",this,this.showObtainNode),registEvent("pdk-showDisPoker",this,this.showDisPoker),registEvent("initTableNode",this,this.initTableNode),registEvent("pdk-onGameScore",this,this.showWinNode),registEvent("pdk-cardWarning",this,this.showWarningNode),registEvent("pdk-onDiscardType",this,this.showDisCardType),registEvent("pdk-disPokerArry",this,this.setDisPokerArry),registEvent("pdk-passcb",this,this.playPassEffect),registEvent("pdk-hintCard",this,this.showHintCard),registEvent("pdk-hideCard",this,this.hidePlayerCard),registEvent("onShowSummary",this,this.stopClockMusic),registEvent("pdk-showWatch",this,this.showWatch),registEvent("pdk-reconnectionInfo",this,this.reconnectionInfo),registEvent("runFlipAction",this,this.runFlipAction),registEvent("initObtainNode",this,this.initObtainNode),registEvent("showDisBtnAndClook",this,this.showDisBtnAndClook);var e=this;this.maskNode.on(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()})},onDestroy:function(){unregistEvent("onPrepareInfo",this,this.showRoomRule),unregistEvent("pdk-onGameInfo",this,this.onShow),unregistEvent("showFirstCard",this,this.showZhuangInfo),unregistEvent("pdk-initCardHands",this,this.onShow),unregistEvent("pdk-initCardHand",this,this.initCardHand),unregistEvent("pdk-initCardHandNum",this,this.showCardNum),unregistEvent("pdk-initCardHandNums",this,this.showCardNum),unregistEvent("pdk-onGameStart",this,this.handleGameStart),unregistEvent("pdk-onShowObtainNode",this,this.showObtainNode),unregistEvent("pdk-showDisPoker",this,this.showDisPoker),unregistEvent("initTableNode",this,this.initTableNode),unregistEvent("pdk-onGameScore",this,this.showWinNode),unregistEvent("pdk-cardWarning",this,this.showWarningNode),unregistEvent("pdk-onDiscardType",this,this.showDisCardType),unregistEvent("pdk-disPokerArry",this,this.setDisPokerArry),unregistEvent("pdk-passcb",this,this.playPassEffect),unregistEvent("pdk-hintCard",this,this.showHintCard),unregistEvent("pdk-hideCard",this,this.hidePlayerCard),unregistEvent("onShowSummary",this,this.stopClockMusic),unregistEvent("pdk-showWatch",this,this.showWatch),unregistEvent("pdk-reconnectionInfo",this,this.reconnectionInfo),unregistEvent("runFlipAction",this,this.runFlipAction),unregistEvent("initObtainNode",this,this.initObtainNode),unregistEvent("showDisBtnAndClook",this,this.showDisBtnAndClook);var e=this;this.maskNode.off(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()})},initData:function(){this.disCardArry=[],this.disPokerArry=[],this._dragonAnimtaionNum=0,this._cardHandPosArr=[],this._angularArr=[],this._dealActionIndex=0,this._flipActionIndex=0,this._cardHand=[],this._dealEnd=!1,this._kickingArr=[],this._buJiao=1,this._passFlag=0},initUI:function(){this.HoleCardsNode.active=!0,this.cardsNode.active=!1,this.jiaofenNode.active=!1,this.ruleLb.string=this.getRuleStr(),this.hideDisCards(),this.changeMultiple(0),this.lastRoundLabel.string="局数:"+GameData.room.roundNum+"/"+GameData.room.opts.roundMax},initTableNode:function(){var e=cc.find("lastpokerNum",this.play_layer_left),t=cc.find("lastpokerNum",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideDisCards(),this.hideHandCards();var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a),this.actionLayer.active=!1,this.hideNodeChild(this.clockNodes),this.changeMultiple(0),GameDataPDK.game.zhuangUid=0,this.chuntianNode.active=!1,this.winAnimation.active=!1,this.loseAnimation.active=!1,this.planeNode.active=!1,this.bobmAinmation.active=!1,this.huojianAinmation.active=!1,this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.stopClockMusic()},showRoomRule:function(){this.ruleLb.string=this.getRuleStr()},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},handleGameStart:function(){GameDataPDK.clearObject(GameDataPDK.hideDisCard),GameDataPDK.clearObject(GameDataPDK.currObtainPlayerData),this.cardsNode.active=!0,this.hideHoleCards()},initCardHand:function(){GameDataPDK.getHandCardSize(),cc.log("---------------------hand card size: ",GameDataPDK.handCardSize),GameDataPDK.getMyHandCards().length==GameDataPDK.handCardSize&&1==GameDataPDK.deal&&(this._firstInit=!0),this.onShow()},initObtainNode:function(){var e=cc.find("actions",this.cardsNode);this.hideNodeChild(e)},onShow:function(){WriteLog("onShow");var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.showCards(),this.cardsNode.active=!0,this.HoleCardsNode.active=!0,this.lastRoundLabel.string="局数:"+GameData.room.roundNum+"/"+GameData.room.opts.roundMax},showCards:function(){WriteLog("showCards");var e=GameData.getPlayerByPos("down");e&&GameDataPDK.cards[e.uid]?(this._firstInit?this.dealActionMngr():this.showMyHandCards(e,this.play_layer_down),this.play_layer_down.active=!0):this.play_layer_down.active=!1},showCardNum:function(){for(var e=["right","left"],t=[this.play_layer_right,this.play_layer_left],a=0;a<GameData.room.opts.joinermax-1;a++){var n=GameData.getPlayerByPos(e[a]);n&&GameDataPDK.cards[n.uid]?(this.showOtherHandCards(n,t[a]),t[a].active=!0):t[a].active=!1}},showMyHandCards:function(e,t){WriteLog("showMyHandCards"),this.resetPokerPos();var a=GameDataPDK.getMyHandCards(),n=cc.find("cardHand/handLayout",t);for(var i in n.children)n.children[i].active=!1;for(var o=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),r=0;r<a.length;r++){var s=cc.find("cardHand/handLayout/hand_"+(o+r),t);s.active=!0,this.showCardContent(s,a[r])}},showOtherHandCards:function(e,t){if(e){var a=e.uid,n=GameDataPDK.getHandCardNum(a),i=cc.find("lastpokerNum/pokerNum",t);i.active=!0,i.getComponent(cc.Label).string=n,cc.find("cardHand/hand_0",t).active=!0}},showCardContent:function(e,t){if(0!=t){var a=e.getComponent("Card");null!=a&&(a.id=t),e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/ddz/UI/pokers/poker_"+t+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)}},showPokerBack:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)this.showCardContent(e.children[t],"back"),e.children[t].active=!1},showZhuangInfo:function(){var e=GameDataPDK.getPosByUid(GameDataPDK.game.zhuangUid);if("left"==e)(t=cc.find("firstCard",this.play_layer_left)).active=!0,this.scaleEffectsOfNode(t,1.5,1.5,1,1,.3,function(){});else if("right"==e){var t;(t=cc.find("firstCard",this.play_layer_right)).active=!0,this.scaleEffectsOfNode(t,1.5,1.5,1,1,.3,function(){})}},hideFirstCardNode:function(e){e!=this.play_layer_down&&(cc.find("firstCard",e).active=!1)},scaleEffectsOfNode:function(e,t,a,n,i,o,r){var s=cc.scaleTo(o,t,a),c=cc.scaleTo(o,n,i),d=cc.callFunc(r,this),h=cc.sequence(d,s,c);e.runAction(h)},dealActionMngr:function(){this._firstInit=!1,this._cardHandPosArr.splice(0,this._cardHandPosArr.length),this._angularArr.splice(0,this._angularArr.length),this._dealActionIndex=0,this._flipActionIndex=0;var e=cc.director.getWinSize();e.width,e.height;this._cardHand=GameDataPDK.getMyHandCards();var t=GameDataPDK.getMyHandCards();this.showPokerBack();var a=cc.find("cardHand/handLayout",this.play_layer_down);Math.ceil(a.childrenCount/2),Math.ceil(t.length/2);this.schedule(this.dealAction,.01)},dealAction:function(){sendEvent("initObtainNode");var e=GameDataPDK.getMyHandCards().length,t=cc.find("cardHand/handLayout",this.play_layer_down),a=Math.ceil(t.childrenCount/2)-Math.ceil(e/2),n=cc.find("cardHand/handLayout/hand_"+(a+this._dealActionIndex),this.play_layer_down);if(this.removeDizhuSign(n),n.active=!0,n.ratationY=180,this._dealActionIndex++,this._dealActionIndex>=e){this.unschedule(this.dealAction),1==GameData.room.opts.zhuangType?sendEvent("rotateAction"):0==GameData.room.opts.zhuangType&&sendEvent("runFlipAction")}},runFlipAction:function(){this.schedule(this.flipAction,.02)},flipAction:function(){var e=GameDataPDK.getMyHandCards().length,t=cc.find("cardHand/handLayout",this.play_layer_down),a=Math.ceil(t.childrenCount/2)-Math.ceil(e/2),n=cc.find("cardHand/handLayout/hand_"+(a+this._flipActionIndex),this.play_layer_down);n.active=!0;var i=cc.rotateTo(.01,0,0),o=this,r=this._flipActionIndex,s=cc.callFunc(function(){o.removeDizhuSign(n),o.showCardContent(n,o._cardHand[r])},this),c=cc.sequence(i,s);n.runAction(c),this._flipActionIndex++,this._flipActionIndex>=e&&(this.unschedule(this.flipAction),o._dealEnd=!0,sendEvent("showDisBtnAndClook"))},angularByCoord:function(e,t){var a,n=Math.abs(e.x)-Math.abs(t.x),i=Math.abs(e.y)-Math.abs(t.y);return a=Math.atan(Math.abs(i)/Math.abs(n)),e.x<t.x?90-a/3.14159*180:a/3.14159*180},showWatch:function(){this.stopClockMusic();for(var e=0;e<GameDataPDK.currtiChuaiPlayerData.length;e++)this.showClock(GameDataPDK.currtiChuaiPlayerData[e])},reconnectionInfo:function(){this._dealEnd=!0},hideHoleCards:function(){var e=cc.find("cards",this.HoleCardsNode);for(var t in e.children)this.showHoleCardContent(e.children[t],"back")},showHoleCardContent:function(e,t){cc.log("cardNode,cardId:"+e,t),e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},showDisBtnAndClook:function(){cc.find("actions/btnDisCard",this.cardsNode).active=!0;var e=GameDataPDK.currObtainPlayerData.uid;this.showClocks(e)},showObtainNode:function(){WriteLog("PDK-roomtable showObtainNode"),this.disCardArry=[];var e=GameDataPDK.currObtainPlayerData.uid,t=GameDataPDK.currObtainPlayerData.flag,a=GameDataPDK.currObtainPlayerData.hintFlag;this._effcetFlag=t;var n=cc.find("actions",this.cardsNode),i=cc.find("actions/btnPass",this.cardsNode),o=cc.find("actions/btnTishi",this.cardsNode),r=cc.find("actions/btnDisCard",this.cardsNode);if(GameData.player.uid==e)if(n.active=!0,t)if(1==GameData.room.opts.passFlag?i.active=!1:2==GameData.room.opts.passFlag&&(i.active=!0),o.active=!0,a)GameDataPDK.currObtainPlayerData.endCardFlag?(i.active=!1,o.active=!1,r.active=!1,this.disEndCard()):this.onHintClick();else{n.active=!1,this._passFlag=1,this.passNode.active=!0;var s=this;this.scheduleOnce(function(){s.easeCubicAction(s.passNode)},2),this.scheduleOnce(function(){s.onPassCardClick()},1)}else i.active=!1,o.active=!1,1==this._dealEnd&&(r.active=!0),GameDataPDK.currObtainPlayerData.endCardFlag&&(r.active=!1,this.disEndCard());else a||(this._passFlag=1),n.active=!1;this.stopClockMusic(),1==this._dealEnd&&this.showClocks(e);var c,d=GameData.tablePos[e];switch(cc.log("pos :"+d),d){case"down":c=cc.find("layer_down/cardDis",this.cardsNode);break;case"right":c=cc.find("layer_right/cardDis",this.cardsNode);break;case"left":c=cc.find("layer_left/cardDis",this.cardsNode);break;case"up":c=cc.find("layer_up/cardDis",this.cardsNode)}null!=c&&this.hideNodeChild(c)},disEndCard:function(){for(var e=GameDataPDK.getMyHandCards(),t=0;t<e.length;t++){var a=e[t];this.disCardArry.push(a)}var n={detail:{cards:this.disCardArry,uid:0}};this.showHintCard(n),this.scheduleOnce(function(){i.requestOnDisCard(this.disCardArry,function(){})},1)},hidePlayerCard:function(e){var t,a=e.detail.uid,n=GameDataPDK.getPosByUid(a);n&&(t=cc.find("layer_"+n+"/cardDis",this.cardsNode)),null!=t&&this.hideNodeChild(t)},hidePassNode:function(e){switch(e){case"down":cc.find("buchuLb0",this.buchuNodes).active=!1;break;case"right":cc.find("buchuLb1",this.buchuNodes).active=!1;break;case"left":cc.find("buchuLb2",this.buchuNodes).active=!1}},onDisCardClick:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in this.disCardArry.splice(0,this.disCardArry.length),this.disPokerArry){var a=this.disPokerArry[t].getComponent("Card").id;cc.log("cardId "+a),this.disCardArry.push(a)}i.requestOnDisCard(this.disCardArry,function(){}),cc.log("disCardArry: ",this.disCardArry),cc.log("disPokerArry: ",this.disPokerArry);var n=0;for(var t in e.children)e.children[t].y==this.defaultPokerY&&n++;0<n&&0==this.disCardArry.length&&createMoveMessage("请选择要出的牌!")},onPassCardClick:function(){var t=cc.find("actions",this.cardsNode);t.active=!1;var a=e("errorCode");i.requestOnPassCard(function(e){e.result!=a.Success&&(t.active=!0)}),this.resetPokerPos()},onHintClick:function(){i.requestOnHintCard(function(e){})},playPassEffect:function(e){var t=e.detail.uid,a=GameData.getPlayerSexByUid(t);s.instance.playOtherAudioPoker("pdk-buyao",a),this.showBuchuNode()},showBuchuNode:function(){for(var e=["down","right","left"],t=0;t<GameData.room.opts.joinermax;t++){var a,n=GameData.getPlayerByPos(e[t]),i=GameDataPDK.getDisPoker(n.uid);a=(this._passFlag,cc.find("yaobuqi"+t,this.buchuNodes)),this.showbuchuStr(n,a,i)}},showbuchuStr:function(e,t,a){if(null!=a)if(0==a[0]){t.active=!0;var n=this;this.scheduleOnce(function(){n.easeCubicAction(t)},2)}else 0==a.length&&(t.active=!1)},easeCubicActionTimer:function(e){e.opacity=e.opacity-51},easeCubicAction:function(t){var a=0,n=this;this.schedule(function e(){a++,n.easeCubicActionTimer(t),5<=a&&(t.active=!1,t.opacity=255,n.unschedule(e))},.1)},showDisPoker:function(){for(var e=["down","right","left"],t=[this.play_layer_down,this.play_layer_right,this.play_layer_left],a=0;a<GameData.room.opts.joinermax;a++){var n=GameData.getPlayerByPos(e[a]),i=GameDataPDK.getDisPoker(n.uid);n&&GameDataPDK.cards[n.uid]?(t[a].active=!0,this.showPokerCards(n,t[a],i)):t[a].active=!1}this.hideDisPoker(),this.changeMultiple(GameDataPDK.boomNum)},hideDisPoker:function(){var e;if(!GameDataPDK.isEmptyObject(GameDataPDK.hideDisCard)){switch(GameDataPDK.getPosByUid(GameDataPDK.hideDisCard.uid)){case"down":e=cc.find("cardDis",this.play_layer_down);break;case"right":e=cc.find("cardDis",this.play_layer_right);break;case"left":e=cc.find("cardDis",this.play_layer_left)}this.hideNodeChild(e)}},showPokerCards:function(e,t,a){GameDataPDK.currObtainPlayerData.uid;var n=cc.find("cardDis",t);if(null!=a)if(this.hideNodeChild(n),this.hideFirstCardNode(t),t==this.play_layer_down)for(var i=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),o=0;o<a.length;o++){var r=cc.find("dis_"+(i+o),n);0==a[0]?r.active=!1:r.active=!0,this.showCardContent(r,a[o])}else for(var s=0;s<a.length;s++){r=cc.find("dis_"+s,n);0==a[0]?r.active=!1:r.active=!0,this.showCardContent(r,a[s])}},showClocks:function(e){if(null!=e)for(var t=["down","right","left"],a=0;a<GameData.room.opts.joinermax;a++){var n=GameData.getPlayerByPos(t[a]),i=cc.find("cloock"+a,this.clockNodes);this.showClockContent(n,i,e)}},showClock:function(e){if(null!=e){var t=GameData.getPlayerByPos("down"),a=cc.find("cloock0",this.clockNodes);this.showClockContent(t,a,e)}},showClockContent:function(e,t,a){e.uid==a&&(t.active=!0,this.PLayerUID=a,this._currClockNodes=t,this.startCoundDown())},startCoundDown:function(){this._countdown_index=14,this.schedule(this.runCountDown,1)},runCountDown:function(){if(this.showCountDown(this._countdown_index+"",this._currClockNodes),this._countdown_index<=0)cc.log("结束"),this._countdown_index=15;else{var e=cc.blink(.5,3);3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&(this._currClockNodes.runAction(e),s.instance.playAudioOther("countdown")),this._countdown_index--}},showCountDown:function(e,t){var a=e;e<10&&(a="0"+e),cc.find("timeLb",t).getComponent(cc.Label).string=a},hideDisCards:function(){var e=cc.find("cardDis",this.play_layer_down),t=cc.find("cardDis",this.play_layer_left),a=cc.find("cardDis",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},hideHandCards:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down),t=cc.find("cardHand",this.play_layer_left),a=cc.find("cardHand",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},showWinNode:function(e){WriteLog("showWinNode");var t=e.detail.winner;this._dealEnd=!1,this._kickingArr.splice(0,this._kickingArr.length),this.passNode.active=!1,this.resetPokerPos(),this.stopClockMusic(),this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.actionLayer.active=!1,sendEvent("HideReadyNode");GameDataPDK.resultData.score[GameData.player.uid];t==GameData.player.uid?s.instance.playOtherAudioPoker("shengli",null):t!=GameData.player.uid&&s.instance.playOtherAudioPoker("shibai",null);for(var a=["down","right","left"],n=[this.play_layer_down,this.play_layer_right,this.play_layer_left],i=0;i<GameData.room.opts.joinermax;i++){var o=GameData.getPlayerByPos(a[i]);o&&GameDataPDK.cards[o.uid]?(n[i].active=!0,this.showWinnerIcon(o,e)):n[i].active=!1}},showWinnerIcon:function(e,t){var a=t.detail.winner,n=0;t.detail.chuntian&&(n=2,this.scheduleOnce(function(){this.chuntianNode.active=!0,this.chuntianNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),s.instance.playOtherAudioPoker("chuntian",null)},1.5*this._dragonAnimtaionNum),this.scheduleOnce(function(){this.chuntianNode.active=!1},1.5*this._dragonAnimtaionNum+2));GameDataPDK.resultData.score[GameData.player.uid];if(a==GameData.player.uid){var i=this;this.scheduleOnce(function(){this.winAnimation.active=!0,this.winAnimation.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)},n+1.5*this._dragonAnimtaionNum),this.scheduleOnce(function(){i.winAnimation.active=!1},4.5+1.5*this._dragonAnimtaionNum)}else a!=GameData.player.uid&&this.scheduleOnce(function(){this.loseAnimation.active=!0,this.loseAnimation.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)},n+1.5*this._dragonAnimtaionNum);var o=3*this._dragonAnimtaionNum+2+n;sendEvent("AnimationDelayTime",o)},getJiaofenImg:function(e){var t="";switch(parseInt(e)){case 1:t="resources/ddz/UI/common/artword/artword_1fen.png";break;case 2:t="resources/ddz/UI/common/artword/artword_2fen.png";break;case 3:t="resources/ddz/UI/common/artword/artword_3fen.png";break;case 4:t="resources/ddz/UI/common/artword/artword_bujiao.png"}return t},showWarningNode:function(e){for(var t=["down","right","left"],a=[this.play_layer_down,this.play_layer_right,this.play_layer_left],n=0;n<GameData.room.opts.joinermax;n++){var i=GameData.getPlayerByPos(t[n]),o=cc.find("warning"+n,this.warningNode),r=null;1<=n&&(r=cc.find("lastCard"+n,this.warningNode)),i&&GameDataPDK.cards[i.uid]?(this.showWarningContent(i,o,e,r),a[n]=!0):a[n]=!1}},showWarningContent:function(e,t,a,n){var i=a.detail.uid,o=GameData.getPlayerSexByUid(i),r=a.detail.baodan;(null!=n&&i==e.uid&&(n.active=!0),this.scheduleOnce(function(){s.instance.playOtherAudioPoker("baojing"+r,o)},1),i==e.uid)&&(t.active=!0,t.getComponent(cc.Animation).play("warningAnimation"))},reconneShowWarning:function(){for(var e=["down","right","left"],t=[this.play_layer_down,this.play_layer_right,this.play_layer_left],a=0;a<GameData.room.opts.joinermax;a++){var n=GameData.getPlayerByPos(e[a]),i=cc.find("warning"+a,this.warningNode),o=null;1<=a&&(o=cc.find("lastCard"+a,this.warningNode)),n&&GameDataPDK.cards[n.uid]?(this.reconneShowWarningContent(n,i,o),t[a]=!0):t[a]=!1}},reconneShowWarningContent:function(e,t,a){var n=GameDataPDK.getHandCardNum(e.uid);n<=2&&0<n?(t.active=!0,null!=a&&(a.active=!0),t.getComponent(cc.Animation).play("warningAnimation")):(t.active=!1,null!=a&&(a.active=!1))},hideWarningNode:function(e){var t,a=null,n=GameDataPDK.getHandCardNum(e);switch(GameDataPDK.getPosByUid(e)){case"down":t=cc.find("warning0",this.warningNode);break;case"right":t=cc.find("warning1",this.warningNode),a=cc.find("lastCard1",this.warningNode);break;case"left":t=cc.find("warning2",this.warningNode),a=cc.find("lastCard2",this.warningNode)}0==n&&(t.active=!1,null!=a&&(a.active=!1))},showDisCardType:function(e){var t=e.detail.type;e.detail.multiple;this.hideWarningNode(e.detail.uid),this._dragonAnimtaionNum=0;var a=GameData.getPlayerSexByUid(e.detail.uid);s.instance.playAudioPokerDisType(e,a,this._effcetFlag),s.instance.playOtherAudioPoker("discard",null),"aircraft"!=t.substring(0,t.length-1)&&"aircraft"!=t&&"tribletraights"!=t||(s.instance.playOtherAudioPoker("plane",null),this.planeNode.active=!0,this._dragonAnimtaionNum++,this.DDZplayAnimation(this.planeNode,1.5)),"bomb"==t&&(this._dragonAnimtaionNum++,s.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.bobmAinmation,2)),"jokerBomb"==t&&(this._dragonAnimtaionNum++,s.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.huojianAinmation,1.7))},changeMultiple:function(e){if(null!=e){var t=cc.find("multipleNum",this.multipleNode);this.showNodeChild(this.multipleNode),t.getComponent(cc.Label).string="X"+e}},showNodeChild:function(e){for(var t in e.children)e.children[t].active=!0},setDisPokerArry:function(e){var t=e.detail;this.disPokerArry=[],cc.log("pokerArry:"+t);for(var a=0;a<t.length;a++){var n=t[a];for(var i in this.handCardLayOut.children)n==this.handCardLayOut.children[i].name&&1==this.handCardLayOut.children[i].active&&this.disPokerArry.push(this.handCardLayOut.children[i])}},DDZplayAnimation:function(e,t){e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),this.scheduleOnce(function(){e.active=!1},t)},resetPokerPos:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.disPokerArry.splice(0,this.disPokerArry.length)},DoubleClick:function(){var e=(new Date).getTime();e-this._currTime<500&&(this.resetPokerPos(),this.disPokerArry=[]),this._currTime=e},showHintCard:function(e){var t=e.detail.cards;e.detail.uid;this.disPokerArry=[];var a=cc.find("layer_down/cardHand/handLayout",this.cardsNode);for(var n in a.children)a.children[n].y=this.defaultPokerY;for(var n in a.children)for(var i=a.children[n].getComponent("Card"),o=0;o<t.length;o++)i.id==t[o]&&1==a.children[n].active&&(a.children[n].y+=30,this.disPokerArry.push(a.children[n]))},stopClockMusic:function(){this.unschedule(this.runCountDown),this.hideNodeChild(this.clockNodes)},getRuleStr:function(){if(GameData.room.opts)return getRuleStrPDK(GameData.room.opts)},addDizhuSign:function(e,t){var a=cc.instantiate(this.dizhuSign);"dis"==t&&a.setPosition(cc.p(-40,45)),e.addChild(a)},removeDizhuSign:function(e){e.removeAllChildren(!0)},connectRecurrence:function(){0!=GameData.room.opts.zhuangType&&(GameDataPDK.getHandCardSize(),GameDataPDK.game.zhuangUid==GameData.player.uid?GameDataPDK.getHandCards(GameDataPDK.game.zhuangUid).length==GameDataPDK.handCardSizeMax&&sendEvent("showFirstCard"):GameDataPDK.getHandCardNum(GameDataPDK.game.zhuangUid)==GameDataPDK.handCardSizeMax&&sendEvent("showFirstCard"),this.changeMultiple(GameDataPDK.boomNum))},onTiBtnChecked:function(e,t){this.tiBtnNode.active=!1,this.stopClockMusic(),i.requestTiChuai(t,function(e){cc.log("tiBtn rtn: ",e)})},onChuaiBtnChecked:function(e,t){this.chuaiBtnNode.active=!1,this.stopClockMusic(),i.requestTiChuai(t,function(e){cc.log("chuaiBtn rtn: ",e)})}});cc._RF.pop()},{"PDK-handler":"PDK-handler",SoundMngr:"SoundMngr",errorCode:"errorCode"}],PengCard:[function(e,t,a){"use strict";cc._RF.push(t,"3a618sHIZ9Ar4Vv2+PDNQN1","PengCard"),cc.Class({extends:cc.Component,properties:{faces:{default:[],type:[cc.Sprite]},body4:cc.Node,huierTemplate:cc.Node,angangBody:cc.Node,_cardRef:null,_huierNodes:[],_currentCards:[],direction:"right"},onLoad:function(){this.initHUierUI()},initHUierUI:function(){if(null!=this.huierTemplate){for(var e=0;e<4;e++){var t=cc.instantiate(this.huierTemplate);null!=this.faces[e]&&(t.parent=this.faces[e].node.parent,this._huierNodes.push(t))}this.huierTemplate.destroy()}},peng:function(e){this._currentCards=e,this.angangBody.active=!1,this.body4.active=!1,this.showFace(e)},chi:function(e){this._currentCards=e,this.angangBody.active=!1,this.body4.active=!1,this.showFace(e)},gang:function(e){this._currentCards=e,null!=this.angangBody&&(this.angangBody.active=!1),this.body4.active=!0,this.showFace(e)},angang:function(e){this._currentCards=e,null!=this.angangBody&&(this.angangBody.active=!0),this.body4.active=!1,this.showFace(e)},showFace:function(e){for(var t=0;t<this.faces.length;t++){var a=this.faces[t];if(null!=a&&t<e.length){var n=e[t],i=this._huierNodes[t];if(null!=i){var o=ReplayDataCenter.isHuier(n);i.active=o}this.showCardContent(a.node,this.getHeader(),n)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},getHeader:function(){return"left"==this.direction?"mj_face_zuo_chu":"right"==this.direction?"mj_face_you_chu":"up"==this.direction?"mj_face_shang_shou":"mj_face_xia_chu"},getCardRef:function(){return null==this._cardRef&&(this._cardRef=this.node.getComponent("CardRef")),this._cardRef},hasCard:function(e){if(null==this._currentCards)return!1;for(var t=0;t<this._currentCards.length;t++){var a=this._currentCards[t];if(1!=ReplayDataCenter.isHuier(a)&&e==a)return!0}return!1}}),cc._RF.pop()},{}],PlayIntroPanel:[function(e,t,a){"use strict";cc._RF.push(t,"3cd49gD1MBFn6mRoDG/V8DJ","PlayIntroPanel");var n=e("SoundMngr"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{tabBtns:{default:[],type:[cc.Node]},targetPos:{default:[],type:[cc.Node]},scrollView:cc.ScrollView,content:cc.Node,_originalY:0,richText1:cc.Node,richText2:cc.Node,richText3:cc.Node,richText4:cc.Node},onLoad:function(){this._originalY=this.content.y},onEnable:function(){this.refreshUI(),this.gotoContent(1),i.ruleType.isRuleType&&this.gotoRuleContent()},clickTabHandler:function(e){n.instance.playAudioOther("button"),this.gotoContent(e.target.name.split("_")[1])},gotoContent:function(e){for(var t=0;t<this.tabBtns.length;t++){var a=this.tabBtns[t],n=a.getComponent(cc.Button),i="btn_"+e;a.name==i?n.interactable=!1:n.interactable=!0}this.scrollView.scrollToOffset(cc.p(0,-this.targetPos[e-1].y),.1)},gotoRuleContent:function(){for(var e=0;e<this.tabBtns.length;e++){var t=this.tabBtns[e],a=t.getComponent(cc.Button),n="btn_"+i.ruleType.type;t.name==n?a.interactable=!1:a.interactable=!0}this.scrollView.scrollToOffset(cc.p(0,-this.targetPos[i.ruleType.type-1].y+i.ruleType.py),.1)},refreshUI:function(){console.log("bool "+!0),this.richText1.active=!0,this.richText2.active=!0,this.richText3.active=!0,this.richText4.active=!0},onClose:function(e){n.instance.playAudioOther("button"),closeView(this.node.name),i.ruleType.isRuleType=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],PosterItemPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"8229bumSEpEjoelaO3gC/ir","PosterItemPrefab"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},setImg:function(e){if(e){var t="resources/zjh/UI/artword/artword_"+e+".png",a=cc.textureCache.addImage(cc.url.raw(t));this.node.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}}}),cc._RF.pop()},{}],PosterPanel:[function(e,t,a){"use strict";cc._RF.push(t,"f9932OO4Y5EZKNdrzGL/Gyn","PosterPanel");var n=e("SoundMngr"),i=e("configMgr");cc.Class({extends:cc.Component,properties:{pageView:cc.PageView,pageItem:cc.Node,pageFlag:cc.Node,pageFlagItem:cc.Node},onLoad:function(){this.limit_time=0,this.posterData=i.getPoster(),null==this.posterData||this.posterData.length<=0||(this.pageContent=this.pageView.content,this.pageContent.width=this.posterData.length*this.pageItem.width,this.initPageContent())},update:function(e){this.pageView.getPages().length<=1||(this.limit_time+=e,3<this.limit_time&&(this.limit_time=0,this.changeCurPageIndex(),this.updatePageFlag()),this.updatePageFlag())},initPageContent:function(){this.pageView.removeAllPages(),this.pageContent.removeAllChildren();for(var e=0;e<this.posterData.length;e++){var t=this.posterData[e];if(!(t.length<=0)){var a;a=0==e?this.pageItem:cc.instantiate(this.pageItem),this.pageView.addPage(a),a.position=cc.p(this.pageItem.x+e*this.pageItem.width,this.pageItem.y);var n=a.getChildByName("sprite");this.loadImage(t,n)}}this.initPageFlag(),this.pageView.getPages().length<=1&&(this.pageView.elastic=!1)},loadImage:function(e,t){var a=cc.textureCache.addImage(cc.url.raw(e));t.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(a)},initPageFlag:function(){this.pageFlag.removeAllChildren();var e=this.pageView.getPages().length,t=0;t=0<e%2?-(parseInt(e/2)*this.pageFlagItem.width+30*parseInt(e/2)+this.pageFlagItem.width/2):-(parseInt(e/2)*this.pageFlagItem.width+30*(parseInt(e/2)-1)+15);for(var a=0;a<e;a++){var n;(n=0==a?this.pageFlagItem:cc.instantiate(this.pageFlagItem)).name="falgItem_"+a,this.pageFlag.addChild(n),n.position=cc.p(t+a*(this.pageFlagItem.width+30),this.pageFlagItem.y)}this.updatePageFlag()},changeCurPageIndex:function(){var e=this.pageView.getCurrentPageIndex()+1;e+1>this.pageView.getPages().length&&(e=0),this.pageView.setCurrentPageIndex(e)},updatePageFlag:function(){for(var e=0;e<this.pageFlag.getChildrenCount();e++){this.pageFlag.getChildren()[e].getChildByName("click").active=!1}var t="falgItem_"+this.pageView.getCurrentPageIndex();this.pageFlag.getChildByName(t).getChildByName("click").active=!0},pageViewEvent:function(){this.pageView.getPages().length<=1||(this.limit_time=0,this.updatePageFlag())},onClose:function(){n.instance.playAudioOther("button"),closeView("PosterPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr"}],PosterPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"34787KZxelGu6qmSw8glWS6","PosterPrefab");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{pageView:cc.PageView,pageItem:cc.Node},onLoad:function(){this.scrollCd=0,this.allPageLength=0,this.currIndex=0},initUI:function(){var e=n.CompetitionPoster();if(e)for(var t=0;t<e.length;t++){var a=this.pageItem.parent.getChildByName("page_"+t);null==a&&((a=cc.instantiate(this.pageItem)).parent=this.pageItem.parent,a.name="page_"+t),this.setImg(a,e[t])}},setImg:function(e,t){if(e){e.getComponent(cc.Sprite).spriteFrame=null;var a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}},update:function(e){if(this.scrollCd+=e,this.allPageLength=this.pageView.getPages().length,this.currIndex=this.pageView.getCurrentPageIndex(),3<=this.scrollCd){this.scrollCd=0;var t=this.currIndex+1>this.allPageLength?0:this.currIndex+1;this.pageView.scrollToPage(t,.2)}}}),cc._RF.pop()},{configMgr:"configMgr"}],PreLoader:[function(e,t,a){"use strict";cc._RF.push(t,"52360f5GYdHC6auCW0y6jLD","PreLoader"),cc._RF.pop()},{}],RecordItem:[function(e,t,a){"use strict";cc._RF.push(t,"952c3pUp05KJqGv/uiHdAhk","RecordItem");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{content:cc.Node,itemPrefab:cc.Prefab,roomid:0,roomIdLab:cc.Label,roomtype:cc.Label,roomclub:cc.Label,createtime:0,creatorId:0,_playerItems:[],_players:[],PlayTimes:cc.Label},onLoad:function(){},setPlayers:function(e,t){if(this._playerItems=[],this.content.removeAllChildren(),this._players=e,0==this._playerItems.length)for(var a=0;a<this._players.length;++a){var n=cc.instantiate(this.itemPrefab);n.parent=this.content,n.setPosition(190*a,10),this._playerItems.push(n)}var i=0;for(a=0;a<e.length;a++){var o=e[a];if(i<this._players.length){var r=this._playerItems[i].getComponent("RecordPlayerInfo");r.setName(o.name),r.setHeadIcon(o.headimgurl),r.setZongfen(2,t[o.uid]);var s=this.setWinner(t,e)==o.uid;r.showWinner(s)}i++}},showTime:function(e){cc.log("playtime = "+e);var t=getTimeStr(e),a=t[0]+"."+t[1]+"."+t[2]+"  "+t[3]+":"+t[4]+":"+t[5];this.PlayTimes.string=a},setWinner:function(e,t){var a;a=t[0].uid;for(var n=1;n<t.length;n++)t[n].uid&&e[t[n].uid]>e[a]&&(a=t[n].uid);return a},openRoundPanel:function(){n.instance.playAudioOther("button");var a=this;openView("RoundPanel","",function(t){GameNet.getInstance().request("game.playerHandler.getRoomRecord",{roomid:a.roomid,createtime:a.createtime},function(e){t.getComponent("RoundPanel").show(e,a.creatorId),closeView("RecordPanel")})})}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],RecordPanel:[function(e,t,a){"use strict";cc._RF.push(t,"8911eisoupJ27a4sTwjMOP1","RecordPanel");var n=e("gameDefine"),o=e("SoundMngr");cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,prefabItem:cc.Prefab,listCount:0,totalJushuLabel:cc.Label,winJushuLabel:cc.Label,chengjiLabel:cc.Label,lijianLabel:cc.Label,creatorNum:cc.Label,_itemList:[],layer_selectOther:cc.Node,roomid:0,_players:null},onLoad:function(){this.initParam(),registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("tjddz-onGameStart",this,this.showTableLayer),this.content=this.scrollView.content,ReplayDataCenter.openRoundPanel&&(this.show(ReplayGameData),ReplayDataCenter.openRoundPanel=!1)},initParam:function(){this.RecordType=[n.GameType.Game_Poker_TianjinDDZ,n.GameType.Game_Mj_Shishi,n.GameType.Game_Mj_Tianjin,n.GameType.Game_MJ_HuaDian,n.GameType.Game_Poker_13shui,n.GameType.Game_niu_niu,n.GameType.Game_TDK,n.GameType.Game_Poker_DDZ,n.GameType.Game_Mj_HZ,n.GameType.Game_Mj_CC,n.GameType.Game_Poker_paodekuai],this.RecordTypeMngr={Game_Poker_TianjinDDZ:!1,Game_Mj_Shishi:!0,Game_Mj_Tianjin:!0,Game_MJ_HuaDian:!0,Game_Poker_13shui:!1,Game_niu_niu:!0,Game_TDK:!0,Game_Poker_DDZ:!0,Game_Mj_HZ:!0,Game_Mj_CC:!0,Game_Poker_paodekuai:!1},this.GameTypeName=["天津斗地主","石狮麻将","天津麻将","桦甸麻将","十三水","经典牛牛","填大坑","经典斗地主","红中麻将","长春麻将","跑得快"]},onEnable:function(){var t=this;GameNet.getInstance().request("game.playerHandler.getPlayerRecord",{},function(e){e&&0<Object.keys(e).length&&t.show(e)})},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTableLayer)},showTableLayer:function(){GameData.client.gameType==n.GameType.Game_Mj_Tianjin?cc.director.loadScene("table"):GameData.client.gameType==n.GameType.Game_Poker_DDZ?cc.director.loadScene("table-DDZ"):GameData.client.gameType==n.GameType.Game_Poker_TianjinDDZ&&cc.director.loadScene("table-TJDDZ")},show:function(e){if(this.totalJushuLabel.string="",this.winJushuLabel.string="",this.chengjiLabel.string="",this.lijianLabel.string="",this.creatorNum.string="",null!=e&&null!=e){if(ReplayGameData=e,ReplayDataCenter.room=e,0==this._itemList.length)for(var t=0;t<20;t++){var a=cc.instantiate(this.prefabItem);this.content.addChild(a),this._itemList.push(a),a.active=!1}for(var n=0;n<=this._itemList.length-1;n++){a=this._itemList[n];if(n<ReplayGameData.length){var i=ReplayGameData[n],o=-1;for(var r in this.RecordTypeMngr)if(o++,1==this.RecordTypeMngr[r]&&i.opts.gameType==this.RecordType[o]){var s=a.getComponent("RecordItem");s.roomid=i.roomid,s.roomIdLab.string=i.roomid,s.createtime=i.createtime,s.showTime(i.createtime),s.creatorId=i.creator,s.setPlayers(i.players,i.score),this.showGameType(s,i.opts),a.active=!0;break}}else a.active=!1}var c=new Date,d=c.getFullYear(),h=c.getMonth(),l=c.getDate(),u=GameData.player.uid,m=0,p=0,g=0;for(t=0;t<ReplayGameData.length;t++){var f=ReplayGameData[t],y=f.createtime,v=(y=new Date(f.createtime)).getFullYear(),C=y.getMonth(),D=y.getDate();o=-1;for(var r in this.RecordTypeMngr)if(o++,1==this.RecordTypeMngr[r]&&f.opts.gameType==this.RecordType[o]){if(v==d&&C==h&&D==l)m++,0<f.score[u]&&p++;f.creator==u&&g++;break}}this.totalJushuLabel.string=m,this.winJushuLabel.string=p,this.creatorNum.string=g}},showGameType:function(e,t){var a="";switch(t.roomType){case 1:a="(普通房)";break;case 2:a="(俱乐部)"}e.roomclub.string=a;var n=-1;for(var i in this.RecordTypeMngr)if(n++,1==this.RecordTypeMngr[i]&&this.RecordType[n]==t.gameType){e.roomtype.string=this.GameTypeName[n];break}},onClose:function(){o.instance.playAudioOther("button"),ReplayDataCenter.openRoundPanel=!1,ReplayDataCenter.openReplayPanel=!1,closeView("RecordPanel")},openSelectRoom:function(e){o.instance.playAudioOther("button"),this.layer_selectOther.active=!0},closeLayer:function(e){o.instance.playAudioOther("button"),this.layer_selectOther.active=!1},sendReplayNum:function(e){o.instance.playAudioOther("button");var t=cc.find("layer_otherRecard/panel/EditBox",this.node).getComponent(cc.EditBox).string,a=t.substring(0,6),i=t.substring(6,t.length);openView("RoundPanel","",function(n){GameNet.getInstance().request("game.playerHandler.getRoomRecord",{roomid:parseInt(a),createtime:parseInt(i)},function(e){var t=[];for(var a in e.players)t.push(e.players[a]);otherReplay[0]=!0,n.getComponent("RoundPanel").show(e,e.creator,t),closeView("RecordPanel")})})}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],RecordPlayerInfo:[function(e,t,a){"use strict";cc._RF.push(t,"1ba58sgHLNCEZrHUzjdRnsZ","RecordPlayerInfo");e("SoundMngr");cc.Class({extends:cc.Component,properties:{headerSprite:cc.Sprite,playerNameLabel:cc.Label,idNode:cc.Node,idLabel:cc.Label,jifenLabel:cc.Label,recordScore:cc.Node,roundScore:cc.Node,font:{default:[],type:[cc.Font]}},onLoad:function(){},setName:function(e){this.playerNameLabel.string=e},setHeadIcon:function(e){if(null!=e&&""!=e){var a=this;cc.loader.load({url:e,type:"png"},function(e,t){null!==t&&(a.headerSprite.spriteFrame=new cc.SpriteFrame(t))})}},setId:function(e){this.idLabel.string=e},setJifen:function(e){this.jifenLabel.string=null==e?"":e},setZongfen:function(e,t){var a;cc.log("changeNum = "+e+",score = "+t),1==e?(this.roundScore.active=!0,this.idNode.active=!0,this.recordScore.active=!1,a=cc.find("total_score",this.roundScore)):(this.roundScore.active=!1,this.idNode.active=!1,this.recordScore.active=!0,a=cc.find("recordScore",this.recordScore)),this.setHeadPosition(e),0<t?(a.getComponent("cc.Label").font=this.font[0],a.getComponent("cc.Label").string="+"+t):t<0?(a.getComponent("cc.Label").font=this.font[1],a.getComponent("cc.Label").string=t):(a.getComponent("cc.Label").font=this.font[2],a.getComponent("cc.Label").string=t,a.color=new cc.Color(0,255,36))},setHeadPosition:function(e){var t=this.headerSprite.node.parent;2==e?t.setPosition(cc.p(40,0)):t.setPosition(cc.p(0,0))},showWinner:function(e){cc.find("winner",this.recordScore).active=e}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],ReplayCardController:[function(e,t,a){"use strict";cc._RF.push(t,"aeb77LcpxRJ8rX67x0HMftk","ReplayCardController"),cc.Class({extends:cc.Component,properties:{uid:0,pengCardList:[],gangCardList:[],handCardList:[],disCardList:[],chiCardList:[],handNode:cc.Node,pengNode:cc.Node,disNode:cc.Node,headNode:cc.Node,headPrefab:cc.Prefab,headComponent:null,cardHuierPrefab:cc.Prefab,direction:"right"},getList:function(){return{uid:this.uid,peng:this.pengCardList,chi:this.chiCardList,gang:this.gangCardList,hand:this.handCardList.sort(this.sortNumber)}},onLoad:function(){this.joinermax=Object.keys(ReplayData.players).length,4==this.joinermax?this.discardMax=24:3==this.joinermax?this.discardMax=36:2==this.joinermax&&(this.discardMax=60)},showHead:function(e,t,a){this.getHeadComponent().setName(t),this.getHeadComponent().setHeadIcon(a),this.getHeadComponent().setPlayer(e)},showZhuang:function(e){this.getHeadComponent().showZhuang(e)},showZhuangNum:function(e,t){this.getHeadComponent().showZhuangNum(e,t)},getLiuGuang:function(e){this.getHeadComponent().getLiuGuang(e)},setCoin:function(e){this.getHeadComponent().setCoin(e)},setChashuiState:function(e){var t=!1;null==ReplayData.opts.water||Object.keys(ReplayData.opts.water).length<=0?t=!1:2==ReplayData.opts.water[e]&&(t=!0),this.getHeadComponent().setChaShuiShow(t)},getHeadComponent:function(){if(null==this.headComponent){var e=cc.instantiate(this.headPrefab);e.parent=this.headNode,this.headComponent=e.getComponent("playerTemplate")}return this.headComponent},sortNumber:function(e,t){return e-t},obtain:function(e){if(null!=e&&1==e.length){var t=e[0];this.handCardList.push(t),this.getObtainCardNode().active=!0,this.showCardContent(this.getObtainCardNode(),this.getHeader(),t),this.setHuierVisible(this.getObtainCardNode(),t)}else cc.log("ReplayCardController,can not obtain the card, the card is null or length is not 1")},discard:function(e){if(null!=e&&1==e.length){var t=e[0];this.handCardListRemove(t),this.disCardList.push(t),this.hideObtainCard(),this.doHandCard(),this.showDisCard(t)}else cc.log("ReplayCardController,can not discard the card, the card is null or length is not 1")},showDisCard:function(e){var t=cc.find("cardDis_4",this.node);t&&(t.active=!1);var a=cc.find("cardDis_3",this.node);a&&(a.active=!1);var n=cc.find("cardDis_2",this.node);n&&(n.active=!1),this.disNode=cc.find("cardDis_"+this.joinermax,this.node),this.disNode.active=!0;for(var i=0;i<this.discardMax;i++){var o=this.disNode.getChildByName("card_face"+i);if(null!=o&&1!=o.active){o.active=!0;var r="";r="left"==this.direction?"mj_face_zuo_chu":"right"==this.direction?"mj_face_you_chu":"up"==this.direction?"mj_face_shang_shou":"mj_face_xia_chu",this.showCardContent(o,r,e);break}}},chi:function(e){if(null!=e&&3==e.length){for(var t=0;t<2;t++)this.handCardListRemove(e[t]);var a=this.getPengCard();a.active=!0,a.getComponent("PengCard").chi(e),this.doHandCard(),this.chiCardList.push(e)}else cc.log("ReplayCardController, chi, cards is null or card length is not 3")},peng:function(e){if(null!=e&&3==e.length){cc.log("peng before - this.handCardList.length : "+this.handCardList.length);for(var t=0;t<2;t++)this.handCardListRemove(e[0]);cc.log("peng after - this.handCardList.length : "+this.handCardList.length);var a=this.getPengCard();a.active=!0,a.getComponent("PengCard").peng(e),this.doHandCard(),this.pengCardList.push(e)}else cc.log("ReplayCardController, peng, cards is null or card length is not 3")},minggang:function(e){if(null!=e&&4==e.length){var t=this.getPengCard();t.active=!0,t.getComponent("PengCard").gang(e);for(var a=0;a<3;a++)this.handCardListRemove(e[a]);this.doHandCard(),this.gangCardList.push(e)}else cc.log("ReplayCardController, minggang, cards is null or card length is not 4")},minggangself:function(e){if(null!=e&&4==e.length){var t=this.getAlreadyPengCard(e[0]);t.active=!0,t.getComponent("PengCard").gang(e),this.handCardListRemove(e[0]),this.hideObtainCard(),this.doHandCard(),this.gangCardList.push(e);for(var a=0;a<3;a++)for(var n=this.pengCardList.length,i=0;i<n;i++){var o=this.pengCardList[i][0];if(cc.log("pengCardId : "+o),o==e[0])return void this.pengCardList.splice(i,1)}}else cc.log("ReplayCardController, minggangself, cards is null or card length is not 4")},angang:function(e){if(null!=e&&0!=e.length){var t=this.getPengCard();t.active=!0,t.getComponent("PengCard").angang(e);for(var a=0;a<4;a++)this.handCardListRemove(e[0]);this.doHandCard(),this.gangCardList.push(e)}},hu:function(e){},getPengCard:function(){for(var e=0;e<4;e++){var t=this.pengNode.getChildByName("cardPeng"+e);if(null!=t&&1!=t.active)return t}return null},getAlreadyPengCard:function(e){for(var t=0;t<4;t++){var a=this.pengNode.getChildByName("cardPeng"+t);if(null!=a&&1==a.active)if(1==a.getComponent("PengCard").hasCard(e))return a}return null},doHandCard:function(){var e=this.getSortCardList();cc.log("replay hand cart list ==>> "+e.length);for(var t=0,a=ReplayData.cards[0].cards.length;1<=a;a--){var n="cardHand"+a,i=this.handNode.getChildByName(n);if(null!=i)if(a>e.length)i.active=!1;else{i.active=!0;var o=e[t];this.showCardContent(i,this.getHeader(),o),this.setHuierVisible(i,o),t++}else cc.error("can not find the card node, name is "+n)}},getHeader:function(){return"left"==this.direction?"mj_face_zuo_chu":"right"==this.direction?"mj_face_you_chu":"up"==this.direction?"mj_face_shang_shou":"mj_face_xia_shou"},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},setHuierVisible:function(e,t){var a=!1;ReplayDataCenter.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");null==n?1==a&&(n=cc.instantiate(this.cardHuierPrefab),cc.find("up",n).active=!1,cc.find("down",n).active=!1,cc.find("right",n).active=!1,cc.find("left",n).active=!1,cc.find(this.direction,n).active=!0,"down"==this.direction?n.y=n.y-18:"up"==this.direction&&(n.y=n.y+6),e.addChild(n),n.name=e.name+"_huier"):n.active=a},removeDisCard:function(e){for(var t=this.disNode.childrenCount-1;0<=t;t--){var a=this.disNode.getChildByName("card_face"+t);if(null!=a&&1==a.active)return void(a.active=!1)}var n=this.disCardList.length;for(t=0;t<n;t++)if(this.disCardList[t]==e)return void this.disCardList.splice(t,1);for(t=0;t<n;t++)this.showDisCard(this.disCardList[t])},handCardListRemove:function(e){for(var t=this.handCardList.length,a=0;a<t;a++)if(this.handCardList[a]==e)return void this.handCardList.splice(a,1)},hideObtainCard:function(){this.handNode.getChildByName("cardHand0").active=!1},getObtainCardNode:function(){return this.handNode.getChildByName("cardHand0")},showHandCard:function(e){if(null!=e){for(var t=0;t<e.length;t++){var a=e[t];this.handCardList.push(a)}this.doHandCard()}else cc.error("cardList is null")},getSortCardList:function(){HuierList;for(var e=[],t=[],a=0;a<this.handCardList.length;a++){var n=this.handCardList[a];1==ReplayDataCenter.isHuier(n)?e.push(n):t.push(n)}var i=e.sort(this.sortNumber),o=t.sort(this.sortNumber);return i.concat(o)}}),cc._RF.pop()},{}],ReplayCardFace:[function(e,t,a){"use strict";cc._RF.push(t,"343563k7UtOHbAFhJI7+psk","ReplayCardFace"),cc.Class({extends:cc.Component,properties:{bottom:cc.Sprite,icon:cc.Sprite,huier:cc.Sprite},onLoad:function(){},setIcon:function(e){if(""===e)this.icon.node.active=!1;else{var t=cc.textureCache.addImage(cc.url.raw(e));this.icon.spriteFrame=new cc.SpriteFrame(t),this.icon.node.active=!0}},setHuier:function(e){var t=cc.textureCache.addImage(cc.url.raw(e));this.huier.spriteFrame=new cc.SpriteFrame(t)},setBottom:function(e){var t=cc.textureCache.addImage(cc.url.raw(e));this.bottom.spriteFrame=new cc.SpriteFrame(t)}}),cc._RF.pop()},{}],ReplayEffectController:[function(e,t,a){"use strict";cc._RF.push(t,"2fb7bYwNPBFuLBP+5GzeaYx","ReplayEffectController"),cc.Class({extends:cc.Component,properties:{spineNode:cc.Node},onLoad:function(){},showEffect:function(e){if(cc.log("show effect: "+e),null!=e){var t="",n="";switch(e){case ActionType.peng:t="spine/table/peng",n="animation";break;case ActionType.minggang:case ActionType.minggangself:case ActionType.angang:t="spine/table/gang",n="a";break;case ActionType.hu:t="spine/table/hu",n="a";break;case ActionType.chi:t="spine/table/chi",n="a";break;case"buhua":t="shishi/animation/bu/bu",n="animation"}var i=this.spineNode;this.spineNode.active=!0,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})}}}),cc._RF.pop()},{}],ReplayLayout:[function(e,t,a){"use strict";cc._RF.push(t,"8fd6cfexeZAq6tgG2vBBaDp","ReplayLayout"),cc.Class({extends:cc.Component,properties:{downHandCardPrefab:cc.Prefab,downHandCardParent:cc.Node,downDisCardPrefab:cc.Prefab,downDisCardParent:cc.Node,downPengCardPrefab:cc.Prefab,downPengCardParent:cc.Node,leftHandCardPrefab:cc.Prefab,leftHandCardParent:cc.Node,leftDisCardPrefab:cc.Prefab,leftDisCardParent:cc.Node,leftPengCardPrefab:cc.Prefab,leftPengCardParent:cc.Node,rightHandCardPrefab:cc.Prefab,rightHandCardParent:cc.Node,rightDisCardPrefab:cc.Prefab,rightDisCardParent:cc.Node,rightPengCardPrefab:cc.Prefab,rightPengCardParent:cc.Node,upHandCardPrefab:cc.Prefab,upHandCardParent:cc.Node,upDisCardPrefab:cc.Prefab,upDisCardParent:cc.Node,upPengCardPrefab:cc.Prefab,upPengCardParent:cc.Node,_showDis:!1,_showObtain:!1,_showPeng:!1,_hasLayout:!1},onLoad:function(){this._showDis=!1,this._showObtain=!1,this._showPeng=!1,this._hasLayout=!1},init:function(){0==this._hasLayout&&(this.initLeftCard(),this.initDownCard(),this.initRightCard(),this.initUpCard(),this._hasLayout=!0)},initLeftCard:function(){for(var e=0;e<GameData.client.handsize;e++){var t=cc.instantiate(this.leftHandCardPrefab);t.name="handCard"+e,t.parent=this.leftHandCardParent,t.y=31*GameData.client.handsize-31*e}var a=cc.instantiate(this.leftHandCardPrefab);a.name="obtain",a.parent=this.leftHandCardParent,a.y=-20,a.active=this._showObtain;for(var n=0;n<26;n++){var i=cc.instantiate(this.leftDisCardPrefab);i.name="disCard"+n,i.parent=this.leftDisCardParent,i.x=48*-Math.floor(n/10),i.y=-n%10*31,i.active=this._showDis}for(var o=0;o<4;o++){var r=cc.instantiate(this.leftPengCardPrefab);r.name="pengCard"+o,r.parent=this.leftPengCardParent,r.x=0,r.y=-100*o,r.active=this._showPeng}},initRightCard:function(){for(var e=0;e<GameData.client.handsize;e++){var t=cc.instantiate(this.rightHandCardPrefab);t.setLocalZOrder(GameData.client.handsize-e),t.name="handCard"+e,t.parent=this.rightHandCardParent,t.y=31*-GameData.client.handsize+31*e}var a=cc.instantiate(this.rightHandCardPrefab);a.name="obtain",a.parent=this.rightHandCardParent,a.y=20,a.active=this._showObtain;for(var n=0;n<26;n++){var i=cc.instantiate(this.rightDisCardPrefab);i.setLocalZOrder(GameData.client.handsize-n),i.name="disCard"+n,i.parent=this.rightDisCardParent,i.x=48*Math.floor(n/10),i.y=n%10*31,i.active=this._showDis}for(var o=0;o<4;o++){var r=cc.instantiate(this.rightPengCardPrefab);r.name="pengCard"+o,r.parent=this.rightPengCardParent,r.x=0,r.y=100*o,r.active=this._showPeng}},initDownCard:function(){for(var e=0;e<GameData.client.handsize;e++){var t=cc.instantiate(this.downHandCardPrefab);t.name="handCard"+e,t.parent=this.downHandCardParent,t.x=-70*GameData.client.handsize+70*e}var a=cc.instantiate(this.downHandCardPrefab);a.name="obtain",a.parent=this.downHandCardParent,a.x=40,a.active=this._showObtain;for(var n=0;n<26;n++){var i=cc.instantiate(this.downDisCardPrefab);i.name="disCard"+n,i.parent=this.downDisCardParent,i.x=0+n%10*37,i.y=0-50*Math.floor(n/10),i.active=this._showDis}for(var o=0;o<4;o++){var r=cc.instantiate(this.downPengCardPrefab);r.name="pengCard"+o,r.parent=this.downPengCardParent,r.x=230*o,r.y=0,r.active=this._showPeng}},initUpCard:function(){for(var e=0;e<GameData.client.handsize;e++){var t=cc.instantiate(this.upHandCardPrefab);t.name="handCard"+e,t.parent=this.upHandCardParent,t.x=40*GameData.client.handsize-40*e}var a=cc.instantiate(this.upHandCardPrefab);a.name="obtain",a.parent=this.upHandCardParent,a.x=-20,a.active=this._showObtain;for(var n=0;n<26;n++){var i=cc.instantiate(this.upDisCardPrefab);i.name="disCard"+n,i.setLocalZOrder(26-n),i.parent=this.upDisCardParent,i.x=0-n%10*33,i.y=0+45*Math.floor(n/10),i.active=this._showDis}for(var o=0;o<4;o++){var r=cc.instantiate(this.upPengCardPrefab);r.name="pengCard"+o,r.parent=this.upPengCardParent,r.x=130*-o,r.y=0,r.active=this._showPeng}}}),cc._RF.pop()},{}],"ReplayMain-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"f98fdkH4jlOGoaWCzRvAhVy","ReplayMain-shishi");e("SoundMngr");cc.Class({extends:cc.Component,properties:{playerCardNodes:{default:[],type:[cc.Node]},huierFace1:cc.Sprite,huierFace2:cc.Sprite,stopBtn:cc.Button,playBtn:cc.Button,exitBtn:cc.Button,quick_btn:cc.Button,overBtn:cc.Button,_actionIndex:-1,_playerCardList:[],_effectController:null,playintrNode:cc.Node,roomNum:cc.Label,runSum:cc.Label},onLoad:function(){this.playIntrSize="small",this.stopBtn.node.active=!1,this.playBtn.node.active=!0},onEnable:function(){cc.director.getScheduler().setTimeScale(1),this._effectController=this.node.getComponent("ReplayEffectController"),this.showPlayIntroduce(this.playIntrSize),this.roomNum.getComponent(cc.Label).string=ReplayRoomData.roomid,this.showUIHuier(),this.initStopPanel(),this.showHandCards();for(var e=0;e<this._playerCardList.length;e++){var t=this._playerCardList[e],a=this.getScore(t.uid);console.log("=============score = "+a),t.setCoin(a)}this.roundBeginHua(),this.schedule(this.runAction,1)},onDestroy:function(){},runAction:function(){this.runNextAction()},initData:function(){ReplayData=JSON.parse(replayDataJson);var e=ReplayData.opts.huier,t=GameData.getOtherHuier(e);cc.log("huier : "+e+",huier2 : "+t),HuierList=[e,t]},initStopPanel:function(){var t=this;this.stopBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(1),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.playBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(0),t.stopBtn.node.active=!0,t.playBtn.node.active=!1}),this.exitBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){ReplayDataCenter.openRoundPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")}),this.quick_btn.node.on(cc.Node.EventType.TOUCH_START,function(e){0!=cc.director.getScheduler().getTimeScale()&&cc.director.getScheduler().setTimeScale(2)}),this.overBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){t.overBtnClick()})},overBtnClick:function(){this.unschedule(this.runAction);for(var e=this._actionIndex+1;e<ReplayData.actions.length;e++){var t=ReplayData.actions[e],a=t.uid,n=t.action,i=t.card;cc.log(e,a,n,i);var o=this.getCardController(a);n==ActionType.obtain?o.obtain(i):n==ActionType.discard?o.discard(i):n==ActionType.peng?o.peng(i):n==ActionType.minggang?o.minggang(i):n==ActionType.minggangself?o.minggangself(i):n==ActionType.angang?o.angang(i):n==ActionType.chi?o.chi(i):n==ActionType.hu&&o.hu(i)}ReplayDataCenter.resultCard=this.getAllCards();for(var r=0;r<Object.keys(ReplayData.players).length;r++){var s=ReplayData.players[r].uid,c=!1;if(ReplayData.dianpao&&(c=s==ReplayData.dianpao.winner),c)for(var d=0;d<ReplayDataCenter.resultCard.length;d++){var h=ReplayDataCenter.resultCard[d];if(h.uid==s){var l=h.hand;16!=l.length&&13!=l.length&&10!=l.length&&7!=l.length&&4!=l.length&&1!=l.length||(l.push(ReplayData.dianpao.discard),l.sort(function(e,t){return t<e}));break}}}openView("ReplayResultPanel-shishi")},showUIHuier:function(){var e=ReplayData.cards[0].cards.length;cc.log("showUIHuier --\x3e "+HuierList[0]+","+HuierList[1]),this.showCardContent(this.huierFace1.node,"mj_face_xia_shou",HuierList[0]),13==e&&this.showCardContent(this.huierFace2.node,"mj_face_xia_shou",HuierList[1])},showCardContent:function(e,t,a){e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/mjcard2d/"+t+"_"+a+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)},runNextAction:function(){if(this._actionIndex++,this._actionIndex<ReplayData.actions.length){var e=ReplayData.actions[this._actionIndex],t=e.uid,a=e.action,n=0;e.youNum&&(n=e.youNum);var i=e.card,o=0;if(e.hua&&0<e.hua.length&&(o=e.hua),cc.log(this._actionIndex,t,a,i),this.gotoShowTurnEffect(t),ReplayData.dianpao&&this._actionIndex+1==ReplayData.actions.length)(s=this.getCardController(ReplayData.dianpao.winner)).obtain(i);this.whoDoSomething(t,a,i,o,n)}else if(this._actionIndex==ReplayData.actions.length){cc.log("replay over");var r=this._actionIndex-1,s=ReplayData.actions[r];if(ReplayData.zimo){this.cardActionAnimation(s.uid,"hu");for(var c=0;c<this.playerCardNodes.length;c++){var d=this.playerCardNodes[c].getComponent("ReplayCardController");cc.log("playerCards.uid == cardController.uid "+d.uid,s.uid,this.playerCardNodes),d.uid==s.uid&&0==c&&this._effectController.showEffect(ActionType.hu)}}if(ReplayData.dianpao)for(c=0;c<this.playerCardNodes.length;c++){(d=this.playerCardNodes[c].getComponent("ReplayCardController")).uid==ReplayData.dianpao.winner&&(0==c?this._effectController.showEffect(ActionType.hu):this.cardActionAnimation(ReplayData.dianpao.winner,"hu"))}for(c=0;c<this._playerCardList.length;c++){var h=this._playerCardList[c],l=this.getScore(h.uid);l+=ReplayData.scores[h.uid],h.setCoin(l)}this.lastTime=2,this.schedule(this.updateLastTime,1)}else this.unschedule(this.runAction)},updateLastTime:function(){this.lastTime--,this.lastTime<=0&&(ReplayDataCenter.resultCard=this.getAllCards(),openView("ReplayResultPanel-shishi"),this.unschedule(this.updateLastTime))},getAllCards:function(){for(var e=[],t=0;t<this.playerCardNodes.length;t++){var a=this.playerCardNodes[t];e.push(a.getComponent("ReplayCardController").getList())}return e},showHandCards:function(){ReplayData.creator;var e,t=ReplayData.cards;if(1==otherReplay[0]){for(var a in ReplayRoomData.players)if(a){e=ReplayRoomData.players[a].uid;break}}else e=GameData.player.uid.toString();for(var n=ReplayDataCenter.room,i={},o=0,r=0;r<n.length;r++)n[r].roomid==ReplayData.room&&(o=(i=n[r].players)[e].seat);if(null!=o&&null!=o){var s=[];this.playerNum=Object.keys(ReplayData.players).length,4==this.playerNum?(0==o&&(s=[0,1,2,3]),1==o&&(s=[1,2,3,0]),2==o&&(s=[2,3,0,1]),3==o&&(s=[3,0,1,2])):3==this.playerNum?(0==o&&(s=[0,1,2]),1==o&&(s=[1,2,0]),2==o&&(s=[2,0,1]),this.playerCardNodes[1].removeFromParent(!0),this.playerCardNodes.splice(1,1)):2==this.playerNum&&(0==o&&(s=[0,1]),1==o&&(s=[1,0]),this.playerCardNodes[1].removeFromParent(!0),this.playerCardNodes[3].removeFromParent(!0),this.playerCardNodes.splice(1,1),this.playerCardNodes.splice(3,1));for(r=0;r<s.length;r++){var c=s[r],d=t[c];if(null!=this.playerCardNodes&&0<this.playerCardNodes.length&&null!=this.playerCardNodes[r]){var h=this.playerCardNodes[r].getComponent("ReplayCardController");h.showHandCard(d.cards);var l=t[c].uid,u=i[l].name,m=i[l].headimgurl;h.uid=l,h.showHead(i[l],u+"",m),h.setChashuiState(l);var p=h.uid==ReplayData.opts.zhuang;h.showZhuang(p),this._playerCardList.push(h)}}}},whoDoSomething:function(e,t,a,n,i){this.runSum.getComponent(cc.Label).string="进度: "+this._actionIndex+"/"+(ReplayData.actions.length-1);var o=this.getCardController(e);if(t==ActionType.obtain){if(o.obtain(a),0!=n){this.cardActionAnimation(o.uid,"buhua");for(var r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&(this.showHua(n,this.playerCardNodes[r]),0==r&&this._effectController.showEffect("buhua"))}}}else if(t==ActionType.discard)o.discard(a);else if(t==ActionType.peng){o.peng(a),this.cardActionAnimation(o.uid,"peng");for(r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&this._effectController.showEffect(ActionType.peng)}this.removeDisFromLast(a[0])}else if(t==ActionType.minggang){o.minggang(a),this.cardActionAnimation(o.uid,"gang");for(r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&this._effectController.showEffect(ActionType.minggang)}this.removeDisFromLast(a[2])}else if(t==ActionType.minggangself){o.minggangself(a),this.cardActionAnimation(o.uid,"gang");for(r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&this._effectController.showEffect(ActionType.minggangself)}}else if(t==ActionType.angang){o.angang(a),this.cardActionAnimation(o.uid,"gang");for(r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&this._effectController.showEffect(ActionType.angang)}}else if(t==ActionType.chi){o.chi(a),this.cardActionAnimation(o.uid,"chi");for(r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&this._effectController.showEffect(ActionType.chi)}this.removeDisFromLast(a[0])}else if("youjin"==t){var s=this.getAnimationIndex(e);console.log("..........................playPos = "+s),o.youjin(i,s)}else cc.log("no action logic, aciotn name is "+t)},removeDisFromLast:function(e){var t=ReplayData.actions[this._actionIndex-1].uid;this.getCardController(t).removeDisCard(e)},getAnimationIndex:function(e){for(var t="",a=0;a<this.playerCardNodes.length;a++){var n=this.playerCardNodes[a].getComponent("ReplayCardController");4==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="right":2==a?t="up":3==a&&(t="left")):3==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="up":2==a&&(t="left")):2==this.playerNum&&n.uid==e&&(0==a?t="down":1==a&&(t="up"))}return t},cardActionAnimation:function(e,t){var a=this.getAnimationIndex(e),n=cc.find("layer_ui/actionAnimations/"+a,this.node);null!=n&&n.getComponent(cc.Animation).play(t)},gotoShowTurnEffect:function(e){var t=!1;if(null!=this._playerCardList)for(var a=0;a<this._playerCardList.length;a++){var n=this._playerCardList[a];t=n.uid==e,n.getLiuGuang(t)}else cc.log("this._playerCardList null")},getCardController:function(e){for(var t=0;t<this._playerCardList.length;t++){var a=this._playerCardList[t];if(a.uid==e)return a}return null},roundBeginHua:function(){for(var e=0;e<ReplayData.cards.length;e++){var t=0;t=ReplayData.cards[e].hua;for(var a=ReplayData.cards[e].uid,n=0;n<ReplayData.actions.length;n++)if(ReplayData.actions[n].uid==a&&ReplayData.actions[n].hua&&0<ReplayData.actions[n].hua.length)for(var i=0;i<t.length;i++)for(var o=ReplayData.actions[n].hua,r=0;r<o.length;r++)t[i]==o[r]&&t.splice(i,1);if(t&&0<t.length){this.cardActionAnimation(a,"buhua");for(var s=0;s<this.playerCardNodes.length;s++){this.playerCardNodes[s].getComponent("ReplayCardController").uid==a&&(this.showHua(t,this.playerCardNodes[s]),0==s&&this._effectController.showEffect("buhua"))}}}},showHua:function(e,t){for(var a=t.getComponent("ReplayCardController").uid,n=this.getAnimationIndex(a),i=e.sort(),o=cc.find("cardhua",t).children,r=0;r<i.length;r++)for(var s=0;s<o.length;s++)if(1!=o[s].active&&null!=o[s]){o[s].active=!0,o[s].getComponent(cc.Sprite).spriteFrame=null;var c=this.showHuaTexture(i[r],n),d=cc.textureCache.addImage(cc.url.raw(c));o[s].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d);break}},showHuaTexture:function(e,t){var a="resources/shishi/image/",n="";111==e?n="chun":112==e?n="xia":113==e?n="qiu":114==e?n="dong":121==e?n="mei":122==e?n="lan":123==e?n="zhu":124==e&&(n="ju");var i="";return"down"==t?i="":"right"==t?i="4":"up"==t?i="3":"left"==t&&(i="2"),a=a+n+i+".png"},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,306)),cc.delayTime(5),cc.moveTo(.5,cc.p(30,406)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){var t=ReplayRoomData.opts;console.log("roomRule = "+JSON.stringify(t));var a=getRuleStrShiShi(t),n=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+",contentNode : "+n);var i=n.getComponent(cc.Label);console.log("playStr = "+a),i.string=a},getScore:function(e){for(var t,a=0;a<ReplayRoomData.games.length;a++)ReplayData.id==ReplayRoomData.games[a].id&&(t=a);var n=0;if(0!=t)for(a=0;a<t;a++)n+=ReplayRoomData.games[a].score[e];return console.log("................nowScore ="+n),n}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],ReplayMain:[function(e,t,a){"use strict";cc._RF.push(t,"d2b10SOo5xGTJ+rwrmscKnG","ReplayMain");var r=e("SoundMngr"),n=e("gameDefine");cc.Class({extends:cc.Component,properties:{playerCardNodes:{default:[],type:[cc.Node]},huierFace1:cc.Sprite,huierFace2:cc.Sprite,stopBtn:cc.Button,playBtn:cc.Button,exitBtn:cc.Button,quick_btn:cc.Button,overBtn:cc.Button,_actionIndex:-1,_playerCardList:[],_effectController:null,playintrNode:cc.Node,roomNum:cc.Label,runSum:cc.Label},onLoad:function(){this.playIntrSize="small",this.stopBtn.node.active=!1,this.playBtn.node.active=!0,registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("tjddz-onGameStart",this,this.showTableLayer),registEvent("pdk-onGameStart",this,this.showTableLayer),registEvent("onServerNotice",this,handlerServerNotice),scheduleLamp(this)},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTableLayer),unregistEvent("pdk-onGameStart",this,this.showTableLayer),unregistEvent("onServerNotice",this,handlerServerNotice)},onEnable:function(){cc.director.getScheduler().setTimeScale(1),this._effectController=this.node.getComponent("ReplayEffectController"),this.roomNum.getComponent(cc.Label).string=ReplayRoomData.roomid,this.showPlayIntroduce(this.playIntrSize),this.showUIHuier(),this.initStopPanel(),this.showHandCards();for(var e=0;e<this._playerCardList.length;e++){var t=this._playerCardList[e],a=this.getScore(t.uid);console.log("=============score = "+a),t.setCoin(a)}this.schedule(this.runAction,1)},showTableLayer:function(){GameData.client.gameType==n.GameType.Game_Mj_Tianjin?cc.director.loadScene("table"):GameData.client.gameType==n.GameType.Game_Poker_DDZ?cc.director.loadScene("table-DDZ"):GameData.client.gameType==n.GameType.Game_Poker_TianjinDDZ?cc.director.loadScene("table-TJDDZ"):GameData.client.gameType==n.GameType.Game_Poker_paodekuai&&cc.director.loadScene("table-PDK")},runAction:function(){this.runNextAction()},initData:function(){ReplayData=JSON.parse(replayDataJson);var e=ReplayData.opts.huier,t=GameData.getOtherHuier(e);cc.log("huier : "+e+",huier2 : "+t),HuierList=[e,t]},initStopPanel:function(){var t=this;this.stopBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(1),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.playBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(0),t.stopBtn.node.active=!0,t.playBtn.node.active=!1}),this.exitBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){ReplayDataCenter.openRoundPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")}),this.quick_btn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(2),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.overBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){t.overBtnClick()})},overBtnClick:function(){r.instance.playAudioOther("button"),this.unschedule(this.runAction);for(var e=this._actionIndex+1;e<ReplayData.actions.length;e++){var t=ReplayData.actions[e],a=t.uid,n=t.action,i=t.card;cc.log(e,a,n,i);var o=this.getCardController(a);n==ActionType.obtain?o.obtain(i):n==ActionType.discard?o.discard(i):n==ActionType.peng?o.peng(i):n==ActionType.minggang?o.minggang(i):n==ActionType.minggangself?o.minggangself(i):n==ActionType.angang?o.angang(i):n==ActionType.hu&&o.hu(i)}ReplayDataCenter.resultCard=this.getAllCards(),openView("ReplayResultPanel")},showUIHuier:function(){ReplayData.cards[0].cards.length;cc.log("showUIHuier --\x3e "+HuierList[0]+","+HuierList[1]),this.showCardContent(this.huierFace1.node,"mj_face_xia_shou",HuierList[0]),this.showCardContent(this.huierFace2.node,"mj_face_xia_shou",HuierList[1])},showCardContent:function(e,t,a){e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/mjcard2d/"+t+"_"+a+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)},getScore:function(e){for(var t,a=0;a<ReplayRoomData.games.length;a++)ReplayData.id==ReplayRoomData.games[a].id&&(t=a);var n=0;if(0!=t)for(a=0;a<t;a++)n+=ReplayRoomData.games[a].score[e];return console.log("................nowScore ="+n),n},runNextAction:function(){if(this._actionIndex++,this._actionIndex<ReplayData.actions.length){var e=ReplayData.actions[this._actionIndex],t=e.uid,a=e.action,n=e.card;cc.log(this._actionIndex,t,a,n),this.gotoShowTurnEffect(t),this.whoDoSomething(t,a,n)}else if(this._actionIndex==ReplayData.actions.length){cc.log("replay over");var i=this._actionIndex-1,o=ReplayData.actions[i];0<ReplayData.result.winner&&this.cardActionAnimation(o.uid,"hu");for(var r=0;r<this.playerCardNodes.length;r++){this.playerCardNodes[r].getComponent("ReplayCardController").uid==o.uid&&0==r&&0<ReplayData.result.winner&&this._effectController.showEffect(ActionType.hu)}for(r=0;r<this._playerCardList.length;r++){var s=this._playerCardList[r],c=this.getScore(s.uid);c+=ReplayData.scores[s.uid],s.setCoin(c)}this.lastTime=2,this.schedule(this.updateLastTime,1)}else this.unschedule(this.runAction)},updateLastTime:function(){this.lastTime--,this.lastTime<=0&&(ReplayDataCenter.resultCard=this.getAllCards(),openView("ReplayResultPanel"),this.unschedule(this.updateLastTime))},getAllCards:function(){for(var e=[],t=0;t<this.playerCardNodes.length;t++){var a=this.playerCardNodes[t];e.push(a.getComponent("ReplayCardController").getList())}return cc.log(JSON.stringify(e)),e},showHandCards:function(){ReplayData.creator;var e,t=ReplayData.cards;if(1==otherReplay[0]){for(var a in ReplayRoomData.players)if(a){e=ReplayRoomData.players[a].uid;break}}else e=GameData.player.uid.toString();var n,i;if(null!=(i=(n=ReplayRoomData.players)[e].seat)&&null!=i){var o=[];this.playerNum=Object.keys(ReplayData.players).length,4==this.playerNum?(0==i&&(o=[0,1,2,3]),1==i&&(o=[1,2,3,0]),2==i&&(o=[2,3,0,1]),3==i&&(o=[3,0,1,2])):3==this.playerNum?(0==i&&(o=[0,1,2]),1==i&&(o=[1,2,0]),2==i&&(o=[2,0,1]),this.playerCardNodes[1].removeFromParent(!0),this.playerCardNodes.splice(1,1)):2==this.playerNum&&(0==i&&(o=[0,1]),1==i&&(o=[1,0]),this.playerCardNodes[1].removeFromParent(!0),this.playerCardNodes[3].removeFromParent(!0),this.playerCardNodes.splice(1,1),this.playerCardNodes.splice(3,1));for(var r=0;r<o.length;r++){var s=o[r],c=t[s];if(null!=this.playerCardNodes&&0<this.playerCardNodes.length&&null!=this.playerCardNodes[r]){var d=this.playerCardNodes[r].getComponent("ReplayCardController");d.showHandCard(c.cards);var h=t[s].uid,l=n[h].name,u=n[h].headimgurl;d.uid=h,d.showHead(n[h],l+"",u);var m=d.uid==ReplayData.opts.zhuang;d.showZhuang(m);var p=ReplayData.opts.zhuangnum[d.uid];d.showZhuangNum(m,p),this._playerCardList.push(d)}}}},whoDoSomething:function(e,t,a){this.runSum.getComponent(cc.Label).string="进度: "+this._actionIndex+"/"+(ReplayData.actions.length-1);var n=this.getCardController(e);if(t==ActionType.obtain)n.obtain(a);else if(t==ActionType.discard)n.discard(a);else if(t==ActionType.peng){n.peng(a),this.cardActionAnimation(n.uid,"peng");for(var i=0;i<this.playerCardNodes.length;i++){this.playerCardNodes[i].getComponent("ReplayCardController").uid==n.uid&&0==i&&this._effectController.showEffect(ActionType.peng)}this.removeDisFromLast(a[0])}else if(t==ActionType.minggang){n.minggang(a),this.cardActionAnimation(n.uid,"gang");for(i=0;i<this.playerCardNodes.length;i++){this.playerCardNodes[i].getComponent("ReplayCardController").uid==n.uid&&0==i&&this._effectController.showEffect(ActionType.minggang)}this.removeDisFromLast(a[2])}else if(t==ActionType.minggangself){n.minggangself(a),this.cardActionAnimation(n.uid,"gang");for(i=0;i<this.playerCardNodes.length;i++){this.playerCardNodes[i].getComponent("ReplayCardController").uid==n.uid&&0==i&&this._effectController.showEffect(ActionType.minggangself)}}else if(t==ActionType.angang){n.angang(a),this.cardActionAnimation(n.uid,"gang");for(i=0;i<this.playerCardNodes.length;i++){this.playerCardNodes[i].getComponent("ReplayCardController").uid==n.uid&&0==i&&this._effectController.showEffect(ActionType.angang)}}else if(t==ActionType.hu){n.hu(a),this.cardActionAnimation(n.uid,"hu");for(i=0;i<this.playerCardNodes.length;i++){this.playerCardNodes[i].getComponent("ReplayCardController").uid==n.uid&&0==i&&this._effectController.showEffect(ActionType.hu)}}else cc.log("no action logic, aciotn name is "+t)},removeDisFromLast:function(e){var t=ReplayData.actions[this._actionIndex-1].uid;this.getCardController(t).removeDisCard(e)},getAnimationIndex:function(e){for(var t="",a=0;a<this.playerCardNodes.length;a++){var n=this.playerCardNodes[a].getComponent("ReplayCardController");4==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="right":2==a?t="up":3==a&&(t="left")):3==this.playerNum?n.uid==e&&(0==a?t="down":1==a?t="up":2==a&&(t="left")):2==this.playerNum&&n.uid==e&&(0==a?t="down":1==a&&(t="up"))}return t},cardActionAnimation:function(e,t){var a=this.getAnimationIndex(e),n=cc.find("layer_ui/actionAnimations/"+a,this.node);null!=n&&n.getComponent(cc.Animation).play(t)},gotoShowTurnEffect:function(e){var t=!1;if(null!=this._playerCardList)for(var a=0;a<this._playerCardList.length;a++){var n=this._playerCardList[a];t=n.uid==e,n.getLiuGuang(t)}else cc.log("this._playerCardList null")},getCardController:function(e){for(var t=0;t<this._playerCardList.length;t++){var a=this._playerCardList[t];if(a.uid==e)return a}return null},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(5),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){var t=ReplayRoomData.opts;console.log("roomRule = "+JSON.stringify(t));var a=getRoomRuleStr(t),n=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+",contentNode : "+n),n.getComponent(cc.Label).string=a}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"ReplayResultPanel-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"742fa1aN6JCmqNF6DKOWSJP","ReplayResultPanel-shishi");var l=e("ruleHandler"),u=e("gameDefine");cc.Class({extends:cc.Component,properties:{cardTemplate:cc.Prefab,cardHuier:cc.Prefab,cardHuImage:cc.Prefab,winNode:cc.Node,lostNode:cc.Node,pingNode:cc.Node,roomID:cc.Label,createtime:cc.Label,roundData:cc.Label,isMark:0,jinNum:0,fonts:{default:[],type:cc.Font}},onLoad:function(){this.pengCard={},this.gangCard={},this.chiCard={},this.onShow()},onClose:function(e){ReplayDataCenter.openReplayPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")},onShow:function(){for(var e=0;e<Object.keys(ReplayData.players).length;e++)this.jinNum=0,this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e);for(e=Object.keys(ReplayData.players).length;e<4;e++){cc.find("player"+(e+1),this.node).active=!1}this.showRoundInfo(),this.showResultIcon()},showWinIcon:function(e){var t=ReplayData.players[e].uid,a=cc.find("player"+(e+1),this.node),n=cc.find("huIcon",a),i=!1;ReplayData.zimo?i=t==ReplayData.zimo.winner:ReplayData.dianpao&&(i=t==ReplayData.dianpao.winner),n.active=i;var o=cc.find("paoIcon",a);cc.log("sadasd "+JSON.stringify(ReplayData));var r=!1;ReplayData.zimo?r=!1:ReplayData.dianpao&&(r=t==ReplayData.dianpao.displayer),o.active=r},showResultIcon:function(){var e;if(this.winNode.active=!1,this.lostNode.active=!1,this.pingNode.active=!1,1==otherReplay[0]){for(var t in ReplayRoomData.players)if(t){e=ReplayRoomData.players[t].uid;break}}else e=GameData.player.uid;var a=ReplayData.scores[e];0<a?this.winNode.active=!0:a<0?this.lostNode.active=!0:this.pingNode.active=!0},showRoundInfo:function(){this.roomID.string="房号："+ReplayData.room;var e=ReplayRoomData.createtime,t=(e=new Date(e)).getFullYear()+"/",a=e.getMonth()+1+"/",n=e.getDate()+"   ",i=e.getHours()+"",o=e.getMinutes()+"",r=e.getSeconds()+"";i=1==i.length?"0"+i:i,o=1==o.length?"0"+o:o,r=1==r.length?"0"+r:r,this.createtime.string=t+a+n+i+":"+o+":"+r;for(var s=0,c=0;c<ReplayRoomData.games.length;c++)ReplayData.id==ReplayRoomData.games[c].id&&(s=c+1);this.roundData.string="第"+s+"局"},showDetail:function(e){var t,a=ReplayData.players[e],n=cc.find("player"+(e+1)+"/term",this.node).getComponent("cc.Label");n.string=" ",0<ReplayData.opts.water[a.uid]&&(n.string+="2水 "),ReplayData.zimo?ReplayData.zimo.winner==a.uid&&(t=ReplayData.zimo.type,n.string+=ReplayDataCenter.replayResultDetailShiShi(t)):ReplayData.dianpao&&ReplayData.dianpao.winner==a.uid&&(t=ReplayData.dianpao.type,n.string+=ReplayDataCenter.replayResultDetailShiShi(t));for(var i=0;i<this.gangCard.length;i++){ReplayDataCenter.isHuier(this.gangCard[i][0])&&(n.string+=" 金杠 +"+ReplayRoomData.opts.jingang);for(var o=0,r=0,s=0;s<this.gangCard.length;s++)4==this.gangCard[s].length?o++:5==this.gangCard[s].length&&r++}if(0<o&&(n.string+="明杠 +1*"+o+"  "),0<r&&(n.string+="暗杠 +2*"+r+"  "),GameData.client.gameType==u.GameType.Game_Mj_Shishi){var c=this.getHuaCards(e);if(1<=c.length){var d=cc.find("player"+(e+1)+"/cards",this.node);this.showHua(c,d)}if(4<=c.length){var h=l.instance.replayCalcHuaScore(a.uid);h&&0!=h&&(n.string+="花杠 +"+h+" ")}}0<this.jinNum&&(n.string+="金 +"+this.jinNum+"  ")},getHuaCards:function(e){var t=ReplayData.players[e],a=[],n=ReplayData.cards[e].hua;0<n.length&&(a=n);for(var i=0;i<ReplayData.actions.length;i++)if(ReplayData.actions[i].uid==t.uid){if(null==ReplayData.actions[i].hua)continue;this.mergeArray(a,ReplayData.actions[i].hua)}return a},mergeArray:function(e,t){for(var a=0;a<t.length;a++)e.push(t[a])},showHua:function(e,t){e.sort();for(var a=cc.find("cardhua",t).children,n=0;n<a.length;n++)a[n].active=!1;for(var i=0;i<e.length;i++){var o=i+1,r=cc.find("cardhua/"+o,t);r.getComponent(cc.Sprite).spriteFrame=null;var s=this.showHuaTexture(e[i]),c=cc.textureCache.addImage(cc.url.raw(s));r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(c),r.active=!0}},showHuaTexture:function(e){var t="resources/shishi/image/",a="";return 111==e?a="chun":112==e?a="xia":113==e?a="qiu":114==e?a="dong":121==e?a="mei":122==e?a="lan":123==e?a="zhu":124==e&&(a="ju"),t=t+a+".png"},showPlayer:function(e){var t=ReplayData.players[e],a=cc.find("player"+(e+1)+"/head/id",this.node),n=cc.find("player"+(e+1)+"/head/name",this.node),i=cc.find("player"+(e+1)+"/head/headpic",this.node),o=cc.find("player"+(e+1)+"/head/zhuang",this.node),r=cc.find("player"+(e+1)+"/head/creator",this.node),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==ReplayData.opts.zhuang,r.active=t.uid==ReplayRoomData.creator,null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showCards:function(e){var t,a,n=ReplayData.players[e],i=cc.find("player"+(e+1),this.node),o=cc.find("cards",i),r=n.uid;ReplayData.zimo?t=r==ReplayData.zimo.winner:ReplayData.dianpao&&(t=r==ReplayData.dianpao.winner),t&&(this.isMark=0);for(var s=0;s<ReplayDataCenter.resultCard.length;s++){var c=ReplayDataCenter.resultCard[s];if(c.uid==r){a=c;break}}this.pengCard=a.peng,this.gangCard=a.gang,this.chiCard=a.chi;for(s=0;s<this.chiCard.length;s++)this.chiCard[s].sort(function(e,t){return e-t});this.showPengCards(n,o,"mj_face_xia_chu","down");var d=a.hand;2<=d.length&&d.sort(function(e,t){return e-t});var h=cc.find("cardHand",o);h.setScale(.7);for(s=0;s<d.length;s++){var l=d[s],u=cc.instantiate(this.cardTemplate);u.getComponent("cardTemplate").setId(l),u.getComponent("cardTemplate").enableButton(!1);var m="mj_face_xia_shou_"+l+".png";u.getComponent("cardTemplate").setIcon("resources/mjcard2d/"+m),u.x=85*s,this.setMyHuierVisible(u,l),this.setMyHuImageVisible(u,l,t),h.addChild(u)}var p=0,g=cc.find("cardPeng",o).children;for(s=0;s<g.length;s++)g[s].active&&p++;h.x=180*p-532,i.active=!0},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},setMyHuierVisible:function(e,t){var a=!1;ReplayDataCenter.isHuier(t)&&(a=!0),1==a&&this.jinNum++;var n=e.getChildByName(e.name+"_huier");null==n?1==a&&((n=cc.instantiate(this.cardHuier)).y=n.y-8,e.addChild(n),n.name=e.name+"_huier"):n.active=a},setMyHuImageVisible:function(e,t,a){var n;ReplayData.zimo?n=ReplayData.zimo.obtain:ReplayData.dianpao&&(n=ReplayData.dianpao.discard);var i=!1;0==a?i=!1:n==t&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuImage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showPengCards:function(e,t,a,n){if(e)for(var i=this.gangCard.concat(this.pengCard,this.chiCard),o=parseInt(16/3),r=0;r<o;r++){var s=cc.find("cardPeng/cardPeng"+(r+1),t);if(r<i.length){for(var c=0;c<4;c++){var d=s.getChildByName("card_face"+(c+1)).getComponent("cc.Sprite");if(c<i[r].length){d.node.active=!0;var h=i[r][c];this.showCardContent(d.node,a,h)}else d.node.active=!1}if(5==i[r].length){d=s.getChildByName("card_face4").getComponent("cc.Sprite");var l=s.getChildByName("card_back4").getComponent("cc.Sprite");d.node.active=!1,l.node.active=!0}else{(l=s.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1}s.active=!0}else s.active=!1}},showScore:function(e){var t=ReplayData.players[e].uid,a=cc.find("player"+(e+1)+"/score",this.node);0<ReplayData.scores[t]?(a.getComponent("cc.Label").string="+"+ReplayData.scores[t],a.getComponent("cc.Label").font=this.fonts[0]):ReplayData.scores[t]<0?(a.getComponent("cc.Label").string=ReplayData.scores[t],a.getComponent("cc.Label").font=this.fonts[1]):(a.getComponent("cc.Label").string=ReplayData.scores[t],a.getComponent("cc.Label").font=this.fonts[2])},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],ReplayResultPanel:[function(e,t,a){"use strict";cc._RF.push(t,"c818cZR0VdIIpz6csUMZ/4e","ReplayResultPanel"),cc.Class({extends:cc.Component,properties:{cardTemplate:cc.Prefab,cardHuier:cc.Prefab,cardHuImage:cc.Prefab,winNode:cc.Node,lostNode:cc.Node,pingNode:cc.Node,roomID:cc.Label,createtime:cc.Label,roundData:cc.Label,isMark:0,font:{default:[],type:[cc.Font]}},onLoad:function(){this.pengCard={},this.gangCard={},this.onShow()},onClose:function(e){ReplayDataCenter.openReplayPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")},onShow:function(){for(var e=0;e<Object.keys(ReplayData.players).length;e++)this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),ReplayData.zimo&&this.showWinIcon(e);for(e=Object.keys(ReplayData.players).length;e<4;e++){cc.find("player"+(e+1),this.node).active=!1}this.showRoundInfo(),this.showResultIcon()},showWinIcon:function(e){var t=ReplayData.players[e].uid,a=cc.find("player"+(e+1),this.node);cc.find("huIcon",a).active=t==ReplayData.zimo.winner},showResultIcon:function(){var e;if(1==otherReplay[0]){for(var t in ReplayRoomData.players)if(t){e=ReplayRoomData.players[t].uid;break}}else e=GameData.player.uid;var a=ReplayData.scores[e];0<a?(this.winNode.active=!0,this.lostNode.active=!1,this.pingNode.active=!1):a<0?(this.winNode.active=!1,this.lostNode.active=!0,this.pingNode.active=!1):(this.winNode.active=!1,this.lostNode.active=!1,this.pingNode.active=!0)},showRoundInfo:function(){this.roomID.string="房号："+ReplayData.room;var e=getTimeStr(ReplayRoomData.createtime);this.createtime.string=e[0]+"/"+e[1]+"/"+e[2]+"  "+e[3]+":"+e[4]+":"+e[5];for(var t=0,a=0;a<ReplayRoomData.games.length;a++)ReplayData.id==ReplayRoomData.games[a].id&&(t=a+1);this.roundData.string="第"+t+"局"},showDetail:function(e){var t=ReplayData.players[e],a=cc.find("player"+(e+1)+"/term",this.node).getComponent("cc.Label"),n=[];if(ReplayData.zimo&&ReplayData.zimo.winner==t.uid){var i=ReplayData.zimo.type;n=ReplayDataCenter.replayResultDetail(i),a.string=n[0]}else a.string="";console.log("huTypeStr = "+JSON.stringify(n)),ReplayData.opts.zhuang==t.uid?1==n[1]&&(a.string+="铲牌 -2   "):a.string+="",ReplayRoomData.opts.times&&(1==ReplayRoomData.opts.times?a.string+="底分 *1   ":2==ReplayRoomData.opts.times?a.string+="底分 *2   ":5==ReplayRoomData.opts.times&&(a.string+="底分 *5   "));for(var o=0,r=0,s=0;s<this.gangCard.length;s++)ReplayDataCenter.isHuier(this.gangCard[s][0])?a.string+="金杠 +"+ReplayRoomData.opts.jingang+"   ":4==this.gangCard[s].length?o++:5==this.gangCard[s].length&&r++;if(0==o||(a.string+="明杠 +1*"+o+"  "),0==r||(a.string+="暗杠 +2*"+r+"  "),(0<o||0<r)&&1==ReplayRoomData.opts.doubleGang&&0<ReplayData.opts.zhuangnum[ReplayData.opts.zhuang]&&(a.string+="杠翻番  "),ReplayData.opts.zhuang==t.uid&&0<ReplayData.opts.zhuangnum[t.uid]){var c=2*(d=ReplayData.opts.zhuangnum[t.uid]);a.string+="坐"+d+"庄 *"+c}else if(ReplayData.opts.zhuang!=t.uid&&0<ReplayData.opts.zhuangnum[t.uid]){var d;c=2*(d=ReplayData.opts.zhuangnum[t.uid]);a.string+="拉"+d+"庄 *"+c}},showPlayer:function(e){var t=ReplayData.players[e],a=cc.find("player"+(e+1)+"/head/id",this.node),n=cc.find("player"+(e+1)+"/head/name",this.node),i=cc.find("player"+(e+1)+"/head/headpic",this.node),o=cc.find("player"+(e+1)+"/head/zhuang",this.node),r=cc.find("player"+(e+1)+"/head/creator",this.node),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==ReplayData.opts.zhuang,r.active=t.uid==ReplayRoomData.creator,null==t.headimgurl||""==t.headimgurl||t.headimgurl.length<=0||cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showCards:function(e){var t,a=ReplayData.players[e],n=cc.find("player"+(e+1),this.node),i=cc.find("cards",n),o=a.uid,r=!1;ReplayData.zimo&&(r=o==ReplayData.zimo.winner),r&&(this.isMark=0);for(var s=0;s<ReplayDataCenter.resultCard.length;s++){var c=ReplayDataCenter.resultCard[s];if(c.uid==o){t=c;break}}this.pengCard=t.peng,this.gangCard=t.gang,this.showPengCards(a,i,"mj_face_xia_chu","down");var d=t.hand,h=cc.find("cardHand",i);for(s=0;s<d.length;s++){var l=d[s],u=cc.instantiate(this.cardTemplate);u.getComponent("cardTemplate").setId(l),u.getComponent("cardTemplate").enableButton(!1);var m="mj_face_xia_shou_"+l+".png";u.getComponent("cardTemplate").setIcon("resources/mjcard2d/"+m),u.x=85*s,this.setMyHuierVisible(u,l),ReplayData.zimo&&this.setMyHuImageVisible(u,l,r),h.addChild(u)}var p=0,g=cc.find("cardPeng",i).children;for(s=0;s<g.length;s++)g[s].active&&p++;h.x=230*p-532,n.active=!0},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},setMyHuierVisible:function(e,t){var a=!1;ReplayDataCenter.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");null==n?1==a&&((n=cc.instantiate(this.cardHuier)).y=n.y-18,cc.find("up",n).active=!1,cc.find("down",n).active=!1,cc.find("right",n).active=!1,cc.find("left",n).active=!1,cc.find("down",n).active=!0,e.addChild(n),n.name=e.name+"_huier"):n.active=a},setMyHuImageVisible:function(e,t,a){var n=ReplayData.zimo.obtain,i=!1;0==a?i=!1:n==t&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuImage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showPengCards:function(e,t,a,n){if(e)for(var i=this.gangCard.concat(this.pengCard),o=parseInt(13/3),r=0;r<o;r++){var s=cc.find("cardPeng/cardPeng"+(r+1),t);if(r<i.length){for(var c=0;c<4;c++){var d=s.getChildByName("card_face"+(c+1)).getComponent("cc.Sprite");if(c<i[r].length){d.node.active=!0;var h=i[r][c];this.showCardContent(d.node,a,h)}else d.node.active=!1}if(5==i[r].length){d=s.getChildByName("card_face4").getComponent("cc.Sprite");var l=s.getChildByName("card_back4").getComponent("cc.Sprite");d.node.active=!1,l.node.active=!0}else{(l=s.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1}s.active=!0}else s.active=!1}},showScore:function(e){var t=ReplayData.players[e].uid,a=cc.find("player"+(e+1)+"/score",this.node);0<ReplayData.scores[t]?(a.getComponent("cc.Label").font=this.font[0],a.getComponent("cc.Label").string="+"+ReplayData.scores[t]):(ReplayData.scores[t]<0?a.getComponent("cc.Label").font=this.font[1]:a.getComponent("cc.Label").font=this.font[2],a.getComponent("cc.Label").string=ReplayData.scores[t])},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{}],RoundItem:[function(e,t,a){"use strict";cc._RF.push(t,"f4282pjyzJGIZVX6KzRyOCr","RoundItem");var o=e("gameDefine"),n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{roundIndexLabel:cc.Label,roomIdLabel:cc.Label,creatorIdLabel:cc.Label,dateLabel:cc.Label,content:cc.Node,itemPrefab:cc.Prefab,_playerItems:[],_recordId:0,_createTime:0,_roomId:0,replayNum:cc.Label,gameTypeNode:cc.Node},onLoad:function(){},openReplay:function(e){GameNet.getInstance().request("game.playerHandler.getGameRecord",{id:this._recordId,roomid:this._roomId},function(e){if(e&&!(Object.keys(e).length<=0)){if(ReplayData=e,ReplayData.cards){var t=ReplayData.cards[0].cards.length,a=ReplayData.opts.huier,n=GameData.getOtherHuier(a);13==t?HuierList=[a,n]:16==t&&(HuierList=[a])}switch(cc.log("go to replay"),ReplayRoomData.opts.gameType){case o.GameType.Game_Poker_DDZ:cc.director.loadScene("replay-DDZ");break;case o.GameType.Game_Mj_Tianjin:cc.director.loadScene("replay");break;case o.GameType.Game_Mj_Shishi:cc.director.loadScene("replay-shishi");break;case o.GameType.Game_TDK:cc.director.loadScene("replay-tdk");break;default:createMoveMessage("暂无回放")}}})},show:function(e,t,a,n,i){this._roomId=t,this._recordId=i,this._createTime=n,this.roundIndexLabel.string=e;for(var o=6-t.toString().length,r=0;r<o;r++)t="0"+t;this.roomIdLabel.string=t,this.creatorIdLabel.string=a,this.replayNum.string=i;var s=getTimeStr(i),c=s[0]+"."+s[1]+"."+s[2]+"  "+s[3]+":"+s[4]+":"+s[5];this.dateLabel.string=c},showGameType:function(e){var t=cc.find("typeName",this.gameTypeNode),a=cc.find("roomtype",this.gameTypeNode),n="";switch(e.roomType){case 1:n="(普通房)";break;case 2:n="(俱乐部)"}a.getComponent("cc.Label").string=n;var i="";switch(e.gameType){case o.GameType.Game_Poker_TianjinDDZ:i="天津斗地主";break;case o.GameType.Game_Mj_Shishi:i="石狮麻将";break;case o.GameType.Game_Mj_Tianjin:i="天津麻将";break;case o.GameType.Game_MJ_HuaDian:i="桦甸麻将";break;case o.GameType.Game_Poker_13shui:i="十三水";break;case o.GameType.Game_niu_niu:i="经典牛牛";break;case o.GameType.Game_TDK:i="填大坑";break;case o.GameType.Game_Poker_DDZ:i="经典斗地主";break;case o.GameType.Game_Mj_HZ:i="红中麻将";break;case o.GameType.Game_Mj_CC:i="长春麻将"}t.getComponent("cc.Label").string=i},setPlayers:function(e,t){if(this._playerItems=[],0==this._playerItems.length)for(var a=0;a<Object.keys(e).length;++a){var n=cc.instantiate(this.itemPrefab);n.parent=this.content,n.setPosition(190*a,10),this._playerItems.push(n)}var i=0;for(var o in e){var r=e[o];if(i<Object.keys(e).length){var s=this._playerItems[i].getComponent("RecordPlayerInfo");s.setName(r.name),s.setHeadIcon(r.headimgurl),s.setId(r.uid),null==t||null==t?s.setZongfen(1,0):s.setZongfen(1,t[r.uid]),s.setJifen(void 0)}i++}},copyRepayNum:function(e){n.instance.playAudioOther("button"),cc.log("this._roomId = "+this._roomId+",this._createTime = "+this._createTime);var t="";t=t+this._roomId+this._createTime,WriteLog("shareStr = "+t),textClipboard(t),createMoveMessage("复制回放码成功")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],RoundPanel:[function(e,t,a){"use strict";cc._RF.push(t,"380a3oAtgRJRJXhjiO0P+Hj","RoundPanel");var n=e("gameDefine"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,prefabItem:cc.Prefab,_itemList:[],roomID:cc.Label,creatorLabel:cc.Label,roonMaxNum:cc.Label,roomRules:cc.Label},onLoad:function(){if(registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("tjddz-onGameStart",this,this.showTableLayer),ReplayDataCenter.openReplayPanel){for(var e=0;e<ReplayDataCenter.room.length;e++)ReplayDataCenter.room[e].roomid==ReplayRoomData.roomid&&ReplayDataCenter.room[e].players;var t=this;GameNet.getInstance().request("game.playerHandler.getRoomRecord",{roomid:ReplayData.room,createtime:ReplayRoomData.createtime},function(e){t.show(e,e.creator)}),ReplayDataCenter.openReplayPanel=!1}},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTableLayer)},showTableLayer:function(){GameData.client.gameType==n.GameType.Game_Mj_Tianjin?cc.director.loadScene("table"):GameData.client.gameType==n.GameType.Game_Poker_DDZ?cc.director.loadScene("table-DDZ"):GameData.client.gameType==n.GameType.Game_Poker_TianjinDDZ&&cc.director.loadScene("table-TJDDZ")},onClose:function(){i.instance.playAudioOther("button"),closeView("RoundPanel"),otherReplay[0]=!1,ReplayDataCenter.openRoundPanel=!0,openView("RecordPanel")},show:function(e,t){if(this._itemList=[],this.roomID.string="",this.creatorLabel.string="",this.roonMaxNum.string="",this.showRoomRule(""),this.scrollView.content.removeAllChildren(),Object.keys(e).length<=0)createMoveMessage("暂无牌局详情");else{var a;if(e.games?a=e.games:e.record&&(a=e.record),0==this._itemList.length)for(var n=0;n<a.length;++n){var i=cc.instantiate(this.prefabItem);this.scrollView.content.addChild(i),this._itemList.push(i),i.active=!1}ReplayRoomData=e,this.roomID.string=e.roomid,this.creatorLabel.string=t,ReplayRoomData.creator=t,this.roonMaxNum.string=a.length,this.showRoomRule(e.opts);for(var o=this._itemList.length-1;0<=o;o--){var r=this._itemList[o];if(r.active)break;var s=a[a.length-1-o];if(o<a.length&&null!=s.score){var c=r.getComponent("RoundItem");c.show(a.length-o,e.roomid,t,e.createtime,s.id),c.showGameType(e.opts),cc.log("oneRoundData = "+JSON.stringify(s)),c.setPlayers(e.players,s.score),r.active=!0}else r.active=!1}}},showRoomRule:function(e){var t="";switch(e.gameType){case n.GameType.Game_Poker_TianjinDDZ:t=getRuleStrTJDDZ(e);break;case n.GameType.Game_Mj_Shishi:t=getRuleStrShiShi(e);break;case n.GameType.Game_Mj_Tianjin:t=getRoomRuleStr(e);break;case n.GameType.Game_MJ_HuaDian:t=getRuleStrHd(e);break;case n.GameType.Game_Poker_13shui:t=getRuleStr13(e);break;case n.GameType.Game_niu_niu:t=getRuleStrNiuNiu(e);break;case n.GameType.Game_TDK:t=getRuleStrTDK(e);break;case n.GameType.Game_Poker_DDZ:t=getRuleStrDDZ(e);break;case n.GameType.Game_Mj_HZ:t=getRuleStrHongZhong(e);break;case n.GameType.Game_Mj_CC:t=getRuleStrCC(e)}this.roomRules.string=t}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],RunlampPanel1:[function(e,t,a){"use strict";cc._RF.push(t,"f4edcZNepZA0ridzpQALZtv","RunlampPanel1");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{runlampLabel:cc.Label,_paoMadengX:0},onLoad:function(){this.node.zIndex=1e3,this.runPaoMadeng();var e=cc.director.getWinSize();cc.find("paoMaDeng",this.node).setPosition(cc.p(e.width/2,e.height/1.25))},onClose:function(){n.instance.playAudioOther("button"),closeView(this.node.name)},changeRunlamp:function(e){var t=cc.director.getWinSize(),a=cc.find("paoMaDeng",this.node);e==AutoScene.SCENE_HORIZONTAL?(a.rotation=-90,a.setPosition(cc.p(t.height/3.8,t.width/3.2))):e==AutoScene.SCENE_VERTICAL&&a.setPosition(cc.p(t.width/1.8,t.height/1.18))},runPaoMadeng:function(){this._paoMadengX=this.runlampLabel.node.x,GameData.configData.paomadengIndex=0,this.gotoPaoMadeng(),this.schedule(this.gotoPaoMadeng,10)},gotoPaoMadeng:function(){if(GameData.serverNoticeData[1]){var e=GameData.serverNoticeData[1].content;e=e.replace(/[\n]/gi,""),this.runlampLabel.string=e,this.runlampLabel.node.x=this._paoMadengX;var t=cc.moveTo(10,cc.p(this._paoMadengX-570-this.runlampLabel.node.width,this.runlampLabel.node.y)),a=cc.sequence(t,cc.callFunc(function(){closeView("RunlampPanel1")}));this.runlampLabel.node.runAction(a)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],RunlampPanel:[function(e,t,a){"use strict";cc._RF.push(t,"d476aKaA9FFZ6+yCGg93TYl","RunlampPanel");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{runlampLabel:cc.Label,_paoMadengX:0},onLoad:function(){this.node.zIndex=1e3,this.runPaoMadeng();var e=cc.director.getWinSize();cc.find("paoMaDeng",this.node).setPosition(cc.p(e.width/2,e.height/1.25))},onClose:function(){n.instance.playAudioOther("button"),closeView(this.node.name)},changeRunlamp:function(e){var t=cc.director.getWinSize(),a=cc.find("paoMaDeng",this.node);e==AutoScene.SCENE_HORIZONTAL?(a.rotation=-90,a.setPosition(cc.p(t.height/3.8,t.width/3.2))):e==AutoScene.SCENE_VERTICAL&&a.setPosition(cc.p(t.width/1.8,t.height/1.18))},runPaoMadeng:function(){this._paoMadengX=this.runlampLabel.node.x,this.gotoPaoMadeng(),this.schedule(this.gotoPaoMadeng,10)},gotoPaoMadeng:function(){if(GameData.serverNoticeData){var e=GameData.serverNoticeData[0].content;e=e.replace(/[\n]/gi,""),this.runlampLabel.string=e,this.runlampLabel.node.x=this._paoMadengX;var t=cc.moveTo(10,cc.p(this._paoMadengX-570-this.runlampLabel.node.width,this.runlampLabel.node.y)),a=cc.sequence(t,cc.callFunc(function(){closeView("RunlampPanel")}));this.runlampLabel.node.runAction(a)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],SSSCard:[function(e,t,a){"use strict";cc._RF.push(t,"5cec9pLTlFJfJHIAjhtQQMN","SSSCard");var n=e("SoundMngr"),i=cc.Class({extends:cc.Component,properties:{card:{default:null,type:cc.Node},oneCard:{default:null,type:cc.Node},towCard:{default:null,type:cc.Node},id:0,isSelect:!1,isChange:!1,cardHand:cc.Node},onLoad:function(){this.cards=[],this.cardList=[],this.oneCard,this.towCard;var e=cc.find("card0",this.cardHand),t=cc.find("card1",this.cardHand);this.cardHand.getChildByName("upCardNode")||(this.distance=1.45*Math.abs(e.getPositionX()-t.getPositionX())),this.addTouchEvent(),this._selectArray=[],this._init_x=0,this._end_x=0},onDestroy:function(){this.card.off(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.card.off(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.card.off(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.card.off(cc.Node.EventType.TOUCH_CANCEL,this.cancelTouch,this)},addTouchEvent:function(){this.card.on(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.card.on(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.card.on(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.card.on(cc.Node.EventType.TOUCH_CANCEL,this.cancelTouch,this)},pushInCardId:function(e){1!=this.checkIsHave(e)&&this._selectArray.push(e)},checkIsHave:function(e){for(var t=0;t<this._selectArray.length;t++)if(this._selectArray[t]==e)return!0;return!1},checkCardPosition_x:function(){var e=this.card.parent.getChildren();if(e.length<=0)cc.log("function:checkCardPosition_x.. children is empty.");else for(var t=0;t<this.card.parent.getChildrenCount();t++){var a=e[t];if(a){var n=a.width*a.scaleX/4,i=a.x-n;i<this._init_x&&i>this._end_x?this.pushInCardId(a.getComponent("SSSCard").id):i>this._init_x&&i<this._end_x&&this.pushInCardId(a.getComponent("SSSCard").id)}}},setCardMaskState:function(){var e=this.card.parent.getChildren();if(e.length<=0)cc.log("function:setCardMaskState.. children is empty.");else for(var t=0;t<this.card.parent.getChildrenCount();t++){var a=e[t];if(a&&a.getComponent("SSSCard")){var n=a.getComponent("SSSCard").id;if(!(n<0)){var i=!1;1==this.checkIsHave(n)&&(i=!0),this.showCardMask(a,i)}}}},showCardMask:function(e,t){cc.find("cardMask",e).active=t},setCardSelectState:function(){for(var e=0;e<this._selectArray.length;e++){var t=this._selectArray[e];if(!(t<0)){var a=cc.find("card"+t,this.card.parent);a&&1==this.checkIsHave(t)&&(a.getComponent("SSSCard").isSelect=0==a.getComponent("SSSCard").isSelect)}}},startTouch:function(e){if(n.instance.playSSSAudio(SSS_AudioType.SAT_6),1!=this.isChange){this.reSetCardsStatus();var t=e.touch.getLocation();this._init_x=this.card.parent.convertToNodeSpaceAR(t).x,this._selectArray=[],this.pushInCardId(this.id),this.setCardMaskState()}else this.setCardStatus(this.card)},moveTouch:function(e){if(1!=this.isChange){var t=e.touch.getLocation();this._end_x=this.card.parent.convertToNodeSpaceAR(t).x,this._selectArray=[],this.pushInCardId(this.id),this.checkCardPosition_x(),this.setCardMaskState()}},endTouch:function(e){this.cardList=this._selectArray,this.setCardSelectState();var t=!1;if(1==this.isChange)return t=!0,void this.showSelectCard(t);this._selectArray=[],this.setCardMaskState(),this.showSelectCard(t)},cancelTouch:function(e){this.cardList=this._selectArray,this.setCardSelectState();var t=!1;if(1==this.isChange)return t=!0,void this.showSelectCard(t);this._selectArray=[],this.setCardMaskState(),this.showSelectCard(t)},setCardList:function(e){this.cardList=[],this.cardList=e},bounceCard:function(){for(var e=0;e<this.cardList.length;e++){var t=cc.find("card"+this.cardList[e],this.cardHand);1==t.getComponent("SSSCard").isSelect?t.y=t.getPositionY()+t.getContentSize().height/5*.55:0==t.getComponent("SSSCard").isSelect&&(t.y=0)}this.removeAllCardsList()},showSelectCard:function(e){1<=this.cardList.length&&0==e?this.bounceCard():1==e&&(this.moveTowCard("up",3)?this.cardList=[]:this.moveTowCard("mid",5)?this.cardList=[]:this.moveTowCard("down",5)&&(this.cardList=[]),this.removeAllCards())},showOneCard:function(e){this.oneCard.active=e},showTowCard:function(e){this.towCard.active=e},moveTowCard:function(e,t){var a=this,n=cc.find("oneCard",this.cardHand),i=cc.find("towCard",this.cardHand),o=cc.find(e+"CardNode",this.cardHand);this.oneCard=n,this.towCard=i;for(var r=0;r<t;r++){var s=cc.find("card"+r,o);1==s.getComponent("SSSCard").isSelect&&(this.cards[this.cards.length]={card:s,id:r,row:e})}if(2==this.cards.length){var c=this.cards[0].card.getComponent(cc.Sprite).spriteFrame,d=this.cards[1].card.getComponent(cc.Sprite).spriteFrame;this.showCardMask(this.cards[0].card,!1),this.showCardMask(this.cards[1].card,!1);var h=this.cards[0].card.getPosition(),l=this.cards[1].card.getPosition();if(0==this.oneCard.active&&0==this.towCard.active){this.oneCard.setPosition(h.x,this.cards[0].card.parent.getPositionY()),this.towCard.setPosition(l.x,this.cards[1].card.parent.getPositionY()),this.cards[0].card.getComponent("SSSCard").isSelect=!1,this.cards[1].card.getComponent("SSSCard").isSelect=!1,moveCard.oneCard=this.cards[0],moveCard.towCard=this.cards[1];var u=cardPoker13[this.cards[0].row][this.cards[0].id];cardPoker13[this.cards[0].row][this.cards[0].id]=cardPoker13[this.cards[1].row][this.cards[1].id],cardPoker13[this.cards[1].row][this.cards[1].id]=u}else if(1==this.oneCard.active||1==this.towCard.active)return this.cards[0].card.getComponent("SSSCard").isSelect=!1,void(this.cards[1].card.getComponent("SSSCard").isSelect=!1);this.oneCard.getComponent(cc.Sprite).spriteFrame=c,this.towCard.getComponent(cc.Sprite).spriteFrame=d,this.cards[0].card.getComponent(cc.Sprite).spriteFrame=d,this.cards[1].card.getComponent(cc.Sprite).spriteFrame=c,this.cards[0].card.active=!1,this.cards[1].card.active=!1,this.showOneCard(!0),this.showTowCard(!0);var m=cc.moveTo(.5,cc.p(l.x,this.cards[1].card.parent.getPositionY())),p=cc.moveTo(.5,cc.p(h.x,this.cards[0].card.parent.getPositionY())),g=this.cards[0].card,f=this.cards[1].card,y=cc.callFunc(function(){g.active=!0,a.showOneCard(!1)},this),v=cc.callFunc(function(){f.active=!0,a.showTowCard(!1)},this),C=cc.callFunc(function(){a.removeAllCards()},this),D=cc.sequence(m,y,C),_=cc.sequence(p,v,C);return this.oneCard.runAction(D),this.towCard.runAction(_),!0}return!1},removeAllCards:function(){0<this.cards.length&&this.cards.splice(0,this.cards.length)},removeAllCardsList:function(){0<this.cardList.length&&this.cardList.splice(0,this.cardList.length)},removeCardListByValue:function(e){for(var t=0;t<this.cardList.length;t++)if(this.cardList[t]==e)return this.cardList.splice(t,1),!1;return this.cardList[this.cardList.length]=e,!0},setCardStatus:function(e){e.getComponent(cc.Sprite).spriteFrame&&(0==e.getComponent("SSSCard").isSelect?(0==e.getComponent("SSSCard").isChange?(this.removeCardListByValue(e.getComponent("SSSCard").id),this.showCardMask(e,!0)):1==e.getComponent("SSSCard").isChange&&this.showCardMask(e,!0),e.getComponent("SSSCard").isSelect=!0):1==e.getComponent("SSSCard").isSelect&&(0==e.getComponent("SSSCard").isChange?(this.removeCardListByValue(e.getComponent("SSSCard").id),this.showCardMask(e,!0)):1==e.getComponent("SSSCard").isChange&&this.showCardMask(e,!1),e.getComponent("SSSCard").isSelect=!1))},reSetCardsStatus:function(){for(var e=this.cardHand.parent,t=cc.find("cardType",e),a=cc.find("upCardNode",t),n=cc.find("midCardNode",t),i=cc.find("downCardNode",t),o=0;o<3;o++){var r=cc.find("card"+o,a);this.showCardMask(r,!1)}for(o=0;o<5;o++){var s=cc.find("card"+o,n),c=cc.find("card"+o,i);this.showCardMask(s,!1),this.showCardMask(c,!1)}}});t.exports=i,cc._RF.pop()},{SoundMngr:"SoundMngr"}],SSSChatPanel:[function(e,t,a){"use strict";cc._RF.push(t,"0d7e6361OtHApblT5I8PbVU","SSSChatPanel");var o=e("gameDefine");cc.Class({extends:cc.Component,properties:{emoScrollView:cc.ScrollView,wordScrollView:cc.ScrollView,wordItem:cc.Node,chatInput:cc.EditBox,sendBtn:cc.Button,emoBtn:cc.Button,wordBtn:cc.Button,emoSprite:cc.Sprite,wordSprite:cc.Sprite,chatAnimationPrefab:cc.Prefab},onLoad:function(){this.emoContent=this.emoScrollView.content,this.wordContent=this.wordScrollView.content,this.initAnimationItems(),this.initFastVoiceItems(),this.onWordButton(),this.emoScrollView.node.off(cc.Node.EventType.TOUCH_START,this.emoScrollView._onTouchMoved,this.emoScrollView,!0),this.emoScrollView.node.off(cc.Node.EventType.TOUCH_MOVE,this.emoScrollView._onTouchMoved,this.emoScrollView,!0),this.emoScrollView.node.off(cc.Node.EventType.TOUCH_END,this.emoScrollView._onTouchMoved,this.emoScrollView,!0),this.emoScrollView.node.off(cc.Node.EventType.TOUCH_CANCEL,this.emoScrollView._onTouchMoved,this.emoScrollView,!0),this.wordScrollView.node.off(cc.Node.EventType.TOUCH_START,this.wordScrollView._onTouchMoved,this.wordScrollView,!0),this.wordScrollView.node.off(cc.Node.EventType.TOUCH_MOVE,this.wordScrollView._onTouchMoved,this.wordScrollView,!0),this.wordScrollView.node.off(cc.Node.EventType.TOUCH_END,this.wordScrollView._onTouchMoved,this.wordScrollView,!0),this.wordScrollView.node.off(cc.Node.EventType.TOUCH_CANCEL,this.wordScrollView._onTouchMoved,this.wordScrollView,!0)},initAnimationItems:function(){for(var e=0;e<16;e++){var t=this.emoContent.children[e];null==t&&(t=cc.instantiate(this.chatAnimationPrefab),this.emoContent.addChild(t)),t.x=e%4*120-175,t.y=-130-130*parseInt(e/4);var a=t.getComponent(cc.Animation);if(e<16){var n=a.getClips()[e].name;t.name=n,a.play(n),t.on(cc.Node.EventType.TOUCH_END,this.onEmoClick,this)}}},initFastVoiceItems:function(){var e=["想跑了是吧，全国都解放了。","楞嘛神儿！相面那。","嘛钱不钱的乐呵乐呵得了。","好嘛！一把十三不靠。","会玩儿嘛！竟放生张儿。","混儿都将了啊。"],t=["card_K_1","card_K_2","card_K_3","card_K_4","card_K_5","card_K_6"];for(var a in GameData.client.gameType==o.GameType.Game_Mj_Shishi?e=["你们都是哪里的人呀？","来来来，血战到天明！","哈哈，上来就可以游金啦！","今天让你们输到不敢在玩麻将！","快点出牌，等的花儿都谢了","老人打牌比你打的都快！"]:GameData.client.gameType==o.GameType.Game_Poker_13shui&&(e=["大家好，很高兴见到各位！","和你合作真是太愉快了。","快点儿啊！都等得我花都谢了。","你的牌打得也忒儿好咧！","不要吵了，专心玩游戏吧。","又断线了， 网络怎么这么差啊。","各位真不好意思，我要离开一会儿。","不要走，决战到天亮。"],t=["Chat_0","Chat_1","Chat_2","Chat_3","Chat_4","Chat_5","Chat_6","Chat_7","Chat_8","Chat_9","Chat_10"]),this.wordContent.children){this.wordContent.children[a].active=!1}this.wordContent.height=650;for(var n=0;n<e.length;n++){var i=this.wordContent.children[n];null==i&&((i=cc.instantiate(this.wordItem)).parent=this.wordContent,i.x=this.wordItem.x,i.y=this.wordItem.y-(this.wordItem.height+20)*n),i.active=!0,cc.find("label",i).getComponent(cc.Label).string=e[n],i.getComponent("SSSFastVoiceButton").sound=t[n]}},onWordButton:function(){this.wordScrollView.node.active=!0,this.emoScrollView.node.active=!1,this.wordSprite.node.active=!0,this.emoSprite.node.active=!1,this.wordBtn.node.active=!1,this.emoBtn.node.active=!0},onEmoButton:function(){this.wordScrollView.node.active=!1,this.emoScrollView.node.active=!0,this.wordSprite.node.active=!1,this.emoSprite.node.active=!0,this.wordBtn.node.active=!0,this.emoBtn.node.active=!1},onEmoClick:function(e){cc.log("on emo click : "+e.target.name);var t=e.target.name;ChatHandler.getInstance().requestChat("emo",t,function(e){}),closeSSSView(this.node.name)},onSendButton:function(){""!=this.chatInput.string&&(ChatHandler.getInstance().requestChat("word",this.chatInput.string,function(e){}),this.chatInput.string="",closeSSSView(this.node.name))},onClose:function(){closeSSSView(this.node.name)}}),cc._RF.pop()},{gameDefine:"gameDefine"}],SSSCreateRoom:[function(e,t,a){"use strict";cc._RF.push(t,"97914sXMyVLLY0rw/anRdum","SSSCreateRoom");e("roomHandler");var n=e("gameDefine"),i=e("configMgr");cc.Class({extends:cc.Component,properties:{playerNum2:{default:null,type:cc.Toggle},playerNum3:{default:null,type:cc.Toggle},playerNum4:{default:null,type:cc.Toggle},playerNum5:{default:null,type:cc.Toggle},owner:{default:null,type:cc.Toggle},AA:{default:null,type:cc.Toggle},seconds30:{default:null,type:cc.Toggle},minute1:{default:null,type:cc.Toggle},minute5:{default:null,type:cc.Toggle},unlimited:{default:null,type:cc.Toggle},round15:{default:null,type:cc.Toggle},round30:{default:null,type:cc.Toggle},round45:{default:null,type:cc.Toggle},round60:{default:null,type:cc.Toggle},round75:{default:null,type:cc.Toggle}},onLoad:function(){this.refreshUi()},createRoom:function(){GameData.setGameType(n.GameType.Game_Poker_13shui),this.saveRuleFromUi();var e={gameType:GameType.Game_Poker_13shui,costType:GameData13.createRoomOpts.payType,joinermax:GameData13.createRoomOpts.joinermax,limitTime:GameData13.createRoomOpts.limiteTime,roundmax:GameData13.createRoomOpts.roundmax,roundRule:1,roomType:0,clubId:0,currencyType:null,settleType:null},t=i.getModeType();return null==t||null==t.Game_Poker_13shui||(e.currencyType=t.Game_Poker_13shui.CurrencyType,e.settleType=t.Game_Poker_13shui.SettleType),e},saveRuleFromUi:function(){this.round15.isChecked?GameData13.createRoomOpts.roundmax=15:this.round30.isChecked?GameData13.createRoomOpts.roundmax=30:this.round45.isChecked?GameData13.createRoomOpts.roundmax=45:this.round60.isChecked?GameData13.createRoomOpts.roundmax=60:this.round75.isChecked?GameData13.createRoomOpts.roundmax=75:GameData13.createRoomOpts.roundmax=15,this.playerNum2.isChecked?GameData13.createRoomOpts.joinermax=2:this.playerNum3.isChecked?GameData13.createRoomOpts.joinermax=3:this.playerNum4.isChecked?GameData13.createRoomOpts.joinermax=4:this.playerNum5.isChecked?GameData13.createRoomOpts.joinermax=5:GameData13.createRoomOpts.joinermax=2,this.seconds30.isChecked?GameData13.createRoomOpts.limiteTime=30:this.minute1.isChecked?GameData13.createRoomOpts.limiteTime=60:this.minute5.isChecked?GameData13.createRoomOpts.limiteTime=300:this.unlimited.isChecked?GameData13.createRoomOpts.limiteTime=0:GameData13.createRoomOpts.limiteTime=30,this.owner.isChecked?GameData13.createRoomOpts.payType=1:this.AA.isChecked?GameData13.createRoomOpts.payType=2:GameData13.createRoomOpts.payType=1,GameData13.saveCreateRoomOpts()},refreshUi:function(){this.round15.isChecked=15==GameData13.createRoomOpts.roundmax,this.round30.isChecked=30==GameData13.createRoomOpts.roundmax,this.round45.isChecked=45==GameData13.createRoomOpts.roundmax,this.round60.isChecked=60==GameData13.createRoomOpts.roundmax,this.round75.isChecked=75==GameData13.createRoomOpts.roundmax,this.playerNum2.isChecked=2==GameData13.createRoomOpts.joinermax,this.playerNum3.isChecked=3==GameData13.createRoomOpts.joinermax,this.playerNum4.isChecked=4==GameData13.createRoomOpts.joinermax,this.playerNum5.isChecked=5==GameData13.createRoomOpts.joinermax,this.seconds30.isChecked=30==GameData13.createRoomOpts.limiteTime,this.minute1.isChecked=60==GameData13.createRoomOpts.limiteTime,this.minute5.isChecked=300==GameData13.createRoomOpts.limiteTime,this.unlimited.isChecked=0==GameData13.createRoomOpts.limiteTime}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],SSSDebug:[function(e,t,a){"use strict";cc._RF.push(t,"85e35w/d1xC5bMsIzIZS9iE","SSSDebug");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{debugNode:{default:null,type:cc.Node},editCards:cc.EditBox,cardInput:cc.EditBox,parents:{default:[],type:cc.Node},debugBtn:cc.Node,cardType:{default:null,type:cc.Node}},onLoad:function(){var e=n.getSetCardsOpen();this.debugBtn.active=e},onClose:function(){this.node.getComponent("SSSRoomMain").showDebugLayer()},onSetCards:function(){var t=this,e=this.editCards.string.split(",");cc.log("debug str: ",JSON.stringify(e));for(var a=[],n=0;n<e.length&&!(n>=GameData13.handSize);n++){var i=parseInt(e[n])%10,o=Math.floor(parseInt(e[n])/10);a.push({type:i,value:o-1})}if(cc.log("debug cards: ",JSON.stringify(a)),0<cardPoker13.up.length){var r=cc.find("upCardNode",this.cardType);t.debugNode.parent.getComponent("SSSRoomTable").setResetCard(r,"up")}if(0<cardPoker13.mid.length){r=cc.find("midCardNode",this.cardType);t.debugNode.parent.getComponent("SSSRoomTable").setResetCard(r,"mid")}if(0<cardPoker13.down.length){r=cc.find("downCardNode",this.cardType);t.debugNode.parent.getComponent("SSSRoomTable").setResetCard(r,"down")}cardPoker13.up.length<=0||cardPoker13.mid.length<=0||cardPoker13.down.length<=0?GameNet.getInstance().request("game.debugHandler.setCards",{roomid:GameData.player.roomid,cards:a},function(e){t.debugNode.parent.getComponent("SSSRoomTable").checkedRecommendManner(),t.debugNode.parent.getComponent("SSSRoomTable").showSpecialType(GameData13.player.type),cc.log("debug rtn: ",JSON.stringify(e))}):cc.log("没有重置上面三墩的牌，不能设置测试牌")},testAllCardShow:function(){},testHand:function(e){},testDis:function(e){},testPeng:function(e){},showCardContent:function(e,t,a){}}),cc._RF.pop()},{configMgr:"configMgr"}],SSSFastVoiceButton:[function(e,t,a){"use strict";cc._RF.push(t,"c647bmZ9LBNbKcehX+yQ+A6","SSSFastVoiceButton"),cc.Class({extends:cc.Component,properties:{sound:"null"},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_END,this.onClick,this)},onClick:function(){var e=cc.find("label",this.node).getComponent(cc.Label).string;ChatHandler.getInstance().requestChat("fast",{sound:this.sound,content:e},function(e){}),closeSSSView("SSSChatPanel")}}),cc._RF.pop()},{}],SSSHideComponent:[function(e,t,a){"use strict";cc._RF.push(t,"29f79HsYmdJX5dy1LboeqKS","SSSHideComponent"),cc.Class({extends:cc.Component,properties:{delay:3},onLoad:function(){},show:function(e){this.node.active=!0,this.unschedule(this.gotoHide),this.scheduleOnce(this.gotoHide,e)},gotoHide:function(){this.node.active=!1}}),cc._RF.pop()},{}],SSSHome:[function(e,t,a){"use strict";cc._RF.push(t,"6804fQpQHJK44XwemEyFeqa","SSSHome");e("SoundMngr");cc.Class({extends:cc.Component,properties:{homeNode:{default:null,type:cc.Node},createRoomNode:{default:null,type:cc.Node},joinRoomNode:{default:null,type:cc.Node},headNode:{default:null,type:cc.Node},playerId:{default:null,type:cc.Label},playerName:{default:null,type:cc.Label},roomCardNum:{default:null,type:cc.Label},createBtn:{default:null,type:cc.Button},joinBtn:{default:null,type:cc.Button},roomCardAddBtn:{default:null,type:cc.Button},paoMaDengContent:{default:null,type:cc.Node},paoMaDengStr:{default:null,type:cc.Node},room_number:cc.String,room_number_bg:{default:null,type:cc.Sprite}},onLoad:function(){this.showPlayer(),this.runPaoMaDeng()},showPlayer:function(){this.playerId.string="ID:"+GameData.player.uid;for(var e=0;e<GameData13.joiners.length;e++)if(GameData.player.uid==GameData13.joiners[e].uid){isChinese(GameData13.joiners[e].name)?this.playerName.string=getShortStr(GameData13.joiners[e].name,5):isChinese(GameData13.joiners[e].name)||(this.playerName.string=getShortStr(GameData13.joiners[e].name,10));break}},onCreateRoomClicked:function(e){this.createRoomNode.active=!0},onJoinRoomClicked:function(e){cc.director.loadScene("home")},onBackToHome:function(e){this.createRoomNode.active=!1},runPaoMaDeng:function(){var t=this;this.paoMaDengAction(5),this.schedule(function(e){t.paoMaDengAction(5)},7)},paoMaDengAction:function(e){this.paoMaDengStr.x=this.paoMaDengContent.getContentSize().width/2+10;this.paoMaDengStr.getComponent(cc.Label).string=GameData.configData.content;var t=0-(this.paoMaDengContent.getContentSize().width/2+10+this.paoMaDengStr.getContentSize().width),a=cc.moveTo(e,cc.p(t,this.paoMaDengStr.getPositionY()));this.paoMaDengStr.runAction(a)}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],SSSPlayerChat:[function(e,t,a){"use strict";cc._RF.push(t,"bb7eaZ/i8xIaLXwnzjsla1a","SSSPlayerChat");var g=e("SoundMngr");cc.Class({extends:cc.Component,properties:{left_node:cc.Node,right_node:cc.Node},onLoad:function(){},playChat:function(e,t,a,n){var i;switch(this.left_node.active=!1,this.right_node.active=!1,t){case"left":i=this.left_node;break;case"right":i=this.right_node}if(null!=i){i.active=!0;var o=cc.find("word",i),r=cc.find("emo",i),s=cc.find("yuyinNode",i);if("word"==a){var c=e.detail.msg.data,d=cc.find("word/bg",i),h=cc.find("word/Label",i).getComponent(cc.Label),l=c;d.width=20+24*l.length,o.getComponent("SSSHideComponent").show(3),h.string=l}else if("fast"==a){var u=e.detail.msg.data.sound;c=e.detail.msg.data.content,d=cc.find("word/bg",i),h=cc.find("word/Label",i).getComponent(cc.Label),l=getShortStr(c,10);d.width=30*l.length,o.getComponent("SSSHideComponent").show(3),h.string=l,g.instance.playAudioChat(u,n)}else if("emo"==a){var m=e.detail.msg.data;r.getComponent(cc.Animation).play(m),r.getComponent("SSSHideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var p=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",p):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(p)),cc.find("yuyinAnimNode/yuyinAnim",s).getComponent(cc.Animation).play("yuyinduihua"),s.getComponent("SSSHideComponent").show(3)}}}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],SSSPromptCard:[function(e,t,a){"use strict";cc._RF.push(t,"fb36fU2SohMhqNcdh0hQdUD","SSSPromptCard");var n=e("SoundMngr"),i=cc.Class({extends:cc.Component,properties:{cardHand:{default:null,type:cc.Node}},onLoad:function(){WriteLog("SSSPromptCard onLoad"),this._pokerDuiZiIndex=0,this._pokerLiangDuiIndex=0,this._pokerSanTiaoIndex=0,this._pokerTongHuaIndex=0,this._pokerShunZiIndex=0,this._pokerHuLuIndex=0,this._pokerTongHuaShunIndex=0,this._pokerTieZhiIndex=0,this._pokerWuTongIndex=0},onDestroy:function(){WriteLog("SSSPromptCard onDestroy")},initPromptData:function(e,t){this._pokerDuiZiIndex=0,this._pokerLiangDuiIndex=0,this._pokerSanTiaoIndex=0,this._pokerTongHuaIndex=0,this._pokerShunZiIndex=0,this._pokerHuLuIndex=0,this._pokerTongHuaShunIndex=0,this._pokerTieZhiIndex=0,this._pokerWuTongIndex=0,this._cardHandList=t,this._pokerTypeObj=e},initCardStatus:function(){for(var e=0;e<this.cardHand.childrenCount;e++){var t=cc.find("card"+e,this.cardHand),a=t.getComponent("SSSCard");(a.isSelect=!0)&&(a.isSelect=!1,t.y=0)}},clearArray:function(e){0<e.length&&e.splice(0,e.length)},sortArray:function(e){for(var t=[],a=0;a<e.length;a++)t.push(e[a]);for(a=0;a<t.length;a++)t[a].value=50*t[a].value,t[a].type=t[a].value+t[a].type;t.sort(function(e,t){return t.type-e.type});for(a=0;a<t.length;a++)t[a].type=t[a].type-t[a].value,t[a].value=t[a].value/50;this.clearArray(e);for(a=0;a<t.length;a++)e.push(t[a])},isSameCard:function(e){for(var t=0,a=0;a<e.length;a++){for(var n=e[a],i=0;i<e.length;i++)n.value==e[i].value&&n.type==e[i].type&&t++;if(2<=t)return!0}return!1},isSameArray:function(e,t){if(this.sortArray(e),this.sortArray(t),e.length!=t.length)return!1;for(var a=0;a<e.length;a++)if(e[a].value!=t[a].value||e[a].type!=t[a].type)return!1;return!0},repetCard:function(e,t){for(var a=!1,n=0;n<t.length;n++)if(t[n]==e){a=!0;break}return a},AvoidDuplicateCardType:function(e,t,a,n){var i=e-1;return 0<=i&&this.isSameArray(this._pokerTypeObj[a][i],t)?(++e==this._pokerTypeObj[a].length&&(e=0),t=this._pokerTypeObj[a][e],n(),t):null},checkedCard:function(e,t,a){return a?!!a&&(!this.repetCard(t,e)&&(cc.find("card"+t,this.cardHand).getComponent("SSSCard").isSelect=!0,e.push(t),!0)):(cc.find("card"+t,this.cardHand).getComponent("SSSCard").isSelect=!0,e.push(t),!0)},checkedCardType:function(e,t,a){var n,i=!1,o=[];this.initCardStatus(),e==this._pokerTypeObj[t].length?(e=0,n=this._pokerTypeObj[t][e],this.AvoidDuplicateCardType(e,n,t,a)&&(n=this.AvoidDuplicateCardType(e,n,t,a))):e<this._pokerTypeObj[t].length&&(n=this._pokerTypeObj[t][e],this.AvoidDuplicateCardType(e,n,t,a)&&(n=this.AvoidDuplicateCardType(e,n,t,a))),this.isSameCard(n)&&(i=!0);for(var r=0;r<n.length;r++)for(var s=n[r],c=0;c<this._cardHandList.length;c++){var d=this._cardHandList[c];if(s.value==d.value&&s.type==d.type){if(this.checkedCard(o,c,i))break;if(!this.checkedCard(o,c,i))continue}}var h=cc.find("card0",this.cardHand).getComponent("SSSCard");h.setCardList(o),h.bounceCard(),cc.log("cardIdArr: ",o)},checkedDuiZi:function(e){var t=this;this.checkedCardType(this._pokerDuiZiIndex,RecommendType.DuiZi,function(){t._pokerDuiZiIndex++}),this._pokerDuiZiIndex++,this._pokerDuiZiIndex>=this._pokerTypeObj[RecommendType.DuiZi].length&&(this._pokerDuiZiIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedLiangDui:function(e){var t=this;this.checkedCardType(this._pokerLiangDuiIndex,RecommendType.LiangDui,function(){t._pokerLiangDuiIndex++}),this._pokerLiangDuiIndex++,this._pokerLiangDuiIndex>=this._pokerTypeObj[RecommendType.LiangDui].length&&(this._pokerLiangDuiIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedSanTiao:function(e){var t=this;this.checkedCardType(this._pokerSanTiaoIndex,RecommendType.SanTiao,function(){t._pokerSanTiaoIndex++}),this._pokerSanTiaoIndex++,this._pokerSanTiaoIndex>=this._pokerTypeObj[RecommendType.SanTiao].length&&(this._pokerSanTiaoIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedShunZi:function(e){var t=this;this.checkedCardType(this._pokerShunZiIndex,RecommendType.ShunZi,function(){t._pokerShunZiIndex++}),this._pokerShunZiIndex++,this._pokerShunZiIndex>=this._pokerTypeObj[RecommendType.ShunZi].length&&(this._pokerShunZiIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedTongHua:function(e){var t=this;this.checkedCardType(this._pokerTongHuaIndex,RecommendType.TongHua,function(){t._pokerTongHuaIndex++}),this._pokerTongHuaIndex++,this._pokerTongHuaIndex>=this._pokerTypeObj[RecommendType.TongHua].length&&(this._pokerTongHuaIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedHuLu:function(e){var t=this;this.checkedCardType(this._pokerHuLuIndex,RecommendType.HuLu,function(){t._pokerHuLuIndex++}),this._pokerHuLuIndex++,this._pokerHuLuIndex>=this._pokerTypeObj[RecommendType.HuLu].length&&(this._pokerHuLuIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedTongHuaShun:function(e){var t=this;this.checkedCardType(this._pokerTongHuaShunIndex,RecommendType.TongHuaShun,function(){t._pokerTongHuaShunIndex++}),this._pokerTongHuaShunIndex++,this._pokerTongHuaShunIndex>=this._pokerTypeObj[RecommendType.TongHuaShun].length&&(this._pokerTongHuaShunIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedTieZhi:function(e){var t=this;this.checkedCardType(this._pokerTieZhiIndex,RecommendType.TieZhi,function(){t._pokerTieZhiIndex++}),this._pokerTieZhiIndex++,this._pokerTieZhiIndex>=this._pokerTypeObj[RecommendType.TieZhi].length&&(this._pokerTieZhiIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)},checkedWuTong:function(e){var t=this;this.checkedCardType(this._pokerWuTongIndex,RecommendType.WuTong,function(){t._pokerWuTongIndex++}),this._pokerWuTongIndex++,this._pokerWuTongIndex>=this._pokerTypeObj[RecommendType.WuTong].length&&(this._pokerWuTongIndex=0),n.instance.playSSSAudio(SSS_AudioType.SAT_1)}});t.exports=i,cc._RF.pop()},{SoundMngr:"SoundMngr"}],SSSRoomDissolve:[function(e,t,a){"use strict";cc._RF.push(t,"cecede67mVNKoD1ejUR20se","SSSRoomDissolve");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("13-GameEnd",this,this.showGameResult),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),this.lastTimeLabel.string="",this.showDissolveText()},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("13-GameEnd",this,this.showGameResult),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=this.headerNode.parent,t=this.headerNode.x,a=this.headerNode.y,n=250,i=1,o=2;o<=GameData13.room.joinermax;o++){var r="header_"+o,s=e.getChildByName(r);null==s&&((s=cc.instantiate(this.headerNode)).name=r,s.parent=e,3<o&&(t=this.headerNode.x+150,a=this.headerNode.y-120,n=200,i=4),s.x=t+n*(o-i),s.y=a),s.active=!1}this.resetUI()},showPlayers:function(){if(GameData13.room.joinermax){for(var e=1;e<=GameData13.joiners.length;e++){cc.find("header_"+e,this.headerNode.parent).active=!0}for(var t=1;t<=GameData13.room.joinermax;t++){var a=t,n=GameData13.joiners[t-1];if(null!=n){var i=n.uid,o=n.headimgurl;this.showHeaderIcon(a,o),this.showHeaderName(a,n.name),this.showHeaderId(a,i);var r=!1;GameData13.owner==i&&(r=!0),this.showMainFlag(a,r),r=!1,2==n.status&&(r=!0),this.showLostImg(a,r)}}}},showHeaderName:function(e,t){var a=cc.find("header_"+e+"/nameLabel",this.headerNode.parent);a&&(a.getComponent(cc.Label).string=getShortStr(t,4))},showHeaderId:function(e,t){var a=cc.find("header_"+e+"/idLabel",this.headerNode.parent);a&&(a.getComponent(cc.Label).string=t)},showAgreeIcon:function(e,t){var a=cc.find("header_"+e+"/duigou",this.headerNode.parent);a&&(a.active=t)},showMainFlag:function(e,t){var a=cc.find("header_"+e+"/fangzhu",this.headerNode.parent);a&&(a.active=t)},showLostImg:function(e,t){var a=cc.find("header_"+e+"/lost",this.headerNode.parent);a&&(a.active=t)},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeBtn.active=e,this.disAgreeBtn.active=e},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData13.room.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(){var e,t=GameData.game.onRoomDissolve,a=0,n=0;for(var i in this.isDis=t.isStart,this.resetUI(),this.showPlayers(),this.alreadyAgree(!0),cc.log("..select:"+JSON.stringify(GameData.game.onRoomDissolve)),GameData.game.onRoomDissolve.select){for(var o=0,r=0;r<GameData13.joiners.length;r++){if((c=GameData13.joiners[r]).uid==i){o=r+1;break}}if("apply"==GameData.game.onRoomDissolve.select[i]){"申请解散房间";for(r=0;r<GameData13.joiners.length;r++){(c=GameData13.joiners[r]).uid==i&&(this.dissolvePerson.string="["+c.name+"]发起投票解散对局")}n++,this.showAgreeIcon(o,!0),i==GameData.player.uid&&(this.agreeWaitNode.active=!0)}else if("agree"==GameData.game.onRoomDissolve.select[i])n++,"同意解散房间",this.showAgreeIcon(o,!0),i==GameData.player.uid&&(this.agreeWaitNode.active=!0);else if("disagree"==GameData.game.onRoomDissolve.select[i]){if("拒绝解散房间",a++,i!=GameData.player.uid)for(var s=0;s<GameData13.joiners.length;s++){var c;if((c=GameData13.joiners[s]).uid==i){var d=c.name;poker13MessageBox("因［"+d+"］拒绝解散房间，游戏需继续进行","","",function(){}),this.agreeWaitNode.active=!1}}break}"agree"!=GameData.game.onRoomDissolve.select[i]&&"apply"!=GameData.game.onRoomDissolve.select[i]||i!=GameData.player.uid||this.alreadyAgree(!1)}1<=a?cc.find("layer_dissolve",this.node).active=!1:(2==GameData13.room.joinermax?e=GameData13.room.joinermax:2<GameData13.room.joinermax&&(e=parseInt(GameData13.room.joinermax/2)+1),n==e&&(GameData.player.roomid=void 0),this.node.getComponent("SSSRoomMain").showdissolveLayer(),this.handleVoteResult(this.isDis),this.handleRoomDisbandTimer(t))},showGameResult:function(e){0==this.isDis&&(cc.log("gemaEndResult: ",JSON.stringify(GameData13.gemaEndResult)),GameData13.isEmptyObject(GameData13.gemaEndResult)?GameData13.isEmptyObject(GameData13.gemaEndResult)&&(GameData13.clearObject(GameData.game.onRoomDissolve)?cc.log("对象已清空"):cc.log("对象没有清空"),GameData13.clearAllGameData(),cc.director.loadScene("home")):(GameData.SetLayerData.soundOpen=!1,this.node.getComponent("SSSRoomMain").showSummaryLayer(),GameData13.clearObject(GameData.game.onRoomDissolve)?cc.log("对象已清空"):cc.log("对象没有清空")))},requestDissolveAgree:function(){n.deleteRoom(GameData.player.roomid,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.player.roomid,"disagree")},handleVoteResult:function(e){0==e&&(this.unschedule(this.updateLastTime),0==GameData13.game.start&&(GameData13.clearObject(GameData.game.onRoomDissolve)?cc.log("对象已清空"):cc.log("对象没有清空"),GameData13.clearAllGameData(),cc.director.loadScene("home")))},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.player.roomid,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData13.joiners.length;a++){var n=GameData13.joiners[a],i=a+1;if(n.uid==e)return n.status=0,void this.showLostImg(i,t)}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],SSSRoomMain:[function(e,t,a){"use strict";cc._RF.push(t,"42615aBtMxHvZlm6NI5DVCf","SSSRoomMain");var i=e("SoundMngr"),n=e("gameDefine");cc.Class({extends:cc.Component,properties:{dissolveLayer:{default:null,type:cc.Node},summaryLayer:{default:null,type:cc.Node},settingLayer:{default:null,type:cc.Node},debugLayer:{default:null,type:cc.Node},playerHeadArray:{default:[],type:[cc.Node]},promptScrollView:{default:null,type:cc.ScrollView},talkBtn:cc.Button,yuyinNode:cc.Node,chatNode:cc.Prefab,prefabList:{default:[],type:[cc.Prefab]}},onLoad:function(){GameData.saveSetLayerData(),this.rotationScene(AutoScene.SCENE_HORIZONTAL),registEvent("onRoomChat",this,this.onSSSChatHandler),registEvent("onRoomDissolve",this,this.showdissolveLayer),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("yunwaUploaded",this,this.onYunwaUploaded);var n=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),inCD(3e3)||(yunwaStartTalk(),n.yuyinNode.active=!0,GameData.isPlayVioce=!0,n.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.parent.convertToNodeSpaceAR(t);(Math.abs(a.x-this.position.x)>this.width||Math.abs(a.y-this.position.y)>this.height)&&(n.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),yunwaStopTalk(),n.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,n.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.playerSex=1,i.instance.playMusic("shisanshui/sound/sss_table_bg1"),this.showdissolveLayer()},onDestroy:function(){unregistEvent("onRoomChat",this,this.onSSSChatHandler),unregistEvent("onCreatorQuit",this,this.onCreatorQuit)},rotationScene:function(e){WriteLog("rotationScene");var t=cc.director.getScene().getChildByName("Canvas"),a=t.getComponent(cc.Canvas);if(e==AutoScene.SCENE_HORIZONTAL){var n=cc.rotateTo(.1,-90),i=new cc.size(1280,720);a.designResolution=i,t.runAction(n),this.promptScrollView.horizontal=!1,this.promptScrollView.vertical=!0}else if(e==AutoScene.SCENE_VERTICAL){i=new cc.size(720,1280);a.designResolution=i,this.promptScrollView.horizontal=!0,this.promptScrollView.vertical=!1}this.changeRunlampPanel(e)},changeRunlampPanel:function(e){if(GameData.gameType==n.GameType.Game_Poker_13shui){var t=cc.director.getScene().getChildByName("lampNode").children;if(t.length<=0)return;if(1<GameData.serverNoticeData.length)t[0].getComponent("RunlampPanel1").changeRunlamp(e);else if(1==GameData.serverNoticeData.length){t[0].getComponent("RunlampPanel").changeRunlamp(e)}}},showPlayers:function(){this.tableNode.active=!0},showSettingLayer:function(e){i.instance.playSSSAudio(SSS_AudioType.SAT_1),openSSSView("SSSSettingsPanel")},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.game.onRoomDissolve={},GameData13.clearAllGameData(),GameData13.owner!=GameData.player.uid?poker13MessageBox("房主已经解散房间","","",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},showdissolveLayer:function(){var e=GameData.game.onRoomDissolve;if(Object.keys(e).length<=0)this.dissolveLayer.active=!1;else{var t=e.select;Object.keys(t).length<=0||null==t?this.dissolveLayer.active=!1:null==GameData.player.roomid||GameData.player.roomid<=0?this.dissolveLayer.active=!1:(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}))}},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),this.node.getComponent("SSSRoomTable").stopGameAction(),GameData.player.uid==GameData13.joiners[0].uid?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},onSSSChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData13.getPlayerSexByUid(t);for(var n=0;n<GameData13.joiners.length;n++)if(t==GameData13.joiners[n].uid){var i=GameData13.getPosition(GameData13.joiners[n].uid),o=this.playerHeadArray[i-1];if(null==o)continue;var r,s=o.getChildByName("chatNode");switch(null==s&&((s=cc.instantiate(this.chatNode)).name="chatNode",s.parent=o),i){case 1:case 2:case 4:r="right";break;case 3:case 5:r="left"}if(null==r)continue;s.getComponent("SSSPlayerChat").playChat(e,r,a,this.playerSex)}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},openChatPanel:function(){inCD(3e3)||openSSSView("SSSChatPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],SSSRoomTable:[function(e,t,a){"use strict";cc._RF.push(t,"ac1c25c8bNHna+u+BXIRxcb","SSSRoomTable");var g=e("SoundMngr"),n=(e("ruleHandler"),e("roomHandler")),s=e("../logic/poker13"),i=e("errorCode"),o=cc.Class({extends:cc.Component,properties:{tableNode:{default:null,type:cc.Node},player:{default:[],type:[cc.Node]},poker_1:{default:null,type:cc.Node},poker_2:{default:null,type:cc.Node},poker_3:{default:null,type:cc.Node},poker_4:{default:null,type:cc.Node},poker_5:{default:null,type:cc.Node},roomId:{default:null,type:cc.Node},roundNum:{default:null,type:cc.Node},setBtn:{default:null,type:cc.Button},chatBtn:{default:null,type:cc.Button},VChatBtn:{default:null,type:cc.Button},ruleBtn:{default:null,type:cc.Button},readyBtn:{default:null,type:cc.Node},quitBtn:{default:null,type:cc.Node},upResetBtn:{default:null,type:cc.Node},midResetBtn:{default:null,type:cc.Node},downResetBtn:{default:null,type:cc.Node},animation:{default:null,type:cc.Node},startAnimation:{default:null,type:cc.Node},up:{default:null,type:cc.Node},mid:{default:null,type:cc.Node},down:{default:null,type:cc.Node},allScore:{default:null,type:cc.Node},waitNode:{default:null,type:cc.Node},jettonNode:{default:null,type:cc.Node},jetton:{default:null,type:cc.Node},specialPlayerName:{default:null,type:cc.Label},neatenNode:{default:null,type:cc.Node},poker:{default:null,type:cc.Node},cardHand:{default:null,type:cc.Node},upCardNode:{default:null,type:cc.Node},midCardNode:{default:null,type:cc.Node},downCardNode:{default:null,type:cc.Node},nodeMask:{default:null,type:cc.Node},promptScrollView:{default:null,type:cc.Node},selection:{default:null,type:cc.Node},disCardBtn:{default:null,type:cc.Button},reelectBtn:{default:null,type:cc.Button},cardGroup:{default:null,type:cc.Node},timeNode:{default:null,type:cc.Node},peculiarBtn:{default:null,type:cc.Button},roomEndClear:{default:null,type:cc.Node},kaiguancao:cc.Node,kai:cc.Node,guan:cc.Node,timer:cc.Label},onLoad:function(){WriteLog("onLoad"),this.declareParam(),this.setMANNER(this._recommendManner.BTN_MANNER),this.readyBtnAndQuitBtnControl(),this.showPlayers(),this.showReady(),registEvent("13-RoomBaseInfo",this,this.showPlayers),registEvent("13-GameStart",this,this.showCards),registEvent("onRoomReadyInfo",this,this.showReadyInfo),registEvent("13-ShowReadyUI",this,this.showReady),registEvent("13-PlayerCards",this,this.refreshCard),registEvent("13-RoomResult",this,this.showRoomResult),registEvent("13-Discard",this,this.showDisCardReady),registEvent("13-GameEnd",this,this.showGameEnd),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("13-DiscardInfo",this,this.showConnectDisCardInfo),registEvent("13-SelfDiscard",this,this.showConnectDisCard),registEvent("againReady",this,this.againReady),this.onShow()},onShow:function(){WriteLog("onShow"),this.clearArray(cardPoker13.up),this.clearArray(cardPoker13.mid),this.clearArray(cardPoker13.down),this.showPeculiarBtn(!1),this.showWaitNode(!0),this.showUpResetBtn(!1),this.showMidResetBtn(!1),this.showDownResetBtn(!1),this.showNeatenNode(!1),this.showRoomEndClear(!1),this.registTouchEvent(),this.setRoundNum(),this.connectRecurrence(),this._playerSex=GameData13.getPlayerSexByUid(GameData.player.uid),cc.find("disCard",this.poker_1).y=this._disCardNodePosYList[0]},onDestroy:function(){WriteLog("onDestroy"),unregistEvent("13-RoomBaseInfo",this,this.showPlayers),unregistEvent("13-GameStart",this,this.showCards),unregistEvent("onRoomReadyInfo",this,this.showReadyInfo),unregistEvent("13-ShowReadyUI",this,this.showReady),unregistEvent("13-PlayerCards",this,this.refreshCard),unregistEvent("13-RoomResult",this,this.showRoomResult),unregistEvent("13-Discard",this,this.showDisCardReady),unregistEvent("13-GameEnd",this,this.showGameEnd),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("13-DiscardInfo",this,this.showConnectDisCardInfo),unregistEvent("13-SelfDiscard",this,this.showConnectDisCard),unregistEvent("againReady",this,this.againReady),this.unregistTouchEvent()},registTouchEvent:function(){this.promptScrollView.on("touch-up",this.lightFrame,this),this.upCardNode.on(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.upCardNode.on(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.upCardNode.on(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.midCardNode.on(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.midCardNode.on(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.midCardNode.on(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.downCardNode.on(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.downCardNode.on(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.downCardNode.on(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.kaiguancao.on(cc.Node.EventType.TOUCH_START,this.onPauseEvent,this),this.kaiguancao.on(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.kaiguancao.on(cc.Node.EventType.TOUCH_END,function(){},this),this.neatenNode.on(cc.Node.EventType.TOUCH_START,function(){},this),this.neatenNode.on(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.neatenNode.on(cc.Node.EventType.TOUCH_END,function(){},this),this.roomEndClear.on(cc.Node.EventType.TOUCH_START,function(){},this),this.roomEndClear.on(cc.Node.EventType.TOUCH_START,function(){},this),this.roomEndClear.on(cc.Node.EventType.TOUCH_START,function(){},this),this.nodeMask.on(cc.Node.EventType.TOUCH_START,function(){},this),this.nodeMask.on(cc.Node.EventType.TOUCH_START,function(){},this),this.nodeMask.on(cc.Node.EventType.TOUCH_START,function(){},this)},unregistTouchEvent:function(){this.promptScrollView.off("touch-up",this.lightFrame,this),this.upCardNode.off(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.upCardNode.off(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.upCardNode.off(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.midCardNode.off(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.midCardNode.off(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.midCardNode.off(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.downCardNode.off(cc.Node.EventType.TOUCH_START,this.startTouch,this),this.downCardNode.off(cc.Node.EventType.TOUCH_MOVE,this.moveTouch,this),this.downCardNode.off(cc.Node.EventType.TOUCH_END,this.endTouch,this),this.kaiguancao.off(cc.Node.EventType.TOUCH_START,this.onPauseEvent,this),this.kaiguancao.off(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.kaiguancao.off(cc.Node.EventType.TOUCH_END,function(){},this),this.neatenNode.off(cc.Node.EventType.TOUCH_START,function(){},this),this.neatenNode.off(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.neatenNode.off(cc.Node.EventType.TOUCH_END,function(){},this),this.roomEndClear.off(cc.Node.EventType.TOUCH_START,function(){},this),this.roomEndClear.off(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.roomEndClear.off(cc.Node.EventType.TOUCH_END,function(){},this),this.nodeMask.off(cc.Node.EventType.TOUCH_START,function(){},this),this.nodeMask.off(cc.Node.EventType.TOUCH_MOVE,function(){},this),this.nodeMask.off(cc.Node.EventType.TOUCH_END,function(){},this)},declareParam:function(){this._playerSex=0,this._handSize=GameData13.handSize,this._cardHandList=[],this._lastCardHand=[],this._checkedCardList=[],this._cardRowList=[[],[],[]],this._groupTypeList=[],this._firstScrollViewPos=0,this._specialTypeOfPlayer=0,this._specialNum=0,this._playSpecialNum=0,this._roundAllScore=0,this._quanLeiDaGunScore=0,this._gunNum=0,this._shootCount=0,this._specialAnimation,this._playQuanLeiDaNum=0,this._jettonIndex=0,this._jettonCount=14,this._winnerIndex=0,this._gunAnimation,this._gunPlayerUid=[],this._holeList=[],this._winnerToLoser={winner:[],loser:[]},this._gameTimer,this._disCardFunc,this._clearFunc,this._readyFunc,this._isDisCardEnd=!1,this._isBiPaiEnd=!1,this._isGunEnd=!1,this._isSpecialEnd=!1,this._isClearEnd=!1,this._isLoserClear=!0,this._isWinnerClear=!0,this._isQuanLeiDa=!1,this._jettonList=[],this._disCardNodePosYList=[-25,-10,-10,-2,-7],this._specialName=["couyise","liuduiban","quanda","quanxiao","sanhuangwudi","sanshunzi","santonghua","santonghuashun","shierhuangzu","wuduisantiao"],this._recommendManner={SCROLL_MANNER:"scrollManner",BTN_MANNER:"btnManner"},this._MANNER},initParam:function(){this.showPeculiarBtn(!1),this.showWaitNode(!1),this.showUpResetBtn(!1),this.showMidResetBtn(!1),this.showDownResetBtn(!1),this.setRoundNum(),this.concealAllSpecialTypeLabel(),this.setJettonCount(14),0!=moveCard.oneCard&&(moveCard.oneCard=0),0!=moveCard.towCard&&(moveCard.towCard=0),this.clearArray(this._holeList),this.clearArray(this._gunPlayerUid),this.clearArray(this._groupTypeList),this.clearArray(this._jettonList),this.clearArray(GameData13.disCardPlayer),this._gunNum=0,this._shootCount=0,this._roundAllScore=0,this._isDisCardEnd=!1,this._isBiPaiEnd=!1,this._isGunEnd=!0,this._isSpecialEnd=!0,this._isClearEnd=!0,this._isLoserClear=!0,this._isWinnerClear=!0,this._isQuanLeiDa=!1,this._specialTypeOfPlayer=0,this._specialNum=0,this._playSpecialNum=0,this._gunAnimation,this._specialAnimation,this._specialPoker=0,this._quanLeiDaGunScore=0,this._playQuanLeiDaNum=0,this._jettonIndex=0,this._winnerIndex=0,GameData13.clearObject(GameData13.roomResult)},refreshCard:function(){this.clearArray(this._cardHandList),0!=(this._cardHandList=GameData13.getCardHand(GameData.player.uid))&&(cc.log("cardHand: ",JSON.stringify(this._cardHandList)),this._cardHandList.length==this._handSize?this.showCardHand():cc.log("手牌数量小于或大于"+this._handSize+"个!"))},refreshRecommendType:function(){for(var e=[],t={},a=0;a<this._lastCardHand.length;a++)e.push(this._lastCardHand[a].card);var n=new s(e);for(var i in RecommendType)t=n.getPokerTypeCards(e.length,RecommendType[i]);n.clearPokerTypeList();var o=cc.find("pokerType",this.cardGroup);for(var i in RecommendType){var r=cc.find(i,o).getComponent(cc.Button);0==t[i].length?r.interactable=!1:r.interactable=!0}this.node.getComponent("SSSPromptCard").initPromptData(t,this._cardHandList)},refreshCheckedCards:function(){this.clearArray(this._checkedCardList);for(var e=0;e<this._cardHandList.length;e++){var t=cc.find("card"+e,this.cardHand);1==t.getComponent("SSSCard").isSelect&&1==t.active&&this._checkedCardList.push({card:this._cardHandList[e],cardId:e})}},refreshLastCard:function(){this._lastCardHand=[];for(var e=0,t=0;t<this._handSize;t++){1==cc.find("card"+t,this.cardHand).active&&(this._lastCardHand[e]={card:this._cardHandList[t],id:t},e++)}},initCardStatus:function(){for(var e=0;e<this.cardHand.childrenCount;e++){var t=cc.find("card"+e,this.cardHand),a=t.getComponent("SSSCard");1==a.isSelect&&(a.isSelect=!1,t.y=0)}},initGroupType:function(){WriteLog("initGroupType");var i,o=0;GameData13.player.recommend&&(i=GameData13.player.recommend.length);var r,s=cc.find("view/content",this.promptScrollView);0<s.childrenCount&&s.removeAllChildren(!0);var c=this;this._firstScrollViewPos=this.promptScrollView.getComponent(cc.ScrollView).getContentPosition();for(var e=0;e<i;e++)cc.loader.loadRes("shisanshui/prefab/groupType",function(e,t){if(e)cc.log("err: ",e);else{var a=cc.instantiate(t);s.addChild(a),c._groupTypeList[c._groupTypeList.length]=a,r=a.getContentSize().width+50,s.setContentSize(cc.size(2*(i+1)*r,a.getContentSize().height+10)),c.scrollViewSize=s.getContentSize();var n=a.getComponent("groupType");n.id=o,n.showRecommend(GameData13.player.recommend),a.x=r*o,++o}})},initDisPos:function(e){for(var t=0;t<GameData13.joiners.length;t++){var a=GameData13.getPosition(GameData13.joiners[t].uid),n=cc.find("poker_"+a,this.tableNode),i=cc.find("zhipai",n);cc.find("poker_"+a+"/disCard",this.tableNode).y=this._disCardNodePosYList[a-1];for(var o=0;o<this._handSize;o++){var r=cc.find("card"+o,i);this.setTexture("resources/shisanshui/cardUI/Poker_back.png",r)}i.active=e}},sortCardHandList:function(){for(var e=[],t=0;t<this._cardHandList.length;t++)0!=this._cardHandList[t]&&(e[e.length]=this._cardHandList[t]);for(t=0;t<e.length;t++)e[t].value=50*e[t].value,e[t].type=e[t].type+e[t].value;e.sort(function(e,t){return t.type-e.type});for(t=0;t<e.length;t++)e[t].type=e[t].type-e[t].value,e[t].value=e[t].value/50;this.clearArray(this._cardHandList);for(var a=0;a<this._handSize;a++)a<e.length?this._cardHandList[a]=e[a]:this._cardHandList[a]=0;return e.length},sortCardHand:function(){for(var e=this.sortCardHandList(),t=GameData13.handSize-e,a=Math.floor(t/2),n=0;n<e&&0!=a;n++)for(var i=1,o=e-n;i<=a;)this._cardHandList[o]=this._cardHandList[o-1],this._cardHandList[o-1]=0,o++,i++},showCardHand:function(){WriteLog("showCardHand");this.sortCardHand();for(var e=0;e<this._cardHandList.length;e++){var t=cc.find("card"+e,this.cardHand);if(0!=this._cardHandList[e]){t.active=!0;var a="resources/shisanshui/cardUI/"+(this._cardHandList[e].value+1)+"_"+(this._cardHandList[e].type+1)+".png";this.setTexture(a,t)}else t.active=!1}if(this.refreshLastCard(),0==this._lastCardHand.length)return this.showCardHandLayer(!1),void(this._MANNER==this._recommendManner.BTN_MANNER&&this.showCardGroupLayer(!1));this.refreshRecommendType()},showSpecialType:function(t){var a=this;if(0<t){this.showPeculiarBtn(!0);var e=function(){SSSHandler.getInstance().requestDiscard({},t,function(e){a._specialTypeOfPlayer=t,cc.find("zhipai/specialType",a.poker_1).active=!0,a.clearCardType()})};for(var n in SpecialType)if(SpecialType[n].id==t)return void poker13MessageBox("",SpecialType[n].name,",预计赢取每家"+SpecialType[n].score,e,function(){})}},showPlayers:function(){this.showHead(),this.setRoomNum(GameData.player.roomid)},showName:function(e,t){isChinese(t)?e.string=getShortStr(t,4):isChinese(t)||(e.string=getShortStr(t,8))},showHead:function(){for(var e,t=0;t<this.player.length;t++)this.player[t].setLocalZOrder(2);for(var a=0;a<this.player.length;a++)this.player[a].active=!1;for(t=0;t<GameData13.joiners.length;t++){cc.find("ready",this.player[GameData13.getPosition(GameData13.joiners[t].uid)-1]);var n=this.player[GameData13.getPosition(GameData13.joiners[t].uid)-1];n.active=!0;var i=cc.find("head",n),o=GameData13.joiners[t].headimgurl;this.setPlayerHead(i,o),this.showOwner(n,GameData13.joiners[t].uid),this.showLost(n,GameData13.joiners[t].status),e=cc.find("name",n),cc.find("score",n).getComponent(cc.Label).string=0,this.showName(e.getComponent(cc.Label),GameData13.joiners[t].name),n.getChildByName("button").setTag(GameData13.joiners[t].uid)}},setPlayerHead:function(e,t){if(null!=e&&null!=t&&""!=t){var a=e.getComponent(cc.Sprite);cc.loader.load({url:t,type:"png"},function(e,t){!e&&t&&a&&(a.spriteFrame=new cc.SpriteFrame(t))})}},showOwner:function(e,t){cc.find("owner",e).active=!1,t==GameData13.owner&&(cc.find("owner",e).active=!0)},showLost:function(e,t){cc.find("lost",e).active=!1,2==t&&(cc.find("lost",e).active=!0)},showHeadScore:function(){for(var e=0;e<GameData13.joiners.length;e++){var t=GameData13.joiners[e].uid,a=this.player[GameData13.getPosition(t)-1],n=cc.find("score",a);GameData13.playerAllScore[t]?(n.getComponent(cc.Label).string=GameData13.playerAllScore[t],this.scaleEffectsOfNode(n,2,2,1,1,.3,function(){})):GameData13.isEmptyObject(GameData13.allScores)||(n.getComponent(cc.Label).string=GameData13.allScores[t],this.scaleEffectsOfNode(n,2,2,1,1,.3,function(){}))}},showReadyInfo:function(){WriteLog("showReadyInfo");for(var e=0;e<GameData13.joiners.length;e++)if(1==GameData.game.onRoomReadyInfo.data[GameData13.joiners[e].uid]){var t=GameData13.getPosition(GameData13.joiners[e].uid);cc.find("ready",this.player[t-1]).active=!0}},showReady:function(){WriteLog("showReady");for(var e=0;e<GameData13.joiners.length;e++)if(1==GameData13.readyInfo[GameData13.joiners[e].uid]){var t=GameData13.getPosition(GameData13.joiners[e].uid);cc.find("ready",this.player[t-1]).active=!0}this.readyBtnAndQuitBtnControl()},showCards:function(){if(WriteLog("showCards"),this.initParam(),!(GameData13.game.roundNum>GameData13.room.roundmax)){var n=this,e=cc.callFunc(function(){n.startAnimation.active=!0,n.playAnimation(AnimateType.Start,n.startAnimation)},this),t=cc.delayTime(1),a=cc.callFunc(function(){n.startAnimation.active=!1,g.instance.playSSSAudio(SSS_AudioType.SAT_7);for(var e=0;e<GameData13.joiners.length;e++){var t=GameData13.getPosition(GameData13.joiners[e].uid);cc.find("poker_"+t+"/fapai",n.tableNode).active=!0,n.dealAction(e);var a=n.player[GameData13.getPosition(GameData13.joiners[e].uid)-1];cc.find("ready",a).active=!1}},this),i=cc.callFunc(function(){n.showNeatenNode(!0),n.checkedRecommendManner(),GameData.player.uid==GameData13.player.uid&&n.showSpecialType(GameData13.player.type)},this),o=cc.sequence(e,t,a,t,i);this.tableNode.runAction(o)}},showCardRow:function(e,t,a){WriteLog("showCardRow");var n=0,i=a-cardPoker13[e].length;if(i<this._checkedCardList.length)createSSSMoveMessage("空位不足");else{for(var o=cardPoker13[e].length;o<a&&!(n>=this._checkedCardList.length);o++){var r=cc.find("card"+o,t);this.hideCardMask(r),r.scaleX=.8515,r.scaleY=.8515;var s="resources/shisanshui/cardUI/"+(this._checkedCardList[n].card.value+1)+"_"+(this._checkedCardList[n].card.type+1)+".png";this.setTexture(s,r),cardPoker13[e][o]=this._checkedCardList[n].card,n++}this.setCheckedCardStatus(),this.initCardStatus(),i>=this._checkedCardList.length&&this.showCardHand(),0<cardPoker13[e].length&&("up"==e?this.showUpResetBtn(!0):"mid"==e?this.showMidResetBtn(!0):"down"==e&&this.showDownResetBtn(!0)),3==cardPoker13.up.length&&5==cardPoker13.mid.length&&5==cardPoker13.down.length&&this.showSelection(!0),this.clearArray(this._checkedCardList)}},hideCardMask:function(e){cc.find("cardMask",e).active=!1},setCheckedCardStatus:function(){if(!(this._checkedCardList.length<=0))for(var e=0;e<this._checkedCardList.length;e++){var t=cc.find("card"+this._checkedCardList[e].cardId,this.cardHand);this.hideCardMask(t),t.active=!1,t.getComponent(cc.Sprite).spriteFrame=null,this._cardHandList[this._checkedCardList[e].cardId]=0}},showDisCard:function(e,t,a){var n;WriteLog("showDisCard");var i="resources/shisanshui/cardUI",o=GameData13.getPosition(e),r=GameData13.getDisCardRow(t),s=cc.find("poker_"+o+"/zhipai",this.tableNode);if(n=1==r?0:3+5*(r-2),1==r)for(var c=n;c<3;c++){var d=a[c],h=cc.find("card"+c,s),l=i+"/"+(d.value+1)+"_"+(d.type+1)+".png";this.setTexture(l,h)}else for(c=n;c<5+n;c++){d=a[c-n],h=cc.find("card"+c,s),l=i+"/"+(d.value+1)+"_"+(d.type+1)+".png";this.setTexture(l,h)}},showRoomResult:function(){WriteLog("showRoomResult");for(var o=this,i=0,r=1,e=cc.find("zhipai",this.poker_1),t=0;t<this._handSize;t++){var a=cc.find("card"+t,e),n=cc.textureCache.addImage(cc.url.raw("resources/shisanshui/cardUI/Poker_back.png"));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}var s={up:[],mid:[],down:[]};for(t=0;t<GameData13.joiners.length;t++)0==GameData13.roomResult.result.ret[GameData13.joiners[t].uid].special.type&&(s.up.push({uid:GameData13.joiners[t].uid,type:GameData13.roomResult.cards[GameData13.joiners[t].uid].up.type}),s.mid.push({uid:GameData13.joiners[t].uid,type:GameData13.roomResult.cards[GameData13.joiners[t].uid].mid.type}),s.down.push({uid:GameData13.joiners[t].uid,type:GameData13.roomResult.cards[GameData13.joiners[t].uid].down.type}));s.up.sort(function(e,t){return e.type-t.type}),s.mid.sort(function(e,t){return e.type-t.type}),s.down.sort(function(e,t){return e.type-t.type});var c=function(e,t,a,n){var i=s[e][a].uid;o.disCardAction(i,e),r==n&&0==o._specialTypeOfPlayer&&o.showScore(t)};this.playRoomAnimate(function e(t){if(i>=GameData13.room.joinermax-o._specialNum&&(i=0),r<=GameData13.room.joinermax-o._specialNum)c("up",o.up,i,GameData13.room.joinermax-o._specialNum);else if(r>GameData13.room.joinermax-o._specialNum&&r<=2*GameData13.room.joinermax-2*o._specialNum)c("mid",o.mid,i,2*GameData13.room.joinermax-2*o._specialNum);else if(r>2*GameData13.room.joinermax-2*o._specialNum&&r<=3*GameData13.room.joinermax-3*o._specialNum)c("down",o.down,i,3*GameData13.room.joinermax-3*o._specialNum);else if(r>3*GameData13.room.joinermax-3*o._specialNum){o._isBiPaiEnd=!0,0<o._gunNum?o._isGunEnd=!1:0<o._specialNum?o._isSpecialEnd=!1:o._isClearEnd=!1;for(var a=0;a<o._handSize;a++){var n=cc.find("card"+a,o.cardHand);n.getComponent("SSSCard").isSelect=!1,n.y=0}o.clearArray(o._lastCardHand),o.clearArray(o._cardHandList),o.clearArray(o._cardRowList[0]),o.clearArray(o._cardRowList[1]),o.clearArray(o._cardRowList[2]),o.unschedule(e),o.concealAllSpecialTypeLabel(),o.gameAnimation()}++i,++r})},showScore:function(e){WriteLog("showScore");var t,a=cc.find("base",e),n=cc.find("extra",e);e.active=!0,e==this.up?t=GameData13.roomResult.result.ret[GameData.player.uid].up:e==this.mid?t=GameData13.roomResult.result.ret[GameData.player.uid].mid:e==this.down&&(t=GameData13.roomResult.result.ret[GameData.player.uid].down),this.playerRoundAllScore(t.base),this.playerRoundAllScore(t.extra),0<=t.base?this.scaleEffectsOfNode(a,1.5,1.5,1,1,.3,function(){a.getComponent(cc.Label).string="+"+t.base}):this.scaleEffectsOfNode(a,1.5,1.5,1,1,.3,function(){a.getComponent(cc.Label).string=t.base}),0<=t.extra?this.scaleEffectsOfNode(n,1.5,1.5,1,1,.3,function(){n.getComponent(cc.Label).string="(+"+t.extra+")"}):this.scaleEffectsOfNode(n,1.5,1.5,1,1,.3,function(){n.getComponent(cc.Label).string="("+t.extra+")"}),this.showRoundAllScore()},showRoundAllScore:function(){var e=this;this.allScore.active=!0,0<=this._roundAllScore?this.scaleEffectsOfNode(this.allScore,1.5,1.5,1,1,.3,function(){e.allScore.getComponent(cc.Label).string="总分:+"+e._roundAllScore}):this.scaleEffectsOfNode(this.allScore,1.5,1.5,1,1,.3,function(){e.allScore.getComponent(cc.Label).string="总分:"+e._roundAllScore})},quanLeiDaGunScoreByUid:function(e){var t=GameData13.roomResult.result.ret[e].up,a=GameData13.roomResult.result.ret[e].mid,n=GameData13.roomResult.result.ret[e].down;this._quanLeiDaGunScore=(t.base+t.extra+a.base+a.extra+n.base+n.extra)/2},numuberOfShots:function(){for(var e in GameData13.roomResult.result.ret)if(0<GameData13.roomResult.result.ret[e].gun.length)for(var t=0;t<GameData13.roomResult.result.ret[e].gun.length;t++)this._gunNum++,this._gunPlayerUid[this._gunPlayerUid.length]={shoot:e,target:GameData13.roomResult.result.ret[e].gun[t]}},angularByCoord:function(e,t){var a=e.x-t.x,n=e.y-t.y;if(a<0&&n<0)return 0-Math.atan(Math.abs(n)/Math.abs(a));if(0<a&&n<0)return Math.atan(Math.abs(n)/Math.abs(a));if(a<0&&0<n)return Math.atan(Math.abs(n)/Math.abs(a));if(0<a&&0<n)return 0-Math.atan(Math.abs(n)/Math.abs(a));if(0<a&&0==n)return Math.atan(Math.abs(n)/Math.abs(a));if(a<0&&0==n)return Math.atan(Math.abs(n)/Math.abs(a));if(0==a&&0<n){if(e.x<0)return Math.atan(Math.abs(n)/Math.abs(a));if(0<e.x)return 0-Math.atan(Math.abs(n)/Math.abs(a))}else if(0==a&&n<0){if(e.x<0)return 0-Math.atan(Math.abs(n)/Math.abs(a));if(0<e.x)return Math.atan(Math.abs(n)/Math.abs(a))}return 0},calculateSpecialPlayer:function(){var e=[];for(var t in GameData13.roomResult.cards)if(0<GameData13.roomResult.cards[t].special){this._specialNum++;var a=GameData13.getPosition(t),n=cc.find("poker_"+a+"/zhipai/specialType",this.tableNode);for(var i in n.active=!0,SpecialType)if(SpecialType[i].id==GameData13.roomResult.cards[t].special){var o=cc.find(i,this.animation);e.push({id:SpecialType[i].id,type:i,node:o,uid:t,score:SpecialType[i].score});break}}return e.sort(function(e,t){return e.id-t.id}),e},calculateQuanLeiDaPlayer:function(){var e=[];if(0!=GameData13.roomResult.result.homeRun&&2<GameData13.room.joinermax){this._isQuanLeiDa=!0,this.quanLeiDaGunScoreByUid(GameData13.roomResult.result.homeRun);var t=cc.find("QuanLeiDa",this.animation);e.push({id:SpecialType.QuanLeiDa.id,type:"QuanLeiDa",node:t,uid:GameData13.roomResult.result.homeRun,scpre:0})}return e},getShootAngular:function(){var e=[];if(0<this._gunNum)for(var t=0;t<this._gunPlayerUid.length;t++){var a=this.player[GameData13.getPosition(this._gunPlayerUid[t].shoot)-1].getPosition(),n=this.player[GameData13.getPosition(this._gunPlayerUid[t].target)-1].getPosition();e.push(this.angularByCoord(a,n)/3.14159*180)}return e},playRoomAnimate:function(e){WriteLog("playRoomAnimate");var t,a=this,n=[],i=GameData13.game.roundNum==GameData13.room.roundmax;this.numuberOfShots(),n=this.calculateQuanLeiDaPlayer(),t=this.getShootAngular(),this._isQuanLeiDa||(n=this.calculateSpecialPlayer()),this._specialNum==GameData13.room.joinermax&&(this._isSpecialEnd=!1),cc.log("quanLeiDa: ",this._isQuanLeiDa),cc.log("_gunNum: ",this._gunNum),cc.log("_specialNum: ",this._specialNum);this._disCardFunc=function(){a._specialNum!=GameData13.room.joinermax&&(g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.Start,a._playerSex),a.schedule(e,1.2))},this.showGunAnimation(t),this.showSpecialAnimation(n);this._clearFunc=function(){a.showClearAnimation()};this._readyFunc=function(){a._specialNum=0,i?a.showGameEnd(1):sendEvent("againReady")},this.gameAnimation()},gameAnimation:function(){WriteLog("gameAnimation"),this._specialNum<GameData13.room.joinermax&&this._isDisCardEnd&&!this._isBiPaiEnd?this._disCardFunc():this._shootCount<this._gunNum&&!this._isGunEnd?(g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.DaQiang,this._playerSex),this._gunAnimation()):this._playSpecialNum<this._specialNum&&!this._isSpecialEnd&&!this._isQuanLeiDa?this._specialAnimation():!this._isSpecialEnd&&this._isQuanLeiDa?this._specialAnimation():!this._isClearEnd&&this._isBiPaiEnd?this._clearFunc():0<this._gunNum&&this._specialNum<=0&&!this._isQuanLeiDa?this._isGunEnd&&this._isBiPaiEnd&&this._isClearEnd&&this._readyFunc():0<this._gunNum&&0<this._specialNum?this._isGunEnd&&this._isSpecialEnd&&this._isBiPaiEnd&&this._isClearEnd&&this._readyFunc():this._gunNum<=0&&0<this._specialNum?this._isSpecialEnd&&this._isBiPaiEnd&&this._isClearEnd&&this._readyFunc():this._gunNum<=0&&this._specialNum<=0?this._isBiPaiEnd&&this._isDisCardEnd&&this._isClearEnd&&this._readyFunc():0<this._gunNum&&this._isQuanLeiDa&&this._isBiPaiEnd&&this._isDisCardEnd&&1==this._playQuanLeiDaNum&&this._isClearEnd&&this._readyFunc()},showGunScore:function(e){if(this._gunPlayerUid[e].shoot==GameData.player.uid){for(var t in GameData13.roomResult.result.ret[GameData.player.uid].playerList)if(this._gunPlayerUid[e].target==t){this._isQuanLeiDa?this.playerRoundAllScore(this._quanLeiDaGunScore):this._isQuanLeiDa||this.playerRoundAllScore(GameData13.roomResult.result.ret[GameData.player.uid].playerList[t].score/2);break}this.showRoundAllScore()}else if(this._gunPlayerUid[e].target==GameData.player.uid){for(var t in GameData13.roomResult.result.ret[GameData.player.uid].playerList)if(this._gunPlayerUid[e].shoot==t){this._isQuanLeiDa?this.playerRoundAllScore(0-this._quanLeiDaGunScore):this._isQuanLeiDa||this.playerRoundAllScore(GameData13.roomResult.result.ret[GameData.player.uid].playerList[t].score/2);break}this.showRoundAllScore()}},showLoophole:function(e){for(var t=GameData13.getPosition(this._gunPlayerUid[e].target),a=cc.find("poker_"+t+"/holeNode",this.tableNode),n=cc.find("hole"+this.getRandom(0,6),a),i=!1;!i;)1==n.active?(n=cc.find("hole"+this.getRandom(0,6),a),i=!1):i=!0;this._holeList.push(n),n.active=!0},showGunAnimation:function(t){var a,e,n=this;n._gunNum<=0||(e=function(){var e=n.player[GameData13.getPosition(n._gunPlayerUid[n._shootCount].shoot)-1];n.player[GameData13.getPosition(n._gunPlayerUid[n._shootCount].target)-1];(a=cc.find("gun",e)).active=!0,a.rotation=t[n._shootCount],g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.SpecialType.QiangJi,n._playerSex),n.playAnimation(AnimateType.QiangJi,a),n._gunPlayerUid.length<=0||(n.showGunScore(n._shootCount),n.showLoophole(n._shootCount),n._shootCount++)},this._gunAnimation=e)},showSpecialScore:function(e,t){var a;t[e].uid==GameData.player.uid?(a=t[e].id==SpecialType.QuanLeiDa.id?GameData13.roomResult.score[GameData.player.uid]:SpecialType[t[e].type].score,cc.log("特殊牌型加分： ",a)):(a=t[e].id==SpecialType.QuanLeiDa.id?GameData13.roomResult.score[GameData.player.uid]:0-SpecialType[t[e].type].score,cc.log("特殊牌型减分: ",a)),this.playerRoundAllScore(a),this._playSpecialNum!=this._specialNum-1||this._isQuanLeiDa?this._isQuanLeiDa&&(this._roundAllScore=GameData13.roomResult.result.ret[GameData.player.uid].score,this.showRoundAllScore()):(e==t.length-1&&(this._roundAllScore=GameData13.roomResult.result.ret[GameData.player.uid].score),this.showRoundAllScore())},showSpecialCard:function(e,t){if(e.length<this._handSize)cc.log("传入的特殊牌长度小于"+this._handSize+"个");else for(var a=0;a<this._handSize;a++){var n=e[a],i=cc.find("card"+a,t),o="resources/shisanshui/cardUI/"+(n.value+1)+"_"+(n.type+1)+".png";this.setTexture(o,i)}},restoreCard:function(){var e=GameData13.roomResult.cards[GameData.player.uid];0<GameData13.roomResult.result.ret[GameData.player.uid].special.type||0==GameData13.roomResult.result.ret[GameData.player.uid].special.type&&(this.showDisCard(GameData.player.uid,"up",e.up.card),this.showDisCard(GameData.player.uid,"mid",e.mid.card),this.showDisCard(GameData.player.uid,"down",e.down.card))},showSpecialAnimation:function(i){WriteLog("show_specialAnimation");var e,o=this;this._specialNum<=0&&!this._isQuanLeiDa||(cc.log("specialList: ",i),e=function(){if(WriteLog("specialAnimationCallBack"),o.showSpecialPlayerName(!0),o._isQuanLeiDa){i[0].node&&(i[0].node.active=!0),o.showSpecialScore(0,i);var e=GameData13.getJoinerByUid(i[0].uid).name;o.showName(o.specialPlayerName,e),g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.SpecialType[i[0].type],o._playerSex),o.playAnimation(AnimateType[i[0].type],i[0].node),o.showSpecialScore(0,i),o._playQuanLeiDaNum=1}else{0<=o._playSpecialNum&&o._playSpecialNum<i.length&&i[o._playSpecialNum].node&&(i[o._playSpecialNum].node.active=!0),o.showSpecialScore(o._playSpecialNum,i);e=GameData13.getJoinerByUid(i[o._playSpecialNum].uid).name;o.showName(o.specialPlayerName,e),g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.SpecialType[i[o._playSpecialNum].type],o._playerSex),o.playAnimation(AnimateType[i[o._playSpecialNum].type],i[o._playSpecialNum].node);var t=i[o._playSpecialNum].uid,a=GameData13.getPosition(t),n=cc.find("poker_"+a+"/zhipai",o.tableNode);o.showSpecialCard(GameData13.roomResult.cards[t].allCards,n),o._specialPoker=cc.find("zhipai",o.poker_1),o.showSpecialCard(GameData13.roomResult.cards[t].allCards,o._specialPoker)}cc.find("animateBg",o.tableNode).active=!0,++o._playSpecialNum},this._specialAnimation=e)},loserClearAnimation:function(){for(var e=0;e<this._winnerToLoser.loser.length;e++){var t,a=this._jettonIndex+1;this.tableNode.getChildByName("jettonNode"+a)?t=this.tableNode.getChildByName("jettonNode"+a):((t=cc.instantiate(this.jettonNode)).name="jettonNode"+a,this.tableNode.addChild(t));var n=this.player[0].getLocalZOrder();t.active=!0,t.setLocalZOrder(n-1),this._jettonList.push(t);var i=this.getRandom(1,5);5!=i&&(t.scaleX=.26,t.scaleY=.26);var o="resources/shisanshui/tableUI/clearing/"+i+".png";this.setTexture(o,t);var r=GameData13.getPosition(this._winnerToLoser.loser[e].uid),s=this.player[r-1];t.setPosition(s.getPosition());var c=this.getRandom(-100,100),d=this.getRandom(-100,100),h=cc.moveTo(.32,cc.p(c,d));t.runAction(h).easing(cc.easeCubicActionOut()),this._jettonIndex++}this._jettonIndex>=this._jettonCount*this._winnerToLoser.loser.length&&(this.unschedule(this.loserClearAnimation),this._isWinnerClear=!1,this.winnerAction())},winnerJettonCount:function(){var e=this._jettonCount*this._winnerToLoser.loser.length;return Math.floor(e/this._winnerToLoser.winner.length)},winnerClearAnimation:function(){for(var o,r=this,e=this._winnerToLoser.winner.length-1,t=0;t<this._winnerToLoser.loser.length;t++){var s,a=this._jettonIndex+1,n=function(e){var t=GameData13.getPosition(r._winnerToLoser.winner[r._winnerIndex].uid),a=r.player[t-1],n=r.getRandom(-50,50),i=r.getRandom(-50,50);s=cc.moveTo(.5,cc.p(a.getPosition().x+n,a.getPosition().y+i)),o=cc.callFunc(function(){r._jettonList[e-1].active=!1,r.tableNode.removeChild(r._jettonList[e-1])},this)};a<=this.winnerJettonCount()*(this._winnerIndex+1)&&this._winnerIndex<e?n(a):a>this.winnerJettonCount()*(this._winnerIndex+1)&&this._winnerIndex<e?(this._winnerIndex++,n(a)):this._winnerIndex==e&&n(a);var i=cc.fadeOut(.1),c=cc.sequence(s,i,o);this._jettonList[this._jettonIndex].runAction(c).easing(cc.easeCubicActionOut()),this._jettonIndex++}this._jettonIndex>=this._jettonCount*this._winnerToLoser.loser.length&&(this.unschedule(this.winnerClearAnimation),this.showHeadScore(),this.gameAnimationMngr(AnimateType.JieSuan))},loserJetton:function(){this._jettonIndex=0,g.instance.playSSSAudio(SSS_AudioType.SAT_2),this.schedule(this.loserClearAnimation,.01)},winnerJetton:function(){this._jettonIndex=0,g.instance.playSSSAudio(SSS_AudioType.SAT_3),this.schedule(this.winnerClearAnimation,.01)},winnerAction:function(){var e=cc.delayTime(1),t=this,a=cc.callFunc(function(){t.winnerJetton()},this),n=cc.sequence(e,a);this.node.runAction(n)},calculateWinnerAndLoser:function(){for(var e in this.clearArray(this._winnerToLoser.winner),this.clearArray(this._winnerToLoser.loser),GameData13.roomResult.result.ret)0<GameData13.roomResult.result.ret[e].score?this._winnerToLoser.winner.push({uid:e,score:GameData13.roomResult.result.ret[e].score}):GameData13.roomResult.result.ret[e].score<0&&this._winnerToLoser.loser.push({uid:e,score:GameData13.roomResult.result.ret[e].score})},showClearAnimation:function(){WriteLog("showClearAnimation"),this.calculateWinnerAndLoser(),0<this._winnerToLoser.winner.length&&(this._isLoserClear=!1),this._isLoserClear?(this._isLoserClear=!1,this._isWinnerClear=!1,this.scheduleOnce(this._readyFunc,1)):this.loserJetton()},showBiPai:function(e){var t=GameData13.getPosition(e),a=cc.find("poker_"+t,this.tableNode);cc.find("fapai/bg",a).active=!1,cc.find("fapai",a).active=!1,cc.find("zhipai",a).active=!0},showDisCardReady:function(){WriteLog("showDisCardReady"),GameData13.isEmptyObject(GameData13.disCardReady)?cc.log("function:showDisCardReady.. GameData13.disCardReady is empty."):this.showBiPai(GameData13.disCardReady.uid)},showGameEnd:function(e){1==e?this.showRoomEndClear(!0):0==e&&this.showRoomEndClear(!1)},showWaitNode:function(e){this.waitNode.active=e},showNeatenNode:function(e){this.neatenNode.active=e},showRoomEndClear:function(e){this.roomEndClear.active=e,GameData13.game.start=!1,this.stopGameAction()},showUpResetBtn:function(e){this.upResetBtn.active=e},showMidResetBtn:function(e){this.midResetBtn.active=e},showDownResetBtn:function(e){this.downResetBtn.active=e},showPeculiarBtn:function(e){this.peculiarBtn.node.active=e},showReadyBtn:function(e){this.readyBtn.active=e},showQuitBtn:function(e){this.quitBtn.active=e},showSelection:function(e){this.selection.active=e},showCardHandLayer:function(e){this.cardHand.active=e},showCardGroupLayer:function(e){this.cardGroup.active=e},showSpecialPlayerName:function(e){this.specialPlayerName.node.active=e},showTimeNode:function(e,t,a,n){this.timeNode.active=t,e?e&&(this.timeNode.x=0,this.timeNode.y=-30):(this.timeNode.x=215,this.timeNode.y=395),a?(cc.log("运行时间计时器"),this.openTimer(a)):n&&(cc.log("关闭时间计时器"),this.closeTimer(n))},showJoinerLost:function(e){WriteLog("showJoinerLost"),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){WriteLog("showJoinerConnect"),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){WriteLog("showHeaderDisconnect");for(var a=0;a<GameData13.joiners.length;a++){if(GameData13.joiners[a].uid==e){var n=this.player[GameData13.getPosition(e)-1];return void(cc.find("lost",n).active=t)}}},showConnectDisCardInfo:function(){WriteLog("showConnectDisCardInfo");for(var e=new Array,t=0;t<GameData13.joiners.length;t++)e.push(GameData13.joiners[t]);if(!GameData13.isEmptyObject(GameData13.playerConnect.disCardInfo)){GameData13.game.start=!0,this.readyBtnAndQuitBtnControl();for(var a=0;a<GameData13.playerConnect.disCardInfo.length;a++)GameData.player.uid==GameData13.playerConnect.disCardInfo[a]&&(this._isDisCardEnd=!0);var n=[];for(a=0;a<GameData13.joiners.length;a++)for(var i=0;i<GameData13.playerConnect.disCardInfo.length;i++)if(GameData13.joiners[a].uid==GameData13.playerConnect.disCardInfo[i]){n.push(GameData13.joiners[a].uid);break}for(t=0;t<e.length;t++)for(var o=0;o<n.length;o++)n[o]==e[t].uid&&(cc.log("disCardUid and joiners: ",n[o],e[t].uid),e.splice(t,1));for(a=0;a<GameData13.playerConnect.disCardInfo.length;a++){var r=GameData13.getPosition(GameData13.playerConnect.disCardInfo[a]);cc.find("poker_"+r+"/zhipai",this.tableNode).active=!0}}if(GameData13.game.reday)for(t=0;t<e.length;t++)for(r=GameData13.getPosition(e[t].uid),a=0;a<this._handSize;a++){cc.find("poker_"+r+"/fapai/card"+a,this.tableNode).active=!0}GameData13.clearObject(GameData13.playerConnect.disCardInfo)},showConnectDisCard:function(){if(WriteLog("showConnectDisCard"),GameData13.isEmptyObject(GameData13.playerConnect.disCard)){for(var e=0;e<GameData13.disCardPlayer.length;e++)this.showBiPai(GameData13.disCardPlayer[e]);cc.log("GameData13.playerConnect.disCard is empty")}else{if(GameData13.game.start=!0,this.showWaitNode(!1),this.readyBtnAndQuitBtnControl(),cc.find("disCard",this.poker_1).y=this._disCardNodePosYList[0],0<GameData13.playerConnect.disCard.special)cc.find("zhipai/specialType",this.poker_1).active=!0;else GameData13.playerConnect.disCard.upCards&&this.showDisCard(GameData.joinContact.uid,"up",GameData13.playerConnect.disCard.upCards),GameData13.playerConnect.disCard.midCards&&this.showDisCard(GameData.joinContact.uid,"mid",GameData13.playerConnect.disCard.midCards),GameData13.playerConnect.disCard.downCards&&this.showDisCard(GameData.joinContact.uid,"down",GameData13.playerConnect.disCard.downCards);GameData13.clearObject(GameData13.playerConnect.disCard)}},connectRecurrence:function(){if(GameData13.isEmptyObject(GameData.joinContact)||(this.setRoomNum(GameData13.joiners[0].roomid),this.showHeadScore(),GameData.player.roomid=GameData13.joiners[0].roomid),GameData13.readyInfo[GameData.joinContact.uid],GameData13.game.start&&(this.ready(),this.showWaitNode(!1)),GameData13.isEmptyObject(GameData13.player)){if(!GameData13.isEmptyObject(GameData13.roomResult)){if(GameData13.isEmptyObject(GameData13.roomResult.result))for(var e=0;e<GameData13.joiners.length;e++){var t=this.player[GameData13.getPosition(GameData13.joiners[e].uid)-1];cc.find("score",t).getComponent(cc.Label).string=GameData13.roomResult.score[GameData13.joiners[e].uid]}return GameData13.game.start=!0,this.showWaitNode(!1),void this.ready()}}else GameData13.game.start=!0,this.showNeatenNode(!0),this.checkedRecommendManner(),this.showWaitNode(!1),this.refreshCard();this.showConnectDisCardInfo(),this.showConnectDisCard()},readyBtnAndQuitBtnControl:function(){if(this.showReadyBtn(!0),this.showQuitBtn(!0),cc.log("..roundNum:"+GameData13.game.roundNum),0<GameData13.game.roundNum)return this.showReadyBtn(!1),void this.showQuitBtn(!1);for(var e in GameData13.readyInfo)if(e==GameData.player.uid){this.showReadyBtn(!1),this.showQuitBtn(!1);break}},concealAllSpecialTypeLabel:function(){for(var e=1;e<=5;e++){cc.find("poker_"+e+"/zhipai/specialType",this.tableNode).active=!1}},stopGameAction:function(){if(this.tableNode.stopAllActions(),0<this._jettonList.length)for(var e=0;e<this._jettonList.length;e++)this._jettonList[e]&&this._jettonList[e].stopAllActions()},getRandom:function(e,t){var a=Math.ceil(Math.random()*(t-e)+e);return Math.floor(a)},setTexture:function(e,t){var a;if(null==e||0==e.length||null==e){t.getComponent(cc.Sprite)&&(t.getComponent(cc.Sprite).spriteFrame=null)}else{var n=cc.url.raw(e);n&&(a=cc.textureCache.addImage(n)),t.getComponent(cc.Sprite)&&(t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a))}},setJettonCount:function(e){this._jettonCount=e},towMoveCardActive:function(e){0!=moveCard.oneCard&&moveCard.oneCard.card.parent==e&&(moveCard.oneCard.card.active=!0),0!=moveCard.towCard&&moveCard.towCard.card.parent==e&&(moveCard.towCard.card.active=!0)},scaleEffectsOfNode:function(e,t,a,n,i,o,r){var s=cc.scaleTo(o,t,a),c=cc.scaleTo(o,n,i),d=cc.callFunc(r,this),h=cc.sequence(d,s,c);e.runAction(h)},playerRoundAllScore:function(e){return this._roundAllScore+=e,this._roundAllScore},clearArray:function(e){0<e.length&&e.splice(0,e.length)},clearCardType:function(){this._isDisCardEnd=!0,this.showCardHandLayer(!0),this.showCardGroupLayer(!0),this.showNeatenNode(!1),this.clearArray(cardPoker13.up),this.clearArray(cardPoker13.mid),this.clearArray(cardPoker13.down);for(var e=0;e<3;e++){var t=cc.find("card"+e,this.upCardNode);t.getComponent(cc.Sprite).spriteFrame=null,t.getComponent("SSSCard").isSelect=!1,this.hideCardMask(t)}for(e=0;e<5;e++){var a=cc.find("card"+e,this.midCardNode),n=cc.find("card"+e,this.downCardNode);a.getComponent(cc.Sprite).spriteFrame=null,n.getComponent(cc.Sprite).spriteFrame=null;var i=a.getComponent("SSSCard"),o=n.getComponent("SSSCard");i.isSelect=!1,o.isSelect=!1,this.hideCardMask(a),this.hideCardMask(n)}},cutOutArray:function(e,t,a){var n=[];if(e.length<=a)return n;for(var i=t;i<=a;i++)n.push(e[i]);return n},openTimer:function(){var t=0,a=GameData13.game.time,n=1/(20*a),i=this,o=cc.find("timeBar",this.timeNode).getComponent(cc.ProgressBar),r=1,s=function(e){i.timer.string=e};this._gameTimer=_gameTimer,this.schedule(function(e){20==++t&&(--a,t=0),10<=a?(Math.floor(a/10),s(a)):0<=a&&s(a);0<r?r-=n:(r=0,i._groupTypeList[0].getComponent("groupType").showRecommendCard(),i.onDisCardBtnCliked(),i.unschedule(_gameTimer)),o.progress=r},.05)},closeTimer:function(){this.unschedule(this.gameTimer)},setCheckedCards:function(e){this.clearArray(this._checkedCardList);for(var t=0;t<e.length;t++)for(var a=0;a<this._cardHandList.length;a++)if(this._cardHandList[a].type==e[t].type&&this._cardHandList[a].value==e[t].value){for(var n=!1,i=0;i<this._checkedCardList.length;i++)if(this._checkedCardList[i].cardId==a){n=!0;break}if(n)continue;this._checkedCardList.push({card:this._cardHandList[a],cardId:a});break}},setResetCard:function(e,t){WriteLog("setResetCard"),this.clearArray(this._checkedCardList);for(var a=0;a<cardPoker13[t].length;a++){var n=cc.find("card"+a,e);this.hideCardMask(n);var i=n.getComponent("SSSCard");i.removeAllCards(),i.isSelect=!1,this.setTexture(null,n),n.active=!0;for(var o=0;o<this._cardHandList.length;o++)if(0==this._cardHandList[o]){this._cardHandList[o]=cardPoker13[t][a];break}}this.showSelection(!1),this.showCardHandLayer(!0),this.showCardGroupLayer(!0),this.showCardHand(),this.clearArray(cardPoker13[t]),this.towMoveCardActive(e),this.initCardStatus(),"up"==t?this.showUpResetBtn(!1):"mid"==t?this.showMidResetBtn(!1):"down"==t&&this.showDownResetBtn(!1)},setRoomNum:function(e){for(var o=this,t=function(e,t,a){var n=new cc.Node;n&&e.addChild(n),n.addComponent(cc.Sprite);var i="resources/shisanshui/tableUI/zhuomian"+a+".png";o.setTexture(i,n),n.x=15*t+10},a=1e5,n=0;n<6;n++){var i=Math.floor(e/a);e%=a,a/=10,t(this.roomId,n,i)}},setRoundNum:function(){var o=this,e=GameData13.game.roundNum>GameData13.room.roundmax?GameData13.room.roundmax:GameData13.game.roundNum,t=function(e,t,a){var n=cc.find("num"+t,e),i="resources/shisanshui/tableUI/zhuomian"+a+".png";o.setTexture(i,n)};if(0<=e&&e<10)t(this.roundNum,1,e);else if(10<=e&&e<100){cc.find("num1",this.roundNum).active=!1;var a=Math.floor(e/10);t(this.roundNum,0,a),a=e%10,t(this.roundNum,2,a)}},startTouch:function(e){var t=[{width:this.upCardNode.getContentSize().width,height:this.upCardNode.getContentSize().height},{width:this.midCardNode.getContentSize().width,height:this.midCardNode.getContentSize().height},{width:this.downCardNode.getContentSize().width,height:this.downCardNode.getContentSize().height}],a=this.upCardNode.convertTouchToNodeSpace(e),n=this.midCardNode.convertTouchToNodeSpace(e),i=this.downCardNode.convertTouchToNodeSpace(e);0<a.x&&a.x<=t[0].width&&0<a.y&&a.y<=t[0].height?(this.refreshCheckedCards(),this.showCardRow("up",this.upCardNode,3)):0<n.y&&n.y<=t[1].height?(this.refreshCheckedCards(),this.showCardRow("mid",this.midCardNode,5)):0<i.y&&i.y<=t[2].height&&(this.refreshCheckedCards(),this.showCardRow("down",this.downCardNode,5))},moveTouch:function(e){},endTouch:function(e){},dealAction:function(e){var t,a;if(0!=e){t=cc.find("poker_"+(e+1)+"/fapai",this.tableNode),cc.find("bg",t).active=!0;for(var n=cc.find("card0",t).getPositionX(),i=0;i<this._handSize;i++){(a=cc.find("card"+i,t)).x=n-30,a.active=!0;var o=cc.moveTo(.3,cc.p(n+15*i,0));a.runAction(o)}}else if(0==e){t=cc.find("poker_"+(e+1)+"/fapai",this.tableNode),cc.find("bg",t).active=!0;for(n=cc.find("card0",t).getPositionX(),i=0;i<this._handSize;i++){(a=cc.find("card"+i,t)).x=n-30,a.active=!0;o=cc.moveTo(.3,cc.p(n+13*i,0));a.runAction(o)}}},disCardAction:function(e,t){var a="resources/shisanshui/cardUI",n=0,i=[],o=[],r=GameData13.getPosition(e),s=GameData13.getDisCardRow(t),c=cc.find("poker_"+r+"/disCard",this.tableNode),d=cc.find("poker_"+r+"/disCard/CommonType",this.tableNode);if(!(GameData13.roomResult.cards[e].allCards&&0<GameData13.roomResult.cards[e].special)){c.active=!0;for(var h=0;h<5;h++)i[h]=cc.find("card"+h,c),i[h].active=!0;1==r&&s-1!=0?c.y=c.getPositionY()-90:1!=r&&s-1!=0&&(c.y=c.getPositionY()-65);for(h=0;h<5;h++)if(1==s){if(0==h||4==h){i[h].active=!1;continue}var l=GameData13.roomResult.cards[e][t].card[n],u=a+"/"+((o[o.length]=l).value+1)+"_"+(l.type+1)+".png";this.setTexture(u,i[h]),n++}else{l=GameData13.roomResult.cards[e][t].card[h],u=a+"/"+((o[o.length]=l).value+1)+"_"+(l.type+1)+".png";this.setTexture(u,i[h])}var m=GameData13.roomResult.cards[e][t].type;for(var p in CommonType)if(m==CommonType[p].id){u="resources/shisanshui/cardTypeUI/"+CommonType[p].str+".png";this.setTexture(u,d),d.active=!0,g.instance.playSSSSpeakAudio(SSS_SpeakAudioType.CommonType[p],this._playerSex);break}1==r?this.playAnimation("bipai1",c):this.playAnimation("bipai2",c),this.scheduleOnce(function(e){d.active=!1,c.active=!1},1.05),this.showDisCard(e,t,o)}},ready:function(){SSSHandler.getInstance().requestReady(function(){});for(var e=0;e<this._holeList.length;e++)this._holeList[e].active=!1;this.up.active=!1,this.mid.active=!1,this.down.active=!1,this.allScore.active=!1,this.initDisPos(!1);var t=GameData13.getPosition(GameData.player.uid),a=cc.find("ready",this.player[t-1]);a.active=!0},againReady:function(){this.ready()},onReadyBtnCliked:function(e){this.ready(),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onDisCardBtnCliked:function(e){this.showSelection(!1);var t=this,a={up:0,mid:0,down:0};a.up=cardPoker13.up,a.mid=cardPoker13.mid,a.down=cardPoker13.down,SSSHandler.getInstance().requestDiscard(a,0,function(e){e.result==i.WarningDiscard?(t.showSelection(!0),g.instance.playSSSAudio(SSS_AudioType.SAT_8),createSSSMoveMessage("倒水")):e.result==i.Success&&(t.showDisCard(GameData.player.uid,"up",cardPoker13.up),t.showDisCard(GameData.player.uid,"mid",cardPoker13.mid),t.showDisCard(GameData.player.uid,"down",cardPoker13.down),t.clearCardType())}),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onReelectBtnCliked:function(e,t){1==t?this.setResetCard(this.upCardNode,"up"):2==t?this.setResetCard(this.midCardNode,"mid"):3==t?this.setResetCard(this.downCardNode,"down"):4==t&&(this.setResetCard(this.upCardNode,"up"),this.setResetCard(this.midCardNode,"mid"),this.setResetCard(this.downCardNode,"down")),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onPeculiarBtnCliked:function(e){this.showSpecialType(GameData13.player.type),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onShareBtnCliked:function(e){g.instance.playSSSAudio(SSS_AudioType.SAT_1),inCD(3e3)||screenShootVertical(wxShareTexture)},onHeadBtnClicked:function(e){for(var t=0;t<GameData13.joiners.length;t++){var a=this.player[GameData13.getPosition(GameData13.joiners[t].uid)-1];cc.find("button",a).setTag(GameData13.joiners[t].uid)}poker13createPlayerInfoPanel(GameData13.getJoinerByUid(e.target.tag)),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onCopyRoomInfo:function(){if(0<GameData.player.roomid){var e="十三水,房间号:"+GameData.player.roomid+",",t=this.getInviteStr();wxShareCommond(e+t)}g.instance.playSSSAudio(SSS_AudioType.SAT_1)},wxInviteBtnClicked:function(){var e="十三水 房间号:"+GameData.player.roomid;4==GameData13.room.costType&&(e="十三水 (代开)房间号:"+GameData.player.roomid);var t=this.getInviteStr();wxShareWeb(e,t),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},getInviteStr:function(){var e=getRuleStr13(GameData13.room);GameData13.room.joinermax&&(e+=","+GameData13.joiners.length+"等"+(GameData13.room.joinermax-GameData13.joiners.length));var t="玩法:"+e+",请您快速加入对局.";return console.log("des = "+t),t},onDeleteRoom:function(){n.deleteRoom(GameData.player.roomid),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},onQuitRoom:function(){GameData13.owner==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(GameData.player.roomid)},lightFrame:function(e){if(this.promptScrollView.getComponent(cc.ScrollView).getContentPosition().x==this._firstScrollViewPos.x)for(var t=0;t<this._groupTypeList.length;t++){var a=cc.find("twinkle",this._groupTypeList[t]);1==a.active&&(a.active=!1)}},onScrollViewEvent:function(e){cc.log("scrollViewEvent");var t=cc.find("view",this.promptScrollView).getContentSize(),a=this.promptScrollView.getComponent(cc.ScrollView);0<a.getContentPosition().x?cc.find("view/content",this.promptScrollView).setContentSize(t):cc.find("view/content",this.promptScrollView).setContentSize(this.scrollViewSize);this._firstScrollViewPos=a.getContentPosition()},onPauseEvent:function(){this.kai.active=!this.kai.active,this.guan.active=!this.guan.active,1==this.kai.active&&0==this.guan.active?cc.director.resume():0==this.kai.active&&1==this.guan.active&&cc.director.pause()},playAnimation:function(o,r){WriteLog("playAnimation");var s=this;for(var e in AnimateType)if(AnimateType[e]==o){var t="shisanshui/animation/shisanshui/"+o;return void cc.loader.loadResDir(t,function(e,t){if(e)cc.log(e);else if(!(t.length<=0)){var a;for(var n in r.parent.setLocalZOrder(10),r.getComponent(dragonBones.ArmatureDisplay)?(cc.log("dragonBones get"),a=r.getComponent(dragonBones.ArmatureDisplay)):(cc.log("dragonBones add"),a=r.addComponent(dragonBones.ArmatureDisplay)),t)t[n]instanceof dragonBones.DragonBonesAsset&&a.dragonAsset!=t[n]&&(a.dragonAsset=t[n]),t[n]instanceof dragonBones.DragonBonesAtlasAsset&&a.dragonAtlasAsset!=t[n]&&(a.dragonAtlasAsset=t[n]);if(o==AnimateType.Start||o==AnimateType.QuanLeiDa)a.armatureName="armature";else{a.armatureName="armature";for(var i=0;i<s._specialName.length;i++)if(o==s._specialName[i]){a.armatureName="armature";break}}a.playAnimation("newAnimation",1),a.addEventListener(dragonBones.EventObject.COMPLETE,function(){r.active=!1,cc.find("animateBg",s.tableNode).active=!1,0!=s._specialPoker&&s.restoreCard(),s.gameAnimationMngr(o),s.showSpecialPlayerName(!1),s.releaseRes(t)},this)}})}null==r||r.getComponent(cc.Animation).play(o)},gameAnimationMngr:function(e){var t=.5;this.animationStatusMngr(),e==AnimateType.Start||e==AnimateType.QiangJi?t=.3:(e=AnimateType.JieSuan)&&(t=1),this.scheduleOnce(this.gameAnimation,t)},animationStatusMngr:function(){this._shootCount>=this._gunNum&&(this._isGunEnd=!0,this._playSpecialNum<this._specialNum&&!this._isQuanLeiDa?this._isSpecialEnd=!1:this._playSpecialNum>=this._specialNum&&!this._isQuanLeiDa?(this._specialNum==GameData13.room.joinermax&&(this._isBiPaiEnd=!0,this.concealAllSpecialTypeLabel()),this._isSpecialEnd=!0,this._isLoserClear&&this._isWinnerClear?this._isClearEnd=!1:this._isLoserClear||this._isWinnerClear||(this._isClearEnd=!0)):this._isQuanLeiDa&&0==this._playQuanLeiDaNum?this._isSpecialEnd=!1:this._isQuanLeiDa&&1==this._playQuanLeiDaNum&&(this._isSpecialEnd=!0,this._isLoserClear&&this._isWinnerClear?this._isClearEnd=!1:this._isLoserClear||this._isWinnerClear||(this._isClearEnd=!0)))},setMANNER:function(e){this._MANNER=e},checkedRecommendManner:function(){if(this._recommendManner.BTN_MANNER==this._MANNER)this.cardHand.y=-348,this.cardGroup.y=-545,cc.find("ScrollView",this.cardGroup).active=!1,cc.find("pokerType",this.cardGroup).active=!0;else if(this._recommendManner.SCROLL_MANNER==this._MANNER){cc.find("ScrollView",this.cardGroup).active=!0,cc.find("pokerType",this.cardGroup).active=!1,this.initGroupType()}},checkedArrangeCards:function(){var i=this,e=GameData13.player.recommend[0],t=function(e,t,a,n){cardPoker13[n].length<=0&&(i.setCheckedCards(e),i.showCardRow(n,a,t))};this.setResetCard(this.upCardNode,"up"),this.setResetCard(this.midCardNode,"mid"),this.setResetCard(this.downCardNode,"down"),t(e[0].cards,5,this.downCardNode,"down"),t(e[1].cards,5,this.midCardNode,"mid"),t(e[2].cards,3,this.upCardNode,"up"),g.instance.playSSSAudio(SSS_AudioType.SAT_1)},releaseRes:function(e){for(var t in e)for(var a=cc.loader.getDependsRecursively(e[t]),n=0;n<a.length;n++)cc.loader.release(a[n])}});t.exports=o,cc._RF.pop()},{"../logic/poker13":"poker13",SoundMngr:"SoundMngr",errorCode:"errorCode",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],SSSSetting:[function(e,t,a){"use strict";cc._RF.push(t,"552d1Ggi91CZ6CZaOIZT1WI","SSSSetting");var n=e("SoundMngr"),i=e("roomHandler"),o=e("loginHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{dissolveBtn:cc.Button,quitBtn:cc.Button,musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,toggle_tianjin:cc.Toggle,toggle_putong:cc.Toggle,fangyanLb:cc.Label,_musicOpen:!0,_soundOpen:!0,_LanguageTypeOpen:!0},onLoad:function(){this._LanguageTypeOpen=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_local,this.musicBtn.getChildByName("guan").active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this.toggle_tianjin.node.on("toggle",this.selectLanguageTypeClick,this),this.toggle_putong.node.on("toggle",this.selectLanguageTypeClick,this),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen,this.controlBtn(),this.selectLanguageTypeOpen(),this.refreshUI()},controlBtn:function(){0<GameData.player.roomid?(this.dissolveBtn.node.active=!0,this.quitBtn.node.active=!1):(this.dissolveBtn.node.active=!1,this.quitBtn.node.active=!0)},dissolveClick:function(){if(cc.log("..dissolve"),GameData.player.uid!=GameData13.owner&&0==GameData13.game.start)return createSSSMoveMessage("牌局开始后才允许解散房间"),void closeSSSView(this.node.name);i.deleteRoom(GameData.player.roomid,"apply"),this.closeSetting()},onQuitGame:function(){o.logout()},musicClick:function(e){this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;n.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},selectLanguageTypeClick:function(e){var t=GameData.language_local;this.toggle_tianjin.isChecked&&(t=GameData.language_local),this.toggle_putong.isChecked&&(t=GameData.language_putong),cc.sys.localStorage.setItem("languageType"+GameData.player.uid,t)},selectLanguageTypeOpen:function(){this._LanguageTypeOpen==GameData.language_local?(this.toggle_tianjin.isChecked=!0,this.toggle_putong.isChecked=!1):(this.toggle_tianjin.isChecked=!1,this.toggle_putong.isChecked=!0)},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,n.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;n.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},logout:function(e){o.logout()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume,GameData.client.gameType==r.GameType.Game_Mj_Shishi?this.fangyanLb.getComponent(cc.Label).string="闽南话":GameData.client.gameType==r.GameType.Game_Mj_Tianjin&&(this.fangyanLb.getComponent(cc.Label).string="天津话")},closeSetting:function(){closeSSSView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],SetWeixin:[function(e,t,a){"use strict";cc._RF.push(t,"8c10f/cWtNK/aH2jRdFL4NW","SetWeixin");var n=e("configMgr"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{Str1:cc.Label,Str2:cc.Label,Str3:cc.Label,Str1Type:cc.Label,Str2Type:cc.Label,Str3Type:cc.Label},onLoad:function(){var e=n.getAgentWeChat();cc.log("..WXConfig:"+JSON.stringify(e)),e&&(this.Str1.string=e.accounts.number,this.Str2.string=e.agentConsult.number,this.Str3.string=e.gameProblem.number,this.Str1Type.string=e.accounts.type,this.Str2Type.string=e.agentConsult.type,this.Str3Type.string=e.gameProblem.type)},onCopyNumber1:function(){if(!inCD(1e3)){i.instance.playAudioOther("button");var e=this.Str1.string;textClipboard(e),createMoveMessage("已复制。"),console.log("Copy successed")}},onCopyNumber2:function(){if(!inCD(1e3)){i.instance.playAudioOther("button");var e=this.Str2.string;textClipboard(e),createMoveMessage("已复制。"),console.log("Copy successed")}},onCopyNumber3:function(e){if(!inCD(1e3)){i.instance.playAudioOther("button");var t=this.Str3.string;textClipboard(t),createMoveMessage("已复制。"),console.log("Copy successed")}},onClose:function(){i.instance.playAudioOther("button"),closeView("kefuweixin")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr"}],SettingsPanel:[function(e,t,a){"use strict";cc._RF.push(t,"6c5f5GMMs1Im5+kU5BhMqDt","SettingsPanel");var n=e("SoundMngr"),i=e("roomHandler"),o=e("loginHandler"),r=e("gameDefine"),s=e("configMgr");cc.Class({extends:cc.Component,properties:{musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,_musicOpen:!0,_soundOpen:!0,_LanguageTypeOpen:!0,byeRoomBtn:cc.Node,quitRoomBtn:cc.Node,toggle_tianjin:cc.Toggle,toggle_putong:cc.Toggle,musicKuang1:cc.Node,musicKuang2:cc.Node,soundKuang1:cc.Node,soundKuang2:cc.Node,areaLb:cc.Label},onLoad:function(){this._LanguageTypeOpen=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin,cc.log("language_type ==============",cc.sys.localStorage.getItem("languageType"+GameData.player.uid)),this.musicBtn.getChildByName("guan").active=!1,this.musicKuang1.active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundKuang1.active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this.toggle_tianjin.node.on("toggle",this.selectLanguageTypeClick,this),this.toggle_putong.node.on("toggle",this.selectLanguageTypeClick,this);var e=cc.director.getScene().name;cc.log("..sceneName:",e),"table"==e||"table-DDZ"==e||"table-shishi"==e||"table-TJDDZ"==e||"table-huadian1"==e||"table-changchun"==e||"table-hz"==e||"home"!=e?(r.roomType.Room_Match!=GameData.room.opts.roomType?this.byeRoomBtn.active=!0:this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!1):(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!0),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen;var t="";s.getArea()==r.AreaType.Area_Test?t="测试语言":s.getArea()==r.AreaType.Area_HuaDian?t="东北话":s.getArea()==r.AreaType.Area_TianJin?t="天津话":s.getArea()==r.AreaType.Area_ShiShi&&(t="闽南话"),cc.log("地区："+s.getArea()),this.areaLb&&(this.areaLb.string=t),this.selectLanguageTypeOpen(),this.refreshUI()},musicClick:function(e){n.instance.playAudioOther("button"),this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;n.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){n.instance.playAudioOther("button"),this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},selectLanguageTypeClick:function(e){n.instance.playAudioOther("button");var t=GameData.language_tianjin;this.toggle_tianjin.isChecked&&(t=GameData.language_tianjin),this.toggle_putong.isChecked&&(t=GameData.language_putong),cc.sys.localStorage.setItem("languageType"+GameData.player.uid,t),cc.log(t),cc.log("languageType= ",cc.sys.localStorage.getItem("languageType"+GameData.player.uid))},selectLanguageTypeOpen:function(){cc.log("=============================>",this._LanguageTypeOpen),this._LanguageTypeOpen==GameData.language_tianjin?(this.toggle_tianjin.isChecked=!0,this.toggle_putong.isChecked=!1):(this.toggle_tianjin.isChecked=!1,this.toggle_putong.isChecked=!0)},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicKuang2.active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen,this.musicKuang1.active=!this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundKuang2.active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen,this.soundKuang1.active=!this._soundOpen},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,n.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;n.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},onClose:function(){n.instance.playAudioOther("button"),closeView(this.node.name)},requestDissolve:function(){if(GameData.room.opts){if(GameData.player.uid!=GameData.joiners[0].uid&&GameData.joiners.length<GameData.room.opts.joinermax)return createMoveMessage("牌局开始后才允许解散房间"),void closeView(this.node.name);switch(i.deleteRoom(GameData.room.id,"apply"),GameData.client.gameType==r.GameType.Game_Poker_TianjinDDZ&&i.deleteRoom(GameData.room.id,"apply"),closeView(this.node.name),GameData.client.gameType){case r.GameType.Game_Poker_DDZ:this.node.parent.getComponent("DDZ-roomMain").showdissolveLayer(1,1),this.node.parent.getComponent("DDZ-roomDissolve").showPlayers(),this.node.parent.getComponent("DDZ-roomDissolve").alreadyAgree();break;case r.GameType.Game_Poker_TianjinDDZ:this.node.parent.getComponent("TJDDZ-roomMain").showdissolveLayer(1,1),this.node.parent.getComponent("TJDDZ-roomDissolve").showPlayers(),this.node.parent.getComponent("TJDDZ-roomDissolve").alreadyAgree();break;case r.GameType.Game_Mj_Tianjin:this.node.parent.getComponent("roomMain").showdissolveLayer(1,1),this.node.parent.getComponent("roomDissolve").showPlayers(),this.node.parent.getComponent("roomDissolve").alreadyAgree();break;case r.GameType.Game_Mj_Shishi:this.node.parent.getComponent("roomMain-shishi").showdissolveLayer(1,1),this.node.parent.getComponent("roomDissolve-shishi").showPlayers(),this.node.parent.getComponent("roomDissolve-shishi").alreadyAgree();break;case r.GameType.Game_MJ_HuaDian:this.node.parent.getComponent("roomMain_huadian").showdissolveLayer(1,1),this.node.parent.getComponent("roomDissolve_huadian").showPlayers(),this.node.parent.getComponent("roomDissolve_huadian").alreadyAgree();break;case r.GameType.Game_Mj_CC:this.node.parent.getComponent("roomMain_changchun").showdissolveLayer(1,1),this.node.parent.getComponent("roomDissolve_changchun").showPlayers(),this.node.parent.getComponent("roomDissolve_changchun").alreadyAgree()}}},logout:function(e){n.instance.playAudioOther("button"),o.logout()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.soundKuang1.active=!GameData.SetLayerData.soundOpen,this.soundKuang2.active=GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume,this.musicKuang2.active=GameData.SetLayerData.musicOpen,this.musicKuang1.active=!GameData.SetLayerData.musicOpen}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],SharePanel:[function(e,t,a){"use strict";cc._RF.push(t,"ce14cP2tA5JzaSp4lYLr8OK","SharePanel");var n=e("configMgr"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{},onLoad:function(){},onClose:function(){closeView(this.node.name)},onShareWeixin:function(){i.instance.playAudioOther("button"),cc.log("share weixin");var e=n.getGameName(),t=n.getWxWelcomeText();wxShareWeb(e,t)},onSharePengyouQuan:function(){i.instance.playAudioOther("button"),cc.log("share peng youquan");var e=n.getGameName();wxShareTimeline(e,"玩家ID："+GameData.player.uid+"邀请您加入【"+e+"】，点击分享信息后，进入该产品下载界面。")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr"}],SoundMngr:[function(e,t,a){"use strict";cc._RF.push(t,"97a18b8RCZFNLbM0Mp+bjrL","SoundMngr");var i=e("gameDefine"),n=cc.Class({extends:cc.Component,properties:{displayId:0,displayUrl:"",displayAudio:{url:cc.AudioClip,default:null}},statics:{instance:null},onLoad:function(){cc.game.addPersistRootNode(this.node),n.instance=this},stopAll:function(){this.displayId=0,this.displayUrl="",cc.audioEngine.stopAll()},playMusic:function(e){if(this.displayUrl!=e){var n=this;this.displayUrl=e,cc.audioEngine.stop(this.displayId),cc.loader.loadRes(e,cc.AudioClip,function(e,t){var a=1==GameData.SetLayerData.musicOpen?GameData.SetLayerData.musicVolume:0;n.displayAudio=t,n.displayId=cc.audioEngine.play(n.displayAudio,!0,a),cc.audioEngine.setVolume(n.displayId,a)})}},bgmVolume:function(e){cc.audioEngine.setVolume(this.displayId,e)},playAudio:function(e,t,a){cc.log("...type, card, sex:"+e,t,a);var n="",i=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin;switch(e){case"dis":n="card_"+t;break;case"peng":n="peng";break;case"gang":n="gang";break;case"hu":n="hu";break;case"chi":n="chi";break;default:return}var o="";i==GameData.language_putong?o=1==a?"putong/boy/":"putong/girl/":i==GameData.language_tianjin&&(o=1==a?"tianjin/boy/":"tianjin/girl/");var r="resources/sound/"+o+n+".mp3";cc.log("...play audio "+n),cc.log("...audioUrl "+r);var s=new cc.AudioSource;s.clip=cc.url.raw(r),0==GameData.SetLayerData.soundOpen?s.volume=0:s.volume=GameData.SetLayerData.soundVolume,s.play()},playAudioChat:function(e,t){console.log("GameData.client.sex,GameData.player.uid",GameData.client.sex,GameData.player.uid,GameData.player.sex);var a="";GameData.client.gameType==i.GameType.Game_Mj_Tianjin?a=1==t?"resources/sound/tianjin/boy/":"resources/sound/tianjin/girl/":GameData.client.gameType==i.GameType.Game_niu_niu||GameData.client.gameType==i.GameType.Game_Niu_Niu_10?(cc.log("..niuniu"),a=1==t?"resources/sound/niuniu/nan/":"resources/sound/niuniu/nv/"):GameData.client.gameType==i.GameType.Game_TDK?(cc.log("..tdk"),a=1==t?"resources/TDK/sound/man/":"resources/TDK/sound/woman/"):GameData.client.gameType==i.GameType.Game_Mj_Shishi?(cc.log("..shishi"),a=1==t?"resources/shishi/sound/shishi_fangyan/man/":"resources/shishi/sound/shishi_fangyan/woman/"):GameData.client.gameType==i.GameType.Game_MJ_HuaDian||GameData.client.gameType==i.GameType.Game_Mj_CC||GameData.client.gameType==i.GameType.Game_Mj_Heb?(cc.log("..huadian or changchun or heb"),a=1==t?"resources/huadian/sound/boy/":"resources/huadian/sound/girl/"):GameData.client.gameType==i.GameType.Game_Poker_ZJH&&(cc.log("..ZJH"),a=1==t?"resources/zjh/sound/man/":"resources/zjh/sound/women/");var n=new cc.AudioSource;n.clip=cc.url.raw(a+e+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playAudioOther:function(e){var t="";switch(e){case"click":t="card_click";break;case"out":t="card_out";break;case"countdown":t="countdown";break;case"button":t="button";break;default:return}var a=new cc.AudioSource;a.clip=cc.url.raw("resources/sound/"+t+".mp3"),0==GameData.SetLayerData.soundOpen?a.volume=0:a.volume=GameData.SetLayerData.soundVolume,a.play()},playAudioHu:function(e,t){var a="",n=new cc.AudioSource,i="";switch(i=1==t?"tianjin/boy/":"tianjin/girl/",e.type.sort(function(e,t){return e-t}),e.type.toString()){case"2":a="1";break;case"3":a="2";break;case"2,10":a="3";break;case"5":a="4";break;case"6":a="5";break;case"3,10":a="6";break;case"2,10":a="7";break;case"4,5":a="8";break;case"2,5":a="9";break;case"5,10":a="10";break;case"5,6":a="11";break;case"7":a="12";break;case"3,6":a="13";break;case"3,7":a="14";break;case"2,6":a="15";break;case"6,10":a="16";break;case"4,5,10":a="17";break;case"2,5,10":a="18";break;case"4,5,6":a="19";break;case"5,7":a="20";break;case"2,5,6":a="21";break;case"5,6,10":a="22";break;case"7,10":a="23";break;case"3,6,10":a="24";break;case"2,6,10":a="25";break;case"2,7":a="26";break;case"4,5,7":a="27";break;case"2,5,6,10":a="28";break;case"5,7,10":a="29";break;case"2,5,7":a="30";break;case"3,7,10":a="31";break;case"2,7,10":a="32";break;case"2,5,7,10":a="33";break;case"8":a="34";break;case"4":a="2";break;default:return}n.clip=cc.url.raw("resources/sound/"+i+"card_h_"+a+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playAudioPokerDisType:function(e,t,a){var n="",i=new cc.AudioSource,o="";switch(o=1==t?"boy/":2==t?"girl/":"boy/",e.detail.type){case"straights":n=a?"dani"+Math.floor(3*Math.random()+1):"shunzi";break;case"threeAndOne":n=a?"dani"+Math.floor(3*Math.random()+1):"sandaiyi";break;case"threeAndTwo":n=a?"dani"+Math.floor(3*Math.random()+1):"sandaier";break;case"fourAndTwo":n=a?"dani"+Math.floor(3*Math.random()+1):"sidaier";break;case"fourAndFour":n=a?"dani"+Math.floor(3*Math.random()+1):"sidailiangdui";break;case"doublestraights":n=a?"dani"+Math.floor(3*Math.random()+1):"liandui";break;case"bomb":n="zhadan";break;case"jokerBomb":n="wangzha";break;case"aircraft":case"aircraft2":case"aircraft3":case"aircraft4":case"aircraft5":case"aircraft6":case"aircraft7":case"aircraft8":n=a?"dani"+Math.floor(3*Math.random()+1):"feiji";break;case"singleCard":n="dan"+e.detail.card;break;case"doubleCards":n="dui"+e.detail.card;break;case"threeCards":n=a?"dani"+Math.floor(3*Math.random()+1):"san"+e.detail.card;break;default:return}i.clip=cc.url.raw("resources/ddz/sound/"+o+n+".mp3"),0==GameData.SetLayerData.soundOpen?i.volume=0:i.volume=GameData.SetLayerData.soundVolume,i.play()},playOtherAudioPoker:function(e,t){var a="",n=new cc.AudioSource,i="";switch(cc.log("sex "+t),i=1==t?"boy/":2==t?"girl/":"",e){case"buyao":a="buyao"+Math.floor(4*Math.random()+1);break;case"pdk-buyao":a="buyao4";break;case"baojing1":a="baojing1";break;case"baojing2":a="baojing2";break;case"baojing":a="baojing";break;case"yifen":a="yifen";break;case"liangfen":a="liangfen";break;case"sanfen":a="sanfen";break;case"bujiao":a="bujiao";break;case"bomb":a="bomb";break;case"chuntian":a="chuntian";break;case"plane":a="plane";break;case"shengli":a="shengli";break;case"shibai":a="shibai";break;case"click":a="click";break;case"discard":a="discard";break;default:return}WriteLog("resAudio"+a),WriteLog("SexPath"+i),n.clip=cc.url.raw("resources/ddz/sound/"+i+a+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playAudioPokerChat:function(e,t){var a="";a=1==t?"boy/":"girl/";var n=new cc.AudioSource;n.clip=cc.url.raw("resources/ddz/sound/"+a+e+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playNiuNiuAudio:function(e,t){t=t||1;var a="resources/sound/niuniu/"+(1==parseInt(t)?"nan/niu_":"nv/niu_")+e+".mp3";-1==e&&(a="resources/sound/niuniu/startgame.mp3"),-2==e&&(a="resources/sound/niuniu/xitongfapai.mp3"),-3==e&&(a="resources/sound/niuniu/niu_win.mp3"),-4==e&&(a="resources/sound/niuniu/niu_lose.mp3"),-5==e&&(a="resources/sound/niuniu/jinbi.mp3"),-6==e&&(a="resources/sound/niuniu/lunzhuang.mp3"),-7==e&&(a="resources/sound/niuniu/dingzhuang.mp3");var n=new cc.AudioSource;n.clip=cc.url.raw(a),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playSSSAudio:function(e){if(!(null==e||e.length<=0)){var t=e,a=new cc.AudioSource;a.clip=cc.url.raw("resources/shisanshui/sound/"+t+".mp3"),0==GameData.SetLayerData.soundOpen?a.volume=0:a.volume=GameData.SetLayerData.soundVolume,a.play()}},playSSSSpeakAudio:function(e,t){if(!(null==e||null==t||e.length<=0)){var a="";a=1==t?"man/"+e:"woman/"+e+"_n";var n=new cc.AudioSource;n.clip=cc.url.raw("resources/shisanshui/sound/"+a+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()}},playTDKAudio:function(e,t){var a="",n="";switch(n=1==t?"man/0_":"woman/1_",e){case 2:a="kou"+Math.floor(2*Math.random()+1);break;case 3:a="xz1";break;case 4:a="gen"+Math.floor(2*Math.random()+1);break;case 5:a="ti"+Math.floor(2*Math.random()+1);break;case 6:a="bt"+Math.floor(2*Math.random()+1);break;case 7:a="ft"+Math.floor(2*Math.random()+1);break;case 8:a="quanxia";break;case"kaipai":a="bp"+Math.floor(2*Math.random()+1)}var i=new cc.AudioSource;i.clip=cc.url.raw("resources/TDK/sound/"+n+a+".mp3"),0==GameData.SetLayerData.soundOpen?i.volume=0:i.volume=GameData.SetLayerData.soundVolume,i.play()},playTDKOther:function(e){var t="";switch(e){case"fapai":t="card";break;case"chouma":t="chip_end";break;case"start":t="start";break;case"languo":t="languo";break;case"win":t="dayingjia";break;case"lost":t="lost";break;case"xiaguo":t="chip_add"}var a=new cc.AudioSource;a.clip=cc.url.raw("resources/TDK/sound/"+t+".mp3"),0==GameData.SetLayerData.soundOpen?a.volume=0:a.volume=GameData.SetLayerData.soundVolume,a.play()},playAudioShiShi:function(e,t,a){var n="",i=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin;switch(e){case"dis":n="card_"+t;break;case"peng":n="peng";break;case"gang":n="gang";break;case"hu":n="hu";break;case"chi":n="chi";break;case"buhua":n="buhua";break;default:return}var o="";i==GameData.language_putong?o=1==a?"shishi_putong/man/":"shishi_putong/woman/":i==GameData.language_tianjin&&(o=1==a?"shishi_fangyan/man/":"shishi_fangyan/woman/"),cc.log("play audio "+n);var r=new cc.AudioSource;console.log("LanguagePath "+o),r.clip=cc.url.raw("resources/shishi/sound/"+o+n+".mp3"),cc.log(o),0==GameData.SetLayerData.soundOpen?r.volume=0:r.volume=GameData.SetLayerData.soundVolume,r.play()},playAudioHD:function(e,t,a){var n="",i=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin;switch(console.log("LanguageType:"+cc.sys.localStorage.getItem("languageType"+GameData.player.uid)),e){case"dis":n="card_"+t;break;case"cha":n="cha";break;case"andan":n="andan";break;case"mingdan":n="mingdan";break;case"hu":n="hu";break;case"chi":n="chi";break;case"buhua":n="buhua";break;case"ting":n="ting";break;default:return}var o="";i==GameData.language_putong?o=1==a?"sound/putong/boy/":"sound/putong/girl/":i==GameData.language_tianjin&&(o=1==a?"huadian/sound/boy/":"huadian/sound/girl/");var r=new cc.AudioSource;console.log("LanguagePath "+o),r.clip=cc.url.raw("resources/"+o+n+".mp3"),0==GameData.SetLayerData.soundOpen?r.volume=0:r.volume=GameData.SetLayerData.soundVolume,r.play()},playAudioCC:function(e,t,a){var n="",i=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin;switch(console.log("LanguageType:"+cc.sys.localStorage.getItem("languageType"+GameData.player.uid)),e){case"dis":n="card_"+t;break;case"cha":n="cha";break;case"andan":n="andan";break;case"mingdan":n="mingdan";break;case"hu":n="hu";break;case"chi":n="chi";break;case"ting":n="ting";break;case"dan":n="dan";break;default:return}var o="";i==GameData.language_putong?o=1==a?"changchun/sound/putong/boy/":"changchun/sound/putong/girl/":i==GameData.language_tianjin&&(o=1==a?"changchun/sound/local/boy/":"changchun/sound/local/girl/");var r=new cc.AudioSource;console.log("LanguagePath "+o),r.clip=cc.url.raw("resources/"+o+n+".mp3"),0==GameData.SetLayerData.soundOpen?r.volume=0:r.volume=GameData.SetLayerData.soundVolume,r.play()},playAudioZJH:function(e,t){var a="";null!=t&&(a+=1==t?"man/":"women/"),a+=e;var n=new cc.AudioSource;n.clip=cc.url.raw("resources/zjh/sound/"+a+".mp3"),0==GameData.SetLayerData.soundOpen?n.volume=0:n.volume=GameData.SetLayerData.soundVolume,n.play()},playTableDynAudio:function(e,t){if(null!=e&&null!=t){var a=void 0,n=void 0;switch(parseInt(e)){case 0:a="FW_";break;case 1:a="ZD_";break;case 2:a="JD_";break;case 3:a="MG_";break;case 4:a="BZ_";break;case 5:a="PJ_"}switch(parseInt(t)){case 0:n="feixing";break;case 1:n="xiaoguo"}var i=cc.url.raw("resources/sound/dyn/"+a+n+".mp3");if(i){var o=new cc.AudioSource;o.clip=i,0==GameData.SetLayerData.soundOpen?o.volume=0:o.volume=GameData.SetLayerData.soundVolume,o.play()}}},playHundredOther:function(e){var t="";switch(e){case"fapai":t="fapai";break;case"chouma":t="chouma";break;case"result":t="coinsfly";break;case"winsign":t="winsign";break;case"stop":t="tingzhixiazhu";break;case"start":t="kaishixiazhu";break;case"countDown":t="daojishi";break;case"baozhuang":t="baozhuang";break;case"guide":t="shensuanzibaoxing";break;case"shangzhuang":t="shangzhuang";break;case"zhuangWin":t="zhuangjiatongchi";break;case"zhuangLose":t="zhuangjiatongpei"}var a=new cc.AudioSource;a.clip=cc.url.raw("resources/hundredNiuNiu/uiResources/sound/"+t+".mp3"),0==GameData.SetLayerData.soundOpen?a.volume=0:a.volume=GameData.SetLayerData.soundVolume,a.play()}});cc._RF.pop()},{gameDefine:"gameDefine"}],SpecialTypeAnimatePanel:[function(e,t,a){"use strict";cc._RF.push(t,"83fd2v/o5lIUZmDndM6sAiq","SpecialTypeAnimatePanel"),cc.Class({extends:cc.Component,properties:{specialName:{default:null,type:cc.Label},animation:{default:null,type:cc.Node},poker:{default:null,type:cc.Node}},onLoad:function(){},showCards:function(){var e=this.id,t=[];for(var a in GameData13.roomResult.cards)if(cc.log("special and uid: ",a,e),GameData13.roomResult.cards[a].special==e){cc.log("allCards: ",GameData13.roomResult.cards[a].allCards),t=GameData13.roomResult.cards[a].allCards;break}for(var n=0;n<GameData13.handSize;n++){var i=cc.find("cardhand/card"+n,this.poker);if(t.length<=0)return void cc.log("special cardHand of null");var o="resources/shisanshui/cardUI/"+(t[n].value+1)+"_"+(t[n].type+1)+".png",r=cc.textureCache.addImage(cc.url.raw(o));i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(r)}},play:function(){},setSpecialName:function(e,t){this.id=t,this.specialName.string=e}}),cc._RF.pop()},{}],"TDK-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"ef4bdf7QH1E/6pnn1FHfq+Z","TDK-createRoom");e("roomHandler");var n=e("tdkRoomData"),c=e("configMgr"),d=e("gameDefine");cc.Class({extends:cc.Component,properties:{round15_tdk:cc.Toggle,round30_tdk:cc.Toggle,player3_tdk:cc.Toggle,player4_tdk:cc.Toggle,player5_tdk:cc.Toggle,player6_tdk:cc.Toggle,pay1_tdk:cc.Toggle,pay2_tdk:cc.Toggle,pay3_tdk:cc.Toggle,qi9_tdk:cc.Toggle,qi10_tdk:cc.Toggle,daiwang_tdk:cc.Toggle,languofanbei_tdk:cc.Toggle,quanya1_tdk:cc.Toggle,quanya2_tdk:cc.Toggle,quanya3_tdk:cc.Toggle,spendUI_tdk:{default:[],type:[cc.Label]},drowArray_tdk:{default:[],type:[cc.Node]}},onLoad:function(){this.modeType=1,this.spendData=void 0,this.refreshUI()},getModeType:function(){return this.modeType},createRoom:function(){GameData.setGameType(d.GameType.Game_TDK),this.saveRuleFromUI();var e={gameType:d.GameType.Game_TDK,roundType:1,roundMax:n.createRoomOpts.roundMax,roundRule:n.createRoomOpts.roundRule,joinermax:n.createRoomOpts.player,roomType:0,costType:n.createRoomOpts.costType,cardType:n.createRoomOpts.playType,allin:n.createRoomOpts.quanya,king:n.createRoomOpts.king,nextDouble:n.createRoomOpts.nextDouble,clubId:0,currencyType:null,settleType:null},t=c.getModeType();return null==t||null==t.Game_TDK||(e.currencyType=t.Game_TDK.CurrencyType,e.settleType=t.Game_TDK.SettleType,n.onRoomReadyInfo={}),e},saveRuleFromUI:function(){this.player3_tdk.isChecked?n.createRoomOpts.player=3:this.player4_tdk.isChecked?n.createRoomOpts.player=4:this.player5_tdk.isChecked?n.createRoomOpts.player=5:this.player6_tdk.isChecked&&(n.createRoomOpts.player=6),this.round15_tdk.isChecked?(n.createRoomOpts.roundMax=15,n.createRoomOpts.roundRule=71):this.round30_tdk.isChecked&&(n.createRoomOpts.roundMax=30,n.createRoomOpts.roundRule=72),this.pay1_tdk.isChecked?n.createRoomOpts.costType=1:this.pay2_tdk.isChecked?n.createRoomOpts.costType=2:this.pay3_tdk.isChecked&&(n.createRoomOpts.costType=3),this.qi9_tdk.isChecked?n.createRoomOpts.playType=1:this.qi10_tdk.isChecked&&(n.createRoomOpts.playType=2),this.quanya1_tdk.isChecked?n.createRoomOpts.quanya=0:this.quanya2_tdk.isChecked?n.createRoomOpts.quanya=30:this.quanya3_tdk.isChecked&&(n.createRoomOpts.quanya=60),n.createRoomOpts.king=this.daiwang_tdk.isChecked,n.createRoomOpts.nextDouble=this.languofanbei_tdk.isChecked,n.saveCreateRoomOpts()},refreshUI:function(){cc.log("tdk_roomData.createRoomOpts = "+JSON.stringify(n.createRoomOpts)),this.round15_tdk.isChecked=15==n.createRoomOpts.roundMax,this.round30_tdk.isChecked=30==n.createRoomOpts.roundMax,this.player3_tdk.isChecked=3==n.createRoomOpts.player,this.player4_tdk.isChecked=4==n.createRoomOpts.player,this.player5_tdk.isChecked=5==n.createRoomOpts.player,this.player6_tdk.isChecked=6==n.createRoomOpts.player,this.qi9_tdk.isChecked=1==n.createRoomOpts.playType,this.qi10_tdk.isChecked=2==n.createRoomOpts.playType,this.pay1_tdk.isChecked=!0,this.pay2_tdk.isChecked=!1,this.pay3_tdk.isChecked=!1,this.quanya1_tdk.isChecked=0==n.createRoomOpts.quanya,this.quanya2_tdk.isChecked=30==n.createRoomOpts.quanya,this.quanya3_tdk.isChecked=60==n.createRoomOpts.quanya,this.daiwang_tdk.isChecked=n.createRoomOpts.king,this.languofanbei_tdk.isChecked=n.createRoomOpts.nextDouble,this.showSpendUI_tdk()},selectSpendData:function(e){this.showSpendUI_tdk()},showSpendUI_tdk:function(){cc.log("..mode..tdk");var e="",t="",a=c.getModeType();if(null!=a&&null!=a.Game_TDK){var n=c.getServerConfig();if(null!=n){switch(this.modeType=a.Game_TDK.CurrencyType,this.modeType){case d.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[d.GameType.Game_TDK];break;case d.currencyType.Currency_Coin:e="金币",this.spendData=n.roomCoin[d.GameType.Game_TDK]}if(this.spendData)for(var i=0;i<Object.keys(this.spendData).length;i++){var o=0;if(this.modeType==d.currencyType.Currency_Card){var r=this.spendData[i+71].cost,s=3;this.player3_tdk.isChecked?s=3:this.player4_tdk.isChecked?s=4:this.player5_tdk.isChecked?s=5:this.player6_tdk.isChecked&&(s=6),o=r[s].final,this.pay2_tdk.isChecked&&(o=Math.ceil(o/s),t="/人")}else o=this.spendData[i].cost;this.drowArray_tdk[i].active=0==o,this.spendUI_tdk[i].string="（"+e+"*"+o+t+"）"}else cc.log("..spendData is undefined")}}}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler",tdkRoomData:"tdkRoomData"}],"TDK-playerTemplate":[function(e,t,a){"use strict";cc._RF.push(t,"5f3a4YHYbVOYo07dh45pKX/","TDK-playerTemplate");var i=e("roomHandler");cc.Class({extends:cc.Component,properties:{uid:0,headBtn:cc.Button,headIcon:cc.Sprite,zhuangIcon:cc.Sprite,zhuangNumIcon:cc.Sprite,nameLabel:cc.Label,score:cc.Node,_player:null,fonts:{default:[],type:cc.Font}},onLoad:function(){},setPlayer:function(e){this._player=e,this.uid=this._player.uid},setName:function(e){this.nameLabel.string=getShortStr(e,4)},setHeadIcon:function(e){if(null==e||""==e||e.length<=0)this.headIcon.spriteFrame=null;else{var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.headIcon.spriteFrame=new cc.SpriteFrame(t))})}},showPlayerIdentity:function(e,t){if(this.setIsPlayerIcon(e),1==t){var a=cc.textureCache.addImage(cc.url.raw("resources/ddz/UI/common/icon/dizhu_icon.png"));this.zhuangIcon.spriteFrame=new cc.SpriteFrame(a)}else if(2==t){a=cc.textureCache.addImage(cc.url.raw("resources/ddz/UI/common/icon/nongmin_icon.png"));this.zhuangIcon.spriteFrame=new cc.SpriteFrame(a)}},setIsPlayerIcon:function(e){this.zhuangIcon.node.active=e},setNamePositionByDir:function(e){"right"==e&&(this.nameLabel.node.x=-57,this.score.x=-53,this.zhuangIcon.node.x=33,console.log("this.nameLabel:"+this.nameLabel.horizontalAlign),this.nameLabel.horizontalAlign=3,this.nameLabel.node.anchorX=1,this.score.horizontalAlign=3,this.score.anchorX=1)},showZhuang:function(e){this.zhuangIcon.node.active=e},showZhuangNum:function(e,t){},enableHeadBtn:function(e){this.headBtn.node.active=e},onHeadBtnClicked:function(e){var t=cc.director.getScene().name;if(cc.log("..sceneName:",t),"home"==t)createPlayerInfoPanel(this._player);else{var a=this,n=i.getRoomData();n&&n.opts&&n.opts.gameType&&(cc.log("..gameType:"+n.opts.gameType),openPlayerInfoView(n.opts.gameType,function(e){if(e){var t=e.getComponent("uiRoomPlayerInfo");t&&t.onShow(a._player)}}))}},setCoin:function(e){var t="";0<e?t="+"+e:e<0?t=e:0==e&&(t=e),cc.find("coin",this.node).getComponent(cc.Label).string=t},getLiuGuang:function(e){cc.find("liuguang",this.node).active=e},setIsOnline:function(e){var t=cc.find("Disconnect",this.node),a=i.isPlayerOnline(e);t.active=!a}}),cc._RF.pop()},{roomHandler:"roomHandler"}],"TDK-poker":[function(e,t,a){"use strict";cc._RF.push(t,"195c5vSPb9CfYGl4KhXWWiD","TDK-poker");e("SoundMngr");cc.Class({extends:cc.Component,properties:{pokerId:0,index:0},onLoad:function(){}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"TDK-roomDissolve":[function(e,t,a){"use strict";cc._RF.push(t,"78ad6z60+hCU43thoIz8uxU","TDK-roomDissolve");var r=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&(cc.log("GameData.game.onRoomDissolve = "+JSON.stringify(GameData.game.onRoomDissolve)),sendEvent("onRoomDissolve",GameData.game.onRoomDissolve)),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showHeaderConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showHeaderConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.opts.joinermax-1;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+(e+2),t.x=this.headerNode.x+190*(e+1)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){var n=a.uid,i=a.headimgurl;this.showHeaderIcon(t,i),this.showHeaderName(t,a.name);var o=r.isPlayerOnline(n);cc.find("header_"+t+"/lost",this.headerNode.parent).active=!o}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(e,t){var a=cc.find("header_"+e+"/headimg",this.headerNode.parent);null==t||""==t||t.length<=0?a.getComponent(cc.Sprite).spriteFrame=null:cc.loader.load({url:t,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return NiuNiuMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("TDK-roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("TDK-roomMain").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("TDK-roomMain").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){r.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("TDK-roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){r.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){r.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(r.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}},showHeaderConnect:function(){for(var e=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid,a=r.isPlayerOnline(t),n=e+1;cc.find("header_"+n+"/lost",this.headerNode.parent).active=!a}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],"TDK-roomMain":[function(e,t,a){"use strict";cc._RF.push(t,"2c65fOzAT1CM5tVf6zcxPFV","TDK-roomMain");var n=e("SoundMngr"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){cc.log("22222222222"),registEvent("onRoomInfo",this,this.showLayer),this.showLayer();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(1e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToNodeSpace(t),n={x:this.getContentSize().width/2,y:this.getContentSize().height/2};cc.pDistance(a,n)>this.getContentSize().width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()})},onEnable:function(){},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),GameData.initRoomData()},showLayer:function(){cc.log("GameData.room.status = "+GameData.room.status),GameData.room.status>TDKPokerCard.STATUS.WAITING?this.showTableLayer():this.showWaitLayer()},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("TDK/sound/backGround")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("TDK/sound/backGround")},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showSettingLayer:function(e,t){1==t?(this.settingLayer.active=!0,this.settingLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.resultLayer.active=!0,this.dissolveLayer.active=!1,GameData.realNum=0,this.resultLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||openView("TDKChatPanel",i.GameType.Game_TDK)},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)},AnimationDelayTime:function(e){this._AnimationDelayTime=e.detail}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"TDK-roomSummary":[function(e,t,a){"use strict";cc._RF.push(t,"3ece2ffqz9OOpUXUD8GMYyB","TDK-roomSummary");var n=e("roomHandler"),i=e("tdkRoomData");cc.Class({extends:cc.Component,properties:{playerRender:cc.Prefab,content:cc.Node,panel:cc.Node},onLoad:function(){this._roomInfo=n,this.handlerMsg(),registEvent("onGameAllResult",this,this.initUI),0<Object.keys(i.resultData).length&&this.initUI()},oonEnable:function(){unregistEvent("onGameAllResult",this,this.initUI)},initUI:function(){this.showTime(this._roomInfo.room.createtime,this._roomInfo.room.id),this.content.removeAllChildren();for(var e=0;e<6;e++){(a=cc.instantiate(this.playerRender)).x=6+212*e,this.content.addChild(a)}var t=this.content.children;for(e=0;e<t.length;e++){var a;if(e<this._roomInfo.players.length)(a=t[e]).getComponent("tdk-ResultRender").initData(this._roomInfo.players[e]),a.getComponent("tdk-ResultRender").getActiveNode().active=!0;else(a=t[e]).getComponent("tdk-ResultRender").getActiveNode().active=!1}},showTime:function(e,t){var a=cc.find("roomID",this.panel),n=cc.find("date",this.panel),i=cc.find("time",this.panel),o=new Date(e),r=o.getFullYear(),s=o.getMonth()+1,c=o.getDate(),d=o.getHours();d<10?d="0"+d+":":d+=":";var h=o.getMinutes();h<10?h="0"+h+":":h+=":";var l=o.getSeconds();l=l<10?"0"+l:l,a.getComponent("cc.Label").string="房号 : "+t,n.getComponent("cc.Label").string=r+"-"+s+"-"+c,i.getComponent("cc.Label").string=d+h+l},btnBackOnClicked:function(e){GameData.player.roomid=void 0,GameData.joiners=[],GameData.game.onRoomDissolve=null,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)},handlerMsg:function(){},onDestroy:function(){}}),cc._RF.pop()},{roomHandler:"roomHandler",tdkRoomData:"tdkRoomData"}],"TDK-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"62c1dPE6hVBHK57V07da30O","TDK-roomWait");var f=e("SoundMngr"),l=e("roomHandler"),h=e("tdkRoomData");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,roomNode:cc.Node,readyNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,btnRule:cc.Button,lostInfo:[],playerNodes:{default:[],type:cc.Node},ruleNode:cc.Node,readyBtn:cc.Node,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.initPlayers(this),registEvent("onTurner",this,this.onGameTurn),registEvent("onRoomInfo",this,this.initPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("onPlayerIncScore",this,this.initPlayers),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("onIncScore",this,this.getConnectChipsScore),registEvent("onPlayerIncScore",this,this.getEveryOneScore),registEvent("onPlayerInitScore",this,this.getEveryOneScore),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("AnimationDelayTime",this,this.onGameScoreHandler),registEvent("dynChat",this,this.dynChatHandler),this.updateTime(),this.updataWifi(),this.electricQuantity();var e=GameData.player.uid==GameData.room.creator;this.deleteRoomBtn.active=e,this.quitRoomBtn.active=!e,this.getConnectChipsScore(),this.onGameTurn(),this.addDynAnimation()},onEnable:function(){},onDestroy:function(){unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),unregistEvent("yunwaUploaded",this,this.onYunwaUploaded),unregistEvent("HideReadyNode",this,this.HideReadyNode),unregistEvent("AnimationDelayTime",this,this.onGameScoreHandler),unregistEvent("onRoomInfo",this,this.initPlayers),unregistEvent("onTurner",this,this.onGameTurn),unregistEvent("onPlayerIncScore",this,this.getEveryOneScore),unregistEvent("onPlayerInitScore",this,this.getEveryOneScore),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(e){},HideReadyNode:function(){},showRule:function(e){var t=cc.find("ruleNode1/rule1",this.ruleNode),a=cc.find("ruleNode2/playerNum",this.ruleNode),n=cc.find("ruleNode2/king",this.ruleNode),i=cc.find("ruleNode2/keng",this.ruleNode),o=cc.find("ruleNode2/languo",this.ruleNode),r=(cc.find("ruleNode2/moti",this.ruleNode),cc.find("ruleNode2/quanya",this.ruleNode));t.getComponent(cc.Label).string="填大坑  共"+e.roundMax+"局",a.getComponent(cc.Label).string=e.joinermax+"人局",1===e.cardType?i.getComponent(cc.Label).string="半坑(9起)":2===e.cardType&&(i.getComponent(cc.Label).string="半坑(10起)"),!0===e.king?n.getComponent(cc.Label).string="带王":n.getComponent(cc.Label).string="不带王",!0===e.nextDouble?o.getComponent(cc.Label).string="烂锅翻倍":o.getComponent(cc.Label).string="烂锅不翻倍",0===e.allin?r.getComponent(cc.Label).string="不带全压":30===e.allin?r.getComponent(cc.Label).string="全压30倍":60===e.allin&&(r.getComponent(cc.Label).string="全压60倍");var s=l.room.roundNum,c=l.room.opts,d=cc.find("roundBg/txt",this.roomNode),h=s>c.roundMax?c.roundMax:s;d.getComponent(cc.Label).string="局数:"+h+"/"+c.roundMax,cc.find("quanya/txt",this.roomNode).getComponent(cc.Label).string="全压:"+GameData.room.opts.allin},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++);},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("TDK-playerTemplate").uid==t){var o=cc.find("chat",i);if(null!=o){var r=cc.find("word",o),s=cc.find("emo",o),c=cc.find("yuyinNode",o);if("word"==a){var d=e.detail.msg.data,h=cc.find("word/bg",o),l=cc.find("word/Label",o).getComponent(cc.Label),u=d;h.width=20+24*u.length,r.getComponent("HideComponent").show(3),l.string=u}else if("fast"==a){var m=e.detail.msg.data.sound;d=e.detail.msg.data.content,h=cc.find("word/bg",o),l=cc.find("word/Label",o).getComponent(cc.Label),u=getShortStr(d,10);h.width=30*u.length,r.getComponent("HideComponent").show(3),l.string=u,f.instance.playAudioChat(m,this.playerSex)}else if("emo"==a){var p=e.detail.msg.data;cc.log("animationName:"+p),s.getComponent(cc.Animation).play(p),s.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var g=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",g):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(g)),cc.find("yuyinAnimNode/yuyinAnim",c).getComponent(cc.Animation).play("yuyinduihua"),c.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("TDK-playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},initPlayers:function(){this.headers=[];for(var e=0;e<this.playerNodes.length;e++)this.playerNodes[e].active=!1;cc.log("joinersNum:"+GameData.joiners.length);for(var t=0;t<GameData.joiners.length;t++)if(null!=GameData.joiners[t]){var a=GameData.joiners[t].uid,n=h.getPlayerInfoByUid(a),i=h.getLocalPosition(t);cc.log("localIdx:"+i);var o=this.playerNodes[i].getChildByName("TableTDKPlayerTemplate");o.parent.active=!0;var r=o.getComponent("TDK-playerTemplate");r.setPlayer(n),r.setHeadIcon(n.headimgurl),r.setName(n.name),r.setIsOnline(a),this.headers.push(o)}this.setRoomNum(),this.onRoomReadyInfoHandler(),this.showRule(GameData.room.opts)},onReadyBtnClick:function(){var t=this;GameNet.getInstance().request("room.roomHandler.ready",{},function(e){t.readyBtn.active=!1})},ruleClick:function(){},isRuleBtn:function(){},onShowPlayIntrClick:function(){},showPlayIntroduce:function(e){},onRoomReadyInfoHandler:function(){cc.log("tdk_roomData.onRoomReadyInfo = "+JSON.stringify(h.onRoomReadyInfo));for(var e=this.readyNode.parent.getChildByName("againBtn"),t=0,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a].uid;for(var i in h.onRoomReadyInfo)i==n&&0==h.onRoomReadyInfo[i]&&(cc.log("cantReady = "+t),t++)}if(t==GameData.room.opts.joinermax&&GameData.room.status>TDKPokerCard.STATUS.WAITING)e.active=!0;else{this.readyNode.active=!0;var o=this.readyNode.children;for(a=0;a<o.length;a++)o[a].active=!1;var r=h.onRoomReadyInfo;for(var i in r){h.getPlayerInfoByUid(i)||delete r[i]}cc.log("readyData = "+JSON.stringify(r));for(a=0;a<GameData.joiners.length;a++)if(null!=GameData.joiners[a]){var s=GameData.joiners[a].uid;if(1==r[s]){var c=h.getLocalPosition(a);this.showReadyIcon(c,!0,!1),s===GameData.player.uid&&(this.readyBtn.active=!1,e.active=!1)}else{c=h.getLocalPosition(a);this.showReadyIcon(c,!1,!0),GameData.room.status>TDKPokerCard.STATUS.WAITING&&s===GameData.player.uid&&(e.active=!0)}}else{c=h.getLocalPosition(a);this.showReadyIcon(c,!1,!1)}var d=[];for(var c in r)!0===r[c]&&d.push(r[c]);d.length===GameData.room.opts.joinermax&&(this.readyNode.active=!1)}},showJoinerLost:function(e){this.showHeaderDisconnect(e.detail.uid,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了")},showJoinerConnect:function(){this.initPlayers()},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("TDK-playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},setRoomNum:function(){if(GameData.room.id){1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"}},backBtnClicked:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitMjRoom(GameData.room.id)},startGameClick:function(){TDKHandler.getInstance().requestStartGame(),cc.log("开始游戏")},wxInviteBtnClicked:function(){var e="填大坑 房间号:"+GameData.room.id,t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="玩法:"+getRuleStrTDK(GameData.room.opts)+"请您快速加入对局.";return console.log("des = "+e),e},onShareResult:function(){},onShareFriend:function(){},onDeleteRoom:function(){NiuNiuMessageBox("解散房间不扣房卡，是否确定解散？",function(){l.deleteRoom(GameData.room.id,"apply")},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitRoom(GameData.room.id)},onCreatorQuit:function(){cc.log("111111"),GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?NiuNiuMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onGameTurn:function(){this.scheduleOnce(this.showTurnEffect,.1)},showTurnEffect:function(){0!=h.turn&&this.gotoShowTurnEffect(h.turn)},gotoShowTurnEffect:function(e){if(null!=this.headers){for(var t=0;t<GameData.joiners.length;t++)if(null!=GameData.joiners[t]){var a=GameData.joiners[t].uid,n=h.getLocalPosition(t),i=this.playerNodes[n].getChildByName("TableTDKPlayerTemplate").getComponent("TDK-playerTemplate");e===a?i.getLiuGuang(!0):i.getLiuGuang(!1)}h.turn=0}else cc.log("this.headers null")},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="填大坑,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1},getEveryOneScore:function(e){for(var t=e.detail,a=0;a<GameData.joiners.length;a++)for(var n=0;n<t.length;n++){var i=t[n].uid,o=t[n].score;if(null!=GameData.joiners[a]&&GameData.joiners[a].uid===i){var r=h.getLocalPosition(a);cc.log("localIdx:"+r);var s=this.playerNodes[r].getChildByName("nowChipsNum");s.active=!0,s.getChildByName("Num").getComponent(cc.Label).string=o}}},getConnectChipsScore:function(){if(!(Object.keys(h.incPokerData).length<=0))for(var e=h.incPokerData,t=0;t<GameData.joiners.length;t++)for(var a in e)if(null!=GameData.joiners[t]&&GameData.joiners[t].uid===parseInt(a)){var n=h.getLocalPosition(t),i=this.playerNodes[n].getChildByName("nowChipsNum"),o=arraySum(e[a]);cc.log("turnerScore = "+o),i.getChildByName("Num").getComponent(cc.Label).string=o}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",roomHandler:"roomHandler",tdkRoomData:"tdkRoomData"}],"TDK-roomtable":[function(e,t,a){"use strict";cc._RF.push(t,"aac20cW5dFM0KjH7mOU6hjz","TDK-roomtable");var c=e("SoundMngr"),r=e("roomHandler"),l=e("tdkRoomData"),s=e("gameDefine");cc.Class({extends:cc.Component,properties:{operationBtns:cc.Node,pokersNode:cc.Node,escapeNode:cc.Node,chips:[cc.Node],chipsNode:cc.Node,clipSlider:cc.Slider,isMask:cc.Node,_clipNum:0,allScore:cc.Label,_spaces:68.1,playerNodes:{default:[],type:cc.Node},operationNode:cc.Node,pokerType:0,genNum:cc.Label,languo:cc.Node,scoreNode:cc.Prefab,scoreParent:cc.Node,winShow:cc.Node,continueBtn:cc.Node,borrowPokerPre:cc.Prefab},onLoad:function(){this.dropPokersInfo={},this.pokerScore={},this.initUI(),this.registListenr(),this.isSeePoker=!1,this.seePokerClick1=!1,GameData.room.status!=TDKPokerCard.STATUS.WAITING&&(GameData.room.status===TDKPokerCard.STATUS.READY?(this.initPokerNode(),this.initBtn()):(this.onShow(),this.otherActionEffect(),this.showObtainNode(),this.showConnectDrop()),this.addChips(),this.changeSumScore())},registListenr:function(){var e=this;this.isMask.on(cc.Node.EventType.TOUCH_END,function(){e.closeClipSlider()}),registEvent("onPlayerInitScore",this,this.basicScore),registEvent("onPlayerCards",this,this.onShow),registEvent("onActionBtn",this,this.showObtainNode),registEvent("onTurner",this,this.initBtn),registEvent("onTurnerAction",this,this.otherActionEffect),registEvent("onGameResult",this,this.gameResult),registEvent("onPrepareInfo",this,this.initUI),registEvent("onIncScore",this,this.addChips),registEvent("onDropPlayerInfo",this,this.showConnectDrop)},onDestroy:function(){unregistEvent("onPlayerInitScore",this,this.basicScore),unregistEvent("onPlayerCards",this,this.onShow),unregistEvent("onActionBtn",this,this.showObtainNode),unregistEvent("onTurner",this,this.initBtn),unregistEvent("onTurnerAction",this,this.otherActionEffect),unregistEvent("onGameResult",this,this.gameResult),unregistEvent("onPrepareInfo",this,this.initUI),unregistEvent("onIncScore",this,this.addChips),unregistEvent("onDropPlayerInfo",this,this.showConnectDrop)},initUI:function(){this.changeSumScore();for(var e=0,t=0;t<GameData.joiners.length;t++){var a=GameData.joiners[t].uid;for(var n in l.onRoomReadyInfo)n==a&&0==l.onRoomReadyInfo[n]&&(cc.log("cantReady = "+e),e++)}if(!(e==GameData.room.opts.joinermax&&GameData.room.status>TDKPokerCard.STATUS.WAITING)){this._clipNum=0,this.dropPokersInfo={},this.initPokerNode(),this.initBtn();for(var i=0;i<GameData.joiners.length;i++)if(null!=GameData.joiners[i]){GameData.joiners[i].uid;var o=l.getLocalPosition(i),r=this.playerNodes[o].getChildByName("pokerBg");this.playerNodes[o].getChildByName("nowChipsNum").active=!1,r.active=!1}for(t=0;t<this.winShow.children.length;t++)this.winShow.children[t].active=!1}},initBtn:function(){for(var e=0;e<this.operationNode.children.length;e++)this.operationNode.children[e].active=!1;this.clipSlider.node.active=!1},initPokerNode:function(){for(var e in this.pokersNode.children)this.hideNodeChild(this.pokersNode.children[e]);for(var e in this.escapeNode.children)this.escapeNode.children[e].active=!1},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},onShow:function(){this.showPokers();for(var e=0;e<GameData.joiners.length;e++)if(null!=GameData.joiners[e]){GameData.joiners[e].uid;var t=l.getLocalPosition(e);this.playerNodes[t].getChildByName("nowChipsNum").active=!0}},showPokers:function(){this.pokerScore={},this.revealPoker=0;for(var e=this.darkPoker=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid;for(var a in l.pokers){if(l.pokers[t])if(this.dropPokersInfo[t])!0===this.dropPokersInfo[t]||this.delayShowPoker(e);else this.delayShowPoker(e)}}var n=this,i=150*GameData.joiners.length;setTimeout(function(){n.showPokerScore(!1)},i)},delayShowPoker:function(e){var i=e,o=this;setTimeout(function(){var e=GameData.joiners[i].uid,t=l.getHandPokerByUid(e),a=TDKPokerCard.calcScore(t);o.pokerScore[e]||(o.pokerScore[e]=a),c.instance.playTDKOther("fapai");var n=l.getLocalPosition(i);GameData.joiners[i].uid===GameData.player.uid?o.showMyHandPokers(t,o.pokersNode.children[n]):o.showOtherHandPokers(t,o.pokersNode.children[n])},150*e)},showMyHandPokers:function(e,t){for(var a=[],n=[],i=0;i<e.length;i++)t.children[i].active=!0,i<2?(n.push(e[i]),this.showPokerContent(t.children[i],"0")):(a.push(e[i]),this.showPokerContent(t.children[i],e[i]));this.darkPoker=TDKPokerCard.calcScore(n),this.revealPoker=TDKPokerCard.calcScore(a)},showOtherHandPokers:function(e,t){for(var a=0;a<e.length;a++)t.children[a].active=!0,this.showPokerContent(t.children[a],e[a])},continueClick:function(){for(var e=0;e<this.scoreParent.children.length;e++)this.scoreParent.children[e].removeAllChildren();if(this.unscheduleAllCallbacks(),this.changeSumScore(),this.continueBtn.active=!1,l.close)this.node.getComponent("TDK-roomMain").showSummaryLayer();else{var t=l.gameResult.winner;(t&&0<t||0<l.connectWin)&&(this.initUI(),this.chipsNode.removeAllChildren()),GameNet.getInstance().request("room.roomHandler.ready",{},function(e){})}},showObtainNode:function(){if(cc.log("111"),!(null===l.actionBtn||Object.keys(l.actionBtn).length<=0)){var e=l.actionBtn,t=e.action,a=e.score;if(!0===l.addpokersRight){var n=this,i=150*GameData.joiners.length;setTimeout(function(){for(var e=0;e<t.length;e++)n.operationNode.getChildByName("operationBtn"+t[e]).active=!0,4===t[e]&&(n.genNum.string=a)},i),l.addpokersRight=!1}else for(var o=0;o<t.length;o++)this.operationNode.getChildByName("operationBtn"+t[o]).active=!0,4===t[o]&&(this.genNum.string=a);l.actionBtn={}}},seePokerClick:function(){cc.log("seePokerClick"),this.isSeePoker=!this.isSeePoker;for(var e=cc.find("handCard0",this.pokersNode),t=l.getHandPokerByUid(GameData.player.uid),a=0;a<2;a++)this.isSeePoker?(this.showPokerContent(e.children[a],t[a]),this.showPokerScore(!0)):(this.showPokerContent(e.children[a],"0"),this.showPokerScore(!1))},showPokerContent:function(e,t){var a;a=1e3<t?t-1e3:t,e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/TDK/UI/poker/poker_"+a+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),this.showBorrowPoker(e,t)},showBorrowPoker:function(e,t){var a=!1;1e3<t&&(a=!0);var n=e.getChildByName(e.name+"_borrow");null==n?1==a&&(n=cc.instantiate(this.borrowPokerPre),cc.find("borrow",n).active=!0,e.addChild(n),n.name=e.name+"_borrow"):n.active=a},showConnectDrop:function(){var s=l.DropPlayerInfo,c=this,e=GameData.joiners.length;setTimeout(function(){for(var e=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid,a=l.getLocalPosition(e),n=c.pokersNode.children[a];for(var i in s)if(s[t]){c.dropPokersInfo[t],c.dropPokersInfo[t]=!0,cc.log("dropInfo[userId] = "+s[t]),cc.log("tdk_roomData.pokers[userId] = "+JSON.stringify(l.pokers[t]));for(var o=l.pokers[t],r=0;r<o.length;r++)cc.log("len = "+r),n.children[r].active=!0,c.showPokerContent(n.children[r],"0");c.escapeNode.children[a].active=!0}}},150*e)},escapePoker:function(e){for(var t=0;t<GameData.joiners.length;t++){var a=GameData.joiners[t].uid,n=l.getHandPokerByUid(a),i=l.getLocalPosition(t);if(GameData.joiners[t].uid===e){this.dropPokersInfo[a],this.dropPokersInfo[a]=!0;for(t=0;t<n.length;t++)this.showPokerContent(this.pokersNode.children[i].children[t],"0"),this.escapeNode.children[i].active=!0;return}}},escapeClick:function(){var e=this;NiuNiuMessageBox("您确认要扣牌吗？",function(){TDKHandler.getInstance().requestDrop(),e.turnerActionEffect(2,null,GameData.player.uid)},function(){})},PassClick:function(){this.turnerActionEffect(6,null,GameData.player.uid),TDKHandler.getInstance().requestPass()},allInClick:function(){this.turnerActionEffect(8,l.allInscore,GameData.player.uid),TDKHandler.getInstance().requestAllInc()},followClick:function(){this.turnerActionEffect(4,l.maxScore,GameData.player.uid),TDKHandler.getInstance().requestFollowBet()},showClipSlider:function(e,t){this.pokerType=parseInt(t),this.initClipViewLen(),this.clipSlider.node.active=!0},initClipViewLen:function(){var e=l.maxScore;this.clipSlider.progress=1;var t=Math.ceil(this.clipSlider.progress*e),a=this.clipSlider.node.getChildByName("Handle");this.clipSlider.node.getChildByName("clipNum").getComponent(cc.Label).string=t,this.clipSlider.node.getChildByName("beijing").height=173.5+a.y,this._clipNum=t},onSliderHEvent:function(e,t){var a=Math.ceil(e.progress*l.maxScore);0===a&&(a=1);var n=this.clipSlider.node.getChildByName("Handle");this.clipSlider.node.getChildByName("clipNum").getComponent(cc.Label).string=a,this.clipSlider.node.getChildByName("beijing").height=173.5+n.y,this._clipNum=a},basicScore:function(){for(var e=0;e<l.initScore.length;e++){var t=l.initScore[e].score;this.clipClick(t,l.initScore[e].uid)}},addChips:function(){if(cc.log("tdk_roomData.incPokerData = "+JSON.stringify(l.incPokerData)),this.chipsNode.removeAllChildren(),!(Object.keys(l.incPokerData).length<=0)){var e=l.incPokerData;for(var t in e)for(var a=e[t],n=0;n<a.length;n++)this.clipClick(a[n],t)}},clipClick:function(e,t){for(var a=e,n=[0,0,0,0],i=0;i<n.length;i++)n[i]=this.spliceScore(a)[i];for(i=0;i<n.length;i++)for(var o=0;o<n[i];o++){for(var r=0;r<GameData.joiners.length;r++){var s=l.getLocalPosition(r);if(GameData.joiners[r].uid===t){var c=this.pokersNode.children[s];this.chips[i].x=c.x,this.chips[i].y=c.y}}var d=cc.instantiate(this.chips[i]);d.parent=this.chipsNode,d.x=this.chips[i].x,d.y=this.chips[i].y,d.active=!0,this.clipFlyToTableAnimation(d)}cc.log("筹码数量："+this.chipsNode.childrenCount)},clipFlyToTableAnimation:function(e){var t=this.randomNum(0,400)-200,a=this.randomNum(0,100)-100,n=cc.moveTo(.3,cc.p(t,a)),i=cc.callFunc(function(){e.removeFromParent(!0)},e),o=cc.fadeOut(.1);c.instance.playTDKOther("xiaguo"),80<this.chipsNode.childrenCount?e.runAction(cc.sequence(n,o,i)).easing(cc.easeCubicActionOut()):e.runAction(n).easing(cc.easeCubicActionOut())},spliceScore:function(e){for(var t=[],a=[10,5,2,1],n=0;n<a.length;n++){var i=Math.floor(e/a[n]);t.push(i),e-=Math.floor(e/a[n])*a[n]}return t},randomNum:function(e,t){var a=t-e,n=Math.random()*a+e;return parseInt(n,10)},clipSliderOKClick:function(){this.closeClipSlider(),this.turnerActionEffect(this.pokerType,this._clipNum,GameData.player.uid),TDKHandler.getInstance().requestIncBet(this._clipNum)},closeClipSlider:function(){this.clipSlider.node.active=!1},playOnePokerAnimation:function(e,t){var a=e.x;e.x+=t,e.active=!0;var n=cc.moveTo(.2,cc.p(a,e.y)),i=cc.delayTime(2),o=cc.callFunc(function(){e.active=!1},e);e.runAction(cc.sequence(n,i,o))},testAnimation:function(){for(var e in this.pokersNode.children){var t=cc.find("poker3",this.pokersNode.children[e]);this.seePokerClick1&&(t=cc.find("poker4",this.pokersNode.children[e])),this.playOnePokerAnimation(t,this._spaces)}this.seePokerClick1=!this.seePokerClick1},otherActionEffect:function(){if(!(null===l.turnerAction||Object.keys(l.turnerAction).length<=0)){var e=l.turnerAction.uid,t=(l.getPlayerSexByUid(e),l.turnerAction.score),a=l.turnerAction.action;this.turnerActionEffect(a,t,e),l.turnerAction={}}},turnerActionEffect:function(e,t,a){var n=l.getPlayerSexByUid(a);c.instance.playTDKAudio(e,n),this.showActionType(a,e),2===e?this.escapePoker(a):6===e?cc.log("buti"):this.clipClick(t,a),this.initBtn()},showActionType:function(e,t){for(var a=0;a<GameData.joiners.length;a++)if(null!=GameData.joiners[a]&&GameData.joiners[a].uid===e){for(var n=l.getLocalPosition(a),i=this.playerNodes[n].getChildByName("actionType"),o=0;o<i.children.length;o++){var r=o+2;i.getChildByName("action"+r).active=r===t}this.scheduleOnce(function(){for(var e=0;e<i.children.length;e++){var t=e+2;i.getChildByName("action"+t).active=!1}},1)}},showPokerScore:function(e){for(var o=this,t=function(){var e=[];for(var t in o.pokerScore)if(parseInt(t)===GameData.player.uid){var a=o.revealPoker;e.push(a)}else e.push(o.pokerScore[t]);for(var n=0,i=1;i<e.length;i++)e[i]&&e[i]>e[n]&&(n=i);return e[n]},a=0;a<GameData.joiners.length;a++)if(null!=GameData.joiners[a]){var n,i=GameData.joiners[a].uid,r=l.getLocalPosition(a),s=this.playerNodes[r].getChildByName("pokerBg"),c=s.getChildByName("pokerScore");s.active=!0,this.pokerScore[i]&&(i===GameData.player.uid?e?(n=this.darkPoker,c.getComponent(cc.Label).string=this.pokerScore[i]+"("+n+")"):(n=this.revealPoker-t(),c.getComponent(cc.Label).string=this.revealPoker+"("+n+")"):(n=this.pokerScore[i]-t(),c.getComponent(cc.Label).string=this.pokerScore[i]+"("+n+")"))}},gameResult:function(){if(this.initBtn(),!(null===l.gameResult||Object.keys(l.gameResult).length<=0)){var n,i,o=l.gameResult,r=o.winner;if(o.cards){var e=o.cards;this.resultMingPokerScore(e)}if(0===r)return this.languo.active=!0,this.languo.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),void this.scheduleOnce(function(){this.initUI()},3);var s=this;return this.scheduleOnce(function(){for(var e=0;e<GameData.joiners.length;e++)if(null!=GameData.joiners[e]&&GameData.joiners[e].uid===r){var t=l.getLocalPosition(e),a=s.playerNodes[t].position;n=a.x,i=a.y,s.winShow.children[t].active=!0,s.winShow.children[t].getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)}r===GameData.player.uid?c.instance.playTDKOther("win"):c.instance.playTDKOther("lost")},1),void this.scheduleOnce(function(){for(var e=0;e<s.chipsNode.children.length;e++){var t=s.chipsNode.children[e],a={};cc.log("posX = "+n+",posY = "+i),a.x=n+(this.randomNum(0,180)-90),a.y=i+(this.randomNum(0,90)-45),s.resultChipsAnimation(t,a)}s.moveAboutScore(o.winner)},3)}},moveAboutScore:function(c){var d=l.presentScore,h=this;this.scheduleOnce(function(){for(var e=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid,a=l.getLocalPosition(e),n=h.scoreParent.getChildByName("score"+a),i=n.getChildByName("resultScore");if(null==i){if(i=cc.instantiate(h.scoreNode),c===t){var o=0;for(var r in d)r!=c&&(o+=d[r]);i.getComponent("tdk-resultFlyScore").getScoreColor(o)}else i.getComponent("tdk-resultFlyScore").getScoreColor(0-d[t]);i.active=!0,n.addChild(i)}var s=cc.moveBy(.75,cc.p(0,60));i.runAction(s)}},.5),this.scheduleOnce(function(){for(var e=0;e<h.scoreParent.children.length;e++)h.scoreParent.children[e].removeAllChildren();h.changeSumScore()},1.5)},resultChipsAnimation:function(e,t){c.instance.playTDKOther("chouma");var a=cc.moveTo(.4,t),n=cc.callFunc(function(){e.active=!1,e.destroy()},e);e.runAction(cc.sequence(a,n))},changeSumScore:function(){for(var e=0;e<GameData.joiners.length;e++)if(null!=GameData.joiners[e]){var t,a=GameData.joiners[e].uid,n=(l.getPlayerInfoByUid(a),l.getLocalPosition(e)),i=this.playerNodes[n].getChildByName("TableTDKPlayerTemplate").getComponent("TDK-playerTemplate"),o=0;GameData.room.opts.currencyType==s.currencyType.Currency_Coin?o=GameData.joiners[e].coin:GameData.room.opts.currencyType==s.currencyType.Currency_Card&&(t=r.scores)[a]&&(o=t[a]),cc.log("eveScore = "+o),i.setCoin(o)}},resultMingPokerScore:function(e){for(var t=0;t<GameData.joiners.length;t++){var a=GameData.joiners[t].uid;for(var n in e)if(e[a]){var i=TDKPokerCard.calcScore(e[a]);this.pokerScore[a]||(this.pokerScore[a]=[]),this.pokerScore[a]=i;var o=l.getLocalPosition(t);this.showResultHandPokers(e[a],this.pokersNode.children[o])}var r=l.getLocalPosition(t),s=this.playerNodes[r].getChildByName("pokerBg"),c=s.getChildByName("pokerScore");if(s.active=!0,this.pokerScore[a]){var d=this.darkPoker;c.getComponent(cc.Label).string=this.pokerScore[a]+"("+d+")"}}},showResultHandPokers:function(e,t){for(var a=[],n=[],i=0;i<e.length;i++)t.children[i].active=!0,i<2?n.push(e[i]):a.push(e[i]),this.showPokerContent(t.children[i],e[i]);this.darkPoker=TDKPokerCard.calcScore(n),this.revealPoker=TDKPokerCard.calcScore(a)}});cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler",tdkRoomData:"tdkRoomData"}],"TDK-setting":[function(e,t,a){"use strict";cc._RF.push(t,"132077LettFApO9JQFsTOu+","TDK-setting");var n=e("SoundMngr"),i=e("roomHandler"),o=e("loginHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,_musicOpen:!0,_soundOpen:!0,_LanguageTypeOpen:!0,byeRoomBtn:cc.Node,quitRoomBtn:cc.Node,toggle_tianjin:cc.Toggle,toggle_putong:cc.Toggle,fangyanLb:cc.Label},onLoad:function(){this._LanguageTypeOpen=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_local,this.musicBtn.getChildByName("guan").active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this.toggle_tianjin.node.on("toggle",this.selectLanguageTypeClick,this),this.toggle_putong.node.on("toggle",this.selectLanguageTypeClick,this);cc.director.getScene().name;"home"==cc.director.getScene().name?(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!0):(this.byeRoomBtn.active=!0,this.quitRoomBtn.active=!1),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen,this.selectLanguageTypeOpen(),this.refreshUI()},onEnable:function(){},musicClick:function(e){this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;n.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},selectLanguageTypeClick:function(e){var t=GameData.language_local;this.toggle_tianjin.isChecked&&(t=GameData.language_local),this.toggle_putong.isChecked&&(t=GameData.language_putong),cc.sys.localStorage.setItem("languageType"+GameData.player.uid,t)},selectLanguageTypeOpen:function(){this._LanguageTypeOpen==GameData.language_local?(this.toggle_tianjin.isChecked=!0,this.toggle_putong.isChecked=!1):(this.toggle_tianjin.isChecked=!1,this.toggle_putong.isChecked=!0)},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen,this.musicBtn.getChildByName("base").active=this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen,this.soundBtn.getChildByName("base").active=this._soundOpen},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,n.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;n.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},onClose:function(){closeView(this.node.name)},requestDissolve:function(){if(GameData.room.opts)return GameData.player.uid!=GameData.joiners[0].uid&&GameData.room.status===TDKPokerCard.STATUS.WAITING?(createMoveMessage("牌局开始后才允许解散房间"),void closeView(this.node.name)):(i.deleteRoom(GameData.room.id,"apply"),closeView(this.node.name),GameData.gameType==r.GameType.Game_TDK?(this.node.parent.getComponent("TDK-roomMain").showdissolveLayer(1,1),this.node.parent.getComponent("TDK-roomDissolve").showPlayers(),void this.node.parent.getComponent("TDK-roomDissolve").alreadyAgree()):void 0)},logout:function(e){o.logout()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("base").active=GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("base").active=GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume,this.fangyanLb.getComponent(cc.Label).string="东北话"}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],"TJDDZ-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"6a7dfjLUVlOYbeLgMIgh0dA","TJDDZ-createRoom");e("roomHandler");var s=e("configMgr"),c=e("gameDefine");cc.Class({extends:cc.Component,properties:{round6:cc.Toggle,round10:cc.Toggle,round20:cc.Toggle,fanshu2:cc.Toggle,fanshu3:cc.Toggle,fanshu4:cc.Toggle,wuxianfan:cc.Toggle,payNode:cc.Node,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,timesNode:cc.Node,times1:cc.Toggle,times2:cc.Toggle,times5:cc.Toggle,scoreNode:cc.Node,score1:cc.Toggle,score2:cc.Toggle,score3:cc.Toggle,limitLabel:cc.Label,jiaofen:{default:null,type:cc.Toggle},roundJiaofen:{default:null,type:cc.Toggle},tiChuai:{default:null,type:cc.Toggle},daiNiEr:{default:null,type:cc.Toggle},spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.refreshUI(),this.modeType=1,this.spendData=void 0},getModeType:function(){return this.modeType},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(c.GameType.Game_Poker_TianjinDDZ);var e={gameType:c.GameType.Game_Poker_TianjinDDZ,roomType:0,roundType:GameDataTJDDZ.createRoomOpts.roundType,playType:GameDataTJDDZ.createRoomOpts.playType,roundMax:GameDataTJDDZ.createRoomOpts.roundMax,roundRule:GameDataTJDDZ.createRoomOpts.roundMax,fanshu:GameDataTJDDZ.createRoomOpts.fanshu,joinermax:3,clubId:0,costType:GameDataTJDDZ.createRoomOpts.costType,jiaofenType:GameDataTJDDZ.createRoomOpts.jiaofenType,mud:GameDataTJDDZ.createRoomOpts.mud,kicking:GameDataTJDDZ.createRoomOpts.kicking,score:GameDataTJDDZ.createRoomOpts.score,times:GameDataTJDDZ.createRoomOpts.times,scorelv:GameDataTJDDZ.createRoomOpts.score,currencyType:null,settleType:null},t=s.getModeType();return null==t||null==t.Game_Poker_TianjinDDZ||(e.currencyType=t.Game_Poker_TianjinDDZ.CurrencyType,e.settleType=t.Game_Poker_TianjinDDZ.SettleType),e},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..ddz..TJ");var e="",t="",a=s.getModeType();if(null!=a&&null!=a.Game_Poker_TianjinDDZ){var n=s.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Poker_TianjinDDZ.CurrencyType,this.modeType){case c.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[c.GameType.Game_Poker_TianjinDDZ];break;case c.currencyType.Currency_Coin:e="金",this.spendData=n.roomCoin[c.GameType.Game_Poker_TianjinDDZ]}if(this.spendData)for(var i,o=0;o<Object.keys(this.spendData).length;o++){var r=0;this.modeType==c.currencyType.Currency_Card?(0===o?i=this.spendData[6].cost:1===o?i=this.spendData[10].cost:2===o&&(i=this.spendData[20].cost),r=i[3].final,this.pay2.isChecked,this.spendUI[o].string="（"+e+"*"+r+t+"）"):(r=(i=this.spendData[o].cost)[3].final,t="/局",this.spendUI[o].string=""),this.drowArray[o].active=0==r}else cc.log("..spendData is undefined")}}},selectRoomType:function(e,t){},saveRuleFromUI:function(){this.round6.isChecked?(GameDataTJDDZ.createRoomOpts.roundMax=6,GameDataTJDDZ.createRoomOpts.roundType=c.roundType.round):this.round10.isChecked?(GameDataTJDDZ.createRoomOpts.roundMax=10,GameDataTJDDZ.createRoomOpts.roundType=c.roundType.round):this.round20.isChecked&&(GameDataTJDDZ.createRoomOpts.roundMax=20,GameDataTJDDZ.createRoomOpts.roundType=c.roundType.round),this.fanshu2.isChecked?GameDataTJDDZ.createRoomOpts.fanshu=2:this.fanshu3.isChecked?GameDataTJDDZ.createRoomOpts.fanshu=3:this.fanshu4.isChecked?GameDataTJDDZ.createRoomOpts.fanshu=4:this.wuxianfan.isChecked&&(GameDataTJDDZ.createRoomOpts.fanshu=15),this.pay1.isChecked?GameDataTJDDZ.createRoomOpts.costType=1:this.pay2.isChecked?GameDataTJDDZ.createRoomOpts.costType=2:this.pay3.isChecked&&(GameDataTJDDZ.createRoomOpts.costType=3),this.jiaofen.isChecked?GameDataTJDDZ.createRoomOpts.jiaofenType=1:this.roundJiaofen.isChecked&&(GameDataTJDDZ.createRoomOpts.jiaofenType=2),this.tiChuai.isChecked?GameDataTJDDZ.createRoomOpts.kicking=!0:GameDataTJDDZ.createRoomOpts.kicking=!1,this.daiNiEr.isChecked?GameDataTJDDZ.createRoomOpts.mud=!0:GameDataTJDDZ.createRoomOpts.mud=!1,this.score1.isChecked?GameDataTJDDZ.createRoomOpts.score=0:this.score2.isChecked?GameDataTJDDZ.createRoomOpts.score=1:this.score3.isChecked&&(GameDataTJDDZ.createRoomOpts.score=2),GameDataTJDDZ.saveCreateRoomOpts()},selectRoundRuleClick:function(e,t){if(null!=t){switch(t){case 6:this.round6.isChecked=!0,this.round10.isChecked=!1,this.round20.isChecked=!1;break;case 10:this.round10.isChecked=!0,this.round6.isChecked=!1,this.round20.isChecked=!1;break;case 20:this.round20.isChecked=!0,this.round6.isChecked=!1,this.round10.isChecked=!1}this.round6.isChecked?GameDataTJDDZ.createRoomOpts.roundMax=6:this.round10.isChecked?GameDataTJDDZ.createRoomOpts.roundMax=10:this.round20.isChecked&&(GameDataTJDDZ.createRoomOpts.roundMax=20),this.showSpendUI(),this.refreshTimesScore()}},selectTimesClick:function(e,t){GameDataTJDDZ.createRoomOpts.times=t,this.showSpendUI(),this.refreshTimesScore()},onTiChuaiChecked:function(){cc.log("tiChuai isChecked: ",this.tiChuai.isChecked)},onDaiNiErChecked:function(){cc.log("daiNiEr isChecked: ",this.daiNiEr.isChecked)},refreshUI:function(){this.round6.isChecked=6==GameDataTJDDZ.createRoomOpts.roundMax,this.round10.isChecked=10==GameDataTJDDZ.createRoomOpts.roundMax,this.round20.isChecked=20==GameDataTJDDZ.createRoomOpts.roundMax,this.fanshu2.isChecked=2==GameDataTJDDZ.createRoomOpts.fanshu,this.fanshu3.isChecked=3==GameDataTJDDZ.createRoomOpts.fanshu,this.fanshu4.isChecked=4==GameDataTJDDZ.createRoomOpts.fanshu,this.wuxianfan.isChecked=15==GameDataTJDDZ.createRoomOpts.fanshu,this.pay1.isChecked=1==GameDataTJDDZ.createRoomOpts.costType,this.pay2.isChecked=2==GameDataTJDDZ.createRoomOpts.costType,this.pay3.isChecked=3==GameDataTJDDZ.createRoomOpts.costType,this.jiaofen.isChecked=1==GameDataTJDDZ.createRoomOpts.jiaofenType,this.roundJiaofen.isChecked=2==GameDataTJDDZ.createRoomOpts.jiaofenType,this.tiChuai.isChecked=1==GameDataTJDDZ.createRoomOpts.kicking,this.daiNiEr.isChecked=1==GameDataTJDDZ.createRoomOpts.mud,this.score1.isChecked=0==GameDataTJDDZ.createRoomOpts.score,this.score2.isChecked=1==GameDataTJDDZ.createRoomOpts.score,this.score3.isChecked=2==GameDataTJDDZ.createRoomOpts.score,this.showSpendUI(),this.refreshTimesScore()},refreshTimesScore:function(){if(this.modeType==c.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)return this.scoreNode.active=!1,this.timesNode.active=!1,void(this.payNode.active=!0);this.scoreNode.active=!0,this.timesNode.active=!1,this.payNode.active=!1;var e=0;switch(GameDataTJDDZ.createRoomOpts.roundMax){case 6:e=0;break;case 10:e=1;break;case 20:e=2}null==GameDataTJDDZ.createRoomOpts.times&&(GameDataTJDDZ.createRoomOpts.times=1);var t=this.spendData[e].cost[3],a=this.spendData[e].enter[3];this.score1.isChecked?GameDataTJDDZ.createRoomOpts.score=0:this.score2.isChecked?GameDataTJDDZ.createRoomOpts.score=1:this.score3.isChecked&&(GameDataTJDDZ.createRoomOpts.score=2);var n=cc.find("label",this.score1.node),i=cc.find("label",this.score2.node),o=cc.find("label",this.score3.node);n.getComponent(cc.Label).string="初级场：台费"+t[0]+" 进入条件≥"+a[0]+" 倍数 100",i.getComponent(cc.Label).string="中级场：台费"+t[1]+" 进入条件≥"+a[1]+" 倍数 200",o.getComponent(cc.Label).string="高级场：台费"+t[2]+" 进入条件≥"+a[2]+" 倍数 500"}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TJDDZ-poker":[function(e,t,a){"use strict";cc._RF.push(t,"0105b4B64dIFapF90c9aNrZ","TJDDZ-poker");var g={straights:{level:1,colorFormat:!1,numFormat:[1,2,3,4,5,6,7,8,9,10,11,12],allowedLength:[5,6,7,8,9,10,11,12],notAllowedCard:[15]}},i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{pokerParent:{default:null,type:cc.Node},cardMask:{default:null,type:cc.Prefab}},onLoad:function(){for(var e in this.cards=this.pokerParent.children,this.pokerParent.children)this.cardInitY=this.cards[e].y;this.touchedCards=[],this.selectedCards=[],this.addTouchEvent()},start:function(){},onDestroy:function(){},addTouchEvent:function(){this.pokerParent.on(cc.Node.EventType.TOUCH_START,function(e){console.log("pokerParent TOUCH_START");var t=e.target;this.touchStartLocation=this.cards[0].convertTouchToNodeSpace(e);for(var a=0,n=0;n<this.cards.length;n++){if(this.cards[n].name==t.name){a=n;break}}if("handLayout"==t.name)return this.firstTouchedCard=void 0,void this.clearTouchedCards();var i={index:a,card:t};cc.log("card.active:"+t.active,t.name),this.firstTouchedCard=i,this.pushTouchedCards(i.index,i.card)},this),this.pokerParent.on(cc.Node.EventType.TOUCH_MOVE,function(e){if(console.log("pokerParent TOUCH_MOVE"),this.clearTouchedCards(),null!=this.firstTouchedCard){this.pushTouchedCards(this.firstTouchedCard.index,this.firstTouchedCard.card);for(var t=this.cards[0].convertTouchToNodeSpace(e),a=(t.x,t.y,this.touchStartLocation),n=0;n<this.cards.length;n++){var i,o,r=this.cards[n],s=r.x+20;a.x<t.x?(i=a.x,o=t.x):(i=t.x,o=a.x),i<=s&&s<=o&&r.active&&this.pushTouchedCards(n,r)}}},this),this.pokerParent.on(cc.Node.EventType.TOUCH_END,function(e){console.log("pokerParent TOUCH_END"),this.doSelectCard()},this),this.pokerParent.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("pokerParent TOUCH_CANCEL"),this.doSelectCard()},this);for(var a=0;a<this.cards.length;a++){var n=this.cards;(function(e){var t=n[a];t.on(cc.Node.EventType.TOUCH_START,function(e){console.log("card TOUCH_START")},t),t.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("card TOUCH_MOVE")},t),t.on(cc.Node.EventType.TOUCH_END,function(e){console.log("card TOUCH_END"),t.active&&i.instance.playOtherAudioPoker("click",null)},t),t.on(cc.Node.EventType.TOUCH_CANCEL,function(e){console.log("card TOUCH_CANCEL"),t.active&&i.instance.playOtherAudioPoker("click",null)},t)})()}},pushTouchedCards:function(e,t){var a={index:e,name:t.name,isSelected:t.y!=this.cardInitY};this.touchedCards.find(function(e){return e.name==t.name?e:null})||(this.touchedCards.push(a),this.addCardMask(t))},clearTouchedCards:function(){for(var e=0;e<this.touchedCards.length;e++){var t=this.touchedCards[e].index;this.cards[t].removeChildByTag(100)}this.touchedCards=[]},doSelectCard:function(){this.selectedCards=[],this.pokerTypeArry=[],this.shunziArry=[];for(var e=[],t=!0,a=0;a<this.touchedCards.length;a++){var n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;this.pokerTypeArry.push(i),e.push(i%100)}for(var o=0;o<this.pokerTypeArry.length;o++)for(var r=0;r<this.pokerTypeArry.length;r++)r!=o&&this.pokerTypeArry[r]%100==this.pokerTypeArry[o]%100&&this.pokerTypeArry.splice(r,1);console.log("1111111111111111```"+this.pokerTypeArry);var s=this.getCardsType(this.pokerTypeArry);if(console.log("1111111111111111```"+s),s){var c=[];for(o=0;o<this.pokerTypeArry.length;o++)c.push(this.pokerTypeArry[o]%100),c.push(this.pokerTypeArry[o]%100);c.sort(function(e,t){return e-t}),e.sort(function(e,t){return e-t}),this.contain(c,e)&&(t=!1)}if(t&&"straights"==s)for(o=0;o<this.pokerTypeArry.length;o++){var d=!0;for(r=0;r<this.shunziArry.length;r++)this.pokerTypeArry[o]%100==this.shunziArry[r]%100&&(d=!1);d&&this.shunziArry.push(this.pokerTypeArry[o])}for(a=0;a<this.touchedCards.length;a++){var h;n=this.touchedCards[a],i=(h=this.cards[n.index]).getComponent("Card").id;cc.log("card:"+h.name);for(o=0;o<this.shunziArry.length;o++)i==this.shunziArry[o]&&(n.isSelected?h.y=h.y-30:h.y=h.y+30);0==this.shunziArry.length&&(n.isSelected?h.y=h.y-30:h.y=h.y+30)}this.clearTouchedCards(),this.showSelectedCards()},addCardMask:function(e){var t=cc.instantiate(this.cardMask);t.setTag(100),t.setPosition(cc.p(0,0)),e.addChild(t)},showSelectedCards:function(){this.selectedCards=[];for(var e=0;e<this.cards.length;e++){var t=this.cards[e];t.y!=this.cardInitY&&this.selectedCards.push(t.name)}sendEvent("tjddz-disPokerArry",this.selectedCards)},contain:function(e,t){return e.toString()==t.toString()},getCardsType:function(e){for(var t in g){for(var a=g[t],n=!1,i=0;i<a.allowedLength.length;i++)a.allowedLength[i]==e.length&&(n=!0);if(n){var o=this.createSortedCardNumbers(e);cc.log("numbers = "+o);var r=!0;if(a.notAllowedCard)for(i=0;i<o.length;i++)for(var s=0;s<a.notAllowedCard.length;s++)o[i]==a.notAllowedCard[s]&&(r=!1);var c=0,d=0;if("aircraft"==t.substring(0,t.length-1)||"aircraft"==t)for(i=0;i<e.length;i++)115==e[i]||215==e[i]||315==e[i]||415==e[i]?c++:114!=e[i]&&214!=e[i]&&314!=e[i]&&414!=e[i]||d++,3==c&&3==d&&(r=!1);if(r){var h=!0,l=a.numFormat,u=null,m=[];for(s=0;s<o.length;s++)for(var p=0;p<o.length;p++)p!=s&&o[p]==o[s]&&o.splice(p,1);o.sort(function(e,t){return e-t}),cc.log("numbers = "+o);for(i=0;i<o.length;i++)if(0!=l[i])if(l[i]<0)if(m[-l[i]]){if(m[-l[i]]!=o[i]){h=!1;break}}else m[-l[i]]=o[i];else if(null==u)u=o[i]-l[i];else if(u!=o[i]-l[i]){h=!1;break}if(h&&5<=o.length)return t}}}return!1},createSortedCardNumbers:function(e){for(var t=[],a=0;a<e.length;a++)t[a]=e[a]%100;return t}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"TJDDZ-roomDissolve":[function(e,t,a){"use strict";cc._RF.push(t,"572f5CYJVxJAaiA3WR6bQZh","TJDDZ-roomDissolve");var s=e("roomHandler"),n=e("gameDefine");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&GameData.client.gameType==n.GameType.Game_Poker_TianjinDDZ&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){var e=!1;if(GameData.room.opts&&(e=!0),e)for(var t=0;t<GameData.room.opts.joinermax-1;t++){var a=cc.instantiate(this.headerNode);a.parent=this.headerNode.parent,a.name="header_"+(t+2),a.x=this.headerNode.x+200*(t+1)}},showPlayers:function(){var e=!1;if(GameData.room.opts&&(e=!0),e&&GameData.room.opts.joinermax)for(var t=0;t<GameData.room.opts.joinermax;t++){var a=t+1,n=GameData.joiners[t];if(null!=n){var i=n.uid,o=n.headimgurl;this.showHeaderIcon(a,o),this.showHeaderName(a,n.name);var r=s.isPlayerOnline(i);cc.find("header_"+a+"/lost",this.headerNode.parent).active=!r}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("TJDDZ-roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("TJDDZ-roomMain").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("TJDDZ-roomMain").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){s.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("TJDDZ-roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){s.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){s.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(s.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TJDDZ-roomMain":[function(e,t,a){"use strict";cc._RF.push(t,"e89a2jm3ylPkKLHp91I6LcT","TJDDZ-roomMain");var n=e("SoundMngr"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){registEvent("tjddz-onGameStart",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("AnimationDelayTime",this,this.showResultLayer),registEvent("onServerNotice",this,handlerServerNotice),scheduleLamp(this),GameDataTJDDZ.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,1==GameDataTJDDZ.openScore&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(1e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToNodeSpace(t),n={x:this.getContentSize().width/2,y:this.getContentSize().height/2};cc.pDistance(a,n)>this.getContentSize().width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),GameDataTJDDZ.game.initcards?this.showTableUI(!0):this.showTableUI(!1)},onDestroy:function(){unregistEvent("tjddz-onGameStart",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("AnimationDelayTime",this,this.showResultLayer),unregistEvent("onServerNotice",this,handlerServerNotice),GameData.initGameData(),GameDataTJDDZ.initRoomData()},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("ddz/sound/ddz_bg")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("ddz/sound/ddz_bg")},showResultLayer:function(e){var t=e.detail,a=this;this.scheduleOnce(function(){a.showResultDirectly()},t)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){WriteLog("-----------------showResultDirectly------------------------");this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&GameData.joinContact.uid==GameData.player.uid?GameData.contact=!1:(GameData.contact=!1,GameData.realNum++),this.node.getComponent("TJDDZ-roomResult").onShow()},showSettingLayer:function(e,t){1==t?openView("DDZ-SettingsPanel",i.GameType.Game_Poker_TianjinDDZ):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,GameData.realNum=0,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)},AnimationDelayTime:function(e){this._AnimationDelayTime=e.detail}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],"TJDDZ-roomResult":[function(e,t,a){"use strict";cc._RF.push(t,"d1e5fZc1p9NVKpspMquxUzS","TJDDZ-roomResult");var o=e("roomHandler"),r=(e("configMgr"),e("gameDefine"));cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,resultIcon:cc.Sprite,isMark:0,roomid:cc.Label,createTime:cc.Label,roundNum:cc.Label,fonts:{default:[],type:cc.Font}},onLoad:function(){},onDestroy:function(){},onShow:function(){if(GameData.room.opts.joinermax){this.hideTiChuai();for(var e=0;e<GameData.room.opts.joinermax;e++)this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e),this.showPoker(e),this.showPlayerTiChuai(e);this.showResultIcon(),this.showRoomDetail()}},initResultLayer:function(){if(!GameDataTJDDZ.isEmptyObject(GameDataTJDDZ.game.onRoomReadyInfo))for(var e in GameDataTJDDZ.game.onRoomReadyInfo)if(1==GameDataTJDDZ.game.onRoomReadyInfo[e]&&e==GameData.player.uid){this.resultLayer.active=!1;break}},showName:function(e,t){isChinese(t)?e.string=getShortStr(t,4):isChinese(t)||(e.string=getShortStr(t,8))},showPlayer:function(e){var a=GameData.joiners[e],t=cc.find("panel/player_"+(e+1)+"/headNode/playerID",this.resultLayer),n=cc.find("panel/player_"+(e+1)+"/headNode/name",this.resultLayer),i=cc.find("panel/player_"+(e+1)+"/headNode/head",this.resultLayer),o=cc.find("panel/player_"+(e+1)+"/headNode/identity_icon",this.resultLayer);this.showName(n.getComponent(cc.Label),a.name),t.getComponent(cc.Label).string="ID:"+a.uid,o.getComponent(cc.Sprite).spriteFrame=null;var r="resources/ddz/UI/common/dizhu_icon.png";r=a.uid==GameDataTJDDZ.game.dizhuUid?"resources/ddz/UI/common/icon/dizhu_icon.png":"resources/ddz/UI/common/icon/nongmin_icon.png";var s=cc.textureCache.addImage(cc.url.raw(r));o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),null!=a.headimgurl&&""!=a.headimgurl&&cc.loader.load({url:a.headimgurl,type:"png"},function(e,t){!e&&t&&(cc.log("result:"+a.headimgurl),i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showDetail:function(e){GameData.joiners[e];var t=cc.find("panel/player_"+(e+1)+"/difen/label",this.resultLayer),a=cc.find("panel/player_"+(e+1)+"/beishu/label",this.resultLayer);t.getComponent(cc.Label).string=GameDataTJDDZ.resultData.remainFen,a.getComponent(cc.Label).string=GameDataTJDDZ.resultData.boomNum},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("panel/player_"+(e+1)+"/field_num1",this.resultLayer),n=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=o.getCoinData();i&&i.coin&&i.coin[t]&&(n=i.coin[t])}else GameDataTJDDZ.resultData.score&&(n=GameDataTJDDZ.resultData.score[t]);null==n&&(n=0),0<n?(a.getComponent("cc.Label").font=this.fonts[0],a.getComponent("cc.Label").string="+"+n):0==n?(a.getComponent("cc.Label").font=this.fonts[2],a.getComponent("cc.Label").string="+"+n):(a.getComponent("cc.Label").font=this.fonts[1],a.getComponent("cc.Label").string=n)},hideTiChuai:function(){for(var e=0;e<GameData.room.opts.joinermax;e++){var t=cc.find("panel/player_"+(e+1),this.resultLayer),a=cc.find("tiIcon",t),n=cc.find("chuaiIcon",t);a.active=!1,n.active=!1}},showPlayerTiChuai:function(e){var t=GameData.joiners[e].uid;if(!GameDataTJDDZ.isEmptyObject(GameDataTJDDZ.kicking))for(var a in GameDataTJDDZ.kicking.kicking){if(a==t&&t!=GameDataTJDDZ.kicking.dizhu){if(1==GameDataTJDDZ.kicking.kicking[a])cc.find("panel/player_"+(e+1)+"/tiIcon",this.resultLayer).active=!0}else if(a==t&&t==GameDataTJDDZ.kicking.dizhu){if(1==GameDataTJDDZ.kicking.kicking[a])cc.find("panel/player_"+(e+1)+"/chuaiIcon",this.resultLayer).active=!0}}},showWinIcon:function(e){},showPoker:function(e){var t=cc.find("panel/player_"+(e+1)+"/cardsNoe",this.resultLayer);for(var a in t.children)t.children[a].active=!1;var n=GameData.joiners[e].uid,i=GameDataTJDDZ.getHandCards(n);if(null!=i)for(var o=0;o<i.length;o++){var r=cc.find("card_"+o,t);r.active=!0,r.getComponent(cc.Sprite).spriteFrame=null;var s="resources/ddz/UI/pokers/poker_"+i[o]+".png",c=cc.textureCache.addImage(cc.url.raw(s));r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(c)}},showResultIcon:function(){var e=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=o.getCoinData();t&&t.coin&&t.coin[GameData.player.uid]&&(e=t.coin[GameData.player.uid])}else e=GameDataTJDDZ.resultData.score[GameData.player.uid];var a="";null==e&&(e=0),0<e?a="resources/ddz/UI/result/woyingle.png":e<0&&(a="resources/ddz/UI/result/shibaile.png"),this.resultIcon.getComponent(cc.Sprite).spriteFrame=null;var n=cc.textureCache.addImage(cc.url.raw(a));this.resultIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},showRoomDetail:function(){this.roomid.string="房间号:"+GameData.room.id,this.createTime.string=getDate(GameData.room.createtime),this.roundNum.string="第 "+GameData.room.roundNum+"/"+GameData.room.opts.roundMax+" 局"},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("TJDDZ-roomMain").showSummaryLayer()):(TJDDZHandler.getInstance().requestReady(function(e){}),this.resultLayer.active=!1,GameDataTJDDZ.game.dizhuUid=0,sendEvent("tjddz-onGameStart"),sendEvent("initTableNode")),GameDataTJDDZ.clearObject(GameDataTJDDZ.kicking)},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TJDDZ-roomSummary":[function(e,t,a){"use strict";cc._RF.push(t,"33cedLpBFlMU4I2H9HLW5pt","TJDDZ-roomSummary");e("configMgr");var l=e("gameDefine"),u=e("roomHandler");cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font},lostNode:{default:null,type:cc.Node}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),this.hideLostNode();for(var e=0;e<GameData.joiners.length;e++)this.showPlayer(GameData.joiners[e],e+1)},hideLostNode:function(){for(var e in this.lostNode.children)this.lostNode.children[e].active=!1},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(a,e){if(cc.log("..showPlayer."+a),a){GameData.room.opts.joinermax;var t=cc.find("player_"+e+"/name",this.panel),n=cc.find("player_"+e+"/field_text1",this.panel),i=cc.find("player_"+e+"/field_num1",this.panel),o=cc.find("player_"+e+"/head",this.panel),r=cc.find("player_"+e+"/playerID",this.panel),s=(cc.find("player_"+e,this.panel),cc.find("player_"+e+"/maxScore",this.panel)),c=cc.find("player_"+e+"/maxBobm",this.panel);cc.find("bg",this.panel).getContentSize().width,cc.find("player_"+e+"/biankuang",this.panel).getContentSize().width;cc.find("player_"+e+"/owner",this.panel).active=GameData.room.creator==a.uid,isChinese(a.name)?t.getComponent("cc.Label").string=getShortStr(a.name,5):t.getComponent("cc.Label").string=getShortStr(a.name,9),r.getComponent("cc.Label").string="ID:"+a.uid,GameDataTJDDZ.roomsummaryData&&0!=Object.keys(GameDataTJDDZ.roomsummaryData).length&&(0!=Object.keys(GameDataTJDDZ.roomsummaryData.maxFen).length&&(s.getComponent("cc.Label").string="单局最高分:"+GameDataTJDDZ.roomsummaryData.maxFen[a.uid]),0!=Object.keys(GameDataTJDDZ.roomsummaryData.maxBoom).length&&(c.getComponent("cc.Label").string="打出炸弹数:"+GameDataTJDDZ.roomsummaryData.maxBoom[a.uid])),null!=a.headimgurl&&""!=a.headimgurl&&0<a.headimgurl.length&&cc.loader.load({url:a.headimgurl,type:"png"},function(e,t){!e&&t&&(cc.log("player.headimgurl:"+a.headimgurl),o.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),cc.find("player_"+e+"/win",this.panel).active=!1;var d=0;if(l.currencyType.Currency_Coin==GameData.room.opts.currencyType){n.active=!1;var h=u.getCoinData();h&&h.coins&&h.coins[a.uid]&&(d=h.coins[a.uid])}else if(null!=GameDataTJDDZ.roomsummaryData.score){d=GameDataTJDDZ.roomsummaryData.score[a.uid];GameDataTJDDZ.roomsummaryData.score[function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&GameDataTJDDZ.roomsummaryData.score[GameData.joiners[t].uid]>GameDataTJDDZ.roomsummaryData.score[e]&&(e=GameData.joiners[t].uid);return e}()],GameDataTJDDZ.roomsummaryData.score[a.uid]}if(null==d&&(d=0),0<d?(i.getComponent("cc.Label").string="+"+d,i.getComponent("cc.Label").font=this.fonts[1]):d<0?(i.getComponent("cc.Label").string=d,i.getComponent("cc.Label").font=this.fonts[0]):(i.getComponent("cc.Label").string=d,i.getComponent("cc.Label").font=this.fonts[2]),cc.log("...score:"+d),GameData.room.creator==a.uid)cc.find("player_"+e+"/owner",this.panel).active=!0}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TJDDZ-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"d74a41zc2xJ9I+QMq2JBHv4","TJDDZ-roomWait");var y=e("SoundMngr"),s=e("roomHandler"),c=e("configMgr"),d=e("gameDefine");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,btnRule:cc.Button,lostInfo:[],readyBtn:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){WriteLog("TJDDZ-roomWait onLoad"),this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomInfo",this,this.showPlayers),registEvent("tjddz-onReady",this,this.onReady),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("tjddz-onDiZhu",this,this.showPlayers),registEvent("initTableNode",this,this.showPlayers),registEvent("onPrepareInfo",this,this.onPrepareInfo),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("tjddz-onGameAllScore",this,this.onGameAllScoreHandler),registEvent("tjddz-onGameStart",this,this.onGameStartHandler),registEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("HideReadyNode",this,this.HideReadyNode),registEvent("AnimationDelayTime",this,this.onGameScoreHandler),registEvent("tjddz-showKicking",this,this.showKicking),registEvent("dynChat",this,this.dynChatHandler),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation(),TJDDZHandler.getInstance().requestReady()},onEnable:function(){this.readyNode.active=!GameDataTJDDZ.game.gameStart,GameData.game.onRoomReadyInfo.data},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("tjddz-onReady",this,this.onReady),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("tjddz-onDiZhu",this,this.showPlayers),unregistEvent("initTableNode",this,this.showPlayers),unregistEvent("onPrepareInfo",this,this.onPrepareInfo),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("tjddz-onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("tjddz-onGameStart",this,this.onGameStartHandler),unregistEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),unregistEvent("tjddz-onGameScore",this,this.onGameScoreHandler),unregistEvent("yunwaUploaded",this,this.onYunwaUploaded),unregistEvent("HideReadyNode",this,this.HideReadyNode),unregistEvent("AnimationDelayTime",this,this.onGameScoreHandler),unregistEvent("tjddz-showKicking",this,this.showKicking),unregistEvent("dynChat",this,this.dynChatHandler)},onReady:function(){GameDataTJDDZ.clearObject(GameDataTJDDZ.kicking),sendEvent("initTableNode"),TJDDZHandler.getInstance().requestReady()},onGameScoreHandler:function(e){var t=e.detail,a=this;this.scheduleOnce(function(){a.readyNode.active=!0},t)},HideReadyNode:function(){this.readyNode.active=!1},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("DDZ-playerTemplate"),n=a.uid;if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameDataTJDDZ.allScores[n]?0:GameDataTJDDZ.allScores[n];a.setCoin(i,1)}}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("DDZ-playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioPokerChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;cc.log("animationName:"+g),c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("DDZ-playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},hideAllReadyStatus:function(){cc.find("ready_hand_left",this.readyNode).active=!1,cc.find("readying_left",this.readyNode).active=!1,cc.find("ready_hand_right",this.readyNode).active=!1,cc.find("readying_right",this.readyNode).active=!1,cc.find("ready_hand_down",this.readyNode).active=!1,cc.find("readying_down",this.readyNode).active=!1},onPrepareInfo:function(e){for(var t in this.hideAllReadyStatus(),this.readyNode.active=!0,this.hideTiChuai(),GameDataTJDDZ.game.onRoomReadyInfo)if(1==GameDataTJDDZ.game.onRoomReadyInfo[t]){var a=GameDataTJDDZ.getPosByUid(t);this.showReadyIcon(a,!0,!1)}this.onRoomReadyInfoHandler(e)},showPlayers:function(){WriteLog("showPlayers"),this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;this.deleteRoomBtn.active=e,this.quitRoomBtn.x=e?107:6,this.connectRecurrence()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){},showPlayer:function(e,t){WriteLog("showPlayer"),t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);if(cc.log("playerNode:",n),n.getComponent("DDZ-playerTemplate").setPlayer(a),n.getComponent("DDZ-playerTemplate").setName(a.name),n.getComponent("DDZ-playerTemplate").setHeadIcon(a.headimgurl),n.getComponent("DDZ-playerTemplate").setNamePositionByDir(e),d.currencyType.Currency_Coin==GameData.room.opts.currencyType)n.getComponent("DDZ-playerTemplate").setGold(a.coin);else{var i=0;null!=GameDataTJDDZ.roomsummaryData.score&&(i=null==GameDataTJDDZ.roomsummaryData.score[a.uid]?0:GameDataTJDDZ.roomsummaryData.score[a.uid]),n.getComponent("DDZ-playerTemplate").setCoin(i,1)}if(n.getComponent("DDZ-playerTemplate").setIsPlayerIcon(!1),0!=GameDataTJDDZ.game.dizhuUid)GameDataTJDDZ.game.dizhuUid==a.uid?n.getComponent("DDZ-playerTemplate").showPlayerIdentity(!0,1):n.getComponent("DDZ-playerTemplate").showPlayerIdentity(!0,2);t.addChild(n),t.active=!0,this.headers.push(n),n.setTag(a.uid),2==a.status&&this.showReadyIcon(e,!1,!1);var o=s.isPlayerOnline(a.uid),r=cc.find("Disconnect",n);cc.find("lost_"+e,this.lostNode).active=!o,r.active=!o}else t.active=!1,this.showReadyIcon(e,!1,!1)},hideTiChuai:function(){for(var e=0;e<this.headers.length;e++){var t=cc.find("tiChuaiNode",this.headers[e]),a=cc.find("tiIcon",t),n=cc.find("chuaiIcon",t);a.active=!1,n.active=!1}},showPlayerTiChuai:function(e,t,a){var n=e.getChildByName("TablePlayerTemplate"),i=cc.find("tiChuaiNode",n);if(1==GameDataTJDDZ.kicking.kicking[a]&&a!=t){var o=cc.find("tiIcon",i);o.active=!0,e==this.play_right_player&&(o.x=-67)}else if(1==GameDataTJDDZ.kicking.kicking[a]&&a==t){var r=cc.find("chuaiIcon",i);r.active=!0,e==this.play_right_player&&(r.x=-67)}},showKicking:function(){for(var e in GameDataTJDDZ.kicking.kicking){var t=GameDataTJDDZ.getPosByUid(e);"down"==t?this.showPlayerTiChuai(this.play_down_player,GameDataTJDDZ.kicking.dizhu,e):"right"==t&&this.showPlayerTiChuai(this.play_right_player,GameDataTJDDZ.kicking.dizhu,e),"left"==t&&this.showPlayerTiChuai(this.play_left_player,GameDataTJDDZ.kicking.dizhu,e)}},connectRecurrence:function(){this.showKicking()},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showPlayers()}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("DDZ-playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameDataTJDDZ.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;a.uid!=i||0==a.uid?(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0):(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1)}cc.log("direction :"+e+n),cc.find("lost_"+e,this.lostNode).active=n}},setRoomNum:function(){1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):TJDDZHandler.getInstance().quitMjRoom(GameData.room.id)},wxInviteBtnClicked:function(){var e="天津斗地主 房间号:"+GameData.room.id,t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="",t="",a="玩法:";if(a+=["房主付,","AA制,","赢家付,","代开房付费,",""][GameData.room.opts.costType-1],GameData.room.opts.currencyType==d.currencyType.Currency_Coin){e="金币场 ";var n=c.getServerConfig();if(n&&n.roomCoin){var i=n.roomCoin[d.GameType.Game_Poker_TianjinDDZ];if(i){var o=0;switch(GameData.room.opts.roundMax){case 6:o=0;break;case 10:o=1;break;case 20:o=2}if(i[o]){var r=i[o].enter[GameData.room.opts.joinermax];r&&(t="进入条件："+r[GameData.room.opts.scorelv])}}}}1==GameData.room.opts.jiaofenType?a+="赢家叫分,":2==GameData.room.opts.jiaofenType&&(a+="轮庄叫分,"),1==GameData.room.opts.mud&&(a+="带泥儿,"),1==GameData.room.opts.kicking&&(a+="带踢踹,");var s=e+t+(a+="局数:"+GameData.room.opts.roundMax+"局,")+"请您快速加入对局."+(15==GameData.room.opts.fanshu?"无限番":GameData.room.opts.fanshu+"番");return console.log("des = "+s),s},onShareResult:function(){wxShareTimeline("天津斗地主","我在天津斗地主等你!")},onShareFriend:function(){wxShareWeb("天津斗地主","我在天津斗地主等你!")},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){s.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):s.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){this.readyNode.active=!GameDataTJDDZ.game.gameStart,this.hideAllReadyStatus()},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TJDDZ-roomtable":[function(e,t,a){"use strict";cc._RF.push(t,"ac64cG4J/NMJY6q4CZcXHY0","TJDDZ-roomtable");var s=e("SoundMngr"),c=e("roomHandler"),d=(e("configMgr"),e("gameDefine"));cc.Class({extends:cc.Component,properties:{play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,ruleLb:cc.Label,handCardLayOut:cc.Node,cardsNode:cc.Node,actionLayer:cc.Node,jiaofenNode:cc.Node,HoleCardsNode:cc.Node,clockNodes:cc.Node,buchuNodes:cc.Node,warningNode:cc.Node,multipleNode:cc.Node,_countdown_index:0,_currClockNodes:cc.Node,lastRoundLabel:cc.Label,dragonAnimations:cc.Node,winAnimation:cc.Node,loseAnimation:cc.Node,planeNode:cc.Node,chuntianNode:cc.Node,bobmAinmation:cc.Node,huojianAinmation:cc.Node,_effcetFlag:!1,maskNode:cc.Node,_currTime:null,dizhuSign:{default:null,type:cc.Prefab},tiBtnNode:{default:null,type:cc.Node},chuaiBtnNode:{default:null,type:cc.Node},chuaiIcon_right:{default:null,type:cc.Node},chuaiIcon_left:{default:null,type:cc.Node},tiIcon_right:{default:null,type:cc.Node},tiIcon_left:{default:null,type:cc.Node}},onLoad:function(){for(var e in WriteLog("TJDDZ-roomtable onLoad"),this.initData(),this.initUI(),this.registListenr(),this.handCardLayOut.children)this.defaultPokerY=this.handCardLayOut.children[e].y;GameDataTJDDZ.game.initcards&&(this.cardsNode.active=!0,this._dealEnd=!0,this.onShow()),null!=GameDataTJDDZ.currJiaofenPlayerData&&this.showJiaoFenNode(),GameDataTJDDZ.game.gameStartDizhu&&(this.showDizhuInfo(),this.showObtainNode(),this.showDisPoker(),this.showBuchuNode(),this.reconneShowWarning()),this.connectRecurrence()},registListenr:function(){registEvent("onPrepareInfo",this,this.showRoomRule),registEvent("tjddz-onGameInfo",this,this.onShow),registEvent("tjddz-onDiZhu",this,this.showDizhuInfo),registEvent("tjddz-initCardHands",this,this.onShow),registEvent("tjddz-initCardHand",this,this.initCardHand),registEvent("tjddz-initCardHandNum",this,this.showCardNum),registEvent("tjddz-initCardHandNums",this,this.showCardNum),registEvent("tjddz-onGameStart",this,this.handleGameStart),registEvent("tjddz-onJiaoFen",this,this.showJiaoFenNode),registEvent("tjddz-jiaoFencb",this,this.playJiaofenEffect),registEvent("tjddz-onShowObtainNode",this,this.showObtainNode),registEvent("tjddz-showDisPoker",this,this.showDisPoker),registEvent("initTableNode",this,this.initTableNode),registEvent("tjddz-onGameScore",this,this.showWinNode),registEvent("tjddz-cardWarning",this,this.showWarningNode),registEvent("tjddz-onDiscardType",this,this.showDisCardType),registEvent("tjddz-disPokerArry",this,this.setDisPokerArry),registEvent("tjddz-passcb",this,this.playPassEffect),registEvent("tjddz-hintCard",this,this.showHintCard),registEvent("tjddz-hideCard",this,this.hidePlayerCard),registEvent("onShowSummary",this,this.stopClockMusic),registEvent("tjddz-startTi",this,this.showTiChuai),registEvent("tjddz-startChuai",this,this.showTiChuai),registEvent("tjddz-showKicking",this,this.showKicking),registEvent("tjddz-showWatch",this,this.showWatch),registEvent("tjddz-reconnectionInfo",this,this.reconnectionInfo),registEvent("coinEndEvent",this,this.coinEndEvent);var e=this;this.maskNode.on(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()})},onDestroy:function(){unregistEvent("onPrepareInfo",this,this.showRoomRule),unregistEvent("tjddz-onGameInfo",this,this.onShow),unregistEvent("tjddz-onDiZhu",this,this.showDizhuInfo),unregistEvent("tjddz-initCardHands",this,this.onShow),unregistEvent("tjddz-initCardHand",this,this.initCardHand),unregistEvent("tjddz-initCardHandNum",this,this.showCardNum),unregistEvent("tjddz-initCardHandNums",this,this.showCardNum),unregistEvent("tjddz-onGameStart",this,this.handleGameStart),unregistEvent("tjddz-onJiaoFen",this,this.showJiaoFenNode),unregistEvent("tjddz-jiaoFencb",this,this.playJiaofenEffect),unregistEvent("tjddz-onShowObtainNode",this,this.showObtainNode),unregistEvent("tjddz-showDisPoker",this,this.showDisPoker),unregistEvent("initTableNode",this,this.initTableNode),unregistEvent("tjddz-onGameScore",this,this.showWinNode),unregistEvent("tjddz-cardWarning",this,this.showWarningNode),unregistEvent("tjddz-onDiscardType",this,this.showDisCardType),unregistEvent("tjddz-disPokerArry",this,this.setDisPokerArry),unregistEvent("tjddz-passcb",this,this.playPassEffect),unregistEvent("tjddz-hintCard",this,this.showHintCard),unregistEvent("tjddz-hideCard",this,this.hidePlayerCard),unregistEvent("onShowSummary",this,this.stopClockMusic),unregistEvent("tjddz-startTi",this,this.showTiChuai),unregistEvent("tjddz-startChuai",this,this.showTiChuai),unregistEvent("tjddz-showKicking",this,this.showKicking),unregistEvent("tjddz-showWatch",this,this.showWatch),unregistEvent("tjddz-reconnectionInfo",this,this.reconnectionInfo),unregistEvent("coinEndEvent",this,this.coinEndEvent);var e=this;this.maskNode.off(cc.Node.EventType.TOUCH_END,function(){e.DoubleClick()})},initData:function(){this.disCardArry=[],this.disPokerArry=[],this._dragonAnimtaionNum=1,this._cardHandPosArr=[],this._angularArr=[],this._dealActionIndex=0,this._flipActionIndex=0,this._cardHand=[],this._dealEnd=!1,this._kickingArr=[],this._buJiao=1},initUI:function(){this.cardsNode.active=!1,this.jiaofenNode.active=!1,this.ruleLb.string=this.getRuleStr(),this.hideDisCards()},initTableNode:function(){var e=cc.find("lastpokerNum",this.play_layer_left),t=cc.find("lastpokerNum",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideDisCards(),this.hideHandCards();var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a),this.actionLayer.active=!1,this.hideNodeChild(this.clockNodes),this.hideNodeChild(this.multipleNode),GameDataTJDDZ.game.dizhuUid=0,this.chuntianNode.active=!1,this.winAnimation.active=!1,this.loseAnimation.active=!1,this.planeNode.active=!1,this.bobmAinmation.active=!1,this.huojianAinmation.active=!1,this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.stopClockMusic()},showRoomRule:function(){this.ruleLb.string=this.getRuleStr()},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},handleGameStart:function(){GameDataTJDDZ.clearObject(GameDataTJDDZ.hideDisCard),GameDataTJDDZ.clearObject(GameDataTJDDZ.currObtainPlayerData),this.cardsNode.active=!0,this.hideHoleCards()},initCardHand:function(){GameDataTJDDZ.getMyHandCards().length==GameDataTJDDZ.handCardSize&&1==GameDataTJDDZ.deal&&(this._firstInit=!0),this.onShow()},onShow:function(){WriteLog("onShow");var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.showCards(),this.cardsNode.active=!0,this.HoleCardsNode.active=!0,this.lastRoundLabel.string="局数:"+GameData.room.roundNum+"/"+GameData.room.opts.roundMax},showCards:function(){WriteLog("showCards");var e=GameData.getPlayerByPos("down");e&&GameDataTJDDZ.cards[e.uid]?(this._firstInit?this.dealActionMngr():this.showMyHandCards(e,this.play_layer_down),this.play_layer_down.active=!0):this.play_layer_down.active=!1},showCardNum:function(){var e=GameData.getPlayerByPos("right");e&&GameDataTJDDZ.cards[e.uid]?(this.showOtherHandCards(e,this.play_layer_right),this.play_layer_right.active=!0):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("left"))&&GameDataTJDDZ.cards[e.uid]?(this.showOtherHandCards(e,this.play_layer_left),this.play_layer_left.active=!0):this.play_layer_left.active=!1},showMyHandCards:function(e,t){WriteLog("showMyHandCards"),this.resetPokerPos();var a=GameDataTJDDZ.getMyHandCards(),n=cc.find("cardHand/handLayout",t);for(var i in n.children)n.children[i].active=!1;for(var o=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),r=0;r<a.length;r++){var s=cc.find("cardHand/handLayout/hand_"+(o+r),t);s.active=!0,e.uid==GameDataTJDDZ.game.dizhuUid?this.addDizhuSign(s):this.removeDizhuSign(s),this.showCardContent(s,a[r])}},showOtherHandCards:function(e,t){if(e){var a=e.uid,n=GameDataTJDDZ.getHandCardNum(a),i=cc.find("lastpokerNum/pokerNum",t);i.active=!0,i.getComponent(cc.Label).string=n,cc.find("cardHand/hand_0",t).active=!0}},showCardContent:function(e,t){if(0!=t){var a=e.getComponent("Card");null!=a&&(a.id=t),e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/ddz/UI/pokers/poker_"+t+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)}},showPokerBack:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)this.showCardContent(e.children[t],"back"),e.children[t].active=!1},showTiChuai:function(){1==GameDataTJDDZ.tiFlag?this.tiBtnNode.active=!0:(GameDataTJDDZ.chuaiFlag=!0)&&(this.chuaiBtnNode.active=!0)},tiChuaiAction:function(e){var t=cc.callFunc(function(){e.active=!0},this),a=cc.callFunc(function(){e.active=!1},this),n=cc.delayTime(1),i=cc.sequence(t,n,a);e.parent.runAction(i)},showPlayerTiChuai:function(e,t,a){1==GameDataTJDDZ.kicking.kicking[a]&&a==t?"right"==e?this.tiChuaiAction(this.chuaiIcon_right):"left"==e&&this.tiChuaiAction(this.chuaiIcon_left):1==GameDataTJDDZ.kicking.kicking[a]&&a!=t&&("right"==e?this.tiChuaiAction(this.tiIcon_right):"left"==e&&this.tiChuaiAction(this.tiIcon_left))},showKicking:function(){for(var e in GameDataTJDDZ.kicking.kicking){for(var t=0,a=!1,n=0;n<this._kickingArr.length;n++)e==this._kickingArr[n]&&(a=!0);0==a&&(t=e,this._kickingArr.push(e));var i=0;if(0!=t&&(i=GameDataTJDDZ.getPosByUid(t)),0!=i){this.showPlayerTiChuai(i,GameDataTJDDZ.kicking.dizhu,t);break}}},dealActionMngr:function(){this._firstInit=!1,this._cardHandPosArr.splice(0,this._cardHandPosArr.length),this._angularArr.splice(0,this._angularArr.length),this._dealActionIndex=0,this._flipActionIndex=0;var e=cc.director.getWinSize();e.width,e.height;this._cardHand=GameDataTJDDZ.getMyHandCards();var t=GameDataTJDDZ.getMyHandCards();this.showPokerBack();var a=cc.find("cardHand/handLayout",this.play_layer_down);Math.ceil(a.childrenCount/2),Math.ceil(t.length/2);this.schedule(this.dealAction,.01)},dealAction:function(){var e=GameDataTJDDZ.getMyHandCards().length,t=cc.find("cardHand/handLayout",this.play_layer_down),a=Math.ceil(t.childrenCount/2)-Math.ceil(e/2),n=cc.find("cardHand/handLayout/hand_"+(a+this._dealActionIndex),this.play_layer_down);if(this.removeDizhuSign(n),n.active=!0,n.ratationY=180,this._dealActionIndex++,this._dealActionIndex>=e){var i=this;this.unschedule(this.dealAction),this.scheduleOnce(function(){i.runFlipAction()},.5)}},runFlipAction:function(){this.schedule(this.flipAction,.02)},flipAction:function(){var e=GameDataTJDDZ.getMyHandCards().length,t=cc.find("cardHand/handLayout",this.play_layer_down),a=Math.ceil(t.childrenCount/2)-Math.ceil(e/2),n=cc.find("cardHand/handLayout/hand_"+(a+this._flipActionIndex),this.play_layer_down);n.active=!0;var i=cc.rotateTo(.01,0,0),o=this,r=this._flipActionIndex,s=cc.callFunc(function(){o.removeDizhuSign(n),o.showCardContent(n,o._cardHand[r])},this),c=cc.sequence(i,s);n.runAction(c),this._flipActionIndex++,this._flipActionIndex>=e&&(this.unschedule(this.flipAction),o._dealEnd=!0,o.showJiaoFenNode())},angularByCoord:function(e,t){var a,n=Math.abs(e.x)-Math.abs(t.x),i=Math.abs(e.y)-Math.abs(t.y);return a=Math.atan(Math.abs(i)/Math.abs(n)),e.x<t.x?90-a/3.14159*180:a/3.14159*180},showWatch:function(){this.stopClockMusic();for(var e=0;e<GameDataTJDDZ.currtiChuaiPlayerData.length;e++)this.showClock(GameDataTJDDZ.currtiChuaiPlayerData[e])},reconnectionInfo:function(){this._dealEnd=!0,this.showJiaoFenNode()},showJiaoFenNode:function(){WriteLog("showJiaoFenNode");var e=GameDataTJDDZ.currJiaofenPlayerData.uid,t=GameDataTJDDZ.currJiaofenPlayerData.maxNum;if(GameDataTJDDZ.game.isJiaofenAgain&&(this._dealEnd=!1,GameDataTJDDZ.game.isJiaofenAgain=!GameDataTJDDZ.game.isJiaofenAgain,1==this._buJiao&&createMessageBox(null,function(){},null,"resources/ddz/UI/common/artword/artword_resendPoker.png"),this._buJiao++),0!=this._dealEnd){this.actionLayer.active=!1;var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a);for(var n=1;n<5;n++){cc.find("btn"+n,this.jiaofenNode).getComponent(cc.Button).interactable=!0}if(cc.log("GameData.player.uid == uid : "+GameData.player.uid,e),GameData.player.uid==e)for(this.jiaofenNode.active=!0;0<t;t--){cc.find("btn"+t,this.jiaofenNode).getComponent(cc.Button).interactable=!1}else this.jiaofenNode.active=!1;this.stopClockMusic(),this.showClocks(e),this.showJianfenText(GameDataTJDDZ.currJiaofenPlayerData)}},showJianfenText:function(e){if(cc.log("data  : "+JSON.stringify(e)),null!=e.allJiaoFen&&null!=e.allJiaoFen&&e.allJiaoFen){var t,a=GameData.getPlayerByPos("down"),n=cc.find("jiaofenSps/downSp",this.cardsNode);a&&GameDataTJDDZ.cards[a.uid]?null!=GameDataTJDDZ.getJiaofenNum(a.uid)&&(n.active=!0,t=cc.textureCache.addImage(cc.url.raw(this.getJiaofenImg(GameDataTJDDZ.getJiaofenNum(a.uid)))),n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)):n.active=!1,a=GameData.getPlayerByPos("right"),n=cc.find("jiaofenSps/rightSp",this.cardsNode),a&&GameDataTJDDZ.cards[a.uid]?null!=GameDataTJDDZ.getJiaofenNum(a.uid)&&(n.active=!0,t=cc.textureCache.addImage(cc.url.raw(this.getJiaofenImg(GameDataTJDDZ.getJiaofenNum(a.uid)))),n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)):n.active=!1,a=GameData.getPlayerByPos("left"),n=cc.find("jiaofenSps/leftSp",this.cardsNode),a&&GameDataTJDDZ.cards[a.uid]?null!=GameDataTJDDZ.getJiaofenNum(a.uid)&&(n.active=!0,t=cc.textureCache.addImage(cc.url.raw(this.getJiaofenImg(GameDataTJDDZ.getJiaofenNum(a.uid)))),n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)):n.active=!1}},selectScroe:function(e,t){switch(parseInt(t)){case 1:TJDDZHandler.getInstance().requestSelectScore(1,function(e){}),this.jiaofenNode.active=!1;break;case 2:TJDDZHandler.getInstance().requestSelectScore(2,function(e){}),this.jiaofenNode.active=!1;break;case 3:TJDDZHandler.getInstance().requestSelectScore(3,function(e){}),this.jiaofenNode.active=!1;break;case 4:TJDDZHandler.getInstance().requestSelectScore(4,function(e){}),this.jiaofenNode.active=!1}this._buJiao=1},playJiaofenEffect:function(e){var t=e.detail.uid,a=e.detail.num,n=GameData.getPlayerSexByUid(t),i="";switch(a){case 1:i="yifen";break;case 2:i="liangfen";break;case 3:i="sanfen";break;case 4:i="bujiao"}s.instance.playOtherAudioPoker(i,n)},showDizhuInfo:function(){var e=GameDataTJDDZ.gameStartData.cards,t=GameDataTJDDZ.gameStartData.multiple;this.showHoleCards(e);var a=cc.find("jiaofenSps",this.cardsNode);this.hideNodeChild(a),this.changeMultiple(t)},hideHoleCards:function(){var e=cc.find("cards",this.HoleCardsNode);for(var t in e.children)this.showHoleCardContent(e.children[t],"back")},showHoleCards:function(a){var n=this;if(null!=a){for(var i=cc.find("cards",this.HoleCardsNode),e=function(e){var t=cc.find("dipai_card"+e,i);o=cc.scaleTo(.3,0,.5),r=cc.scaleTo(.3,.5,.5),t.runAction(cc.sequence(o,r)),n.scheduleOnce(function(){this.showHoleCardContent(t,a[e])},.3)},t=0;t<i.childrenCount;t++){var o,r;e(t)}this.jiaofenNode.active=!1}},showHoleCardContent:function(e,t){cc.log("cardNode,cardId:"+e,t),e.getComponent(cc.Sprite).spriteFrame=null;var a="resources/ddz/UI/pokers/poker_"+t+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},showObtainNode:function(){this.disCardArry=[];var e=GameDataTJDDZ.currObtainPlayerData.uid,t=GameDataTJDDZ.currObtainPlayerData.flag,a=GameDataTJDDZ.currObtainPlayerData.hintFlag;this._effcetFlag=t;var n=cc.find("actions",this.cardsNode),i=cc.find("actions/btnPass",this.cardsNode),o=cc.find("actions/btnTishi",this.cardsNode);cc.find("actions/btnDisCard",this.cardsNode);GameData.player.uid==e?(n.active=!0,t?(i.active=!0,o.active=!0,a||createMoveMessage("没有大过上家的牌!")):(i.active=!1,o.active=!1)):n.active=!1,this.stopClockMusic(),this.showClocks(e);var r,s=GameData.tablePos[e];switch(cc.log("pos :"+s),s){case"down":r=cc.find("layer_down/cardDis",this.cardsNode);break;case"right":r=cc.find("layer_right/cardDis",this.cardsNode);break;case"left":r=cc.find("layer_left/cardDis",this.cardsNode);break;case"up":r=cc.find("layer_up/cardDis",this.cardsNode)}this.hidePassNode(s),null!=r&&this.hideNodeChild(r);var c=GameDataTJDDZ.getMyHandCards().length;if(cc.log("myPokerNum:"+c,o.active,i.active),!i.active&&!o.active&&1==c)for(var d in this.handCardLayOut.children)1==this.handCardLayOut.children[d].active&&GameData.player.uid==e&&this.handCardLayOut.children[d].y==this.defaultPokerY&&(this.handCardLayOut.children[d].y+=30,this.disPokerArry.push(this.handCardLayOut.children[d]))},hidePlayerCard:function(e){var t,a=e.detail.uid,n=GameDataTJDDZ.getPosByUid(a);n&&(t=cc.find("layer_"+n+"/cardDis",this.cardsNode)),null!=t&&this.hideNodeChild(t)},hidePassNode:function(e){switch(e){case"down":cc.find("buchuLb0",this.buchuNodes).active=!1;break;case"right":cc.find("buchuLb1",this.buchuNodes).active=!1;break;case"left":cc.find("buchuLb2",this.buchuNodes).active=!1}},onDisCardClick:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in this.disCardArry.splice(0,this.disCardArry.length),this.disPokerArry){var a=this.disPokerArry[t].getComponent("Card").id;cc.log("cardId "+a),this.disCardArry.push(a)}TJDDZHandler.getInstance().requestOnDisCard(this.disCardArry,function(){}),cc.log("disCardArry: ",this.disCardArry),cc.log("disPokerArry: ",this.disPokerArry);var n=0;for(var t in e.children)e.children[t].y==this.defaultPokerY&&n++;0<n&&0==this.disCardArry.length&&createMoveMessage("请选择要出的牌!")},onPassCardClick:function(){var t=cc.find("actions",this.cardsNode);t.active=!1;var a=e("errorCode");TJDDZHandler.getInstance().requestOnPassCard(function(e){e.result!=a.Success&&(t.active=!0)}),this.resetPokerPos()},onHintClick:function(){TJDDZHandler.getInstance().requestOnHintCard(function(e){})},playPassEffect:function(e){var t=e.detail.uid,a=GameData.getPlayerSexByUid(t);s.instance.playOtherAudioPoker("buyao",a),this.showBuchuNode()},showBuchuNode:function(){var e=GameData.getPlayerByPos("down"),t=GameDataTJDDZ.getDisPoker(e.uid),a=cc.find("buchuLb0",this.buchuNodes);this.showbuchuStr(e,a,t),e=GameData.getPlayerByPos("right"),t=GameDataTJDDZ.getDisPoker(e.uid),a=cc.find("buchuLb1",this.buchuNodes),this.showbuchuStr(e,a,t),e=GameData.getPlayerByPos("left"),t=GameDataTJDDZ.getDisPoker(e.uid),a=cc.find("buchuLb2",this.buchuNodes),this.showbuchuStr(e,a,t)},showbuchuStr:function(e,t,a){null!=a&&(0==a[0]?(t.active=!0,GameDataTJDDZ.isEmptyObject(GameDataTJDDZ.currObtainPlayerData)||GameDataTJDDZ.currObtainPlayerData.uid==e.uid&&(t.active=!1)):0==a.length&&(t.active=!1))},showDisPoker:function(){var e=GameData.getPlayerByPos("down"),t=GameDataTJDDZ.getDisPoker(e.uid);e&&GameDataTJDDZ.cards[e.uid]?(this.play_layer_down.active=!0,this.showPokerCards(e,this.play_layer_down,t)):this.play_layer_down.active=!1,e=GameData.getPlayerByPos("right"),t=GameDataTJDDZ.getDisPoker(e.uid),e&&GameDataTJDDZ.cards[e.uid]?(this.play_layer_right.active=!0,this.showPokerCards(e,this.play_layer_right,t)):this.play_layer_right.active=!1,e=GameData.getPlayerByPos("left"),t=GameDataTJDDZ.getDisPoker(e.uid),e&&GameDataTJDDZ.cards[e.uid]?(this.play_layer_left.active=!0,this.showPokerCards(e,this.play_layer_left,t)):this.play_layer_left.active=!1,this.hideDisPoker()},hideDisPoker:function(){var e;if(!GameDataTJDDZ.isEmptyObject(GameDataTJDDZ.hideDisCard)){switch(GameDataTJDDZ.getPosByUid(GameDataTJDDZ.hideDisCard.uid)){case"down":e=cc.find("cardDis",this.play_layer_down);break;case"right":e=cc.find("cardDis",this.play_layer_right);break;case"left":e=cc.find("cardDis",this.play_layer_left)}this.hideNodeChild(e)}},showPokerCards:function(e,t,a){GameDataTJDDZ.currObtainPlayerData.uid;var n=cc.find("cardDis",t);if(null!=a)if(this.hideNodeChild(n),t==this.play_layer_down)for(var i=Math.ceil(n.childrenCount/2)-Math.ceil(a.length/2),o=0;o<a.length;o++){var r=cc.find("dis_"+(i+o),n);0==a[0]?r.active=!1:r.active=!0,e.uid==GameDataTJDDZ.game.dizhuUid?this.addDizhuSign(r,"dis"):this.removeDizhuSign(r),this.showCardContent(r,a[o])}else for(var s=0;s<a.length;s++){r=cc.find("dis_"+s,n);0==a[0]?r.active=!1:r.active=!0,e.uid==GameDataTJDDZ.game.dizhuUid?this.addDizhuSign(r,"dis"):this.removeDizhuSign(r),this.showCardContent(r,a[s])}},showClocks:function(e){if(null!=e){var t=GameData.getPlayerByPos("down"),a=cc.find("cloock0",this.clockNodes);this.showClockContent(t,a,e),t=GameData.getPlayerByPos("right"),a=cc.find("cloock1",this.clockNodes),this.showClockContent(t,a,e),t=GameData.getPlayerByPos("left"),a=cc.find("cloock2",this.clockNodes),this.showClockContent(t,a,e)}},showClock:function(e){if(null!=e){var t=GameData.getPlayerByPos("down"),a=cc.find("cloock0",this.clockNodes);this.showClockContent(t,a,e)}},showClockContent:function(e,t,a){e.uid==a&&(t.active=!0,this.PLayerUID=a,this._currClockNodes=t,this.startCoundDown())},startCoundDown:function(){this._countdown_index=14,this.schedule(this.runCountDown,1)},runCountDown:function(){if(this.showCountDown(this._countdown_index+"",this._currClockNodes),this._countdown_index<=0)cc.log("结束"),this._countdown_index=15;else{var e=cc.blink(.5,3);3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&(this._currClockNodes.runAction(e),s.instance.playAudioOther("countdown")),this._countdown_index--}},showCountDown:function(e,t){var a=e;e<10&&(a="0"+e),cc.find("timeLb",t).getComponent(cc.Label).string=a},hideDisCards:function(){var e=cc.find("cardDis",this.play_layer_down),t=cc.find("cardDis",this.play_layer_left),a=cc.find("cardDis",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},hideHandCards:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down),t=cc.find("cardHand",this.play_layer_left),a=cc.find("cardHand",this.play_layer_right);this.hideNodeChild(e),this.hideNodeChild(t),this.hideNodeChild(a)},showWinNode:function(e){WriteLog("showWinNode"),this._dealEnd=!1,this._kickingArr.splice(0,this._kickingArr.length),this.stopClockMusic(),this.hideNodeChild(this.warningNode),this.hideNodeChild(this.buchuNodes),this.actionLayer.active=!1,sendEvent("HideReadyNode");var t=GameData.getPlayerByPos("down"),a=0;if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType){var n=c.getCoinData();n&&n.coin&&(a=n.coin[GameData.player.uid])}else a=GameDataTJDDZ.resultData.score[GameData.player.uid];0<a?s.instance.playOtherAudioPoker("shengli",null):s.instance.playOtherAudioPoker("shibai",null),t&&GameDataTJDDZ.cards[t.uid]?(this.play_layer_down.active=!0,this.showWinnerIcon(t,e)):this.play_layer_down.active=!1,(t=GameData.getPlayerByPos("right"))&&GameDataTJDDZ.cards[t.uid]?(this.play_layer_right.active=!0,this.showWinnerIcon(t,e)):this.play_layer_right.active=!1,(t=GameData.getPlayerByPos("left"))&&GameDataTJDDZ.cards[t.uid]?(this.play_layer_left.active=!0,this.showWinnerIcon(t,e)):this.play_layer_left.active=!1},coinEndEvent:function(e){e.detail.chuntian,this.scheduleOnce(function(){sendEvent("AnimationDelayTime",e.detail)},4+3*this._dragonAnimtaionNum)},showWinnerIcon:function(e,t){t.detail.winner;var a=0;t.detail.chuntian&&(a=2,this.scheduleOnce(function(){this.chuntianNode.active=!0,this.chuntianNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),s.instance.playOtherAudioPoker("chuntian",null)},1.5*this._dragonAnimtaionNum),this.scheduleOnce(function(){this.chuntianNode.active=!1},1.5*this._dragonAnimtaionNum+2));var n=0;if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=c.getCoinData();i&&i.coin&&(n=i.coin[GameData.player.uid])}else n=GameDataTJDDZ.resultData.score[GameData.player.uid];if(0<n){cc.log("1111111111111111111111111");var o=this;this.scheduleOnce(function(){this.winAnimation.active=!0,this.winAnimation.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)},a+1.5*this._dragonAnimtaionNum),this.scheduleOnce(function(){o.winAnimation.active=!1},4.5+1.5*this._dragonAnimtaionNum)}else cc.log("22222222222222222222222222222222"),this.scheduleOnce(function(){this.loseAnimation.active=!0,this.loseAnimation.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)},a+1.5*this._dragonAnimtaionNum);cc.log("44444444444444444444444: ",this._dragonAnimtaionNum," 5555: ",n);var r=3*this._dragonAnimtaionNum+2+a;sendEvent("AnimationDelayTime",r)},getJiaofenImg:function(e){var t="";switch(parseInt(e)){case 1:t="resources/ddz/UI/common/artword/artword_1fen.png";break;case 2:t="resources/ddz/UI/common/artword/artword_2fen.png";break;case 3:t="resources/ddz/UI/common/artword/artword_3fen.png";break;case 4:t="resources/ddz/UI/common/artword/artword_bujiao.png"}return t},showWarningNode:function(e){var t=GameData.getPlayerByPos("down"),a=cc.find("warning0",this.warningNode);t&&GameDataTJDDZ.cards[t.uid]?(this.showWarningContent(t,a,e),this.play_layer_down.active=!0):this.play_layer_down.active=!1,t=GameData.getPlayerByPos("right"),a=cc.find("warning1",this.warningNode),t&&GameDataTJDDZ.cards[t.uid]?(this.showWarningContent(t,a,e),this.play_layer_right.active=!0):this.play_layer_right.active=!1,t=GameData.getPlayerByPos("left"),a=cc.find("warning2",this.warningNode),t&&GameDataTJDDZ.cards[t.uid]?(this.showWarningContent(t,a,e),this.play_layer_left.active=!0):this.play_layer_left.active=!1},showWarningContent:function(e,t,a){var n=a.detail.uid,i=GameData.getPlayerSexByUid(n),o=a.detail.baodan;(this.scheduleOnce(function(){s.instance.playOtherAudioPoker("baojing"+o,i)},1),n==e.uid)&&(t.active=!0,t.getComponent(cc.Animation).play("warningAnimation"))},reconneShowWarning:function(){var e=GameData.getPlayerByPos("down"),t=cc.find("warning0",this.warningNode);e&&GameDataTJDDZ.cards[e.uid]?(this.play_layer_down.active=!0,this.reconneShowWarningContent(e,t)):this.play_layer_down.active=!1,e=GameData.getPlayerByPos("right"),t=cc.find("warning1",this.warningNode),e&&GameDataTJDDZ.cards[e.uid]?(this.reconneShowWarningContent(e,t),this.play_layer_right.active=!0):this.play_layer_right.active=!1,e=GameData.getPlayerByPos("left"),t=cc.find("warning2",this.warningNode),e&&GameDataTJDDZ.cards[e.uid]?(this.reconneShowWarningContent(e,t),this.play_layer_left.active=!0):this.play_layer_left.active=!1},reconneShowWarningContent:function(e,t){var a=GameDataTJDDZ.getHandCardNum(e.uid);a<=2&&0<a?(t.active=!0,t.getComponent(cc.Animation).play("warningAnimation")):t.active=!1},hideWarningNode:function(e){var t,a=GameDataTJDDZ.getHandCardNum(e);switch(GameDataTJDDZ.getPosByUid(e)){case"down":t=cc.find("warning0",this.warningNode);break;case"right":t=cc.find("warning1",this.warningNode);break;case"left":t=cc.find("warning2",this.warningNode)}0==a&&(t.active=!1)},showDisCardType:function(e){var t=e.detail.type,a=e.detail.multiple;this.hideWarningNode(e.detail.uid),this._dragonAnimtaionNum=0;var n=GameData.getPlayerSexByUid(e.detail.uid);s.instance.playAudioPokerDisType(e,n,this._effcetFlag),s.instance.playOtherAudioPoker("discard",null),"aircraft"!=t.substring(0,t.length-1)&&"aircraft"!=t&&"tribletraights"!=t||(s.instance.playOtherAudioPoker("plane",null),this.planeNode.active=!0,this._dragonAnimtaionNum++,this.DDZplayAnimation(this.planeNode,1.5)),"bomb"==t&&(this._dragonAnimtaionNum++,s.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.bobmAinmation,2)),"jokerBomb"==t&&(this._dragonAnimtaionNum++,s.instance.playOtherAudioPoker("bomb",null),this.DDZplayAnimation(this.huojianAinmation,1.7)),this.changeMultiple(a)},changeMultiple:function(e){if(null!=e){var t=cc.find("multipleNum",this.multipleNode);this.showNodeChild(this.multipleNode),t.getComponent(cc.Label).string="X"+e}},showNodeChild:function(e){for(var t in e.children)e.children[t].active=!0},setDisPokerArry:function(e){var t=e.detail;this.disPokerArry=[],cc.log("pokerArry:"+t);for(var a=0;a<t.length;a++){var n=t[a];for(var i in this.handCardLayOut.children)n==this.handCardLayOut.children[i].name&&1==this.handCardLayOut.children[i].active&&this.disPokerArry.push(this.handCardLayOut.children[i])}},DDZplayAnimation:function(e,t){e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),this.scheduleOnce(function(){e.active=!1},t)},resetPokerPos:function(){var e=cc.find("cardHand/handLayout",this.play_layer_down);for(var t in e.children)e.children[t].y=this.defaultPokerY;this.disPokerArry.splice(0,this.disPokerArry.length)},DoubleClick:function(){var e=(new Date).getTime();e-this._currTime<500&&(this.resetPokerPos(),this.disPokerArry=[]),this._currTime=e},showHintCard:function(e){var t=e.detail.cards;e.detail.uid;this.disPokerArry=[];var a=cc.find("layer_down/cardHand/handLayout",this.cardsNode);for(var n in a.children)a.children[n].y=this.defaultPokerY;for(var n in a.children)for(var i=a.children[n].getComponent("Card"),o=0;o<t.length;o++)i.id==t[o]&&1==a.children[n].active&&(a.children[n].y+=30,this.disPokerArry.push(a.children[n]))},stopClockMusic:function(){this.unschedule(this.runCountDown),this.hideNodeChild(this.clockNodes)},getRuleStr:function(){if(GameData.room.opts)return getRuleStrTJDDZ(GameData.room.opts)},addDizhuSign:function(e,t){var a=cc.instantiate(this.dizhuSign);"dis"==t&&a.setPosition(cc.p(-40,45)),e.addChild(a)},removeDizhuSign:function(e){e.removeAllChildren(!0)},connectRecurrence:function(){var e=!1;GameData.room.opts&&(e=!0),e&&1==GameData.room.opts.kicking&&this.connectTiChuai()},connectTiChuai:function(){if(!GameDataTJDDZ.isEmptyObject(GameData.joinContact)&&!GameDataTJDDZ.isEmptyObject(GameDataTJDDZ.kicking)&&GameData.joinContact.uid==GameData.player.uid){for(var e in GameDataTJDDZ.kicking.kicking)if(e==GameData.player.uid)return this.tiBtnNode.active=!1,void(this.chuaiBtnNode.active=!1);if(GameDataTJDDZ.game.dizhuUid==GameData.player.uid)if(2==GameDataTJDDZ.objectLen(GameDataTJDDZ.kicking.kicking)){this.showWatch();var t=0;for(var e in GameDataTJDDZ.kicking.kicking)0==GameDataTJDDZ.kicking.kicking[e]&&t++;this.chuaiBtnNode.active=2!=t}else GameDataTJDDZ.kicking.flag,this.chuaiBtnNode.active=!1;else this.showWatch(),this.tiBtnNode.active=!0}},onTiBtnChecked:function(e,t){this.tiBtnNode.active=!1,this.stopClockMusic(),TJDDZHandler.getInstance().requestTiChuai(t,function(e){cc.log("tiBtn rtn: ",e)})},onChuaiBtnChecked:function(e,t){this.chuaiBtnNode.active=!1,this.stopClockMusic(),TJDDZHandler.getInstance().requestTiChuai(t,function(e){cc.log("chuaiBtn rtn: ",e)})}});cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"TingTip-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"d37fb9UPmNKAb8IDSZkA+GK","TingTip-shishi");e("ruleHandler");cc.Class({extends:cc.Component,properties:{tingNode:cc.Node,bg:cc.Node,cardTemplate:cc.Node,totalLeftLabel:cc.Label,huSprite:cc.Sprite},onLoad:function(){this.bgHeight=this.bg.height,this.huPosition=this.huSprite.node.position,this.totalLeftLabelPosition=this.totalLeftLabel.node.position,this.cardNodeList=[],this.cardTemplate.active=!1,this.selectCard=-1},show:function(e,t){for(var a=[],n=[],i={},o=0,r=0;r<t.length;r++){var s=t[r];if(s.discard==e){a=s.ting;break}}if(0<a.length){this.tingNode.active=!0;for(r=0;r<this.cardNodeList.length;r++){(v=this.cardNodeList[r]).destroy()}this.cardNodeList.splice(0,this.cardNodeList.length);for(var c=0;c<a.length;c++){var d=(h=a[c]).type.toString();"4"===d&&(d="3"),i[d]=i[d]||[],i[d].push(h)}for(var r in i){var h;if(15<=(h=i[r]).length)n.push({obcard:-1,score:h[0].score});else for(var l in h)n.push({obcard:h[l].obcard,score:h[l].score})}n.sort(function(e,t){return t.score-e.score});var u=-1;for(r=0;r<n.length;r++)if(-1!=n[r].obcard){var m=n[r].obcard,p=n[r].score;o+=g=this.leftCard(m),this.showCardNode(m,p,g)}else u=r;if(0<=u){m="renyi",p=n[u].score;var g=GameData.game.cardleft-o;o=GameData.game.cardleft-16-GameData.getAllGangNumber(),this.showCardNode(m,p,g)}cc.find("totalLeftLabel",this.tingNode).getComponent(cc.Label).string="剩余"+o+"张";var f=this.cardNodeList.length,y=4<f?Math.ceil(f/2):f;Math.ceil(f/y);this.bg.width=200+90*y;for(r=0;r<this.cardNodeList.length;r++){var v;(v=this.cardNodeList[r]).x=this.cardTemplate.x+r%y*90-90*y/2,v.y=4<f?this.cardTemplate.y-154*Math.floor(r/y)+152:this.cardTemplate.y-154*Math.floor(r/y)}4<f?(this.bg.height=370,this.huSprite.node.x=this.huPosition.x-90*y/2,this.huSprite.node.y=this.huPosition.y+76,this.totalLeftLabel.node.x=this.totalLeftLabelPosition.x-90*y/2,this.totalLeftLabel.node.y=this.totalLeftLabelPosition.y+76):(this.bg.height=this.bgHeight,this.huSprite.node.x=this.huPosition.x-90*y/2,this.huSprite.node.y=this.huPosition.y,this.totalLeftLabel.node.x=this.totalLeftLabelPosition.x-90*y/2,this.totalLeftLabel.node.y=this.totalLeftLabelPosition.y),this.selectCard=e}else this.tingNode.active=!1},getTingSelectCard:function(){return this.selectCard},getTingNodeActive:function(){return this.tingNode.active},hide:function(){this.tingNode.active=!1,this.selectCard=-1},showCardNode:function(e,t,a){var n=cc.instantiate(this.cardTemplate),i="resources/mjcard2d/mj_face_xia_shou_"+e+".png",o=cc.textureCache.addImage(cc.url.raw(i));n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),cc.find("scoreLabel",n).getComponent(cc.Label).string=t+"分",cc.find("leftLabel",n).getComponent(cc.Label).string=a+"张",cc.find("mask",n).active=0==a,n.active=!0,this.tingNode.addChild(n),this.cardNodeList.push(n)},leftCard:function(e){var t=0,a=GameData.getMyHandCards();for(var n in a)e==n&&(t+=a[n]);for(var i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o){var r=o.uid,s=GameData.getDisCards(r),c=GameData.getChiCards(r),d=GameData.getPengCards(r),h=GameData.getGangCards(r);for(var n in s)e==s[n]&&(t+=1);for(var n in c){var l=c[n];if(!(null==l||l.length<=0))for(var u in l)if(e==l[u]){t+=1;break}}for(var n in d)e==d[n][0]&&(t+=3);for(var n in h)4==h[n].length&&e==h[n][0]&&(t+=4)}}var m=4-t;return m=m<=0?0:m}}),cc._RF.pop()},{ruleHandler:"ruleHandler"}],TingTip:[function(e,t,a){"use strict";cc._RF.push(t,"f8afciFIxFLYJEUpv18Dm2T","TingTip");e("ruleHandler"),e("SoundMngr");cc.Class({extends:cc.Component,properties:{tingNode:cc.Node,bg:cc.Node,nbg:cc.Node,cardTemplate:cc.Node},onLoad:function(){this.bgHeight=this.bg.height,this.nbgHeight=this.nbg.height,this.cardNodeList=[],this.cardTemplate.active=!1},show:function(e,t){for(var a=[],n=[],i={},o=0,r=0;r<t.length;r++){var s=t[r];if(s.discard==e){a=s.ting;break}}if(0<a.length){this.tingNode.active=!0;for(r=0;r<this.cardNodeList.length;r++){(v=this.cardNodeList[r]).destroy()}this.cardNodeList.splice(0,this.cardNodeList.length);for(var c=0;c<a.length;c++){var d=(h=a[c]).type.toString();"4"===d&&(d="3"),i[d]=i[d]||[],i[d].push(h)}for(var r in i){var h;if(15<=(h=i[r]).length)n.push({obcard:-1,score:h[0].score});else for(var l in h)n.push({obcard:h[l].obcard,score:h[l].score})}n.sort(function(e,t){return t.score-e.score});var u=-1;for(r=0;r<n.length;r++)if(-1!=n[r].obcard){var m=n[r].obcard,p=n[r].score;o+=g=this.leftCard(m),this.showCardNode(m,p,g)}else u=r;if(0<=u){m="renyi",p=n[u].score;var g=GameData.game.cardleft-o;o=GameData.game.cardleft,this.showCardNode(m,p,g)}cc.find("totalLeftLabel",this.tingNode).getComponent(cc.Label).string="剩余"+o+"张";var f=this.cardNodeList.length,y=4<f?Math.ceil(f/2):f;for(Math.ceil(f/y),r=0;r<this.cardNodeList.length;r++){var v;(v=this.cardNodeList[r]).x=this.cardTemplate.x+r%y*90,v.y=this.cardTemplate.y-154*Math.floor(r/y)}this.nbg.width=90*y,this.bg.width=220+this.nbg.width,4<f?(this.bg.height=370,this.nbg.height=300):(this.bg.height=this.bgHeight,this.nbg.height=this.nbgHeight)}else this.tingNode.active=!1},hide:function(){this.tingNode.active=!1},showCardNode:function(e,t,a){var n=cc.instantiate(this.cardTemplate),i="resources/mjcard2d/mj_face_xia_shou_"+e+".png",o=cc.textureCache.addImage(cc.url.raw(i));n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),cc.find("scoreLabel",n).getComponent(cc.Label).string=t+"分",cc.find("leftLabel",n).getComponent(cc.Label).string=a+"张",cc.find("mask",n).active=0==a,n.active=!0,this.tingNode.addChild(n),this.cardNodeList.push(n)},leftCard:function(e){var t=0,a=GameData.getMyHandCards();for(var n in a)e==n&&(t+=a[n]);for(var i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o){var r=o.uid,s=GameData.getDisCards(r),c=GameData.getPengCards(r),d=GameData.getGangCards(r);for(var n in s)e==s[n]&&(t+=1);for(var n in c)e==c[n][0]&&(t+=3);for(var n in d)e==d[n][0]&&(t+=4)}}var h=4-t;return h=h<=0?0:h}}),cc._RF.pop()},{SoundMngr:"SoundMngr",ruleHandler:"ruleHandler"}],"TuiDaoHu-Data":[function(e,t,a){"use strict";cc._RF.push(t,"48505JJbP1N3pbnGf21JtLz","TuiDaoHu-Data");var n=function(){this.cards={},this.game={roundType:0,roundNum:0,roundmax:0,zhuangUid:0,cardleft:0,turn:0,wildcard:[],lastdisUid:0,lastdisCard:0,winnerUid:0,winnerType:0,obtain:0},this.passAction={lastUid:0,fromCard:0,action:[],checkCards:[]},this.actionType=!1,this.actionEffect={uid:null,card:null,action:null},this.scores={}};t.exports=new n,n.prototype.getGameInfoData=function(){return this.game},n.prototype.getPlayerCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e]},n.prototype.getChiCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].chi},n.prototype.getPengCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].peng},n.prototype.getGangCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].gang},n.prototype.getHandCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].hand},n.prototype.getHandCardNum=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].handnum},n.prototype.getDisCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].dis},n.prototype.getPassActionsData=function(){return this.passAction},n.prototype.getActionsType=function(){return this.actionType},n.prototype.getActionEffectData=function(){return this.actionEffect},n.prototype.getGameScoreData=function(){return this.scores},n.prototype.onGameInfoSetData=function(e){null!=e&&(this.game.roundType=e.roundType,this.game.roundNum=e.roundNum,this.game.roundmax=e.roundmax,this.game.zhuangUid=e.zhuang,this.game.cardleft=e.cardleft,this.game.turn=e.turn,this.game.wildcard=e.wildcard,this.game.lastdisUid=e.disuid,this.game.lastdisCard=e.discard)},n.prototype.onGameStartSetData=function(e){null!=e&&(this.game.gameStart=!0,this.passAction.lastUid=0,this.passAction.fromCard=0,this.passAction.action=[],this.passAction.checkCards=[])},n.prototype.onGameScoreSetData=function(e){null!=e&&(this.scores=e,this.game.gameStart=!1)},n.prototype.onGamePassSetData=function(e){null!=e&&(this.passAction.lastUid=e.uid,this.passAction.fromCard=e.card,this.passAction.action=e.act,this.actionType=!1)},n.prototype.onGameActionSetData=function(e){null!=e&&(this.passAction.action=e.act,this.actionType=!0)},n.prototype.initCardHandSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].hand=e.hand,this.game.obtain=e.obtain)},n.prototype.initCardHandNumSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].handnum=e.num)},n.prototype.initCardChiSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].chi=e.chi)},n.prototype.initCardPengSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].peng=e.peng)},n.prototype.initCardGangSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].gang=e.gang)},n.prototype.initCardDisSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].dis=e.dis)},n.prototype.setActionEffect=function(e,t){null!=e&&null!=t&&(this.actionEffect.uid=t.player,this.actionEffect.card=t.card,this.actionEffect.action=e)},n.prototype.onCardDisSetData=function(e){this.setActionEffect("dis",e)},n.prototype.onCardChiSetData=function(e){this.setActionEffect("chi",e)},n.prototype.onCardPengSetData=function(e){this.setActionEffect("peng",e)},n.prototype.onCardGangMingSetData=function(e){this.setActionEffect("gang",e)},n.prototype.onCardGangAnSetData=function(e){this.setActionEffect("gang",e)},n.prototype.onCardGangBuSetData=function(e){this.setActionEffect("gang",e)},n.prototype.onCardHuSetData=function(e){this.setActionEffect("hu",e)},cc._RF.pop()},{}],"TuiDaoHu-Protocol":[function(e,t,a){"use strict";cc._RF.push(t,"6229bIJafNBc7+zFYtcP3kp","TuiDaoHu-Protocol");var n=e("gameConfig"),i=e("errorCode"),o=t.exports;o.requestDisCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.discard",{card:e},function(e){cc.log("room.hzhmjHandler.discard:%d",e.result),t(e)})},o.requestPass=function(t){GameNet.getInstance().request("room.hzhmjHandler.pass",{},function(e){cc.log("room.hzhmjHandler.pass response:%d",e.result),e.result==i.Fail&&createMoveMessage("请等待其他玩家选择"),t(e)})},o.requestChiCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.chi",{cards:e.cards},function(e){cc.log("room.hzhmjHandler.chi response:%d",e.result),t(e)})},o.requestPengCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.peng",{},function(e){cc.log("room.hzhmjHandler.peng response:%d",e.result),t(e)})},o.requestAnGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangAn",{card:e.cards},function(e){cc.log("room.hzhmjHandler.gangAn response:%d",e.result),t(e)})},o.requestMingGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangMing",{},function(e){cc.log("room.hzhmjHandler.gangMing response:%d",e.result),t(e)})},o.requestBuGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangBu",{card:e.cards},function(e){cc.log("room.hzhmjHandler.gangBu response:%d",e.result),t(e)})},o.requestDianPao=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.dianPao",{},function(e){cc.log("room.hzhmjHandler.dianPao response:%d",e.result),t(e)})},o.requestHu=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.hu",{},function(e){cc.log("room.hzhmjHandler.hu response:%d",e.result),t(e)})},o.registMessage=function(){GameNet.getInstance().setCallBack("hzhmj-onGameInfo",function(e){n.getGameData().onGameInfoSetData(e),sendEvent("onGameInfo",e),sendEvent("onGameTurn"),sendEvent("updateCards")}),GameNet.getInstance().setCallBack("hzhmj-initCardHand",function(e){n.getGameData().initCardHandSetData(e),sendEvent("initCardHand",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardHandNum",function(e){n.getGameData().initCardHandNumSetData(e),sendEvent("initCardHandNum",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardChi",function(e){n.getGameData().initCardChiSetData(e),sendEvent("initCardChi",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardPeng",function(e){n.getGameData().initCardPengSetData(e),sendEvent("initCardPeng",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardGang",function(e){n.getGameData().initCardGangSetData(e),sendEvent("initCardGang",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardDis",function(e){n.getGameData().initCardDisSetData(e),sendEvent("initCardDis",e)}),GameNet.getInstance().setCallBack("hzhmj-onGamePass",function(e){n.getGameData().onGamePassSetData(e),sendEvent("onGamePass",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameAction",function(e){n.getGameData().onGameActionSetData(e),sendEvent("onGameAction",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardDis",function(e){n.getGameData().setActionEffect("dis",e),sendEvent("onCardDis",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardChi",function(e){n.getGameData().setActionEffect("chi",e),sendEvent("onCardChi",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardPeng",function(e){n.getGameData().setActionEffect("peng",e),sendEvent("onCardPeng",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangAn",function(e){n.getGameData().setActionEffect("gang",e),sendEvent("onCardGangAn",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangMing",function(e){n.getGameData().setActionEffect("gang",e),sendEvent("onCardGangMing",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangBu",function(e){n.getGameData().setActionEffect("gang",e),sendEvent("onCardGangBu",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardHu",function(e){n.getGameData().setActionEffect("hu",e),sendEvent("onCardHu",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameStart",function(e){n.getGameData().onGameStartSetData(e),sendEvent("onGameStart",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameScore",function(e){n.getGameData().onGameScoreSetData(e),sendEvent("onGameScore",e)})},cc._RF.pop()},{errorCode:"errorCode",gameConfig:"gameConfig"}],"TuiDaoHu-Rules":[function(e,t,a){"use strict";cc._RF.push(t,"50c8cfvxZREga2bHXhdvqjS","TuiDaoHu-Rules");var n=e("gameConfig"),i=(e("roomHandler"),t.exports);i.isWildCard=function(e){return-1!=n.getGameData().game.wildcard.indexOf(e)},i.getWildCards=function(){return n.getGameData().game.wildcard},cc._RF.pop()},{gameConfig:"gameConfig",roomHandler:"roomHandler"}],TuiDaoHu:[function(e,t,a){"use strict";cc._RF.push(t,"de6a74ynkJIYYD/GfXWL2DT","TuiDaoHu");var n=e("TuiDaoHu-Data"),i=e("TuiDaoHu-Rules"),o=e("TuiDaoHu-Protocol"),r={name:"推到胡麻将",language:{name:"中国话"},prefabs:{wifiView:"views/room/common/WifiView",powerView:"views/room/common/PowerView",timeView:"views/room/common/TimeView",roomNumView:"views/room/common/RoomNumView",ruleView:"views/room/common/RuleView",ruleTipsView:"views/room/common/RuleTipsView",chatView:"views/common/ChatView",talkView:"views/common/TalkView",settingView:"views/common/SettingView",dissolveView:"views/room/common/DissolveView",headView:"views/room/mahjong/HeadView",waitView:"views/room/mahjong/WaitView",prepareView:"views/room/mahjong/PrepareView",cardsView:"views/room/mahjong/CardsView",wildCard1View:"views/room/mahjong/WildCard1View",directionView:"views/room/mahjong/DirectionView",cardActionView:"views/room/mahjong/CardActionView",debugView:"views/room/mahjong/DebugView",resultView:"views/room/mahjong/ResultView",summaryView:"views/room/mahjong/SummaryView"},views:{base:["talkView","wifiView","powerView","timeView","roomNumView","ruleView"],wait:["waitView","headView","prepareView","ruleTipsView"],game:["wildCard1View","directionView","cardsView","headView","ruleTipsView","cardActionView"],ready:["headView","directionView","prepareView","ruleTipsView"]},chat:{talks:["嘛钱不钱的，乐呵乐呵得了。","哎呀，出错牌了。","怒了啊，怒了啊。","今儿运气不错啊，没少赢。","楞嘛神儿！快点吧，花都谢了。","我要加油了啊。","这牌打的没谁了，谢了啊。","还让不让人活了，我要发威了","今儿输的太多了，太点背了。","土豪，咱们做朋友吧。","等下哈，我考虑考虑出嘛。","不好意思啊。"],soundKeys:["card_K_1","card_K_2","card_K_3","card_K_4","card_K_5","card_K_6","card_K_7","card_K_8","card_K_9","card_K_10","card_K_11","card_K_12"]},actions:{chi:{type:"chi",icon:"resources/table/action/chi.png",spine:"spine/table/chi",animate:"a",request_fn:"requestChiCard"},peng:{type:"peng",icon:"resources/table/action/peng.png",spine:"spine/table/peng",animate:"animation",request_fn:"requestPengCard"},minggang:{type:"gang",icon:"resources/table/action/gang.png",spine:"spine/table/gang",animate:"a",request_fn:"requestMingGangCard"},angang:{type:"gang",icon:"resources/table/action/gang.png",spine:"spine/table/gang",animate:"a",request_fn:"requestAnGangCard"},bugang:{type:"gang",icon:"resources/table/action/gang.png",spine:"spine/table/gang",animate:"a",request_fn:"requestBuGangCard"},zimo:{type:"hu",icon:"resources/table/action/hu.png",spine:"spine/table/hu",animate:"a",request_fn:"requestHu"},dianpao:{type:"hu",icon:"resources/table/action/hu.png",spine:"spine/table/hu",animate:"a",request_fn:"requestDianPao"}},resources:{wildIcon:"resources/newui/huier_icon.png"},getRuleStr:function(e){return getRuleStrHongZhong(e)},getRuleHandler:function(){return i},getDataHandler:function(){return n},getProtocolHandler:function(){return o}};t.exports=r,cc._RF.pop()},{"TuiDaoHu-Data":"TuiDaoHu-Data","TuiDaoHu-Protocol":"TuiDaoHu-Protocol","TuiDaoHu-Rules":"TuiDaoHu-Rules"}],UIClub:[function(e,t,a){"use strict";cc._RF.push(t,"33159FAs7ZM04ogH5++Ys0S","UIClub");var n=e("configMgr"),c=e("SoundMngr");cc.Class({extends:cc.Component,properties:{inviteNode:cc.Node,applyNode:cc.Node,clubBtnNode:cc.Node,clubHead:cc.Prefab,clubHeadNode:cc.Node},onLoad:function(){this.initUIRule(),this.registerListener(),this.operaUIActive(1),this.refreshUIMyClub()},registerListener:function(){registEvent("refreshUIClubData",this,this.refreshUIMyClub),registEvent("refreshUIClubInvite",this,this.refreshUIApplyClub),registEvent("refreshUIClubApply",this,this.refreshUIApplyClub)},uiUpDate:function(){},initUIRule:function(){var e=n.getAgentWeChat();e&&(cc.find("applyClubPanel/BaseFrame1/LabelWeiXin",this.node).getComponent("cc.Label").string=e.agentConsult.number)},operaUIActive:function(e){var t=cc.find("applyClubPanel",this.node),a=cc.find("myClubPanel",this.node),n=cc.find("btnTitleBg/myClubBtn",this.node),i=cc.find("btnTitleBg/applyClubBtn",this.node),o=cc.find("btnTitleBg/myClubImg",this.node),r=cc.find("btnTitleBg/applyClubImg",this.node);switch(e){case 1:n.active=!0,r.active=!1,a.active=!0,i.active=!1,o.active=!1,t.active=!1;break;case 2:n.active=!1,r.active=!1,a.active=!1,i.active=!0,o.active=!0,t.active=!0}},onUIMyClub:function(){this.operaUIActive(1),this.refreshUIMyClub()},onUIApplyClub:function(){this.operaUIActive(2),this.refreshUIApplyClub()},refreshUIMyClub:function(){if(GameData.player.club){var e=Object.keys(GameData.player.club).length,t=cc.find("myClubPanel/noneData",this.node),a=cc.find("myClubPanel/club_img",this.node),n=cc.find("myClubPanel/BaseFrame",this.node),i=cc.find("myClubPanel/clubBtnScrollView",this.node);if(t.active=!1,a.active=!1,n.active=!1,i.active=!1,e<=0)t.active=!0;else{a.active=!0,n.active=!0,i.active=!0;var o=GameData.player.club,r=this.clubBtnNode.getChildByName("bigNode"),s=this.clubBtnNode.getChildByName("smallNode");r.active=!1,s.active=!0,s.getChildByName("clubName").getComponent("cc.Label").string=o.clubName,this.refreshMyClubInfo()}}},refreshMyClubBtn:function(e){c.instance.playAudioOther("button");var t=parseInt(e.target.tag);for(var a in this.clubBtnNode.parent.children){var n=this.clubBtnNode.parent.children[a];if(n){var i=n.getChildByName("bigNode"),o=n.getChildByName("smallNode"),r=i.getChildByName("clickSprite"),s=o.getChildByName("clickSprite");r.active=!1,s.active=!1}}e.target.parent.getChildByName("clickSprite").active=!0,this.refreshMyClubInfo(t)},refreshMyClubInfo:function(){var e=GameData.player.club;if(null!=e){var t=cc.find("myClubPanel",this.node),a=(cc.find("myClubPanel/BaseFrame",this.node),cc.find("myClubPanel/BaseFrame/club_name",this.node)),n=cc.find("myClubPanel/BaseFrame/club_main_name",this.node),i=cc.find("myClubPanel/BaseFrame/club_ID",this.node),o=cc.find("myClubPanel/BaseFrame/club_number",this.node),r=cc.find("myClubPanel/BaseFrame/club_notice",this.node);a.getComponent("cc.Label").string=e.clubName,n.getComponent("cc.Label").string="代理:"+e.clubID,i.getComponent("cc.Label").string="ID:"+e.clubID,o.getComponent("cc.Label").string="人数:"+e.clubNumber,r.getComponent("cc.Label").string=e.clubNotify,null!=e.clubNotify&&"null"!=e.clubNotify||(r.getComponent("cc.Label").string="此代理很懒，没有留下任何信息。"),null==this.clubHeadNode&&(this.clubHeadNode=cc.instantiate(this.clubHead),t.addChild(this.clubHeadNode),this.clubHeadNode.setScale(1.5),this.clubHeadNode.setPosition(cc.p(480,430))),this.clubHeadNode.getComponent("playerTemplate").setName(""),this.clubHeadNode.getComponent("playerTemplate").showZhuang(!1),this.clubHeadNode.getComponent("playerTemplate").enableHeadBtn(!1)}else cc.log("data is null !! clubId = "+clubId)},refreshUIApplyClub:function(){var e=cc.find("applyClubPanel/BaseFrame2/noneData",this.node),t=cc.find("applyClubPanel/BaseFrame2/inviteScrollView",this.node);e.active=!1,t.active=!1;var a=Object.keys(GameData.player.clubInvite).length;for(var n in cc.log("inviteNumber:"+a),a<=0?e.active=!0:t.active=!0,this.inviteNode.parent.children){var i=this.inviteNode.parent.children[n];i&&(i.active=!1)}this.inviteNode.getParent().height=(this.inviteNode.height+10)*a;var o=1e3;for(var r in GameData.player.clubInvite){if(null!=(f=GameData.player.clubInvite[r])){null==(y=this.inviteNode.parent.getChildByTag(o))&&(y=this.inviteNode,0<o-1e3&&(y=cc.instantiate(this.inviteNode),this.inviteNode.parent.addChild(y),y.setPosition(cc.p(this.inviteNode.x,this.inviteNode.y-(this.inviteNode.height+10)*(o-1e3))))),y.setTag(o),y.active=!0;var s=y.getChildByName("clubName"),c=y.getChildByName("noBtn"),d=y.getChildByName("yseBtn");c.setTag(f.club_id),d.setTag(f.club_id),s.getComponent("cc.Label").string=f.clubName,c.on(cc.Node.EventType.TOUCH_END,this.noJoinClubClick,this),d.on(cc.Node.EventType.TOUCH_END,this.yesJoinClubClick,this),o++}}var h=cc.find("applyClubPanel/BaseFrame3/noneData",this.node),l=cc.find("applyClubPanel/BaseFrame3/applyScrollView",this.node);h.active=!1,l.active=!1;var u=Object.keys(GameData.player.clubApply).length;for(var m in cc.log("applyNumber:"+u),u<=0?h.active=!0:l.active=!0,this.applyNode.parent.children){var p=this.applyNode.parent.children[m];p&&(p.active=!1)}this.applyNode.getParent().height=(this.applyNode.height+10)*u;var g=2e3;for(var r in GameData.player.clubApply){var f,y;if(null!=(f=GameData.player.clubApply[r]))null==(y=this.applyNode.parent.getChildByTag(g))&&(y=this.applyNode,0<g-2e3&&(y=cc.instantiate(this.applyNode),this.applyNode.parent.addChild(y),y.setPosition(cc.p(this.applyNode.x,this.applyNode.y-(this.applyNode.height+10)*(g-2e3))))),y.setTag(g),y.active=!0,(s=y.getChildByName("clubName")).getComponent("cc.Label").string=f.clubName,g++}},noJoinClubClick:function(e){c.instance.playAudioOther("button");var t=e.target.tag;cc.log("noJoin"+t),ClubHandler.getInstance().doInvite(t,!1)},yesJoinClubClick:function(e){c.instance.playAudioOther("button");var t=e.target.tag;cc.log("yesJoin"+t),ClubHandler.getInstance().doInvite(t,!0)},sendApply:function(){c.instance.playAudioOther("button");var e=cc.find("applyClubPanel/BaseFrame4/applyEditBox",this.node).getComponent(cc.EditBox).string;cc.log("sendApply"+e),ClubHandler.getInstance().reqJoinClub(e)},sendQuitClub:function(e){c.instance.playAudioOther("button");var t=e.target.tag;cc.log("sendQuitClub"+t),ClubHandler.getInstance().reqQuitClub(GameData.player.uid,t),this.clubHeadNode.active=!1},onClose:function(){c.instance.playAudioOther("button"),closeView("PanelClub")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr"}],UICoinRankingList:[function(e,t,a){"use strict";cc._RF.push(t,"1af99mhvjVMqpqHD7rqcOmk","UICoinRankingList");var n=e("SoundMngr"),i=(e("gameDefine"),e("configMgr"),e("topHandler"));cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,item:cc.Node,selfRank:cc.Node},onLoad:function(){registEvent("updateCoinTopList",this,this.onUpdateCoinTopListHandler)},onDestroy:function(){unregistEvent("updateCoinTopList",this,this.onUpdateCoinTopListHandler)},onEnable:function(){this.hideScrollViewChildren(),openView("Loading"),i.getCoinTopList()},onUpdateCoinTopListHandler:function(e){null!=e&&(closeView("Loading"),this.updateUI(e.detail))},hideScrollViewChildren:function(){for(var e=this.scrollView.content,t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}},updateUI:function(e){if(this.hideScrollViewChildren(),null!=e){var t=e.length,a=t*this.item.height;a<450&&(a=450);var n=this.scrollView.content;n.height=a;for(var i=void 0,o=0,r=0;r<t;r++){var s=e[r];if(null!=s){var c=n.getChildren()[o];null==c&&((c=cc.instantiate(this.item)).parent=n),c.active=!0,c.x=this.item.x,c.y=this.item.y-this.item.height*o,this.updateScrollViewItem(o,s,c),s.uid==GameData.player.uid&&(i=o),o++,this.updateSelfRank(i)}}}},updateScrollViewItem:function(e,t,a){if(null!=e&&null!=t&&null!=a){var n=cc.find("rankImg",a),i=cc.find("rankLabel",a),o=cc.find("icon",a),r=cc.find("name",a),s=cc.find("golds/golds_num",a);e<3?(n.active=!0,i.active=!1,this.loadUIImg(n,this.getRankingImg(e))):(n.active=!1,i.active=!0,i.getComponent(cc.Label).string=e+1),this.LoadHeadIcon(o,t.headimgurl),r.getComponent(cc.Label).string=t.name,s.getComponent(cc.Label).string=t.coin}},updateSelfRank:function(e){this.selfRank.getComponent(cc.Label).string=null==e?"未上榜":e},loadUIImg:function(e,t){if(!(null==e||null==t||t.length<=0)){var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a))}},LoadHeadIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},getRankingImg:function(e){var t;switch(e){case 0:t="resources/rankingList/coin/rank_1.png";break;case 1:t="resources/rankingList/coin/rank_2.png";break;case 2:t="resources/rankingList/coin/rank_3.png"}return t},onClose:function(){n.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",topHandler:"topHandler"}],UICompetition:[function(e,t,a){"use strict";cc._RF.push(t,"de84beAwvNF3pTH7R6Xr1GL","UICompetition");e("gameDefine");var n=e("configMgr");e("competitionHandler");cc.Class({extends:cc.Component,properties:{posterNode:cc.Node,posterPrefab:cc.Prefab,scrollView:cc.ScrollView,scrollViewItem:cc.Node,content:cc.Node},onLoad:function(){this.initPosterNode(),this.initGameTypeNode(),this.refreshTimeCD=0},onEnable:function(){this.scrollView.scrollToTopLeft(.1)},update:function(e){this.refreshTimeCD+=e,10<=this.refreshTimeCD&&(this.refreshTimeCD=0)},initPosterNode:function(){var e=this.posterNode.getChildByName("posterPrefab");null==e&&((e=cc.instantiate(this.posterPrefab)).getComponent("PosterPrefab").initUI(),e.name="posterPrefab",e.parent=this.posterNode,e.scale=.7)},initGameTypeNode:function(){for(var e=this.getOpenGameList(),t=0;t<e.length;t++){var a=cc.find("item"+t,this.content);null==a&&((a=cc.instantiate(this.scrollViewItem)).parent=this.content,a.x=this.scrollViewItem.x+(this.scrollViewItem.width-20)*t),a.getComponent("selectGameItem").initUI(e[t],t+1);var n=cc.find("gameDetailBtn",a);n.tag=t,n.on(cc.Node.EventType.TOUCH_END,this.gameDetailClick,this)}this.content.width=(e.length+.2)*this.scrollViewItem.width},getOpenGameList:function(){var e=n.getFightGameType();return null==e?[]:(cc.log("..gameList:"+JSON.stringify(e)),e)},gameDetailClick:function(e){var t=e.target.tag+1;cc.log("点击--\x3e"+t),openView("CompetitionDetail",null,function(e){e.getComponent("CompetitionDetail").initUI(t)})},showRecordLayer:function(){openView("CompetitionRecord")}}),cc._RF.pop()},{competitionHandler:"competitionHandler",configMgr:"configMgr",gameDefine:"gameDefine"}],UIGroup:[function(e,t,a){"use strict";cc._RF.push(t,"664f1LG5TpGCIucBF1ivLfV","UIGroup");var n=e("SoundMngr"),i=e("roomHandler");e("matchHandler"),e("gameDefine"),e("configMgr");cc.Class({extends:cc.Component,properties:{create_btn:cc.Button,join_btn:cc.Button,back_btn:cc.Button},onLoad:function(){this.refreshCreateOrBackBtn(),registEvent("onRoomClose",this,this.refreshCreateOrBackBtn)},onEnable:function(){},onDestroy:function(){unregistEvent("onRoomClose",this,this.refreshCreateOrBackBtn)},refreshCreateOrBackBtn:function(){GameData.roomClose&&(GameData.player.roomid=void 0),null==GameData.player.roomid||0==GameData.player.roomid?(this.create_btn.node.active=!0,this.back_btn.node.active=!1):(this.create_btn.node.active=!1,this.back_btn.node.active=!0)},loadSpriteImg:function(e,t){if(!(null==e||null==t||t.length<=0)){var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.spriteFrame=new cc.SpriteFrame(a))}},createBtnClicked:function(e){inCD(1e3)||(n.instance.playAudioOther("button"),openView("UICreate"))},backBtnClicked:function(e){n.instance.playAudioOther("button"),i.enterRoom(GameData.player.roomid),this.refreshCreateOrBackBtn()},joinBtnClicked:function(e){inCD(1e3)||(n.instance.playAudioOther("button"),null==GameData.player.roomid||GameData.player.roomid<=0?openView("UIJoin"):createMessageBox("您已在房间中,不能加入别的房间,是否返回房间?",function(){i.enterRoom(GameData.player.roomid)},function(){}))}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",matchHandler:"matchHandler",roomHandler:"roomHandler"}],UIMatch:[function(e,t,a){"use strict";cc._RF.push(t,"010a6lJ7dNKXbV1zYCG55nj","UIMatch");e("gameDefine");var o=e("matchHandler"),n=(e("configMgr"),e("SoundMngr"));cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label},onLoad:function(){this.limit_time=0},initUITime:function(){var e=++o.matchTime,t=parseInt(e/3600),a=parseInt(e%3600/60),n=e%3600%60;t<10&&(t="0"+t),a<10&&(a="0"+a),n<10&&(n="0"+n);var i=t+": "+a+": "+n;this.timeLabel.string=i},update:function(e){},onCancelClick:function(){if(!inCD(500)){var e=this;n.instance.playAudioOther("button"),o.cancel(function(){e.initUITime(),closeView(e.node.name)})}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",matchHandler:"matchHandler"}],UIPushGame:[function(e,t,a){"use strict";cc._RF.push(t,"84a2fDHve9BdKV2K2Xhb74J","UIPushGame");var i=e("SoundMngr"),u=(e("roomHandler"),e("matchHandler"),e("gameDefine")),o=(e("configMgr"),e("errorCode"));cc.Class({extends:cc.Component,properties:{pushToggle:cc.Toggle,withDrawToggle:cc.Toggle,pushPanel:cc.Node,withDrawPanel:cc.Node,logPanel:cc.Node,moneyPanel:cc.Node,QRPanel:cc.Node,QRNode:cc.Node,QRCutNode:cc.Node,LinkNode:cc.Node,sliderNode:cc.Slider,progressBar:cc.ProgressBar,withdrawMoney:cc.EditBox,scrollView:cc.ScrollView,scrollItem:cc.Node,nameEditBox:cc.EditBox,cardEditBox:cc.EditBox},onLoad:function(){registEvent("onPlayerUpdate",this,this.refreshUIWithDrawPanel),this.logList=void 0,this.refreshUIPushPanel(),this.refreshUIWithDrawPanel(),this.refreshUILogPanel(),this.refreshUIMoneyPanel()},onEnable:function(){this.initUIShow()},onDestroy:function(){unregistEvent("onPlayerUpdate",this,this.refreshUIWithDrawPanel)},initUIShow:function(){this.pushToggle.isChecked=!0,this.withDrawToggle.isChecked=!1,this.pushPanel.active=!0,this.withDrawPanel.active=!1,this.logPanel.active=!1,this.moneyPanel.active=!1},refreshUIPushPanel:function(){if(null!=GameData.player.qrcodeUrl){this.LinkNode.getComponent(cc.Label).string=getShortStr(GameData.player.qrcodeUrl,16);var e=new QRCode(-1,QRErrorCorrectLevel.H);e.addData(GameData.player.qrcodeUrl),e.make();var t=this.QRNode.getComponent(cc.Graphics);t.fillColor=cc.Color.BLACK;for(var a=this.QRNode.width/e.getModuleCount(),n=this.QRNode.height/e.getModuleCount(),i=0;i<e.getModuleCount();i++)for(var o=0;o<e.getModuleCount();o++)if(e.isDark(i,o)){t.fillColor=cc.Color.BLACK;var r=Math.ceil((o+1)*a)-Math.floor(o*a),s=Math.ceil((i+1)*a)-Math.floor(i*a);t.rect(Math.round(o*a),Math.round(i*n),r,s),t.fill()}else t.fillColor=cc.Color.WHITE;this.QRNode.rotation=90;var c=new QRCode(-1,QRErrorCorrectLevel.H);c.addData(GameData.player.qrcodeUrl),c.make();var d=this.QRCutNode.getComponent(cc.Graphics);d.fillColor=cc.Color.BLACK;for(var h=this.QRNode.width/e.getModuleCount(),l=this.QRNode.height/e.getModuleCount(),u=0;u<e.getModuleCount();u++)for(var m=0;m<e.getModuleCount();m++)if(e.isDark(u,m)){d.fillColor=cc.Color.BLACK;var p=Math.ceil((m+1)*h)-Math.floor(m*h),g=Math.ceil((u+1)*h)-Math.floor(u*h);d.rect(Math.round(m*h),Math.round(u*l),p,g),d.fill()}else d.fillColor=cc.Color.WHITE;this.QRCutNode.rotation=90}else cc.log("QRCode is undefined")},refreshUIWithDrawPanel:function(){var e=cc.find("money",this.withDrawPanel),t=cc.find("havePushNumber",this.withDrawPanel);e.getComponent(cc.Label).string=GameData.player.income||0,t.getComponent(cc.Label).string=GameData.player.lower||0,this.sliderHandlerClick()},refreshUILogPanel:function(){for(var e=this.logList,t=this.scrollView.content,a=0;a<t.getChildrenCount();a++){var n=t.getChildren()[a];n&&(n.active=!1)}if(null!=e){var i=e.length*this.scrollItem.height;i<265&&(i=265),t.height=i;var o=0;for(var r in e){var s=e[r];if(null==s)return;var c=t.getChildren()[o];null==c&&((c=cc.instantiate(this.scrollItem)).parent=t),c.active=!0,c.x=this.scrollItem.x,c.y=this.scrollItem.y-this.scrollItem.height*o;var d=cc.find("time",c),h=cc.find("money",c),l=cc.find("state",c);switch(d.getComponent(cc.Label).string=s.time,h.getComponent(cc.Label).string=s.money.toFixed(1),s.state){case u.withdrawState.wait:l.getComponent(cc.Label).string="待审核",l.color=cc.color(65,92,94);break;case u.withdrawState.succeed:l.getComponent(cc.Label).string="已完成",l.color=cc.color(65,92,94);break;case u.withdrawState.fail:l.getComponent(cc.Label).string="驳回",l.color=cc.color(255,0,0)}o++}}},refreshUIMoneyPanel:function(){cc.find("money",this.moneyPanel).getComponent(cc.Label).string="提现金额："+this.withdrawMoney.string;var e=JSON.parse(cc.sys.localStorage.getItem("withdrawLog"));cc.log("..withdrawLogData:"+JSON.stringify(e)),e&&(this.nameEditBox.string=e.name,this.cardEditBox.string=e.card)},loadSpriteImg:function(e,t){if(!(null==e||null==t||t.length<=0)){var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.spriteFrame=new cc.SpriteFrame(a))}},sliderHandlerClick:function(){this.progressBar.progress=this.sliderNode.progress;var e=GameData.player.income||0;if(e<100)this.withdrawMoney.string=0;else{var t=parseInt(this.sliderNode.progress*e);t<100&&(t=100),this.withdrawMoney.string=t}},QRShareBtnClick:function(){cc.log("..QRShareBtnClick"),0==inCD(1e3)&&(i.instance.playAudioOther("button"),screenPartShoot(this.QRPanel,wxShareTexture))},linkShareBtnClick:function(){cc.log("..linkShareBtnClick"),0==inCD(3e3)&&(i.instance.playAudioOther("button"),wxShareWeb("推广",GameData.player.qrcodeUrl))},submitAppBtnClick:function(){cc.log("..submitAppBtnClick"),i.instance.playAudioOther("button");var a=this.nameEditBox.string,n=this.cardEditBox.string,e=parseInt(this.withdrawMoney.string);if(null==a||a.length<=0||null==n||n.length<=0||e<=0)createMessageBox("请正确输入信息。",function(){});else{var t={name:a,card:n,money:e};cc.log("..data:"+JSON.stringify(t)),GameNet.getInstance().request("game.playerHandler.reqDrawApply",t,function(e){if(e.result==o.Success){if(createMessageBox("已提交。",function(){}),null==a||null==n)return;var t={};t.name=a,t.card=n,cc.sys.localStorage.setItem("withdrawLog",JSON.stringify(t))}else createMessageBox("提交失败！",function(){})}),this.moneyPanel.active=!1}},showUIPanel:function(e,t){if(i.instance.playAudioOther("button"),null!=t)switch(parseInt(t)){case 1:this.pushPanel.active=!0,this.withDrawPanel.active=!1;break;case 2:this.pushPanel.active=!1,this.withDrawPanel.active=!0}},showUILog:function(){this.logPanel.active=!0;var t=this;GameNet.getInstance().request("game.playerHandler.reqDrawList",null,function(e){cc.log("..rtn:"+JSON.stringify(e)),t.logList=e,t.refreshUILogPanel()})},showUIMoney:function(){var e=GameData.player.income||0,t=parseInt(this.withdrawMoney.string);e<t?createMessageBox("提现金额超出推广金！",function(){}):t<100?createMessageBox("提现金额不能小于100！",function(){}):(this.moneyPanel.active=!0,this.refreshUIMoneyPanel())},closeUILog:function(){i.instance.playAudioOther("button"),this.logPanel.active=!1},closeUIMoney:function(){i.instance.playAudioOther("button"),this.moneyPanel.active=!1},closeUIPushGame:function(){i.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",matchHandler:"matchHandler",roomHandler:"roomHandler"}],UISelectGameLv:[function(e,t,a){"use strict";cc._RF.push(t,"fe572jyFr1GjKUHgGRINF/g","UISelectGameLv");var p=e("gameDefine"),g=e("matchHandler"),f=e("configMgr"),n=e("errorCode"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{selfGolds:cc.Label,lvBtnPanel:cc.Node,typeTitle:cc.Node},onLoad:function(){registEvent("onPlayerUpdate",this,this.initUI)},onDestroy:function(){unregistEvent("onPlayerUpdate",this,this.initUI)},onEnable:function(){this.initUI()},initUI:function(){this.selfGolds.string=ConversionCoinValue(GameData.player.coin,0),this.selectLv=-1;var e=f.getServerConfig();if(null!=e){var t=e.matchCoin;if(null!=t)if(null!=g){var a=t[g.selectGameType];if(null!=a){var n=this.getGameTypeTitleImgUrl(g.selectGameType);if(n&&0<n.length){var i=cc.textureCache.addImage(cc.url.raw(n));i&&(this.typeTitle.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i))}for(var o=0;o<3;o++){var r="item"+(o+1),s=cc.find(r,this.lvBtnPanel),c=a.cost[o];g.selectGameType==p.GameType.Game_Niu_Hundred&&(c=a.zhuang[o]);var d=getMatchCoinEnterLimit(g.selectGameType,o)||0,h=cc.find("number",s),l=cc.find("score",s),u=cc.find("golds/golds_num",s);this.initScoreSp(s,g.selectGameType);var m=o+1;this.initBtnNodeSp(s,m,g.selectGameType),h.getComponent(cc.Label).string=o+"人",l.getComponent(cc.Label).string=ConversionCoinValue(c,0),u.getComponent(cc.Label).string="≥"+d,GameData.player.coin>=d?u.color=new cc.Color(253,243,0):u.color=new cc.Color(255,0,0),s.tag=o}}else cc.log("..serverConfig is undefined.")}else cc.log("..matchHandler is undefined.");else cc.log("..serverConfig is undefined.")}else cc.log("..serverConfig is undefined.")},initScoreSp:function(e,t){var a=cc.find("scoreBg",e),n="resources/home/selectLv/difenkuang.png";n=t==p.GameType.Game_Niu_Hundred?"resources/home/selectLv/difenkuang_beishu.png":"resources/home/selectLv/difenkuang.png";var i=cc.textureCache.addImage(cc.url.raw(n));i&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i))},initBtnNodeSp:function(e,t,a){var n="resources/home/selectLv/chujichang.png";switch(t){case 1:n=a==p.GameType.Game_Niu_Hundred?"resources/home/selectLv/chujichang_beishu.png":"resources/home/selectLv/chujichang.png";break;case 2:n=a==p.GameType.Game_Niu_Hundred?"resources/home/selectLv/zhongjichang_beishu.png":"resources/home/selectLv/zhongjichang.png";break;case 3:n=a==p.GameType.Game_Niu_Hundred?"resources/home/selectLv/gaojichang_beishu.png":"resources/home/selectLv/gaojichang.png";break;default:n=""}if(n&&0<n.length){var i=cc.textureCache.addImage(cc.url.raw(n));i&&(e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i))}},refreshBtnSelect:function(){for(var e=0;e<3;e++){var t="item"+(e+1),a=cc.find(t,this.lvBtnPanel);e==this.selectLv?a.scale=1.1:a.scale=1}},getGameTypeTitleImgUrl:function(e){var t="resources/home/match/jb_bt_doudizhu.png";switch(e){case p.GameType.Game_Mj_Tianjin:case p.GameType.Game_Mj_Shishi:case p.GameType.Game_Mj_AS:case p.GameType.Game_Mj_HZ:case p.GameType.Game_Mj_Heb:case p.GameType.Game_Mj_CC:case p.GameType.Game_MJ_HuaDian:t="";break;case p.GameType.Game_Poker_DDZ:case p.GameType.Game_Poker_TianjinDDZ:t="resources/home/match/jb_bt_doudizhu.png";break;case p.GameType.Game_Poker_13shui:t="";break;case p.GameType.Game_niu_niu:case p.GameType.Game_Niu_Niu_10:t="resources/home/match/jb_bt_pinshi.png";break;case p.GameType.Game_Niu_Hundred:t="resources/home/match/jb_bt_bairenpinshi.png";break;case p.GameType.Game_TDK:case p.GameType.Game_Poker_paodekuai:t="";break;case p.GameType.Game_Poker_ZJH:t="resources/home/match/jb_bt_sanzhangpai.png";break;case p.GameType.Game_Poker_HHDZ:t="resources/home/match/jb_bt_hhdz.png"}return t},onAddGoldClick:function(){i.instance.playAudioOther("button");var e=cc.director.getScene().getChildByName("Canvas").getChildByName("shoppingPanel");null!=e&&e.setLocalZOrder(this.node.getLocalZOrder()+1),openView("shoppingPanel",void 0,function(e){if(e){var t=e.getComponent("shoppingPanel");t&&t.showPanel(2)}})},onSelectLvClick:function(e){i.instance.playAudioOther("button");var t=e.target.tag;t<0||2<t||(this.selectLv=t,cc.log("..selectLv:"+t),this.onBeginMatchClick())},onBeginMatchClick:function(){inCD(500)||(null!=this.selectLv?checkOpenUISuccour(g.selectGameType,this.selectLv)||((getMatchCoinEnterLimit(g.selectGameType,this.selectLv)||0)>GameData.player.coin?createMoveMessage("",n.LessCoin):(openView("Loading"),g.selectGameLv=this.selectLv,g.signup())):cc.log("cur select lv is undefined."))},onBackClick:function(){i.instance.playAudioOther("button"),closeView(this.node.name)},update:function(e){}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",matchHandler:"matchHandler"}],UISelectGame:[function(e,t,a){"use strict";cc._RF.push(t,"98285StyW9CNavb6rsW6dSd","UISelectGame");var i=e("gameDefine"),n=e("matchHandler"),o=e("configMgr"),r=e("SoundMngr");cc.Class({extends:cc.Component,properties:{pageView:cc.PageView,content:cc.Node,pageItem:cc.Node,btnItem:cc.Node,flag:cc.Node,flagItem:cc.Node,detail:cc.Node,leftBtnNode:cc.Node,rightBtnNode:cc.Node,scrollView:cc.ScrollView,scrollItem:cc.Node},onLoad:function(){this.initScrollContent()},onEnable:function(){this.scrollView.scrollToTopLeft(.1)},initUIDetail:function(){this.detail.getComponent(cc.Label).string="参与匹配获取积分"},initPageContent:function(){this.pageView.removeAllPages(),this.content.removeAllChildren();var e=this.getOpenGameList();this.content.width=e.length*this.pageItem.width;var t=parseInt(e.length/4);0<e.length%4&&t++;for(var a=0;a<t;a++){var n=cc.instantiate(this.pageItem);this.pageView.addPage(n),n.active=!0,n.position=cc.p(this.pageItem.x+a*this.pageItem.width,this.pageItem.y),this.initPageItem(n,e,a)}this.initPageFlag()},initPageItem:function(e,t,a){if(null!=e){for(var n=0;n<e.getChildrenCount();n++){var i=e.getChildren()[n];i&&(i.active=!1)}var o=4*a,r=4*a+4,s=t.length-r;s<0&&(r+=s);var c,d=0,h=r-o;d=0<h%2?0-(parseInt(h/2)*this.btnItem.width+0*parseInt(h/2)+this.btnItem.width/2):0-(parseInt(h/2)*this.btnItem.width+0*(parseInt(h/2)-1)+0),d+=this.btnItem.width/2;for(var l=0;o<r;o++){var u=t[o];if(null!=u){c="item"+l;var m=e.getChildByName(c);null==m&&((m=cc.instantiate(this.btnItem)).parent=e,m.name=c),m.active=!0,m.x=d+l*(this.btnItem.width+0),m.y=this.btnItem.y,cc.find("label",m).getComponent(cc.Label).string=getGameTypeNameString(u),cc.find("limit",m).getComponent(cc.Label).string="进入条件："+this.getGameLimitByType(u);var p=m.getComponent(cc.Sprite);this.loadItemSprite(p,u),m.tag=u,m.on(cc.Node.EventType.TOUCH_END,this.onSelectGameClick,this),l++}}}},loadItemSprite:function(e,t){var a=void 0;switch(t){case"addBtn":a="resources/home/match/btn-home-add.png";break;case i.GameType.Game_Mj_Tianjin:a="resources/home/match/btn-home-tjmj.png";break;case i.GameType.Game_Mj_Shishi:a="resources/home/match/btn-home-ssmj.png";break;case i.GameType.Game_MJ_HuaDian:a="resources/home/match/btn-home-hdmj.png";break;case i.GameType.Game_Mj_HZ:a="resources/home/match/btn-home-hzmj.png";break;case i.GameType.Game_Mj_CC:a="resources/home/match/btn-home-ccmj.png";break;case i.GameType.Game_Mj_Heb:a="resources/home/match/btn-home-hebmj.png";break;case i.GameType.Game_Poker_TianjinDDZ:case i.GameType.Game_Poker_DDZ:a="resources/home/match/doudizhu01.png";break;case i.GameType.Game_niu_niu:a="resources/home/match/niuniu01.png";break;case i.GameType.Game_Niu_Hundred:a="resources/home/match/home_btn_2.png";break;case i.GameType.Game_TDK:a="resources/home/match/tiandaken01.png";break;case i.GameType.Game_Poker_13shui:a="resources/home/match/shisanshui01.png";break;case i.GameType.Game_Poker_paodekuai:a="resources/home/match/paodekuaianniu01.png";break;case i.GameType.Game_Poker_ZJH:a="resources/home/match/btn-home-szp.png";break;case i.GameType.Game_Poker_HHDZ:a="resources/home/match/btn-home-hhdz.png"}if(null!=a&&null!=e){var n=cc.textureCache.addImage(cc.url.raw(a));e.spriteFrame=new cc.SpriteFrame(n)}},initPageFlag:function(){this.flag.removeAllChildren();var e=this.pageView.getPages().length,t=0;t=0<e%2?-(parseInt(e/2)*this.flagItem.width+30*parseInt(e/2)+this.flagItem.width/2):-(parseInt(e/2)*this.flagItem.width+30*(parseInt(e/2)-1)+15);for(var a=0;a<e;a++){var n;(n=0==a?this.flagItem:cc.instantiate(this.flagItem)).name="flag_"+a,this.flag.addChild(n),n.position=cc.p(t+a*(this.flagItem.width+30),this.flagItem.y)}this.updatePageFlag()},updatePageFlag:function(){for(var e=0;e<this.flag.getChildrenCount();e++){this.flag.getChildren()[e].getChildByName("click").active=!1}var t="flag_"+this.pageView.getCurrentPageIndex();this.flag.getChildByName(t).getChildByName("click").active=!0},pageViewEvent:function(){this.updatePageFlag()},initScrollContent:function(){var e=this.scrollView.content,t=this.getOpenGameList(),a=(t.length+1)*(this.scrollItem.width-25);a<1280&&(a=1280),e.width=a;for(var n=0,i=!1,o=0;o<t.length+1;o++){var r;if(o==t.length)i=!0;else{if(null==(r=t[n]))continue;i=!1,n++}var s="item"+o,c=e.getChildByName(s);if(c||((c=cc.instantiate(this.scrollItem)).parent=e,c.name=s,c.y=this.scrollItem.y,c.x=this.scrollItem.x+o*(this.scrollItem.width-30)),c.active=!0,i)this.initAddBtnItem(c);else{cc.find("label",c).getComponent(cc.Label).string=getGameTypeNameString(r),cc.find("limit",c).getComponent(cc.Label).string="进入条件："+this.getGameLimitByType(r);var d=c.getComponent(cc.Sprite);this.loadItemSprite(d,r),c.tag=r,c.on(cc.Node.EventType.TOUCH_END,this.onSelectGameClick,this)}}t.length<=3&&(this.leftBtnNode.active=!1,this.rightBtnNode.active=!1,this.scrollView.enabled=!1)},initAddBtnItem:function(e){if(null!=e){e.active=!0;var t=cc.find("label",e),a=cc.find("dikuang",e);t.active=!1,a.active=!1;var n=e.getComponent(cc.Sprite);this.loadItemSprite(n,"addBtn"),e.on(cc.Node.EventType.TOUCH_END,this.onAddGameClick,this)}},getOpenGameList:function(){var e=o.getMatchGameType();return null==e?[]:(cc.log("..gameList:"+JSON.stringify(e)),e)},getGameLimitByType:function(e){var t="",a=o.getServerConfig();if(null==a||null==a.matchCoin)return t;var n=a.matchCoin[e];return null==n||null==n.enter?t:t=n.enter[0]},onSelectGameClick:function(e){if(!inCD(1e3)){r.instance.playAudioOther("button");var t=e.target.tag;cc.log("..gameType:"+t),n.selectGameType=t;var a=getMatchSumLv(t);if(null!=a)if(1==a){if(n.selectGameLv=0,checkOpenUISuccour(n.selectGameType,n.selectGameLv))return;if((getMatchCoinEnterLimit(n.selectGameType,n.selectGameLv)||0)>GameData.player.coin)return void createMoveMessage("",errorCode.LessCoin);openView("Loading"),n.signup()}else openView("SelectGameLvPanel")}},onAddGameClick:function(){cc.log("..onAddGameClick"),r.instance.playAudioOther("button")},onLeftBtnClick:function(){cc.log("..onLeftBtnClick"),r.instance.playAudioOther("button")},onRightBtnClick:function(){cc.log("..onRightBtnClick"),r.instance.playAudioOther("button")},onClose:function(){r.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",matchHandler:"matchHandler"}],UISuccour:[function(e,t,a){"use strict";cc._RF.push(t,"d9bbbVOkDdFJraxBkVNLgw9","UISuccour");var n=e("SoundMngr");e("roomHandler"),e("matchHandler"),e("gameDefine"),e("configMgr"),e("errorCode");cc.Class({extends:cc.Component,properties:{getPanel:cc.Node,goToPanel:cc.Node,timeNode:cc.Node,getBtnNode:cc.Node},onLoad:function(){},onDestroy:function(){},onEnable:function(){this.initUIPanel()},showUIPanel:function(e){this.getPanel.active=e,this.goToPanel.active=!e},initUIPanel:function(){cc.log("..benefitCount:"+GameData.player.benefitCount),null==GameData.player.benefitCount&&(GameData.player.benefitCount=2),this.timeNode.getComponent(cc.Label).string="每天可领取"+(2-GameData.player.benefitCount)+"/2次"},getBtnClick:function(e){n.instance.playAudioOther("button"),GameNet.getInstance().request("game.playerHandler.getBenefitCoin",null,function(e){}),this.onClose(),createMoveMessage("领取成功。")},goToBtnClick:function(e){n.instance.playAudioOther("button");openView("shoppingPanel",void 0,function(e){if(e){var t=e.getComponent("shoppingPanel");t&&t.showPanel(2)}}),this.onClose()},onClose:function(e){n.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",matchHandler:"matchHandler",roomHandler:"roomHandler"}],UITask:[function(e,t,a){"use strict";cc._RF.push(t,"da931iloqpHp4F5Wx6iRakJ","UITask");var n=e("SoundMngr"),h=(e("roomHandler"),e("matchHandler"),e("gameDefine"),e("configMgr"),e("errorCode"),e("mission")),i=e("missionHandler");cc.Class({extends:cc.Component,properties:{getPanel:cc.Node,scrollView:cc.ScrollView,item:cc.Node},onLoad:function(){registEvent("playerMissionData",this,this.onPlayerMissionHandler),registEvent("taskGetReward",this,this.onTaskGetRewardHandler)},onDestroy:function(){unregistEvent("playerMissionData",this,this.onPlayerMissionHandler),unregistEvent("taskGetReward",this,this.onTaskGetRewardHandler)},onEnable:function(){this.initUIPanel()},onPlayerMissionHandler:function(){this.initUIPanel()},onTaskGetRewardHandler:function(e){null!=e&&null!=e.detail&&this.onShowGetPanel(e.detail)},onShowGetPanel:function(e){this.getPanel.active=!0,this.initUIGetReward(e)},initUIPanel:function(){for(var e=this.scrollView.content,t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}var n=GameData.player.mission;if(!(null==n||Object.keys(n).length<=0)){var i=Object.keys(n)*this.item.height;i<400&&(i=400),e.height=i;var o=0;for(var r in n){var s=n[r];if(null!=s&&0==s.isGet){var c=h.getMissionData(r);if(null!=c){var d=e.getChildren()[o];null==d&&((d=cc.instantiate(this.item)).parent=e),d.active=!0,d.x=this.item.x,d.y=this.item.y-this.item.height*o,o++,this.updateTaskItem(c,s,d)}}}}},updateTaskItem:function(e,t,a){if(null!=e&&null!=t&&null!=a){var n=cc.find("icon",a),i=cc.find("name",a),o=cc.find("reward",a),r=cc.find("count",a),s=cc.find("doIt",a),c=cc.find("toGet",a);i.getComponent(cc.Label).string=e.desc,r.getComponent(cc.Label).string=t.count+"/"+e.count,o.getComponent(cc.Label).string=h.getMissionRewardStr(e.reward);var d=!1;parseInt(t.count)>=parseInt(e.count)&&0==parseInt(t.isGet)&&(d=!0),s.active=!d,c.active=d,s.tag=e.id,c.tag=e.id,this.loadIconImg(n,e.icon)}},loadIconImg:function(e,t){if(null==e||null==t||t.length<=0)cc.log("..loadIconImg..return");else{var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a))}},initUIGetReward:function(e){if(null!=e){var t=h.getMissionData(e);if(null!=t){var a=h.getMissionRewardData(e);if(null!=a){var n=cc.find("icon",this.getPanel);cc.find("count",this.getPanel).getComponent("cc.Label").string=a.count,this.loadIconImg(n,t.icon)}}}},onToGetBtnClick:function(e){n.instance.playAudioOther("button");var t=e.target.tag;i.getReward(t)},onDoItBtnClick:function(e){n.instance.playAudioOther("button");var t=e.target.tag;switch(parseInt(t)){case 0:openView("SharePanel");break;default:return}},onCloseGetPanel:function(e){n.instance.playAudioOther("button"),this.getPanel.active=!1;var t=this;setTimeout(function(){i.checkAllComplete(GameData.player.mission)&&closeView(t.node.name)},1e3)},onClose:function(e){n.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",errorCode:"errorCode",gameDefine:"gameDefine",matchHandler:"matchHandler",mission:"mission",missionHandler:"missionHandler",roomHandler:"roomHandler"}],WebPanel:[function(e,t,a){"use strict";cc._RF.push(t,"ee050Br1mhNrIWqJx5C91Lq","WebPanel"),cc.Class({extends:cc.Component,properties:{webView:cc.WebView},onLoad:function(){WriteLog("onLoad")},onDestroy:function(){WriteLog("onDestroy")},onEnable:function(){WriteLog("onEnable")},onClose:function(){WriteLog("onClose"),this.node.active=!1},onOpen:function(e){e&&0<e.length&&(this.webView.url=e)}}),cc._RF.pop()},{}],"ZJH-RoomData":[function(e,t,a){"use strict";cc._RF.push(t,"a759dQxmYpMSZjQq/ZFAq1k","ZJH-RoomData");var i={createRoomOpts:{},playersArr:[],obPlayersArr:[],losersArr:[],GiveUpArr:[],isCompare:!1,startAnimFinish:!0,isRunAnimation:!1,pokers:{},playerPokerType:{},gameInfo:{},gameResultData:{},gameState:{Zhuang:1,BaseScore:2,Chips:3,Compare:4,Settle:5,End:6},CoinChipConfig:{0:[50,100,250,500,1e3],1:[300,600,1500,3e3,6e3],2:[1e3,2e3,5e3,1e4,2e4]},PokerCardType:{0:"sanpai",1:"duizi",2:"shunzi",3:"jinhua",4:"shunjin",5:"baozi",6:"235"},initData:function(){this.playersArr=[],this.obPlayersArr=[],this.GiveUpArr=[],this.losersArr=[],this.pokers={},this.gameInfo={}}};(t.exports=i).initCreateRoomOpts=function(){var e=cc.sys.localStorage.getItem("createRoomOpts_ZJH");null==e?(i.createRoomOpts={},i.createRoomOpts.twoThreeFiveBiger=1,i.createRoomOpts.compareSuit=0,i.createRoomOpts.chipsType=0,i.createRoomOpts.roundMax=10,i.createRoomOpts.roundRule=10,i.createRoomOpts.a23Type=0,i.createRoomOpts.canNotLookTurnNum=3,i.createRoomOpts.maxTunNum=5,i.createRoomOpts.costType=1,i.createRoomOpts.playerMax=6,i.createRoomOpts.playerMin=2):i.createRoomOpts=JSON.parse(e)},i.saveCreateRoomOpts=function(){null!=i.createRoomOpts&&null!=i.createRoomOpts&&cc.sys.localStorage.setItem("createRoomOpts_ZJH",JSON.stringify(i.createRoomOpts))},i.setPlayerArr=function(e){for(var t in i.playersArr=[],e)0<e[t].length&&i.playersArr.push(parseInt(t))},i.setLosersArr=function(e){for(var t in i.losersArr=[],e)e[t]&&i.losersArr.push(parseInt(t))},i.setGiveUpArr=function(e){for(var t in i.GiveUpArr=[],e)e[t]&&i.GiveUpArr.push(parseInt(t))},i.setPosition=function(){var e;GameData.tablePos={};var t=GameData.getPlayerIndex(GameData.player.uid);if(null!=GameData.room.opts){0==t?e=[0,1,2,3,4,5]:1==t?e=[5,0,1,2,3,4]:2==t?e=[4,5,0,1,2,3]:3==t?e=[3,4,5,0,1,2]:4==t?e=[2,3,4,5,0,1]:5==t&&(e=[1,2,3,4,5,0]);for(var a=0;a<GameData.joiners.length;a++)GameData.joiners[a]?GameData.tablePos[GameData.joiners[a].uid]=e[a]:null==GameData.joiners[a]&&(GameData.tablePos.null=e[a]);cc.log("table pos:"+JSON.stringify(GameData.tablePos))}},i.getHandPokerByUid=function(e){for(var t in i.pokers)if(t==e)return i.pokers[t];return null},i.getPlayerPokerByUid=function(e){for(var t in i.pokers)if(t==e)return i.pokers[t];return null},i.getPlayerPokerTypeByUid=function(e){if(0!=Object.keys(i.gameInfo).length){for(var t in i.playerPokerType)if(t==e){var a=i.playerPokerType[t];return i.PokerCardType[a]}return null}},i.getLivePlayers=function(){for(var e=[],t=0;t<i.playersArr.length;t++){var a=i.playersArr[t];-1==i.losersArr.indexOf(a)&&e.push(a)}return e},i.getWinPlayer=function(e){var t=-1!=i.playersArr.indexOf(e),a=-1==i.losersArr.indexOf(e),n=i.playersArr.length-i.losersArr.length==1;return!!(t&&a&&n)},i.getPlayerIsSeePokerByUid=function(e){if(i.gameInfo.show)for(var t in i.gameInfo.show)if(t==e)return i.gameInfo.show[t]},i.getGameAllChips=function(){if(0!=Object.keys(i.gameInfo).length){var e=[];for(var t in i.gameInfo.chips)for(var a=0;a<i.gameInfo.chips[t].length;a++)e.push(i.gameInfo.chips[t][a]);return e}},i.getPlayerChipsByUid=function(e){if(0!=Object.keys(i.gameInfo).length){var t=0;for(var a in i.gameInfo.chips)if(a==e)for(var n=0;n<i.gameInfo.chips[a].length;n++)t+=i.gameInfo.chips[a][n];return t}},i.getRoomCoinChipConfig=function(e){return i.CoinChipConfig[e]},i.isGameStart=function(){if(0!=Object.keys(i.gameInfo).length)return i.gameInfo.currentPlayer==i.gameInfo.firstOperatePlayer&&1==i.gameInfo.curTurnNum},i.isGameEnd=function(){return 0!=Object.keys(i.gameInfo).length?i.losersArr.length==i.playersArr.length-1:null},i.isObPlayer=function(e){if(i.playersArr)return-1==i.playersArr.indexOf(e)},i.isLoser=function(e){if(0!=Object.keys(i.gameInfo).length)return-1!=i.losersArr.indexOf(e)&&-1==i.GiveUpArr.indexOf(e)},i.isAddChips=function(e){for(var t in i.gameInfo.chips)if(t==e)return 1<i.gameInfo.chips[t].length;return null},i.isAutoFollow=function(e){for(var t in i.gameInfo.auotFollowUids)if(t==e)return!!i.gameInfo.auotFollowUids[t];return null},i.isMingPai=function(e){for(var t in i.gameInfo.playerMingPai)return t==e;return null},i.isFirstTurn=function(e){for(var t in i.gameInfo.chips)if(e==t)return 2==i.gameInfo.chips[t].length;return null},i.registMessage=function(){i.initCreateRoomOpts(),GameNet.getInstance().setCallBack("zhaJinHua-onGameInfo",function(e){WriteLog("do event onGameInfo  "+JSON.stringify(e)),i.gameInfo=e,GameData.game.zhuangUid=e.zhuangUid,GameData.game.gameStart=!0,i.setPlayerArr(e.chips),i.setLosersArr(e.losers),i.setGiveUpArr(e.playerGiveUps),sendEvent("zhaJinHua-onGameInfo")}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerAddChips",function(e){WriteLog("do event onPlayerAddChips  "+JSON.stringify(e)),sendEvent("onPlayerAddChips",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerFollowChips",function(e){WriteLog("do event onPlayerFollowChips  "+JSON.stringify(e)),sendEvent("onPlayerFollowChips",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerGiveUp",function(e){WriteLog("do event onPlayerGiveUp  "+JSON.stringify(e)),sendEvent("onPlayerGiveUp",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerCompare",function(e){WriteLog("do event onPlayerCompare  "+JSON.stringify(e)),i.isCompare=!0,sendEvent("onPlayerCompare",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerCheck",function(e){WriteLog("do event onPlayerCheck  "+JSON.stringify(e)),i.pokers[e.uid]=e.cards,i.playerPokerType[e.uid]=e.type,sendEvent("onPlayerCheck",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onPlayerMingPai",function(e){WriteLog("do event onPlayerMingPai  "+JSON.stringify(e)),i.pokers[e.uid]=e.cards,i.playerPokerType[e.uid]=e.type,sendEvent("onPlayerMingPai",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onShowCardsInfo",function(e){for(var t in WriteLog("do event zhaJinHua-onShowCardsInfo  "+JSON.stringify(e)),i.pokers[GameData.player.uid]=e.selfCards,i.playerPokerType[GameData.player.uid]=e.selfType,e.othersCards)i.pokers[t]=e.othersCards[t];for(var a in e.othersTypes)i.playerPokerType[a]=e.othersTypes[t];sendEvent("refreshPoker")}),GameNet.getInstance().setCallBack("zhaJinHua-onZhaJinHuaRunEnd",function(e){WriteLog("do event onZhaJinHuaRunEnd  "+JSON.stringify(e)),sendEvent("onZhaJinHuaRunEnd",e)}),GameNet.getInstance().setCallBack("zhaJinHua-onZhaJinHuaRoomEnd",function(e){WriteLog("do event onZhaJinHuaRoomEnd   "+JSON.stringify(e)),GameData.game.close=!0,GameData.game.gameStart=!1,i.gameResultData=e,sendEvent("onZhaJinHuaRoomEnd"),i.initData()}),GameNet.getInstance().setCallBack("zhaJinHua-onGameStart",function(e){WriteLog("do event zhaJinHua-onGameStart  "+JSON.stringify(e)),GameData.game.gameStart=!0,GameData.game.close=!1,i.isCompare=!1,i.pokers={},i.playerPokerType={},sendEvent("zhaJinHua-onGameStart")})},i.unregistAllMessage=function(){},cc._RF.pop()},{}],"ZJH-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"eb04dRk4VVC6K9zPbDd/l3/","ZJH-createRoom");e("roomHandler");var n=e("ZJH-RoomData"),c=e("configMgr"),d=e("gameDefine");cc.Class({extends:cc.Component,properties:{round10:cc.Toggle,round20:cc.Toggle,round30:cc.Toggle,player:cc.Toggle,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,chouMa1:cc.Toggle,chouMa2:cc.Toggle,baoZi:cc.Toggle,huaSe:cc.Toggle,A23da:cc.Toggle,A23xiao:cc.Toggle,A23diLong:cc.Toggle,men0:cc.Toggle,men1:cc.Toggle,men2:cc.Toggle,men3:cc.Toggle,fengDing5:cc.Toggle,fengDing10:cc.Toggle,fengDing15:cc.Toggle,fengDing20:cc.Toggle,spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.modeType=1,this.spendData=void 0,this.refreshUI()},getModeType:function(){return this.modeType},createRoom:function(){GameData.setGameType(d.GameType.Game_Poker_ZJH),this.saveRuleFromUI();var e={gameType:d.GameType.Game_Poker_ZJH,roundType:1,roundMax:n.createRoomOpts.roundMax,roundRule:n.createRoomOpts.roundRule,joinermax:n.createRoomOpts.playerMax,joinermin:n.createRoomOpts.playerMin,twoThreeFiveBiger:n.createRoomOpts.twoThreeFiveBiger,compareSuit:n.createRoomOpts.compareSuit,chipsType:n.createRoomOpts.chipsType,a23Type:n.createRoomOpts.a23Type,canNotLookTurnNum:n.createRoomOpts.canNotLookTurnNum,maxTunNum:n.createRoomOpts.maxTunNum,roomType:0,costType:n.createRoomOpts.costType,cardType:n.createRoomOpts.playType,clubId:0,currencyType:1,settleType:1},t=c.getModeType();return null==t||null==t.Game_Poker_ZJH||(e.currencyType=t.Game_Poker_ZJH.CurrencyType,e.settleType=t.Game_Poker_ZJH.SettleType,n.onRoomReadyInfo={}),e},saveRuleFromUI:function(){this.round10.isChecked?(n.createRoomOpts.roundMax=10,n.createRoomOpts.roundRule=10):this.round20.isChecked?(n.createRoomOpts.roundMax=20,n.createRoomOpts.roundRule=20):this.round30.isChecked&&(n.createRoomOpts.roundMax=30,n.createRoomOpts.roundRule=30),this.pay1.isChecked?n.createRoomOpts.costType=1:this.pay2.isChecked?n.createRoomOpts.costType=2:this.pay3.isChecked&&(n.createRoomOpts.costType=3),this.huaSe.isChecked?n.createRoomOpts.compareSuit=1:n.createRoomOpts.compareSuit=0,this.baoZi.isChecked?n.createRoomOpts.twoThreeFiveBiger=1:n.createRoomOpts.twoThreeFiveBiger=0,this.chouMa1.isChecked?n.createRoomOpts.chipsType=0:this.chouMa2.isChecked&&(n.createRoomOpts.chipsType=1),this.A23diLong.isChecked?n.createRoomOpts.a23Type=1:this.A23da.isChecked?n.createRoomOpts.a23Type=0:this.A23xiao.isChecked&&(n.createRoomOpts.a23Type=2),this.men0.isChecked?n.createRoomOpts.canNotLookTurnNum=0:this.men1.isChecked?n.createRoomOpts.canNotLookTurnNum=1:this.men2.isChecked?n.createRoomOpts.canNotLookTurnNum=2:this.men3.isChecked&&(n.createRoomOpts.canNotLookTurnNum=3),this.fengDing5.isChecked?n.createRoomOpts.maxTunNum=5:this.fengDing10.isChecked?n.createRoomOpts.maxTunNum=10:this.fengDing15.isChecked?n.createRoomOpts.maxTunNum=15:this.fengDing20.isChecked&&(n.createRoomOpts.maxTunNum=20),n.saveCreateRoomOpts()},refreshUI:function(){cc.log("ZJH_roomData.createRoomOpts = "+JSON.stringify(n.createRoomOpts)),this.round10.isChecked=15==n.createRoomOpts.roundMax,this.round20.isChecked=20==n.createRoomOpts.roundMax,this.round30.isChecked=30==n.createRoomOpts.roundMax,this.pay1.isChecked=!0,this.pay2.isChecked=!1,this.pay3.isChecked=!1,this.huaSe.isChecked=1==n.createRoomOpts.compareSuit,this.baoZi.isChecked=1==n.createRoomOpts.twoThreeFiveBiger,this.chouMa1.isChecked=0==n.createRoomOpts.chipsType,this.chouMa2.isChecked=1==n.createRoomOpts.chipsType,this.A23diLong.isChecked=0==n.createRoomOpts.a23Type,this.A23da.isChecked=1==n.createRoomOpts.a23Type,this.A23xiao.isChecked=2==n.createRoomOpts.a23Type,this.men0.isChecked=0==n.createRoomOpts.canNotLookTurnNum,this.men1.isChecked=1==n.createRoomOpts.canNotLookTurnNum,this.men2.isChecked=2==n.createRoomOpts.canNotLookTurnNum,this.men3.isChecked=3==n.createRoomOpts.canNotLookTurnNum,this.fengDing5.isChecked=5==n.createRoomOpts.maxTunNum,this.fengDing10.isChecked=10==n.createRoomOpts.maxTunNum,this.fengDing15.isChecked=15==n.createRoomOpts.maxTunNum,this.fengDing20.isChecked=20==n.createRoomOpts.maxTunNum,this.showSpendUI()},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..ZJH");var e="",t="",a=c.getModeType();if(null!=a&&null!=a.Game_Poker_ZJH){var n=c.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Poker_ZJH.CurrencyType,this.modeType){case d.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[d.GameType.Game_Poker_ZJH];break;case d.currencyType.Currency_Coin:e="金币",this.spendData=n.roomCoin[d.GameType.Game_Poker_ZJH]}if(this.spendData)for(var i=0;i<Object.keys(this.spendData).length;i++){var o=0;if(this.modeType==d.currencyType.Currency_Card){var r=this.spendData[i+71].cost,s=3;this.player3.isChecked?s=3:this.player4.isChecked?s=4:this.player5.isChecked?s=5:this.player6.isChecked&&(s=6),o=r[s].final,this.pay2.isChecked&&(o=Math.ceil(o/s),t="/人")}else o=this.spendData[i].cost;this.drowArray[i].active=0==o,this.spendUI_tdk[i].string="（"+e+"*"+o+t+"）"}else cc.log("..spendData is undefined")}}}}),cc._RF.pop()},{"ZJH-RoomData":"ZJH-RoomData",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"ZJH-roomDissolve":[function(e,t,a){"use strict";cc._RF.push(t,"c170bVSd/BGUp4xNR6f12cr","ZJH-roomDissolve");var r=e("roomHandler");e("ZJH-RoomData"),e("gameDefine");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&(cc.log("GameData.game.onRoomDissolve = "+JSON.stringify(GameData.game.onRoomDissolve)),sendEvent("onRoomDissolve",GameData.game.onRoomDissolve)),this.openDisAgree=!1,registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showHeaderConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showHeaderConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.opts.joinermax-1;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+(e+2),t.x=this.headerNode.x+190*(e+1),t.active=!1}},showPlayers:function(){for(var e=0;e<GameData.joiners.length;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){var n=a.uid,i=a.headimgurl;this.showHeaderIcon(t,i),this.showHeaderName(t,a.name);var o=r.isPlayerOnline(n);cc.find("header_"+t+"/lost",this.headerNode.parent).active=!o,cc.find("header_"+t,this.headerNode.parent).active=!0}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(e,t){var a=cc.find("header_"+e+"/headimg",this.headerNode.parent);null==t||""==t||t.length<=0?a.getComponent(cc.Sprite).spriteFrame=null:cc.loader.load({url:t,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return NiuNiuMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();t.isStart;for(var a in this.showPlayers(),t.select){for(var n=0,i=0;i<GameData.joiners.length;i++){if((o=GameData.joiners[i])&&o.uid==a){n=i+1;break}}if("apply"==t.select[a]){"申请解散房间";for(i=0;i<GameData.joiners.length;i++){var o;(o=GameData.joiners[i])&&o.uid==a&&(this.dissolvePerson.string="["+o.name+"]发起投票解散对局")}this.showAgreeIcon(n,!0)}else if("agree"==t.select[a])"同意解散房间",this.showAgreeIcon(n,!0);else if("disagree"==t.select[a])return"拒绝解散房间",0,this.node.parent.parent.getComponent("ZJH_roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(a);"agree"!=t.select[a]&&"apply"!=t.select[a]||a!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||this.handleRoomDisbandTimer(t)},handleVoteResult:function(e){0==e&&(this.node.getComponent("TDK-roomMain").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){r.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("TDK-roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){r.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){r.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(r.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}},showHeaderConnect:function(){for(var e=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid,a=r.isPlayerOnline(t),n=e+1;cc.find("header_"+n+"/lost",this.headerNode.parent).active=!a}}}),cc._RF.pop()},{"ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"ZJH-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"d469buB0+pBX61eHZms64Hu","ZJH-roomWait");var f=e("SoundMngr"),h=e("roomHandler"),l=e("ZJH-RoomData"),u=e("gameDefine"),n=e("configMgr");cc.Class({extends:cc.Component,properties:{readyNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,playersNode:{default:[],type:cc.Node},ruleNode:cc.Node,readyBtn:cc.Node,readyCountDownNode:cc.Node,unStartLayer:cc.Node,waitTips:cc.Node,costTips:cc.Node,playerPrefab:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.registListenr(),this.init(),this.reconnect(),this.onReConnectShow(),this.addDynAnimation()},init:function(){this.playIntrSize="small",this.playerSex=1,this.lastTime=0,this.headers=new Array,this.onReadyFlag=!0,this.TipsFlag=!0,this.readyCountDownNode.active=!1,this.costTips.active=!1,this.quitRoomBtn.active=this.readyBtn.active,this.showPlayers(this)},registListenr:function(){registEvent("onRoomInfo",this,this.showPlayers),registEvent("dynChat",this,this.dynChatHandler),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("zhaJinHua-onGameInfo",this,this.onGameTurn),registEvent("onZhaJinHuaRunEnd",this,this.showReadyNode),registEvent("onReadyCountDown",this,this.onReadyCountDown),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("zhaJinHua-onGameStart",this,this.onGameStartHandler)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("dynChat",this,this.dynChatHandler),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("zhaJinHua-onGameInfo",this,this.onGameTurn),unregistEvent("onZhaJinHuaRunEnd",this,this.showReadyNode),unregistEvent("onReadyCountDown",this,this.onReadyCountDown),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),unregistEvent("zhaJinHua-onGameStart",this,this.onGameStartHandler)},showReadyNode:function(){var e=this;this.scheduleOnce(function(){h.room.opts.currencyType==u.currencyType.Currency_Card&&(e.readyNode.active=!0)},2);for(var t=0;t<GameData.joiners.length;t++)if(GameData.joiners[t]){var a=GameData.getPlayerByUid(GameData.joiners[t].uid);if(null!=a){var n=a.uid,i=GameData.getPlayerPosByUid(n),o=this.playersNode[i].getChildByName("headNode").getComponent("pokerRoomPlayer");o.showZhuang(!1),o.showCountDownEffect(!1)}}var r=l.isCompare?5.5:3.5;h.room.opts.currencyType==u.currencyType.Currency_Coin&&l.gameInfo.status==l.gameState.Settle&&this.scheduleOnce(function(){e.quitRoomBtn.active=!0},r)},onReadyCountDown:function(e){this.onReadyFlag&&(this.onReadyFlag=!1,this.readyCountDownNode.active=!1,this.unschedule(this.showReadyCountDown),h.room.opts.currencyType==u.currencyType.Currency_Coin?(this.lastTime=5,l.isRunAnimation&&(this.lastTime=4)):this.lastTime=4,1==e&&(h.readyCountDown-=2),this.TipsFlag=!0,this.schedule(this.showReadyCountDown,1));var t=cc.find("btnWeixin",this.unStartLayer),a=cc.find("btnCopy",this.unStartLayer);t.active=!1,a.active=!1},showReadyCountDown:function(){this.waitTips.active=!1;var e=this.isFirstPlayGame();h.room.opts.currencyType==u.currencyType.Currency_Coin?h.readyCountDown<=5&&0<h.readyCountDown&&!l.isRunAnimation&&(this.readyCountDownNode.active=!0,this.TipsFlag&&e&&h.room.opts.currencyType==u.currencyType.Currency_Coin&&(this.showCostTips(),this.TipsFlag=!1)):this.readyCountDownNode.active=!0,cc.find("time",this.readyCountDownNode).getComponent(cc.Label).string=this.lastTime-1+"",h.readyCountDown--,this.readyCountDownNode.active&&this.lastTime--,this.lastTime<0&&(this.onReadyFlag=!0,this.unschedule(this.showReadyCountDown),this.readyCountDownNode.active=!1,this.costTips.active=!1)},showCostTips:function(){var e=n.getServerConfig(),t=h.room.opts.scorelv,a=e.matchCoin[GameData.client.gameType].cost[t];this.costTips.active=!0,this.costTips.getComponent(cc.Label).string="每局消耗"+a+"金币"},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);var n=GameData.getPlayerPosByUid(t),i=this.playersNode[n].getChildByName("headNode");if(i){var o=cc.find("chatNode/chat"+n,i);if(null!=o){var r=cc.find("word",o),s=cc.find("emo",o),c=cc.find("yuyinNode",o);if("word"==a){var d=e.detail.msg.data,h=cc.find("word/bg",o),l=cc.find("word/Label",o).getComponent(cc.Label),u=d;h.width=20+24*u.length,r.getComponent("HideComponent").show(3),l.string=u}else if("fast"==a){var m=e.detail.msg.data.sound;d=e.detail.msg.data.content,h=cc.find("word/bg",o),l=cc.find("word/Label",o).getComponent(cc.Label),u=getShortStr(d,10);h.width=30*u.length,r.getComponent("HideComponent").show(3),l.string=u,f.instance.playAudioChat(m,this.playerSex)}else if("emo"==a){var p=e.detail.msg.data;cc.log("animationName:"+p),s.getComponent(cc.Animation).play(p),s.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var g=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",g):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(g)),cc.find("yuyinAnimNode/yuyinAnim",c).getComponent(cc.Animation).play("yuyinduihua"),c.getComponent("HideComponent").show(3)}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("pokerRoomPlayer");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},showPlayers:function(){this.headers=[];for(var e=0;e<GameData.room.opts.joinermax;e++)this.showPlayer(e,this.playersNode[e]);this.onRoomReadyInfoHandler()},showPlayer:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=t.getChildByName("headNode");null==n&&((n=cc.instantiate(this.playerPrefab)).name="headNode",t.addChild(n)),this.headers.push(n),n.getComponent("pokerRoomPlayer").setPlayer(a),n.getComponent("pokerRoomPlayer").setHeadIcon(a.headimgurl),n.getComponent("pokerRoomPlayer").setName(a.name),n.getComponent("pokerRoomPlayer").setIsOnline(a.uid),n.getComponent("pokerRoomPlayer").showZhuang(a.uid==GameData.game.zhuangUid),t.active=!0}else t.active=!1},onReadyBtnClick:function(){var t=this;this.quitRoomBtn.active=!1,f.instance.playAudioOther("button"),GameNet.getInstance().request("room.roomHandler.ready",{},function(e){t.readyBtn.active=!1})},onRoomReadyInfoHandler:function(){for(var e=this.readyNode.children,t=0;t<e.length;t++)e[t].active=!1;var a=h.getRoomReadyData();cc.log("readyData = "+JSON.stringify(a));for(t=0;t<GameData.joiners.length;t++)if(GameData.joiners[t]){var n=GameData.joiners[t].uid;if(null!=GameData.joiners[t])if(1==a[n]){var i=GameData.getPlayerPosByUid(n);h.room.opts.currencyType!=u.currencyType.Currency_Coin&&(this.showReadyIcon(i,!0,!1),n===GameData.player.uid&&(this.quitRoomBtn.active=!1)),l.gameInfo.status==l.gameState.Settle&&h.room.opts.currencyType==u.currencyType.Currency_Card&&n===GameData.player.uid&&(this.waitTips.active=!0),l.isGameEnd()&&n===GameData.player.uid&&h.room.opts.currencyType!=u.currencyType.Currency_Coin&&sendEvent("initTableUI")}else{i=GameData.getPlayerPosByUid(n);!l.isGameEnd()&&GameData.game.gameStart&&n===GameData.player.uid&&h.room.opts.currencyType!=u.currencyType.Currency_Coin&&sendEvent("initTableUI")}else{i=GameData.getPlayerPosByUid(n);this.showReadyIcon(i,!1,!1)}}},showJoinerLost:function(e){var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了")},showJoinerConnect:function(e){this.showPlayers();var t=e.detail.uid,a=GameData.getPlayerByUid(t).name;createMoveMessage("玩家["+a+"]重新连接!")},backBtnClicked:function(){f.instance.playAudioOther("button"),GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):h.quitMjRoom(GameData.room.id)},wxInviteBtnClicked:function(){f.instance.playAudioOther("button");var e="三张牌 房间号:"+GameData.room.id,t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="玩法:"+(GameData.room.opts.joinermin+"-"+GameData.room.opts.joinermax+"人,")+getRuleStrZJH(GameData.room.opts)+"请您快速加入对局.";return console.log("des = "+e),e},onShareResult:function(){wxShareTimeline("三张牌","我在三张牌等你!")},onShareFriend:function(){wxShareWeb("三张牌","我在三张牌等你!")},onDeleteRoom:function(){NiuNiuMessageBox("解散房间不扣房卡，是否确定解散？",function(){h.deleteRoom(GameData.room.id,"apply")},function(){})},onQuitRoom:function(){f.instance.playAudioOther("button"),GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):(GameData.player.roomid=void 0,h.quitRoom(GameData.room.id))},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?NiuNiuMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onGameTurn:function(){l.gameInfo.status!=l.gameState.End&&this.onGameStartHandler();for(var e=l.gameInfo.currentPlayer,t=0;t<GameData.joiners.length;t++){var a=GameData.joiners[t];if(null!=a){var n=-1!=l.playersArr.indexOf(a.uid),i=a.uid,o=GameData.getPlayerPosByUid(i),r=this.playersNode[o].getChildByName("headNode").getComponent("pokerRoomPlayer");if(r.showZhuang(a.uid==GameData.game.zhuangUid),n){var s=l.gameInfo.remainSec;l.isGameEnd()||e!==i?r.showCountDownEffect(!1):r.showCountDownEffect(!0,15-s)}}}var c=-1!=l.losersArr.indexOf(GameData.player.uid),d=-1!=l.GiveUpArr.indexOf(GameData.player.uid);h.room.opts.currencyType==u.currencyType.Currency_Coin&&(d||c)&&(this.quitRoomBtn.active=!0)},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="三张牌,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},onGameStartHandler:function(e){this.waitTips.active=!1,this.readyCountDownNode.active=!1,this.costTips.active=!1,this.unschedule(this.showReadyCountDown),this.onReadyFlag=!0;var t=-1!=l.losersArr.indexOf(GameData.player.uid);h.isPlayGameByUid(GameData.player.uid)?t&&h.room.opts.currencyType==u.currencyType.Currency_Coin?cc.log("zanbuchuli"):this.quitRoomBtn.active=!GameData.game.gameStart:this.quitRoomBtn.active=!0,h.room.opts.currencyType==u.currencyType.Currency_Card&&(this.readyNode.active=!GameData.game.gameStart)},reconnect:function(){h.isPlayGameByUid(GameData.player.uid)?GameData.room.status>u.RoomState.WAIT&&(this.quitRoomBtn.active=!1,this.onGameTurn()):this.quitRoomBtn.active=!0,h.room.opts.currencyType==u.currencyType.Currency_Coin&&(0<h.readyCountDown&&this.onReadyCountDown(1),GameData.room.status>u.RoomState.WAIT&&this.onGameTurn())},onReConnectShow:function(){h.room.opts.currencyType==u.currencyType.Currency_Card&&GameData.room.status==u.RoomState.GAMEING&&(this.readyNode.active=!GameData.game.gameStart)},isFirstPlayGame:function(){var e=h.getScoreData();for(var t in e)if(t==GameData.player.uid)return 0==e[t]}}),cc._RF.pop()},{SoundMngr:"SoundMngr","ZJH-RoomData":"ZJH-RoomData",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"ZJH-roomtable":[function(e,t,a){"use strict";cc._RF.push(t,"ced3fWPBTdKr5xvSd6EZTnU","ZJH-roomtable");var v=e("SoundMngr"),l=e("roomHandler"),C=e("ZJH-RoomData"),u=e("gameDefine"),n=e("pokerAnimationBase");cc.Class({extends:cc.Component,properties:{operationBtns:cc.Node,secondOperBtns:cc.Node,pokersNode:cc.Node,escapeNode:cc.Node,selectCompareNode:cc.Node,compareLayer:cc.Node,chipsNode:cc.Node,playerStateNode:[cc.Node],playerChips:cc.Node,isMask:cc.Node,allScoreNode:cc.Node,playerNodes:{default:[],type:cc.Node},dragNode:cc.Node,continueBtn:cc.Node,animNodes:cc.Node,seePokerBtn:cc.Button,menXPokerBtn:cc.Node,allFollowBtn:cc.Button,mingPaiBtn:cc.Button,mingPaiNode:cc.Node,animationEffect:cc.Node,chipPrefab:cc.Prefab,playerStatePrefab:cc.Prefab,scorePrefab:cc.Prefab,pokerMask:cc.Prefab,chipMask:cc.Prefab},onLoad:function(){this.playerSex=GameData.player.sex,this.pokerAnimBase=new n,this.registListenr(),this.initData(),this.saveAllPokerPosition(),this.initUI(),this.onShow(),this.onReConnectShow()},registListenr:function(){var e=this;this.isMask.on(cc.Node.EventType.TOUCH_END,function(){e.showSecondOperBtn(!1)}),registEvent("initTableUI",this,this.initUI),registEvent("onRoomInfo",this,this.onRoomInfo),registEvent("onPlayerCheck",this,this.showMyPokerCards),registEvent("zhaJinHua-onGameInfo",this,this.onShow),registEvent("refreshPoker",this,this.refreshPoker),registEvent("onZhaJinHuaRunEnd",this,this.onShowResult),registEvent("onPlayerGiveUp",this,this.onPlayerGiveUp),registEvent("onPlayerMingPai",this,this.onPlayerMingPai),registEvent("onPlayerAddChips",this,this.onPlayerAddChips),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("zhaJinHua-onGameStart",this,this.onGameStart),registEvent("onPlayerCompare",this,this.showCompareAnimation),registEvent("onPlayerFollowChips",this,this.onPlayerFollowChips)},onDestroy:function(){this.isMask.off(cc.Node.EventType.TOUCH_END,function(){self.showSecondOperBtn(!1)}),unregistEvent("initTableUI",this,this.initUI),unregistEvent("onRoomInfo",this,this.onRoomInfo),unregistEvent("onPlayerCheck",this,this.showMyPokerCards),unregistEvent("zhaJinHua-onGameInfo",this,this.onShow),unregistEvent("refreshPoker",this,this.refreshPoker),unregistEvent("onZhaJinHuaRunEnd",this,this.onShowResult),unregistEvent("onPlayerGiveUp",this,this.onPlayerGiveUp),unregistEvent("onPlayerMingPai",this,this.onPlayerMingPai),unregistEvent("onPlayerAddChips",this,this.onPlayerAddChips),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("zhaJinHua-onGameStart",this,this.onGameStart),unregistEvent("onPlayerCompare",this,this.showCompareAnimation),unregistEvent("onPlayerFollowChips",this,this.onPlayerFollowChips)},initUI:function(){this.initBtn(),this.initPokerNode(),this.initPlayerState(),this.showSecondOperBtn(!1),this.showSelectPlayerPK(!1),this.operationBtns.active=!1,this.hideNodeChild(this.animNodes),this.hideNodeChild(this.animationEffect),this.mingPaiNode.active=!1},initData:function(){this.pokerArr=[],this.pokerPosArr=[],this.allpokerPosArr=[],this.winner=0,C.startAnimFinish=!1},initBtn:function(){this.showSeePokerBtn(!1),this.operationBtns.active=!1,this.continueBtn.active=!1,this.mingPaiBtn.node.active=!1,this.allFollowBtn.node.active=!1},initPlayerState:function(){for(var e=0;e<this.playerStateNode.length;e++)this.playerStateNode[e].active=!0,this.playerStateNode[e].removeAllChildren(!0)},initPokerNode:function(){this.hideNodeChild(this.pokersNode),this.hideNodeChild(this.escapeNode);for(var e=0;e<this.pokersNode.childrenCount;e++){var t=this.pokersNode.children[e].getChildByName("style2");if(t){t.active=!1;for(var a=0;a<t.childrenCount;a++)this.showPokerContent(t.children[a],0),t.children[a].removeAllChildren(!0)}for(var n=0;n<this.pokersNode.children[e].getChildByName("style1").childrenCount;n++)this.showPokerContent(this.pokersNode.children[e].getChildByName("style1").children[n],0),this.pokersNode.children[e].getChildByName("style1").children[n].removeAllChildren(!0),this.pokersNode.children[e].getChildByName("style1").children[n].position=this.allPokerPosArr[e][n]}},onShow:function(){C.startAnimFinish&&(this.showSeePokerBtn(!0),this.showOperBtn()),C.gameInfo.status==C.gameState.Settle&&(this.showSeePokerBtn(!1),this.operationBtns.active=!1),this.showPlayerState(),this.showPlayerChips()},onReConnectShow:function(){if(0!=Object.keys(C.gameInfo).length){if(C.gameInfo.status!=C.gameState.Settle&&C.gameInfo.status!=C.gameState.End)for(var e=C.getGameAllChips(),t=0;t<e.length;t++){var a=this.randomNum(0,400)-200,n=this.randomNum(0,100)-100,i=e[t],o=cc.instantiate(this.chipPrefab);o.getComponent("poker_chipPrefab").setChipImg(i),o.x=a,o.y=n,o.parent=this.chipsNode}this.showJoinerConnect()}},onRoomInfo:function(){if(l.room.opts.currencyType==u.currencyType.Currency_Coin)for(var e=0;e<GameData.room.opts.joinermax;e++){if(null==GameData.joiners[e]){var t=GameData.getPlayerPosByUid("null");null!=t&&(this.escapeNode.children[t].active=!1,this.animNodes.children[t].active=!1,this.pokersNode.children[t].active=!1,this.playerChips.children[t].active=!1,this.playerStateNode[t].active=!1)}}},onGameStart:function(){C.startAnimFinish=!1,C.isRunAnimation=!0,this.initUI(),this.savePokerData(),this.playGameStartAnim(),this.showPlayerChips()},onPlayerAddChips:function(e){var t=e.detail.uid,a=e.detail.chips,n=GameData.getPlayerSexByUid(t),i=.5<Math.random()?1:2;a==C.getGameAllChips()[0]?v.instance.playAudioZJH("follow1",n||1):v.instance.playAudioZJH("addChip"+i,n||1),this.addChip(a,t)},onPlayerFollowChips:function(e){var t=e.detail.uid,a=e.detail.chips,n=GameData.getPlayerSexByUid(t);if(C.isFirstTurn(t))v.instance.playAudioZJH("follow1",n||1);else{var i=.5<Math.random()?2:3;v.instance.playAudioZJH("follow"+i,n||1)}this.addChip(a,t)},onPlayerGiveUp:function(e){var t=e.detail.uid,a=GameData.getPlayerPosByUid(t),n=this.escapeNode.children[a],i=0==a?1:.7;n&&this.pokerAnimBase.playScaleAnim(n,i);var o=GameData.getPlayerSexByUid(t),r=.5<Math.random()?1:2;v.instance.playAudioZJH("giveUp"+r,o||1),t==GameData.player.uid&&(this.showSecondOperBtn(!1),this.showSelectPlayerPK(!1),this.operationBtns.active=!1)},onPlayerMingPai:function(e){this.showMingPai(e)},onShowResult:function(e){this.showSecondOperBtn(!1),this.showSelectPlayerPK(!1),this.operationBtns.active=!1,this.initBtn(),C.startAnimFinish=!1,this.hideNodeChild(this.animNodes);var s=e.detail.winnerUid;this.winner=s;var c=this,d=GameData.getPlayerPosByUid(s),a=this.playerNodes[d].position,h=e.detail.scores,t=C.isCompare?4.5:2;C.isRunAnimation=!0,this.scheduleOnce(function(){for(var e=0;e<c.chipsNode.children.length;e++){var t=c.chipsNode.children[e];c.resultChipsAnimation(t,a),c.allScoreNode.active=!1,v.instance.playAudioZJH("get_chip",null)}},t),this.scheduleOnce(function(){for(var e in h)c.moveAboutScore(e,h[e]);l.room.opts.currencyType!=u.currencyType.Currency_Coin&&(c.continueBtn.active=!0);var t=c.playerStateNode[d],a=t.getChildByName(t.name+"_yikanpai"),n=t.getChildByName(t.name+"_pokerTypeMask");a&&(a.active=!1,n.active=!1);var i=GameData.getPlayerPosByUid(s),o=this.animationEffect.children[i];o.active=!0,this.pokerAnimBase.playDragAnimation(o,"zjh/animation/headEffect","newAnimation");var r=c.animNodes.children[d];r.active=!0,c.pokerAnimBase.playDragAnimation(r,"zjh/animation/shengli","newAnimation"),c.refreshPlayerAllScore(),c.mingPaiBtn.node.active=s==GameData.player.uid,C.isRunAnimation=!1},t+.5),l.room.opts.currencyType==u.currencyType.Currency_Coin&&this.scheduleOnce(function(){c.mingPaiBtn.node.active=!1},t+3.5)},showJoinerConnect:function(e){if(e&&e.detail.uid!=GameData.player.uid)return;C.startAnimFinish=GameData.game.gameStart,C.gameInfo.status!=C.gameState.Settle&&C.gameInfo.status!=C.gameState.End||(l.room.opts.currencyType==u.currencyType.Currency_Card&&(this.continueBtn.active=!0),this.chipsNode.removeAllChildren(!0),this.allScoreNode.active=!1),GameData.room.status==u.RoomState.GAMEING&&C.gameInfo.status!=C.gameState.Settle?(this.showSeePokerBtn(!0),this.showOperBtn(),this.continueBtn.active=!1):(this.showSeePokerBtn(!1),this.operationBtns.active=!1),C.isRunAnimation=!1;for(var t=0;t<C.playersArr.length;t++){var a=C.getWinPlayer(C.playersArr[t]),n=GameData.getPlayerPosByUid(C.playersArr[t]),i=this.animNodes.children[n],o=C.isMingPai(C.playersArr[t]);i&&(a?o?i.active=!0:(i.active=!0,this.mingPaiBtn.node.active=C.playersArr[t]==GameData.player.uid):i.active=!1)}if(this.showPokerCards(),this.showPlayerState(),this.refreshPlayerAllScore(),C.isObPlayer(GameData.player.uid)){n=GameData.getPlayerPosByUid(GameData.player.uid);this.escapeNode.children[n].active=!1,this.animNodes.children[n].active=!1}1!=l.getRoomReadyData()[GameData.player.uid]||C.gameInfo.status!=C.gameState.Settle&&C.gameInfo.status!=C.gameState.End||this.initUI()},showSeePokerBtn:function(e){var t=C.isObPlayer(GameData.player.uid),a=C.getPlayerIsSeePokerByUid(GameData.player.uid),n=-1!=C.losersArr.indexOf(GameData.player.uid),i=C.isGameEnd();if(C.startAnimFinish){this.allFollowBtn.node.active=!(n||t||i);var o=cc.find("checkBtn",this.allFollowBtn.node),r=cc.find("animation",this.allFollowBtn.node);if(C.isAutoFollow(GameData.player.uid)?(o.active=!0,r.active=!0):(o.active=!1,r.active=!1),t||a||n)return this.seePokerBtn.node.active=!1,void(this.menXPokerBtn.active=!1);this.seePokerBtn.node.active=e}else this.seePokerBtn.node.active=!1;C.gameInfo.curTurnNum<=GameData.room.opts.canNotLookTurnNum?(this.seePokerBtn.interactable=!1,this.menXPokerBtn.active=!0,cc.find("menX",this.menXPokerBtn).getComponent(cc.Label).string=GameData.room.opts.canNotLookTurnNum-(C.gameInfo.curTurnNum-1)):(this.seePokerBtn.interactable=!0,this.menXPokerBtn.active=!1)},showOperBtn:function(){var e=C.isObPlayer(GameData.player.uid),t=C.isGameEnd(),a=C.isAutoFollow(GameData.player.uid),n=C.isLoser(GameData.player.uid);C.gameInfo.currentPlayer!=GameData.player.uid||C.isRunAnimation||a||e||t||n?(this.operationBtns.active=!1,this.showSecondOperBtn(!1)):(this.operationBtns.active=!0,this.controlBtnDisable())},showSecondOperBtn:function(e){(this.secondOperBtns.active=e)?(this.isMask.active=!0,this.showChipBtnImg()):this.isMask.active=!1},showPlayerChips:function(){if(this.hideNodeChild(this.playerChips),GameData.game.gameStart){for(var e=0;e<C.playersArr.length;e++){var t=C.playersArr[e],a=GameData.getPlayerPosByUid(t);this.playerChips.children[a]&&(this.playerChips.children[a].active=!0)}this.refreshPlayerChipNum()}},showChipBtnImg:function(){if(GameData.room.opts){var e=GameData.room.opts.chipsType,t=parseInt(C.gameInfo.maxChipsValue),a=C.getPlayerIsSeePokerByUid(GameData.player.uid),n=[];if(n=e?[5,10,20,50,100]:[1,2,5,10,20],l.room.opts.currencyType==u.currencyType.Currency_Coin){var i=l.room.opts.scorelv;n=C.getRoomCoinChipConfig(i)}for(var o=0;o<this.secondOperBtns.childrenCount;o++)this.secondOperBtns.children[o].removeAllChildren(!0);for(var r=0;r<this.secondOperBtns.childrenCount;r++){this.secondOperBtns.children[r].getComponent(cc.Button).normalSprite=null;var s="resources/zjh/UI/img/chip/chip_"+n[r]+".png",c=cc.textureCache.addImage(cc.url.raw(s));this.secondOperBtns.children[r].getComponent(cc.Button).normalSprite=new cc.SpriteFrame(c),r<4&&(a?(n[r]<=2*t?(this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!1,this.addNodeMask(this.secondOperBtns.children[r],this.chipMask)):this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!0,2!=t&&20!=t&&100!=t&&600!=t&&2e3!=t||(n[r]<=2.5*t?(this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!1,this.addNodeMask(this.secondOperBtns.children[r],this.chipMask)):this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!0)):n[r]<=t?(this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!1,this.addNodeMask(this.secondOperBtns.children[r],this.chipMask)):this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!0,0==r&&a&&(this.secondOperBtns.children[r].getComponent(cc.Button).interactable=!1,this.addNodeMask(this.secondOperBtns.children[r],this.chipMask)))}var d=this.secondOperBtns.children[4];a?n[4]<=2*t?(d.getComponent(cc.Button).interactable=!1,this.addNodeMask(d,this.chipMask)):d.getComponent(cc.Button).interactable=!0:(d.getComponent(cc.Button).interactable=!1,this.addNodeMask(d,this.chipMask))}},showSelectPlayerPK:function(e){this.selectCompareNode.active=e;var t=cc.find("nodes",this.selectCompareNode);if(this.hideNodeChild(t),e)for(var a=C.getLivePlayers(),n=0;n<a.length;n++){var i=a[n],o=GameData.getPlayerPosByUid(i);i!=GameData.player.uid?t.children[o].active=!0:t.children[o].active=!1}},showPokerCards:function(e){if(this.secondOperBtns.active&&this.showChipBtnImg(),e){var t=GameData.getPlayerSexByUid(e.detail.uid),a=.5<Math.random()?1:2;v.instance.playAudioZJH("kanpai"+a,t)}this.hideNodeChild(this.pokersNode);for(var n=0;n<C.playersArr.length;n++){var i=C.playersArr[n],o=GameData.getPlayerPosByUid(i),r=this.pokersNode.children[o],s=C.getPlayerPokerByUid(i),c=C.getPlayerIsSeePokerByUid(i),d=C.isMingPai(i);if(r&&(r.active=!0),s&&r){var h=r.getChildByName("style1");if(c&&i==GameData.player.uid||d)for(var l=0;l<r.childrenCount;l++)this.showPokerContent(h.children[l],s[l]);else for(l=0;l<r.childrenCount;l++)this.showPokerContent(h.children[l],0)}}},showMyPokerCards:function(e){var t=e.detail.uid,a=GameData.getPlayerPosByUid(t),n=GameData.getPlayerSexByUid(t),i=.5<Math.random()?1:2;v.instance.playAudioZJH("kanpai"+i,n),this.playFlopAnimtaion(t);var o=C.getPlayerPokerTypeByUid(t);cc.log("牌型："+o);var r=this.playerStateNode[a];this.scheduleOnce(function(){this.addPlayerStateImg("pokerTypeMask",r,.8,-45),this.addPlayerStateImg(o,r,.8,-40)},.5)},playFlopAnimtaion:function(e){var t=GameData.getPlayerPosByUid(e),a=this.pokersNode.children[t].getChildByName("style1"),n=C.getPlayerPokerByUid(e);if(n){for(var i=0;i<a.childrenCount;i++)this.pokerAnimBase.playFlopAnimation(a.children[i]);this.scheduleOnce(function(){for(var e=0;e<a.childrenCount;e++)this.showPokerContent(a.children[e],n[e])},.25)}},showPokerContent:function(e,t){var a="resources/niuNiuTable/poker/"+(0<t?this.getSpriteNameByCardId(t):t)+".png";this.setNodeImg(e,a)},showMingPai:function(e){this.mingPaiNode.active=!0;var t=cc.find("mingpaiAnim",this.mingPaiNode),a=cc.find("downNode",this.mingPaiNode);this.setMingPaiData(a,e),this.pokerAnimBase.flyToMidAction(a,.5,500),this.pokerAnimBase.playDragAnimation(t,"zjh/animation/liangpai","newAnimation"),this.scheduleOnce(function(){this.mingPaiNode.active=!1},1.3)},showPlayerState:function(){for(var e=0;e<C.playersArr.length;e++){var t=C.playersArr[e],a=GameData.getPlayerPosByUid(t),n=this.playerStateNode[a],i=C.getPlayerIsSeePokerByUid(t),o=C.isLoser(t),r=-1!=C.GiveUpArr.indexOf(t),s=C.getWinPlayer(t);if(n&&this.pokersNode.children[a]){var c=this.pokersNode.children[a].getChildByName("style1"),d=this.pokersNode.children[a].getChildByName("style2");if(o)this.addPlayerStateImg("shule",n,0);else{var h=n.getChildByName("shule");h&&(h.active=!1)}var l=this.escapeNode.children[a];r?(n.removeAllChildren(!0),l.active=!0):l.active=!1,i&&t!=GameData.player.uid&&(this.addPlayerStateImg("pokerTypeMask",n,.6),this.addPlayerStateImg("yikanpai",n),d.active=!0,c.active=!1);var u=n.getChildByName(n.name+"_yikanpai"),m=n.getChildByName(n.name+"_pokerTypeMask");if(s&&n.removeAllChildren(!0),o||r){for(var p=0;p<c.childrenCount;p++)this.addNodeMask(c.children[p],this.pokerMask),d&&this.addNodeMask(d.children[p],this.pokerMask);this.seePokerBtn.active=!1,u&&(u.active=!1,m.active=!1)}}}},showCompareAnimation:function(e){var t=this,a=0,n=0,i=e.detail.chips,o=(e=e.detail,GameData.getPlayerSexByUid(e.uid));e.isWin?(a=e.uid,n=e.otherId):(a=e.otherId,n=e.uid);var r=GameData.getPlayerPosByUid(n),s=this.playerStateNode[r],c=this.pokersNode.children[r].getChildByName("style1"),d=this.pokersNode.children[r].getChildByName("style2");d&&d.active&&(c=d),s.removeAllChildren(!0),this.addPlayerStateImg("shule",s);var h=cc.find(s.name+"_shule",s);h&&(h.active=!1);for(var l=0;l<c.childrenCount;l++){this.addNodeMask(c.children[l],this.pokerMask);var u=cc.find(c.children[l].name+"mask",c.children[l]);u&&(u.active=!1)}C.isRunAnimation=!0,this.addChip(i,e.uid);var m=.5<Math.random()?1:2;v.instance.playAudioZJH("cmp"+m,o||1),this.scheduleOnce(function(){t.playPkAction(a,n,e)}.bind(this),1)},refreshPlayerChipNum:function(){for(var e=0;e<C.playersArr.length;e++){var t=C.playersArr[e],a=GameData.getPlayerPosByUid(t),n=C.getPlayerChipsByUid(t),i=cc.find("score",this.playerChips.children[a]),o=l.getPlayersCoin();if(i&&(i.getComponent(cc.Label).string=n+""),l.room.opts.currencyType==u.currencyType.Currency_Coin)if(this.playerNodes[a])this.playerNodes[a].getChildByName("headNode").getComponent("pokerRoomPlayer").setCoin(o[t]-n)}var r=0,s=C.getGameAllChips();if(this.allScoreNode.active=!0,s){for(e=0;e<s.length;e++)r+=s[e];var c=cc.find("score",this.allScoreNode);r=ConversionCoinValue(r,2),c.getComponent(cc.Label).string=r}var d=cc.find("gameTurnLb",this.allScoreNode),h=C.gameInfo.curTurnNum;d.getComponent(cc.Label).string="第"+h+"轮"},playGameStartAnim:function(){var e=this;this.dragNode.active=!0,this.pokerAnimBase.playDragAnimation(this.dragNode,"zjh/animation/kaishi","newAnimation",function(){cc.log("gamestart finish"),e.dragNode.active=!1}),v.instance.playAudioZJH("start",null),this.stake(),v.instance.playAudioZJH("chip_add",null),this.scheduleOnce(this.dealAction,2)},stake:function(){var e=0;if(e=GameData.room.opts.chipsType?5:1,l.room.opts.currencyType==u.currencyType.Currency_Coin){var t=l.room.opts.scorelv;e=C.getRoomCoinChipConfig(t)[0]}for(var a=0;a<C.playersArr.length;a++)this.addChip(e,C.playersArr[a])},dealAction:function(){var t=this;this.pokerAnimBase.dealAction(this.pokerArr,this.pokersNode.position,this.pokerPosArr,.4,function(e){t.scheduleOnce(function(){C.startAnimFinish=!0,C.isRunAnimation=!1,t.showOperBtn(),t.showSeePokerBtn(!0)},e)});for(var e=0;e<this.pokerArr.length;e++)this.scheduleOnce(function(){v.instance.playAudioZJH("card",null)},.1*(e+1))},clipFlyToTableAnimation:function(e){var t=this.randomNum(0,400)-200,a=this.randomNum(0,100)-100,n=cc.moveTo(.3,cc.p(t,a)),i=cc.callFunc(function(){e.removeFromParent(!0)},e),o=cc.fadeOut(.1);80<this.chipsNode.childrenCount?e.runAction(cc.sequence(n,o,i)).easing(cc.easeCubicActionOut()):e.runAction(n).easing(cc.easeCubicActionOut())},playPkAction:function(e,a,t){var n=this,i=cc.find("left",this.compareLayer),o=cc.find("right",this.compareLayer),r=cc.find("resultIcon",i),s=cc.find("resultIcon",o),c=cc.find("mid",this.compareLayer),d=cc.find("vs",this.compareLayer),h=t.isWin;this.setPkData(t),this.compareLayer.active=!0,this.compareLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),c.active=!1,r.active=!1,s.active=!1,this.pokerAnimBase.flyToMidAction(i,.3,-500),this.pokerAnimBase.flyToMidAction(o,.3,500),v.instance.playAudioZJH("compare",null),this.scheduleOnce(function(){c.active=!0},.3-.2),this.scheduleOnce(function(){this.pokerAnimBase.playDragAnimation(d,"zjh/animation/vs","vs")},.3);var l="",u="";h?(l="resources/zjh/UI/img/img_win.png",u="resources/zjh/UI/img/img_lose.png"):(l="resources/zjh/UI/img/img_lose.png",u="resources/zjh/UI/img/img_win.png"),this.setNodeImg(r,l),this.setNodeImg(s,u),this.scheduleOnce(function(){this.pokerAnimBase.playScaleAnim(r,1),this.pokerAnimBase.playScaleAnim(s,1)},.8),this.scheduleOnce(function(){this.compareLayer.active=!1},2.3);var m=GameData.getPlayerPosByUid(a),p=this.playerStateNode[m],g=this.pokersNode.children[m].getChildByName("style1"),f=this.pokersNode.children[m].getChildByName("style2");f&&f.active&&(g=f);var y=cc.find(p.name+"_shule",p);this.scheduleOnce(function(){y&&(y.active=!0,n.pokerAnimBase.playScaleAnim(y,1)),a==GameData.player.uid&&v.instance.playAudioZJH("shibai",null);for(var e=0;e<g.childrenCount;e++){var t=cc.find(g.children[e].name+"mask",g.children[e]);t&&(t.active=!0)}C.isGameEnd()||(C.isRunAnimation=!1)},2.5)},operBtnClick:function(e,t){var a=t;cc.log("operAction Btn index:"+a),v.instance.playAudioOther("button");var n=C.isAutoFollow(GameData.player.uid),i=C.gameInfo.curTurnNum>=GameData.room.opts.maxTunNum,o=C.playersArr.length-C.losersArr.length==2&&3<=C.gameInfo.curTurnNum;if(!n||i||o)switch(parseInt(a)){case 1:this.operationBtns.active=!1,this.requestPlayerGiveUp();break;case 2:this.comparePoker();break;case 3:this.operationBtns.active=!1,this.requestPlayerFollowChips();break;case 4:this.showSecondOperBtn(!0)}else createMoveMessage("正处在自动跟注状态,请取消自动跟注！")},secondOperBtnClick:function(e,t){var a=t,n=[],i=0;if(v.instance.playAudioOther("button"),n=GameData.room.opts.chipsType?[5,10,20,50,100]:[1,2,5,10,20],l.room.opts.currencyType==u.currencyType.Currency_Coin){var o=l.room.opts.scorelv;n=C.getRoomCoinChipConfig(o)}switch(parseInt(a)){case 1:i=n[0];break;case 2:i=n[1];break;case 3:i=n[2];break;case 4:i=n[3];break;case 5:i=n[4]}this.showSecondOperBtn(!1),this.operationBtns.active=!1,this.requestPlayerAddChips(i)},comparePoker:function(){for(var e=C.playersArr.length-C.losersArr.length==2,t=0,a=C.getLivePlayers(),n=0;n<a.length;n++)if(GameData.player.uid!=a[n]){t=a[n];break}e?this.requestPlayerCompare(t):this.showSelectPlayerPK(!0)},selectPlayerClick:function(e,t){var a=t,n=GameData.getPlayerByPos(a).uid;this.showSelectPlayerPK(!1),this.requestPlayerCompare(n)},controlBtnDisable:function(){if(C.gameInfo){cc.log("当前轮数："+C.gameInfo.curTurnNum);var e=C.gameInfo.curTurnNum==GameData.room.opts.maxTunNum,t=GameData.room.opts.chipsType?50:10;if(l.room.opts.currencyType==u.currencyType.Currency_Coin){var a=l.room.opts.scorelv,n=C.CoinChipConfig[a].length-2;t=C.getRoomCoinChipConfig(a)[n]}var i=C.playersArr.length-C.losersArr.length==2,o=parseInt(C.gameInfo.maxChipsValue)==t,r=cc.find("operationBtn3",this.operationBtns);r.getComponent(cc.Button).interactable=!e;var s=cc.find("operationBtn4",this.operationBtns);s.getComponent(cc.Button).interactable=!e&&!o;var c=cc.find("operationBtn2",this.operationBtns);e||i&&3<=C.gameInfo.curTurnNum||5<=C.gameInfo.curTurnNum?c.getComponent(cc.Button).interactable=!0:c.getComponent(cc.Button).interactable=!1}},continueClick:function(){(this.continueBtn.active=!1,this.mingPaiBtn.active=!1,v.instance.playAudioOther("button"),GameData.game.close)?cc.find("layer_summary",this.node).active=!0:GameNet.getInstance().request("room.roomHandler.ready",{},function(e){})},mingPaiClick:function(){v.instance.playAudioOther("button"),this.mingPaiBtn.node.active=!1,ZJHHandler.getInstance().requestPlayerMingPai()},allFollowClick:function(){v.instance.playAudioOther("button"),this.requestAutoFollow()},requestPlayerCheck:function(){inCD(2e3)||(v.instance.playAudioOther("button"),ZJHHandler.getInstance().requestPlayerCheck())},requestPlayerAddChips:function(e){this.isCheckPlayerCoin()||ZJHHandler.getInstance().requestPlayerAddChips(e)},requestPlayerGiveUp:function(){this.showSecondOperBtn(!1),ZJHHandler.getInstance().requestPlayerGiveUp()},requestPlayerFollowChips:function(){this.isCheckPlayerCoin()||(this.showSecondOperBtn(!1),ZJHHandler.getInstance().requestPlayerFollowChips())},requestAutoFollow:function(){var e=cc.find("checkBtn",this.allFollowBtn.node),t=cc.find("animation",this.allFollowBtn.node);e.active=!e.active,t.active=!t.active,this.isCheckPlayerCoin()||ZJHHandler.getInstance().requestAutoFollow(e.active)},requestPlayerCompare:function(e){this.isCheckPlayerCoin()||(this.showSecondOperBtn(!1),this.operationBtns.active=!1,ZJHHandler.getInstance().requestPlayerCompare(e))},getSpriteNameByCardId:function(e){var t=parseInt(e/100);return e-100*t+16*(t-1)},addChip:function(e,t){var a=e,n=GameData.getPlayerPosByUid(t),i=cc.instantiate(this.chipPrefab),o=this.playerNodes[n];i&&(i.getComponent("poker_chipPrefab").setChipImg(a),i.parent=this.chipsNode,i.x=o.x,i.y=o.y,i.active=!0,this.clipFlyToTableAnimation(i))},randomNum:function(e,t){var a=t-e,n=Math.random()*a+e;return parseInt(n,10)},saveAllPokerPosition:function(){this.allPokerPosArr=[];for(var e=0;e<this.pokersNode.childrenCount;e++){for(var t=[],a=this.pokersNode.children[e].getChildByName("style1"),n=0;n<a.childrenCount;n++)t.push(a.children[n].position);this.allPokerPosArr.push(t)}},savePokerData:function(){this.pokerArr=[],this.pokerPosArr=[];for(var e=C.playersArr,t=0;t<3;t++)for(var a=0;a<e.length;a++){var n=GameData.getPlayerPosByUid(e[a]),i=this.pokersNode.children[n].getChildByName("style1");this.pokerArr.push(i.children[t]),this.pokerPosArr.push(i.children[t].position)}cc.log("save Pokerdata finish!")},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},addPlayerStateImg:function(e,t,a,n){var i=t.getChildByName(t.name+"_"+e);null==i&&((i=cc.instantiate(this.playerStatePrefab)).parent=t,i.getComponent("poker_playerStateImgPrefab").setImg(e,a,n),i.name=t.name+"_"+e)},addNodeMask:function(e,t){var a=e.getChildByName(e.name+"mask");null==a&&(a=cc.instantiate(t),e.addChild(a),a.name=e.name+"mask")},setMingPaiData:function(e,t){var a=t.detail.uid,n=C.getPlayerPokerByUid(a),i=C.getPlayerPokerTypeByUid(a),o=cc.find("playerNode/headMask/headIcon",e),r=cc.find("playerNode/name",e),s=cc.find("pokerNode/pokers",e),c=cc.find("pokerNode/pokerTypeBg/pokerType",e),d=GameData.getPlayerByUid(a).headimgurl,h=GameData.getPlayerByUid(a).name;if(this.setHeadIcon(o,d),r.getComponent(cc.Label).string=getShortStr(h,4),n&&s)for(var l=0;l<s.childrenCount;l++)this.showPokerContent(s.children[l],n[l]);var u="resources/zjh/UI/artword/artword_"+i+".png";this.setNodeImg(c,u)},setPkData:function(e){var t=e.uid,a=e.otherId,n=cc.find("left/playerIcon",this.compareLayer),i=cc.find("right/playerIcon",this.compareLayer),o=cc.find("left/pokers",this.compareLayer),r=cc.find("right/pokers",this.compareLayer);if(t&&a){var s=GameData.getPlayerByUid(t).headimgurl,c=GameData.getPlayerByUid(a).headimgurl;this.setHeadIcon(n,s),this.setHeadIcon(i,c);for(var d=0;d<3;d++)this.setPkPokerImg(o.children[d],t,d),this.setPkPokerImg(r.children[d],a,d)}},setHeadIcon:function(e,t){var a=e.getComponent(cc.Sprite);null==t||""==t||t.length<=0?a.spriteFrame=null:cc.loader.load({url:t,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},setPkPokerImg:function(e,t,a){var n=0;if(C.getPlayerIsSeePokerByUid(t)){var i=C.getPlayerPokerByUid(t);i&&(n=i[a])}else n=0;this.showPokerContent(e,n)},setNodeImg:function(e,t){if(e){e.getComponent(cc.Sprite).spriteFrame=null;var a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}},moveAboutScore:function(e,t){var a=this;if(0!=t){var n=GameData.getPlayerPosByUid(e),i=this.playerNodes[n];if(i)var o=i.getChildByName("resultScore");var r=cc.moveBy(.5,cc.p(0,40));null==o&&i&&((o=cc.instantiate(this.scorePrefab)).getComponent("tdk-resultFlyScore").getScoreColor(t),cc.find("score",o).x+=20,o.name="resultScore",o.setTag(1e3),o.active=!0,i.addChild(o)),o&&o.runAction(r),this.scheduleOnce(function(){for(var e=0;e<a.playerNodes.length;e++){a.playerNodes[e].getChildByTag(1e3)&&a.playerNodes[e].removeChildByTag(1e3)}},1.5)}},resultChipsAnimation:function(e,t){var a=cc.moveTo(.4,t),n=cc.callFunc(function(){e.active=!1,e.destroy()},e);e.runAction(cc.sequence(a,n))},closePkLayer:function(){this.selectCompareNode.active=!1},refreshPlayerAllScore:function(){var e=l.getScoreData();l.room.opts.currencyType==u.currencyType.Currency_Coin&&(e=l.getPlayersCoin());for(var t=GameData.joiners,a=0;a<t.length;a++)if(t[a]){var n=GameData.getPlayerPosByUid(t[a].uid);if(this.playerNodes[n])this.playerNodes[n].getChildByName("headNode").getComponent("pokerRoomPlayer").setCoin(e[t[a].uid])}},refreshPoker:function(){var e=this.pokersNode.children[0].getChildByName("style1");if(C.getPlayerIsSeePokerByUid(GameData.player.uid))for(var t=C.getPlayerPokerByUid(GameData.player.uid),a=0;a<e.childrenCount;a++)this.showPokerContent(e.children[a],t[a])},isCheckPlayerCoin:function(){var e=GameData.player.coin,t=parseInt(C.gameInfo.maxChipsValue),a=!0;return C.getPlayerIsSeePokerByUid(GameData.player.uid)?e<2*t?(createMoveMessage("金币不足"),a=!0):a=!1:e<t?(createMoveMessage("金币不足"),a=!0):a=!1,a}});cc._RF.pop()},{SoundMngr:"SoundMngr","ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",pokerAnimationBase:"pokerAnimationBase",roomHandler:"roomHandler"}],ZJH_roomMain:[function(e,t,a){"use strict";cc._RF.push(t,"3fe1du58HlC2p5c1prVG1Uv","ZJH_roomMain");var n=e("SoundMngr"),i=e("gameDefine"),o=(e("configMgr"),e("ruleHandler")),r=e("roomHandler"),s=e("ZJH-RoomData");cc.Class({extends:cc.Component,properties:{waitLayer:cc.Node,tableLayer:cc.Node,resultLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,resultPrefab:cc.Prefab,summaryPrefab:cc.Prefab,dissolvePrefab:cc.Prefab,debugPrefab:cc.Prefab},onLoad:function(){scheduleLamp(this),this.initUIData(),this.initUIShow(),this.addUIResult(),this.addUISummary(),this.addUIDissolve(),this.addUIDebug(),this.setLayerShow(),this.registAllEvent(),GameData.game.onRoomDissolve&&0!=Object.keys(GameData.game.onRoomDissolve).length&&(cc.log("GameData.game.onRoomDissolve = "+JSON.stringify(GameData.game.onRoomDissolve)),sendEvent("onRoomDissolve",GameData.game.onRoomDissolve))},onDestroy:function(){unregistEvent("onRoomInfo",this,this.RoomInfoHandler),unregistEvent("onRoomQuit",this,this.onRoomQuit),unregistEvent("zhaJinHua-onGameStart",this,this.GameStartHandler),unregistEvent("onGameScore",this,this.GameScoreHandler),unregistEvent("onRoomDissolve",this,this.showDissolve),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onZhaJinHuaRoomEnd",this,this.showSummaryLayer)},registAllEvent:function(){registEvent("onRoomInfo",this,this.RoomInfoHandler),registEvent("onRoomQuit",this,this.onRoomQuit),registEvent("zhaJinHua-onGameStart",this,this.GameStartHandler),registEvent("onGameScore",this,this.GameScoreHandler),registEvent("onRoomDissolve",this,this.showDissolve),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onZhaJinHuaRoomEnd",this,this.showSummaryLayer)},initUIData:function(){cc.log("...room main init data."),o.instance.setGameType(GameData.client.gameType),this._curGameData=void 0,this.setCurGameData()},initUIShow:function(){this.resultLayer.active=!1,this.summaryLayer.active=!1,this.dissolveLayer.active=!1,this.setLayerShow()},setCurGameData:function(){r.getRoomData()},setLayerShow:function(){GameData.room.status>i.RoomState.WAIT?this.showTableLayer():this.showWaitLayer()},RoomInfoHandler:function(e){null!=e&&(r.onRoomInfoSetData(e.detail),this.setCurGameData(),this.setLayerShow(),this.addUISummary())},GameStartHandler:function(){this.setLayerShow()},GameScoreHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGameScoreSetData(e.detail),this.showResultLayer())},addUIResult:function(){var e=this.resultLayer.getChildByName("uiResult");null==e&&((e=cc.instantiate(this.resultPrefab)).parent=this.resultLayer,e.name="uiResult")},addUISummary:function(){var e=this.summaryLayer.getChildByName("uiSummary");null==e&&((e=cc.instantiate(this.summaryPrefab)).parent=this.summaryLayer,e.name="uiSummary")},addUIDissolve:function(){var e=this.dissolveLayer.getChildByName("uiDissolve");null==e&&((e=cc.instantiate(this.dissolvePrefab)).parent=this.dissolveLayer,e.name="uiDissolve",e.active=!0)},addUIDebug:function(){var e=this.debugLayer.getChildByName("uiDebug");null==e&&((e=cc.instantiate(this.debugPrefab)).parent=this.debugLayer,e.name="uiDebug",e.active=!1)},showWaitLayer:function(){r.room.opts.currencyType!=i.currencyType.Currency_Coin?this.waitLayer.active=!0:this.waitLayer.active=!1,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("zjh/sound/game_bgm")},showTableLayer:function(){this.showTableUI(!0),this.waitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("zjh/sound/game_bgm")},showTableUI:function(e){cc.log("...showTableUI:"+e),this.tableLayer.active=e},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showResultDirectly:function(){},showSettingLayer:function(e){sendEvent("runlamp"),openView("SettingsPanel")},showSummaryLayer:function(){var e=this,t=r.getRoomData();if(GameData.room.status==i.RoomState.WAIT)return GameData.player.roomid=void 0,GameData.joiners=[],GameData.game.onRoomDissolve=null,void cc.director.loadScene("home");null!=t&&(GameData.room.status==i.RoomState.READY?this.summaryLayer.active=!0:s.isCompare?this.scheduleOnce(function(){e.summaryLayer.active=!0},5):GameData.room.roundNum==GameData.room.opts.roundMax?this.scheduleOnce(function(){e.summaryLayer.active=!0},3):this.summaryLayer.active=!0,GameData.player.uid==t.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1))},showDissolve:function(){this.showdissolveLayer(1,1)},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showScoreLayer:function(){},showDebugLayer:function(){var e=this.debugLayer.getChildByName("uiDebug");e&&(e.active=!0)},showChat:function(){inCD(3e3)||openView("ChatPanel")},showJoinerLost:function(e){var t=e.detail.uid,a=GameData.getPlayerByUid(t).name;createMoveMessage("玩家["+a+"]掉线啦!")},showJoinerConnect:function(e){var t=e.detail.uid,a=GameData.getPlayerByUid(t).name;createMoveMessage("玩家["+a+"]重新连接!")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)},onRoomQuit:function(){s.initData()}}),cc._RF.pop()},{SoundMngr:"SoundMngr","ZJH-RoomData":"ZJH-RoomData",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],agentBindLayer:[function(e,t,a){"use strict";cc._RF.push(t,"049510b5oZD4btLrFJE6y1H","agentBindLayer");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{EditBox:cc.EditBox,jlNum:cc.Label},onLoad:function(){this.jlNum.string="5"},agentBindClick:function(){n.instance.playAudioOther("button");var e=this.EditBox.getComponent(cc.EditBox).string;ClubHandler.getInstance().reqBindAgent(GameData.player.uid,e)}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],agentPanel:[function(e,t,a){"use strict";cc._RF.push(t,"713a1Ay7OBJa651mIbyQ7Vc","agentPanel");var k=e("SoundMngr"),i=e("roomHandler"),o=e("gameDefine");cc.Class({extends:cc.Component,properties:{kaifangBtn:cc.Node,kaifangLb:cc.Node,jiesuanBtn:cc.Node,jiesuanLb:cc.Node,roomState:cc.Label,kaifangNode:cc.ScrollView,jiesuanNode:cc.ScrollView,ScrollItem:cc.Node,jiesuanItem:cc.Node,dissolveLayer:cc.Node,infoLayer:cc.Node,fonts:{default:[],type:cc.Font}},onLoad:function(){this.registerListener(),this.refreshUINew(),this.refreshUIResult()},registerListener:function(){registEvent("refreshAgentRoomUINew",this,this.refreshUINew),registEvent("refreshAgentRoomUIResult",this,this.refreshUIResult)},onDestroy:function(){unregistEvent("refreshAgentRoomUINew",this,this.refreshUINew),unregistEvent("refreshAgentRoomUIResult",this,this.refreshUIResult)},refreshUINew:function(){cc.log("GameData.AgentRoomsData:"+JSON.stringify(GameData.AgentRoomsData));for(var e=this.kaifangNode.content,t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}if(!(null==GameData.AgentRoomsData||Object.keys(GameData.AgentRoomsData).length<=0)){var n=Object.keys(GameData.AgentRoomsData).length,i=parseInt(n/3)*this.ScrollItem.height;1<=n%3&&(i+=this.ScrollItem.height),i<550&&(i=550),e.height=i;var o=0;for(var r in GameData.AgentRoomsData){var s=GameData.AgentRoomsData[r];if(null!=s){var c=e.getChildren()[o];c||((c=cc.instantiate(this.ScrollItem)).parent=e,c.x=this.ScrollItem.x+this.ScrollItem.width*(o%3),c.y=this.ScrollItem.y-this.ScrollItem.height*parseInt(o/3)),c.active=!0,this.initItemChildNode(c,s),o++}}}},refreshUIResult:function(){for(var e=this.jiesuanNode.content,t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}if(!(null==GameData.AgentResultRoom||Object.keys(GameData.AgentResultRoom).length<=0)){var n=Object.keys(GameData.AgentResultRoom).length*this.jiesuanItem.height;n<550&&(n=550),e.height=n;var i=0;for(var o in GameData.AgentResultRoom){var r=GameData.AgentResultRoom[o];if(null!=r){var s=e.getChildren()[i];s||((s=cc.instantiate(this.jiesuanItem)).parent=e,s.y=this.jiesuanItem.y-this.jiesuanItem.height*i),s.active=!0,this.initJSItemChildNode(s,r),i++}}}},initItemChildNode:function(e,t){if(null!=e&&null!=t){var a=t.roomid,n=cc.find("inviteBtn",e),i=cc.find("dissolveBtn",e),o=cc.find("infoBtn",e),r=cc.find("roomTypeSprite",e),s=cc.find("gameTypeSprite",e),c=cc.find("roomId",e),d=cc.find("roomState",e);c.getComponent("cc.Label").string=a;var h="",l=new cc.Color(254,48,0),u=!0;if(null!=t.players){var m,p,g,f;Object.keys(t.players).length<=0?h="未开始":0<Object.keys(t.players).length&&Object.keys(t.players).length<t.opts.joinermax?(h="等待中",l=new cc.Color(0,53,49)):Object.keys(t.players).length==t.opts.joinermax&&(h="进行中",l=new cc.Color(0,53,49),u=!1),d.getComponent("cc.Label").string=h,d.color=l,i.active=u,m=this.getGameTypeImageUrl(t.opts.gameType),(p=cc.textureCache.addImage(cc.url.raw(m)))&&(s.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(p)),m=this.getRoomTypeImageUrl(t.opts.roomType),cc.log("...roomType:"+t.opts.roomType),cc.log("...textureUrl:"+m),(p=cc.textureCache.addImage(cc.url.raw(m)))&&(r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(p));for(var y=1;y<=6;y++)(g=cc.find("playerNode/player_"+y,e))&&(g.active=!1),(f=cc.find("playerNode/headBgs/headBg"+y,e))&&(f.active=!1);for(var v=1;v<=t.opts.joinermax;v++)(f=cc.find("playerNode/headBgs/headBg"+v,e))&&(f.active=!0);var C=1;for(var D in t.players){var _=t.players[D];if(_){if(g=cc.find("playerNode/player_"+C,e)){g.active=!0;var G=cc.find("playerHead",g),w=_.headimgurl;this.setPlayerHead(G,w)}C++}}n.setTag(a),n.on(cc.Node.EventType.TOUCH_END,this.inviteClick,this),i.setTag(a),i.on(cc.Node.EventType.TOUCH_END,this.dissolveClick,this),o.setTag(a),o.on(cc.Node.EventType.TOUCH_END,this.infoClick,this)}}},initJSItemChildNode:function(e,t){if(null!=e&&null!=t){cc.log("..jiesuanData:"+JSON.stringify(t));var a=t.roomid,n=cc.find("shareBtn",e),i=cc.find("roomId",e),o=cc.find("createtime",e),r=cc.find("gametype",e),s=cc.find("roomrule",e);n.setTag(a),n.on(cc.Node.EventType.TOUCH_END,this.shareClick,this),i.getComponent(cc.Label).string="房间号:"+a;var c=new Date(t.createtime),d=c.getFullYear(),h=c.getMonth()+1,l=c.getDate(),u=c.getHours();u<10?u="0"+u+":":u+=":";var m,p,g,f=c.getMinutes();f=f<10?"0"+f:f,o.getComponent(cc.Label).string=d+"-"+h+"-"+l+"  "+u+f,s.getComponent(cc.Label).string=this.getRoomRule(t.opts),m=this.getGameTypeImageUrl(t.opts.gameType),(p=cc.textureCache.addImage(cc.url.raw(m)))&&(r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(p));for(var y=1;y<=6;y++)(g=cc.find("playerNode/player_"+y,e))&&(g.active=!1);var v=1;for(var C in t.players){var D=t.players[C];if(D){if(g=cc.find("playerNode/player_"+v,e)){g.active=!0;var _=cc.find("score",g),G=cc.find("name",g),w=this.getSumScore(t,D.uid);0<w?(_.getComponent(cc.Label).font=this.fonts[0],_.getComponent(cc.Label).string="+"+w):(_.getComponent(cc.Label).font=w<0?this.fonts[1]:this.fonts[2],_.getComponent(cc.Label).string=w),isChinese(D.name)?G.getComponent(cc.Label).string=getShortStr(D.name,4):G.getComponent(cc.Label).string=getShortStr(D.name,8)}v++}}}},setPlayerHead:function(a,e){null!=e&&""!=e&&0<e.length&&cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},getSumScore:function(e,t){var a=0;for(var n in e.scores)n==t&&(a=e.scores[n]);return a},getGameTypeImageUrl:function(e){var t="resources/createroom/agentInfo/majiangzi.png";switch(e){case o.GameType.Game_Mj_Tianjin:case o.GameType.Game_Mj_Shishi:case o.GameType.Game_MJ_HuaDian:t="resources/createroom/agentInfo/majiangzi.png";break;case o.GameType.Game_Poker_DDZ:case o.GameType.Game_Poker_TianjinDDZ:t="resources/createroom/agentInfo/doudizhuzi.png";break;case o.GameType.Game_Poker_13shui:t="resources/createroom/agentInfo/shisanshuizi.png";break;case o.GameType.Game_niu_niu:t="resources/createroom/agentInfo/liurenniuniu.png";break;case o.GameType.Game_Niu_Niu_10:t="resources/createroom/agentInfo/shirenniuniu.png";break;case o.GameType.Game_TDK:t="resources/createroom/agentInfo/tiandakengzi.png";break;case o.GameType.Game_Poker_paodekuai:t="resources/createroom/agentInfo/paodeikuaizi.png";break;case o.GameType.Game_Poker_ZJH:t="resources/createroom/agentInfo/zhajinhuazi.png"}return t},getRoomTypeImageUrl:function(e){var t="resources/createroom/agentInfo/putongzi.png";switch(e){case 1:t="resources/createroom/agentInfo/putongzi.png";break;case 2:t="resources/createroom/agentInfo/julebuzi.png"}return t},getRoomRule:function(e){var t="";if(null==e||Object.keys(e).length<=0)return t;switch(e.gameType){case o.GameType.Game_Mj_Tianjin:t=getRoomRuleStr(e);break;case o.GameType.Game_Mj_Shishi:t=getRuleStrShiShi(e);break;case o.GameType.Game_MJ_HuaDian:t=getRuleStrHd(e);break;case o.GameType.Game_Mj_HZ:t=getRuleStrHongZhong(e);break;case o.GameType.Game_Mj_CC:t=getRuleStrCC(e);break;case o.GameType.Game_Poker_TianjinDDZ:t=getRuleStrTJDDZ(e);break;case o.GameType.Game_Poker_DDZ:t=getRuleStrDDZ(e);break;case o.GameType.Game_niu_niu:case o.GameType.Game_Niu_Niu_10:t=getRuleStrNiuNiu(e);break;case o.GameType.Game_TDK:t=getRuleStrTDK(e);break;case o.GameType.Game_Poker_13shui:t=getRuleStr13(e);break;case o.GameType.Game_Poker_paodekuai:t=getRuleStrPDK(e);break;case o.GameType.Game_Poker_ZJH:t=getRuleStrZJH(e)}return t},getInviteStr:function(e){var t=e.roomid,a="";switch(e.opts.gameType){case o.GameType.Game_Mj_Tianjin:a="天津攒局麻将 (代开)房间号:"+t;break;case o.GameType.Game_Mj_Shishi:a="石狮摸摸麻将 (代开)房间号:"+t;break;case o.GameType.Game_MJ_HuaDian:a="摸摸桦甸麻将 (代开)房间号:"+t;break;case o.GameType.Game_Mj_HZ:a="红中麻将 (代开)房间号:"+t;break;case o.GameType.Game_Mj_CC:a="长春麻将 (代开)房间号:"+t;break;case o.GameType.Game_Poker_DDZ:a="经典斗地主 (代开)房间号:"+t;break;case o.GameType.Game_Poker_TianjinDDZ:a="天津斗地主 (代开)房间号:"+t;break;case o.GameType.Game_niu_niu:a="拼十(6人) (代开)房间号:"+t;break;case o.GameType.Game_Niu_Niu_10:a="拼十(10人) (代开)房间号:"+t;break;case o.GameType.Game_TDK:a="填大坑 (代开)房间号:"+t;break;case o.GameType.Game_Poker_13shui:a="十三水 (代开)房间号:"+t;break;case o.GameType.Game_Poker_paodekuai:a="跑得快 (代开)房间号:"+t;break;case o.GameType.Game_Poker_ZJH:a="三张牌 (代开)房间号:"+t}cc.log("...opts:"+JSON.stringify(e.opts));var n="玩法:"+this.getRoomRule(e.opts)+",请您快速加入对局.";return console.log("des = "+n),{title:a,des:n}},selectUIType:function(e,t){k.instance.playAudioOther("button");var a=!1;1==t&&(a=!0),this.kaifangLb.active=a,this.kaifangBtn.active=!a,this.jiesuanLb.active=!a,this.jiesuanBtn.active=a,this.kaifangNode.node.active=a,this.jiesuanNode.node.active=!a},joinRoomClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag.toString();console.log("加入房间号为："+t),t&&6<=t.length&&i.enterRoom(t)},shareClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag;console.log("分享房间号："+t)},inviteClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag;console.log("邀请好友,房间号："+t);var a=GameData.getAgentRoomDataByRoomid(t);if(null!=a){var n=this.getInviteStr(a);cc.sys.localStorage.setItem("selfAgentRoomId",t),wxShareCommond(n.title+n.des)}},dissolveClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag;if(!(t<=0)){this.dissolveLayer.active=!0;var a=cc.find("text",this.dissolveLayer),n=cc.find("btnAgree",this.dissolveLayer),i=cc.find("btnDisagree",this.dissolveLayer);a.getComponent(cc.Label).string="确定要解散房间"+t+"吗？",n.setTag(t),n.on(cc.Node.EventType.TOUCH_END,this.confirmDissolveClick,this),i.on(cc.Node.EventType.TOUCH_END,this.cancelDissolveClick,this)}},confirmDissolveClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag;console.log("解散房间："+t);var a=GameData.getAgentRoomDataByRoomid(t);if(null!=a&&null!=a){var n=!1;Object.keys(a.players).length<=0&&(i.deleteRoom(t,"close"),n=!0),this.dissolveLayer.active=!1,this.showDissolveRoomTip(n)}},cancelDissolveClick:function(){k.instance.playAudioOther("button"),this.dissolveLayer.active=!1},infoClick:function(e){k.instance.playAudioOther("button");var t=e.target.tag;console.log("查看房间："+t);var a=GameData.getAgentRoomDataByRoomid(t);if(null!=a&&null!=a){this.infoLayer.active=!0;var n=cc.find("panel/roomType",this.infoLayer),i=cc.find("panel/gameType",this.infoLayer),o=cc.find("panel/roomId",this.infoLayer),r=cc.find("panel/createTime",this.infoLayer),s=cc.find("panel/clubLabel",this.infoLayer),c=cc.find("panel/club",this.infoLayer),d=cc.find("panel/agent",this.infoLayer),h=cc.find("panel/rule",this.infoLayer),l=cc.find("panel/playerNode",this.infoLayer);o.getComponent(cc.Label).string="房间号:"+t;var u=new Date(a.createtime),m=u.getFullYear(),p=u.getMonth()+1,g=u.getDate(),f=u.getHours();f<10?f="0"+f+":":f+=":";var y,v,C,D,_=u.getMinutes();_=_<10?"0"+_:_,r.getComponent(cc.Label).string=m+"-"+p+"-"+g+"  "+f+_,2==a.opts.roomType?(s.active=!0,c.active=!0,c.getComponent(cc.Label).string=GameData.player.club.clubName):(s.active=!1,c.active=!1),d.getComponent(cc.Label).string="代理(ID):"+a.creator,h.getComponent(cc.Label).string=this.getRoomRule(a.opts),y=this.getGameTypeImageUrl(a.opts.gameType),(v=cc.textureCache.addImage(cc.url.raw(y)))&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(v)),y=this.getRoomTypeImageUrl(a.opts.roomType),(v=cc.textureCache.addImage(cc.url.raw(y)))&&(n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(v));for(var G=1;G<=6;G++)(C=cc.find("player_"+G,l))&&(C.active=!1),(D=cc.find("headBgs/headBg"+G,l))&&(D.active=!1);for(var w=1;w<=a.opts.joinermax;w++)(D=cc.find("headBgs/headBg"+w,l))&&(D.active=!0);var S=1;for(var T in a.players){var N=a.players[T];if(N){if(C=cc.find("player_"+S,l)){C.active=!0;var b=cc.find("playerHead",C),R=N.headimgurl;this.setPlayerHead(b,R);var P=cc.find("nameLabel",C);isChinese(N.name)?P.getComponent(cc.Label).string=getShortStr(N.name,4):P.getComponent(cc.Label).string=getShortStr(N.name,8)}S++}}}},closeInfoLayer:function(){k.instance.playAudioOther("button"),this.infoLayer.active=!1},refreshDataClick:function(){inCD(3e3)||(k.instance.playAudioOther("button"),i.reqAgentRoom(),i.reqAgentResultRoom())},showDissolveRoomTip:function(e){var t="解散房间成功。";0==e&&(t="房间已有人进入，不能解散！"),createMessageBox(t,function(){i.reqAgentRoom(),i.reqAgentResultRoom()})},close:function(){k.instance.playAudioOther("button"),closeView(this.node.name)}});cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],appstore:[function(e,t,a){"use strict";cc._RF.push(t,"553eeBeYnlGuK+1jfw/QKWG","appstore");var n=e("gameDefine"),i={areaType:n.AreaType.Area_TianJin,serverIP:"116.62.203.138",serverPort:3910,gameName:"天津攒局麻将",versionText:"审批文号：新广出审[2017]10415号  出版物号：ISBN978-7-498-03201-0  出版单位：天津电子出版社有限公司",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rytianjinmajiang",wxWelcomeText:"还等嘛!我在天津攒局麻将等你!",loginLogo:"resources/login/cuanjumajiang.png",Poster:["resources/poster/tianjin/poster_tianjin_1.png"],GameVisible:[n.GameType.Game_Mj_Tianjin,n.GameType.Game_MJ_HuaDian,n.GameType.Game_Mj_CC,n.GameType.Game_Mj_Heb,n.GameType.Game_Poker_DDZ,n.GameType.Game_Poker_TianjinDDZ,n.GameType.Game_TDK,n.GameType.Game_niu_niu,n.GameType.Game_Poker_paodekuai],ModeType:{Game_Mj_Tianjin:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_MJ_HuaDian:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Mj_CC:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Mj_Heb:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_niu_niu:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_TianjinDDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]}},SetCardsOpen:!1,MatchGameType:[n.GameType.Game_Mj_Tianjin,n.GameType.Game_MJ_HuaDian,n.GameType.Game_TDK,n.GameType.Game_Poker_TianjinDDZ,n.GameType.Game_Mj_CC,n.GameType.Game_Mj_Heb,n.GameType.Game_Poker_DDZ],serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[5e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[0,0,0],enter:[2e3,15e3,1e4]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[0,0,0],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[0,0,0],enter:[2e3,15e3,1e4]}},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:1,enter:[20,50,100],perround:5},{name:"8局",roundType:1,roundMax:8,cost:2,enter:[40,100,200],perround:5},{name:"16局",roundType:1,roundMax:16,cost:4,enter:[80,200,400],perround:5},{name:"1圈",roundType:2,roundMax:1,cost:1,enter:[20,50,100],perround:5},{name:"2圈",roundType:2,roundMax:2,cost:2,enter:[40,100,200],perround:5},{name:"4圈",roundType:2,roundMax:4,cost:4,enter:[80,200,400],perround:5}],8:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}],102:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}]},roomCard:{1:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:0}}},2:{name:"8局",cost:{2:{final:0},3:{final:0},4:{final:0}}},3:{name:"16局",cost:{2:{final:0},3:{final:0},4:{final:0}}},4:{name:"1圈",cost:{2:{final:0},3:{final:0},4:{final:0}}},5:{name:"2圈",cost:{2:{final:0},3:{final:0},4:{final:0}}},6:{name:"4圈",cost:{2:{final:0},3:{final:0},4:{final:0}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:0}}},2:{name:"8局",cost:{2:{final:0},3:{final:0},4:{final:0}}},3:{name:"16局",cost:{2:{final:0},3:{final:0},4:{final:0}}},4:{name:"1课/50分",cost:{2:{final:0},3:{final:0},4:{final:0}}},5:{name:"1课/100分",cost:{2:{final:0},3:{final:0},4:{final:0}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},8:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}},9:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:0}}},2:{name:"8局",cost:{2:{final:0},3:{final:0},4:{final:0}}},3:{name:"16局",cost:{2:{final:0},3:{final:0},4:{final:0}}}},10:{61:{name:"4局",cost:{2:{final:0}}},62:{name:"8局",cost:{2:{final:0}}},63:{name:"16局",cost:{2:{final:0}}},64:{name:"1圈",cost:{4:{final:0}}},65:{name:"2圈",cost:{4:{final:0}}},66:{name:"4圈",cost:{4:{final:0}}}},11:{10:{name:"10局",cost:{2:{final:0},3:{final:0}}},20:{name:"20局",cost:{2:{final:0},3:{final:0}}},30:{name:"30局",cost:{2:{final:0},3:{final:0}}}},13:{1:{name:"4局",cost:{2:{final:0}}},2:{name:"8局",cost:{2:{final:0}}},3:{name:"16局",cost:{2:{final:0}}},64:{name:"1圈",cost:{4:{final:0}}},65:{name:"2圈",cost:{4:{final:0}}},66:{name:"4圈",cost:{4:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],cardActionView:[function(e,t,a){"use strict";cc._RF.push(t,"c98c5Vvo41JyYvqqGZA+OSe","cardActionView");var l=e("gameConfig");cc.Class({extends:cc.Component,properties:{spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.onEnable),registEvent("onGamePass",this,this.setActionData),registEvent("onGameAction",this,this.setActionData),registEvent("onCardChi",this,this.handleCardChi),registEvent("onCardPeng",this,this.handleCardPeng),registEvent("onCardGang",this,this.handleCardGang),registEvent("onCardHu",this,this.handleCardHu)},onDestroy:function(){unregistEvent("onGameStart",this,this.onEnable),unregistEvent("onGamePass",this,this.setActionData),unregistEvent("onGameAction",this,this.setActionData),unregistEvent("onCardChi",this,this.handleCardChi),unregistEvent("onCardPeng",this,this.handleCardPeng),unregistEvent("onCardGang",this,this.handleCardGang),unregistEvent("onCardHu",this,this.handleCardHu)},onEnable:function(){this.actions=[],this.spineNode.active=!1,this.setActionData()},setActionData:function(){this.actions=[];for(var e=l.getGameData().getPassActionsData(),t=e.action.length,a=e.fromCard,n="",i=-1,o=0;o<t;++o){var r=e.action[o],s=r.act,c=r.cards,d=l.getActionData(s);if(n!=d.type&&(n=d.type,this.actions[++i]={type:d.type,actionData:[]}),null!=c&&c[0]instanceof Array)for(var h=0;h<c.length;++h)this.actions[i].actionData.push({act:s,fromCard:a,cards:c[h]});else this.actions[i].actionData.push(r)}console.log("actions Data:"+JSON.stringify(this.actions)),this.showActions()},showActions:function(){for(var e=1;e<=4;++e)if(e<=this.actions.length){var t=this.actions[e-1],a=l.getActionData(t.actionData[0].act);this.createActionBtn(e,a.icon)}else{cc.find("btnAct"+e,this.actionLayer).active=!1}this.actionLayer.active=0<this.actions.length},showActionsSecondary:function(){var e=cc.find("card",this.actionSecondaryLayer),t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren(),this.actionSecondaryLayer.active=!0;var a=this.actions[this.selectAction].actionData;console.log("actions Secondary Data:"+JSON.stringify(a));for(var n=0;n<a.length;n++){var i=a[n],o=cc.instantiate(e);o.name=n+"",o.active=!0,o.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(o);var r=i.cards.concat(i.fromCard);r.sort(function(e,t){return e-t});for(var s=0;s<r.length;s++){var c=cc.find("card_"+s,o);if(null!=c){var d="resources/mjcard2d/mj_face_xia_shou_"+r[s]+".png",h=cc.textureCache.addImage(cc.url.raw(d));c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h)}}}},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){var t=this,a=e.target.name,n=this.actions[this.selectAction].actionData[a];console.log("actions Secondary Clicked Data:"+JSON.stringify(n));var i=l.getActionData(n.act);l.getGameProtocol()[i.request_fn](n,function(e){0==e.result&&showSpineEffect(t.spineNode,i.spine,i.animate)}),this.moveBackMyCards(),this.actionSecondaryLayer.active=!1},createActionBtn:function(e,t){var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw(t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){var a=this,n=this.actions[t].actionData;if(console.log("actions Clicked Data:"+JSON.stringify(n)),1<n.length)this.selectAction=t,this.showActionsSecondary();else if(1==n.length){var i=n[0],o=l.getActionData(i.act);l.getGameProtocol()[o.request_fn](i,function(e){0==e.result&&showSpineEffect(a.spineNode,o.spine,o.animate)})}this.moveBackMyCards(),this.actionLayer.active=!1},onBtnPassClicked:function(e){l.getGameData().getGameInfoData().turn!=GameData.player.uid&&l.getGameProtocol().requestPass(function(e){}),this.moveBackMyCards(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1},handleCardChi:function(e){var t=e.detail.player;if(t!=GameData.player.uid){var a=GameData.getPlayerPosByUid(t);this.playActionAnimation(a,"chi"),console.log("playActionAnimation uid:%d %s chi",t,a)}},handleCardPeng:function(e){var t=e.detail.player;if(t!=GameData.player.uid){var a=GameData.getPlayerPosByUid(t);this.playActionAnimation(a,"peng"),console.log("playActionAnimation uid:%d %s peng",t,a)}},handleCardGang:function(e){var t=e.detail.player;if(t!=GameData.player.uid){var a=GameData.getPlayerPosByUid(t);this.playActionAnimation(a,"gang"),console.log("playActionAnimation uid:%d %s gang",t,a)}},handleCardHu:function(e){var t=e.detail.player;if(t!=GameData.player.uid){var a=GameData.getPlayerPosByUid(t);this.playActionAnimation(a,"hu"),console.log("playActionAnimation uid:%d %s hu",t,a)}},playActionAnimation:function(e,t){console.log("playActionAnimation %s %s",e,t);var a=cc.find("actionAnimations/"+e,this.node);null!=a&&a.getComponent(cc.Animation).play(t)},moveBackMyCards:function(){}}),cc._RF.pop()},{gameConfig:"gameConfig"}],cardBtnView:[function(e,t,a){"use strict";cc._RF.push(t,"a01bfVwUwFC5Lyp2pqW7gCM","cardBtnView");var n=e("gameConfig"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{cardId:0,index:0,_isPlay:!1,_isMove:!1,_initPos:void 0,_firstMovePos:void 0},onLoad:function(){registEvent("AllHandCardRestoration",this,this.cardRestoration),this.node.parent&&(this._initPos=this.node.parent.position),this.setTouchOn()},onDestroy:function(){unregistEvent("AllHandCardRestoration",this,this.cardRestoration)},onEnable:function(){this._isPlay=!1,this._isMove=!1,this._firstMovePos=void 0},setTouchOn:function(){this.node.interactable=!0,this.node.on(cc.Node.EventType.TOUCH_START,this.onBtnStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onBtnMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onBtnEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onBtnCancel,this)},setTouchOff:function(){this.node.interactable=!1,this.node.off("touchstart",this.onBtnStart,this),this.node.off("touchmove",this.onBtnMove,this),this.node.off("touchend",this.onBtnEnd,this),this.node.off("touchcancel",this.onBtnCancel,this)},getCardId:function(){return this.cardId},setCardId:function(e){this.cardId=e},getIndex:function(){return this.index},setIndex:function(e){this.index=e},cardRestoration:function(){null!=this._initPos&&(this._isPlay=!1,this.node.parent.setPosition(this._initPos))},cardUpspring:function(){null!=this._initPos&&(this._isPlay=!0,this.node.parent.setPositionY(this._initPos.y+30))},onBtnStart:function(e){i.instance.playAudioOther("card_click"),n.getGameData().getGameInfoData().turn==GameData.player.uid&&(this._firstMovePos=e.touch.getLocation())},onBtnMove:function(e){if(n.getGameData().getGameInfoData().turn==GameData.player.uid){var t=e.touch.getLocation(),a=this.node.parent;(20<=Math.abs(t.x-this._firstMovePos.x)||20<=Math.abs(t.y-this._firstMovePos.y))&&(this._isMove=!0),1==this._isMove&&a.setPosition(a.parent.convertToNodeSpaceAR(t))}},onBtnEnd:function(e){if(n.getGameData().getGameInfoData().turn==GameData.player.uid){var t=this.node.parent;1==this._isMove&&(t.getPositionY()<100?this._isPlay=!1:this._isPlay=!0),this.playCard(),this._isMove=!1}},onBtnCancel:function(e){n.getGameData().getGameInfoData().turn==GameData.player.uid&&(this.cardRestoration(),sendEvent("onSelectCard",0))},playCard:function(){var e=this.getCardId();this.node.parent;if(1==this._isPlay){if(n.getGameData().getGameInfoData().turn==GameData.player.uid){n.getGameProtocol().requestDisCard(e,function(){sendEvent("onSelectCard",0)})}}else sendEvent("AllHandCardRestoration"),sendEvent("onSelectCard",e),this.cardUpspring()}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameConfig:"gameConfig"}],cardTemplate:[function(e,t,a){"use strict";cc._RF.push(t,"082053TUvdGdqmdJhKOb/0j","cardTemplate"),cc.Class({extends:cc.Component,properties:{id:0,index:0,bottom:cc.Sprite,icon:cc.Sprite,huier:cc.Sprite,btn:cc.Button},onLoad:function(){},setId:function(e){this.id=e},setIndex:function(e){this.index=e},setIcon:function(e){if(""===e)this.icon.node.active=!1;else{var t=cc.textureCache.addImage(cc.url.raw(e));this.icon.spriteFrame=new cc.SpriteFrame(t),this.icon.node.active=!0}},setHuier:function(e){var t=cc.textureCache.addImage(cc.url.raw(e));this.huier.spriteFrame=new cc.SpriteFrame(t);var a=new cc.Node;this.node.addChild(a),a.y=48;var n=cc.textureCache.addImage(cc.url.raw("resources/table/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},setBottom:function(e){},enableButton:function(e){this.btn.node.active=e},onBtnClicked:function(e){sendEvent("onHandCardClicked",{card:this.id,index:this.index})}}),cc._RF.pop()},{}],"cardTest-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"fea0fK7NcRBDYhTVWSaBlLb","cardTest-shishi"),cc.Class({extends:cc.Component,properties:{parents:{default:[],type:cc.Node}},onLoad:function(){}}),cc._RF.pop()},{}],cardTest:[function(e,t,a){"use strict";cc._RF.push(t,"e63f6TutMROuJn8oCgWjmRi","cardTest"),cc.Class({extends:cc.Component,properties:{parents:{default:[],type:cc.Node}},onLoad:function(){}}),cc._RF.pop()},{}],cardsView:[function(e,t,a){"use strict";cc._RF.push(t,"f9858uI4DlDlZfACLJthvcJ","cardsView");var y=e("gameConfig"),g=e("roomHandler");cc.Class({extends:cc.Component,properties:{play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,disCardArrow:cc.Prefab,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab},onLoad:function(){registEvent("onGameInfo",this,this.showCards),registEvent("onGameScore",this,this.showResult),registEvent("onSelectCard",this,this.onSelectCard)},onDestroy:function(){unregistEvent("onGameInfo",this,this.showCards),unregistEvent("onGameScore",this,this.showResult),unregistEvent("onSelectCard",this,this.onSelectCard)},onEnable:function(){this.play_layer_up.active=!1,this.play_layer_left.active=!1,this.play_layer_right.active=!1,this._cardArrow=cc.instantiate(this.disCardArrow),this._cardArrow.active=!1,this.showCards()},showCards:function(){var e=y.getGameData();for(var t in e.cards){var a=e.cards[t],n=e.game.obtain;this.showMyHandCards(t,a.hand,n),this.showHandCards(t,a.handnum),this.showUsedCards(t,a.chi,a.peng,a.gang),this.showDisCards(t,a.dis)}},showMyHandCards:function(e,t,a){if(e==GameData.player.uid){var n=cc.find("cardHand",this.play_layer_down);if(null!=n){var i=y.getGameRule(),o=!0,r=[],s=[];0<a&&r.push(a);for(var c=t.length-1;0<=c;--c){var d=t[c];o&&d==a?o=!1:i.isWildCard(d)?s.push(d):r.push(d)}r=r.concat(s);for(var h=GameData.client.handsize,l=0,u=0,m=r.length;l<=h;++l){var p=cc.find("cardHand"+l,n);if(0==l?(p.active=m%3==2,m=m%3==2?m-1:m):p.active=l<=m,p.active){var g=r[u++];this.showCardContent(p,g,"mj_face_xia_shou"),this.setCardButton(p,g,l),this.setWildVisible(p,g,"down")}}n.active=!0}}},showHandCards:function(e,t){if(e!=GameData.player.uid){var a=this["play_layer_"+GameData.getPlayerPosByUid(e)];if(null!=a){var n=cc.find("cardHand",a);if(null!=n){var i=cc.find("cardHand0",n),o=e==y.getGameData().getGameInfoData().turn;t=(i.active=o)?t-1:t;for(var r=GameData.client.handsize,s=1;s<=r;++s){cc.find("cardHand"+s,n).active=s<=t}n.active=!0,a.active=!0}}}},showUsedCards:function(e,t,a,n){var i=parseInt(GameData.client.handsize/3),o=[].concat(n,a,t),r=GameData.getPlayerPosByUid(e),s=this["play_layer_"+r];if(null!=s){var c=cc.find("cardPeng",s);if(null!=c)for(var d=this.getCardImgStr(r),h=y.getGameRule(),l=0;l<i;++l){var u=cc.find("cardPeng"+(l+1),c);if(null!=u&&(u.active=l<o.length,!(l>=o.length))){var m=o[l].cards;m.sort(function(e,t){return e-t});for(var p=0;p<4;++p){var g=u.getChildByName("card_face"+(p+1));if(p<m.length){var f=m[p];this.showCardContent(g,f,d),3==p&&1==h.isWildCard(f)&&this.addHuierIcon(g,r),g.active=!0}else g.active=!1}5==m.length?(u.getChildByName("card_face4").active=!1,u.getChildByName("card_back4").active=!0):u.getChildByName("card_back4").active=!1}}}},showDisCards:function(e,t){var a=GameData.getPlayerPosByUid(e),n=g.getRoomData().opts.joinermax,i=this["play_layer_"+a];if(null!=i){var o=cc.find("cardDis_4",i);o&&(o.active=!1);var r=cc.find("cardDis_3",i);r&&(r.active=!1);var s=cc.find("cardDis_2",i);s&&(s.active=!1);var c=cc.find("cardDis_"+n,i);c.active=!0;for(var d=this.getCardImgStr(a),h=y.getGameData().getGameInfoData().lastdisUid,l=y.getGameData().getGameInfoData().lastdisCard,u=1;u<=c.childrenCount;u++){var m=cc.find("card_face"+u,c);if(u<=t.length){var p=t[u-1];m.active=!0,this.showCardContent(m,p,d),e==h&&p==l&&(this._cardArrow.active=!0,this._cardArrow.parent=m,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==a,cc.find("down",this._cardArrow).active="down"==a,cc.find("right",this._cardArrow).active="right"==a,cc.find("up",this._cardArrow).active="up"==a)}else m.active=!1}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=t);var i="resources/mjcard2d/"+a+"_"+t+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},setCardButton:function(e,t,a){var n=e.getChildByName(e.name+"_button");null==n&&((n=cc.instantiate(this.cardButtonPrefab)).name=e.name+"_button",e.addChild(n));var i=n.getComponent("cardBtnView");i.setCardId(t),i.setIndex(a),i.cardRestoration()},setWildVisible:function(e,t,a){var n=y.getGameRule().isWildCard(t),i=e.getChildByName(e.name+"_huier");null==i?n&&(i=cc.instantiate(this.cardHuierPrefab),cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0,i.y=i.y-18,e.addChild(i),i.name=e.name+"_huier"):i.active=n},onSelectCard:function(e){var t=e.detail,a=GameData.getPlayerByPos("up");a&&(this.showPengCardMask(t,this.play_layer_up,"up"),this.showDisCardMask(t,this.play_layer_up,"up")),(a=GameData.getPlayerByPos("down"))&&(this.showPengCardMask(t,this.play_layer_down,"down"),this.showDisCardMask(t,this.play_layer_down,"down")),(a=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(t,this.play_layer_left,"left"),this.showDisCardMask(t,this.play_layer_left,"left")),(a=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(t,this.play_layer_right,"right"),this.showDisCardMask(t,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=cc.find("cardPeng",t),i=1;i<=n.childrenCount;i++){var o=cc.find("cardPeng"+i,n);if(null!=o&&o.active)for(var r=1;r<5;r++){var s=cc.find("card_face"+r,o);s.active&&this.gotoMask(s,e,a)}}},showDisCardMask:function(e,t,a){var n=cc.find("cardDis_"+g.getRoomData().opts.joinermax,t);if(null!=n)for(var i=1;i<=n.childrenCount;i++){var o=cc.find("card_face"+i,n);o.active&&this.gotoMask(o,e,a)}},gotoMask:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i=t==n.id,o=this.setMaskVisible(e,i);null!=o&&(cc.find("up",o).active=!1,cc.find("down",o).active=!1,cc.find("right",o).active=!1,cc.find("left",o).active=!1,cc.find(a,o).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?t&&((a=cc.instantiate(this.cardMaskPrefab)).name=e.name+"_mask",e.addChild(a)):a.active=t,a},getCardImgStr:function(e){return"down"==e?"mj_face_xia_chu":"up"==e?"mj_face_shang_shou":"left"==e?"mj_face_zuo_chu":"right"==e?"mj_face_you_chu":""},showResult:function(){setTimeout(function(){sendEvent("onShowView","resultView")},1500)}}),cc._RF.pop()},{gameConfig:"gameConfig",roomHandler:"roomHandler"}],changchun:[function(e,t,a){"use strict";cc._RF.push(t,"67f7axmaf1CIqvdCJEFnCIJ","changchun");var n=e("gameDefine"),i={gameName:"若宇摸摸棋牌",areaType:n.AreaType.Area_Changchun,serverIP:"mahjong.ry-play.com",serverPort:3010,versionText:"",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rymmqpcc",wxWelcomeText:"还等啥!我在摸摸棋牌等你!",loginLogo:"resources/login/momoqipailogo.png",agentWeChat:{accounts:{number:"",type:"若宇摸摸棋牌"},agentConsult:{number:"",type:"rymm028"},gameProblem:{number:"",type:"rymm028"}},Poster:[],GameVisible:[n.GameType.Game_TDK,n.GameType.Game_Poker_paodekuai,n.GameType.Game_Poker_DDZ,n.GameType.Game_Mj_CC,n.GameType.Game_niu_niu,n.GameType.Game_Niu_Niu_10],SetCardsOpen:!1,MatchGameType:[],FightGameType:[],ModeType:{Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Mj_CC:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_niu_niu:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Niu_Niu_10:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]}},fight:{},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],6:[{name:"6局",roundType:1,roundMax:4,cost:{2:{final:10},4:{final:20}},enter:{2:[100,200,500],4:[200,400,1e3]}},{name:"12局",roundType:1,roundMax:4,cost:{2:{final:20},4:{final:30}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"24局",roundType:1,roundMax:4,cost:{2:{final:30},4:{final:40}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:40},4:{final:50}},enter:{2:[200,200,5e4],4:[200,400,1e3]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:50},4:{final:60}},enter:{2:[300,300,6e4],4:[300,500,2e3]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:60},4:{final:70}},enter:{2:[400,400,7e4],4:[400,600,3e3]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}],10:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],13:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}]},roomCard:{5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},10:{61:{name:"4局",cost:{2:{final:0}}},62:{name:"8局",cost:{2:{final:0}}},63:{name:"16局",cost:{2:{final:0}}},64:{name:"1圈",cost:{4:{final:0}}},65:{name:"2圈",cost:{4:{final:0}}},66:{name:"4圈",cost:{4:{final:0}}}},11:{10:{name:"10",cost:{2:{final:0},3:{final:0}}},20:{name:"20",cost:{2:{final:0},3:{final:0}}},30:{name:"30",cost:{2:{final:0},3:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}},104:{1:{name:"10局",cost:{10:{final:0}}},2:{name:"20局",cost:{10:{final:0}}},3:{name:"30局",cost:{10:{final:0}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],chatView:[function(e,t,a){"use strict";cc._RF.push(t,"82a78VL3R5Ft5wujkMjS57N","chatView");var o=e("gameConfig"),c=e("SoundMngr");cc.Class({extends:cc.Component,properties:{chatInput:cc.EditBox,sendButton:cc.Node,fastVoiceItem:cc.Node,chatAnimationItem:cc.Node},onLoad:function(){},onDestroy:function(){},onEnable:function(){this.initFastVoiceItems(),this.initEmoAnimation(),this.selectEmoAndWord(null,1)},onClose:function(){c.instance.playAudioOther("button");for(var e=0;e<this.chatAnimationItem.parent.childrenCount;e++){var t=this.chatAnimationItem.parent.children[e].getComponent(cc.Animation);if(t){var a=t.getClips()[e].name;t.stop(a)}}this.node.active=!1},initEmoAnimation:function(){for(var e=0;e<16;e++){var t=this.chatAnimationItem.parent.getChildren()[e];null==t&&(t=cc.instantiate(this.chatAnimationItem),this.chatAnimationItem.parent.addChild(t),t.x=this.chatAnimationItem.x+e%6*140,t.y=this.chatAnimationItem.y-150*parseInt(e/6));var a=t.getComponent(cc.Animation);if(a){var n=a.getClips()[e].name;t.name=n,a.play(n),t.on(cc.Node.EventType.TOUCH_END,this.onEmoClick,this)}}},initFastVoiceItems:function(){for(var e=o.getChatData(),t=e.talks,a=e.soundKeys,n=0;n<t.length;n++){var i=this.fastVoiceItem.parent.getChildren()[n];null==i&&((i=cc.instantiate(this.fastVoiceItem)).parent=this.fastVoiceItem.parent,i.x=this.fastVoiceItem.x,i.y=this.fastVoiceItem.y-61*n),cc.find("Label",i).getComponent(cc.Label).string=t[n],i.tag=a[n],i.on(cc.Node.EventType.TOUCH_END,this.onVoiceClick,this)}this.fastVoiceItem.parent.height=this.fastVoiceItem.parent.childrenCount*this.fastVoiceItem.height},onVoiceClick:function(e){c.instance.playAudioOther("button");var t=e.target.tag,a=cc.find("Label",e.target).getComponent(cc.Label).string;ChatHandler.getInstance().requestChat("fast",{sound:t,content:a},function(e){}),this.onClose()},onEmoClick:function(e){c.instance.playAudioOther("button");var t=e.target.name;ChatHandler.getInstance().requestChat("emo",t,function(e){}),this.onClose()},onSendButton:function(){c.instance.playAudioOther("button"),""!=this.chatInput.string&&(ChatHandler.getInstance().requestChat("word",this.chatInput.string,function(e){}),this.chatInput.string="",this.onClose())},selectEmoAndWord:function(e,t){e&&c.instance.playAudioOther("button");var a=cc.find("allPanel/emoScrollView",this.node),n=cc.find("allPanel/wordScrollView",this.node),i=cc.find("allPanel/switchToggle/wordBtn",this.node),o=cc.find("allPanel/switchToggle/emoBtn",this.node),r=cc.find("allPanel/switchToggle/wordBtn_stop",this.node),s=cc.find("allPanel/switchToggle/emoBtn_stop",this.node);1==t?(i.active=!0,s.active=!0,n.active=!0,o.active=!1,r.active=!1,a.active=!1):2==t&&(i.active=!1,s.active=!1,n.active=!1,o.active=!0,r.active=!0,a.active=!0)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameConfig:"gameConfig"}],chip_mask:[function(e,t,a){"use strict";cc._RF.push(t,"2be068+XwtFbLQnaVtEeypg","chip_mask"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){}}),cc._RF.pop()},{}],clubPanel:[function(e,t,a){"use strict";cc._RF.push(t,"589f4MYU71FXahATR2EYOyS","clubPanel");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{selectCloseBtn:cc.Button,joinCloseBtn:cc.Button},onLoad:function(){this.registerListener(),this.initUI()},onEnter:function(){},registerListener:function(){},initUI:function(){},onDestroy:function(){},joinClubClick:function(){n.instance.playAudioOther("button"),openView("joinclubPanel")},close:function(e,t){n.instance.playAudioOther("button"),1==t?closeView("selectclubPanel"):closeView("joinclubPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],codeString:[function(e,t,a){"use strict";cc._RF.push(t,"3d54eCu+llECYB5r6BKkCnP","codeString");t.exports={110:"俱乐部钻石不足",111:"房卡不足",112:"金币不足",113:"俱乐部不存在",114:"已经加入该俱乐部",115:"俱乐部申请提交成功",116:"不是该俱乐部成员",117:"已经申请加入俱乐部",118:"代理钻石不足",119:"俱乐部权限太低",122:"已经邀请过玩家",123:"没有从DB中找到邀请信息",124:"没有从DB中找到申请信息",130:"等待其他人操作",200:"大不过上家的信息",201:"出牌牌形错误",202:"没有大过上家的牌",203:"只能从最大的牌出",204:"不含有红桃三",300:"13水倒水"},cc._RF.pop()},{}],coin:[function(e,t,a){"use strict";var n;function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}cc._RF.push(t,"d6941C7MsBFgrmn+iUrSOHk","coin");var o=e("gameDefine"),r={gameName:"若宇摸摸麻将",areaType:o.AreaType.Area_Coin,serverIP:"coin.mahjong.ry-play.com",serverPort:3310,versionText:"测试服版本",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/coin1",wxWelcomeText:"还等啥!我在摸摸棋牌等你!",loginLogo:"resources/login/momoqipailogo.png",agentWeChat:{accounts:{number:123,type:"(微信号)"},agentConsult:{number:456,type:"(QQ号)"},gameProblem:{number:789,type:"(手机号)"}},Poster:[],GameVisible:[o.GameType.Game_MJ_HuaDian,o.GameType.Game_Mj_Tianjin,o.GameType.Game_Mj_HZ,o.GameType.Game_Mj_CC,o.GameType.Game_Mj_AS,o.GameType.Game_Poker_DDZ,o.GameType.Game_Poker_TianjinDDZ,o.GameType.Game_TDK,o.GameType.Game_niu_niu,o.GameType.Game_Niu_Niu_10,o.GameType.Game_Poker_paodekuai,o.GameType.Game_Poker_ZJH],SetCardsOpen:!1,MatchGameType:[o.GameType.Game_Poker_DDZ,o.GameType.Game_niu_niu],FightGameType:[],ModeType:{Game_Mj_Tianjin:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_TianjinDDZ:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_niu_niu:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Niu_Niu_10:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_TDK:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Mj_CC:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_MJ_HuaDian:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Mj_Heb:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},5:{name:"牛牛匹配局",roundType:1,roundMax:-1,joinerMax:6,cost:[50,300,2e3],enter:[2e3,15e3,1e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,500,2e3],enter:[2e3,1e4,5e4]},103:{name:"三张牌匹配局",roundType:1,roundMax:1,joinerMax:6,cost:[50,300,2e3],enter:[2e4,1e5,5e5]}},fight:{},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],6:[{name:"6局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,500],4:[200,400,1e3]}},{name:"12局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"24局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[200,200,5e4],4:[200,400,1e3]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[300,300,6e4],4:[300,500,2e3]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[400,400,7e4],4:[400,600,3e3]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:[100,200,500]},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}}],10:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],13:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:[100,200,500]},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}}]},roomCard:(n={1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:1},4:{final:1}}},62:{name:"12局",cost:{2:{final:1},4:{final:1}}},63:{name:"24局",cost:{2:{final:2},4:{final:2}}},64:{name:"1圈",cost:{2:{final:1},4:{final:1}}},65:{name:"2圈",cost:{2:{final:1},4:{final:1}}},66:{name:"4圈",cost:{2:{final:2},4:{final:2}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},10:{61:{name:"4局",cost:{2:{final:0}}},62:{name:"8局",cost:{2:{final:0}}},63:{name:"16局",cost:{2:{final:0}}},64:{name:"1圈",cost:{4:{final:0}}},65:{name:"2圈",cost:{4:{final:0}}},66:{name:"4圈",cost:{4:{final:0}}}},11:{10:{name:"10",cost:{2:{final:0},3:{final:0}}},20:{name:"20",cost:{2:{final:0},3:{final:0}}},30:{name:"30",cost:{2:{final:0},3:{final:0}}}},13:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}}},i(n,"5",{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}}),i(n,"104",{1:{name:"10局",cost:{10:{final:0}}},2:{name:"20局",cost:{10:{final:0}}},3:{name:"30局",cost:{10:{final:0}}}}),n)}};t.exports=r,cc._RF.pop()},{gameDefine:"gameDefine"}],competitionHandler:[function(e,t,a){"use strict";cc._RF.push(t,"d2a17VefN5C1KkpJyVKObZY","competitionHandler");e("roomHandler");var n=e("errorCode"),i={gameListData:{}};(t.exports=i).setGameListData=function(e){this.gameListData=e},i.setGameListData=function(){return this.gameListData},i.getPeopleNum=function(e){for(var t in this.gameListData)if(this.gameListData[t].templateId===e)return this.gameListData[t].players.length},i.isApply=function(e,t){for(var a in this.gameListData)if(this.gameListData[a].templateId===e)return-1!=this.gameListData[a].players.indexOf(t)},i.getActivityList=function(){GameNet.getInstance().request("game.activityHandler.getActivityList",{},function(e){e.code==n.Success&&(i.gameListData=e.result,sendEvent("onActivityList"))})},i.apply=function(e){GameNet.getInstance().request("game.activityHandler.apply",{templateId:e},function(e){})},i.cancel=function(e){GameNet.getInstance().request("game.activityHandler.cancel",{templateId:e},function(e){})},i.giveUp=function(){GameNet.getInstance().request("game.activityHandler.giveUp",{},function(e){})},i.registMessage=function(){WriteLog("registMessage 比赛交互消息"),GameNet.getInstance().setCallBack("onActivityList",function(e){WriteLog("do event onActivityList  "+JSON.stringify(e.result)),i.gameListData=e.result,sendEvent("onActivityList")})},cc._RF.pop()},{errorCode:"errorCode",roomHandler:"roomHandler"}],configMgr:[function(e,t,a){"use strict";cc._RF.push(t,"6f0b8uU1FVGp6wy+ixuTwSt","configMgr");var n=e("gameDefine"),i={m_cur_config:null};(t.exports=i).init=function(){switch(n.AreaType.Area_Test){case n.AreaType.Area_Test:this.m_cur_config=e("test");break;case n.AreaType.Area_TianJin:this.m_cur_config=e("tianjin");break;case n.AreaType.Area_HuaDian:this.m_cur_config=e("huadian");break;case n.AreaType.Area_DunHua:this.m_cur_config=e("dunhua");break;case n.AreaType.Area_HEB:this.m_cur_config=e("haerbin");break;case n.AreaType.Area_Hebei:this.m_cur_config=e("hebei");break;case n.AreaType.Area_Changchun:this.m_cur_config=e("changchun");break;case n.AreaType.Area_Appstore:this.m_cur_config=e("appstore");break;case n.AreaType.Area_Coin:this.m_cur_config=e("coin")}},i.getConfig=function(){return this.m_cur_config},i.getServerConfig=function(){return this.m_cur_config.serverConfig},i.getAreaType=function(){return this.m_cur_config.areaType},i.getGameName=function(){return this.m_cur_config.gameName},i.getIP=function(){return this.m_cur_config.serverIP},i.getPort=function(){return this.m_cur_config.serverPort},i.getModeType=function(){return this.m_cur_config.ModeType},i.getWXShareUrl=function(){return this.m_cur_config.wxShareUrl},i.getWxWelcomeText=function(){return this.m_cur_config.wxWelcomeText},i.getLogo=function(){return this.m_cur_config.loginLogo},i.getNotice=function(){return this.m_cur_config.notice},i.getVersionText=function(){return this.m_cur_config.versionText},i.getGameVisible=function(){return this.m_cur_config.GameVisible},i.getSetCardsOpen=function(){return this.m_cur_config.SetCardsOpen},i.getArea=function(){return this.m_cur_config.areaType},i.getMatchGameType=function(){return this.m_cur_config.MatchGameType},i.getFightGameType=function(){return this.m_cur_config.FightGameType},i.getPoster=function(){return this.m_cur_config.Poster},i.CompetitionPoster=function(){return this.m_cur_config.CompetitionPoster},i.getAgentWeChat=function(){return this.m_cur_config.agentWeChat},cc._RF.pop()},{appstore:"appstore",changchun:"changchun",coin:"coin",dunhua:"dunhua",gameDefine:"gameDefine",haerbin:"haerbin",hebei:"hebei",huadian:"huadian",test:"test",tianjin:"tianjin"}],createControl:[function(e,t,a){"use strict";cc._RF.push(t,"3ac97Dl0AhNr52Ddb8Q03Qb","createControl");var o=e("SoundMngr"),i=e("roomHandler"),f=e("configMgr"),y=e("gameDefine");cc.Class({extends:cc.Component,properties:{layer_create:cc.Node,gameTypeScrollView:cc.ScrollView,OrdScrollView:cc.ScrollView,MjTianJin:cc.Prefab,MjShiShi:cc.Prefab,MjHuanDian:cc.Prefab,MjHongZhong:cc.Prefab,MjChangChun:cc.Prefab,MjHeb:cc.Prefab,DDZTianJin:cc.Prefab,DDZ:cc.Prefab,NiuNiu:cc.Prefab,tenNiuNiu:cc.Prefab,TDK:cc.Prefab,ShiSanShui:cc.Prefab,PDK:cc.Prefab,ZJH:cc.Prefab,gameTypes:{default:[],type:[cc.Sprite]},createBtns:cc.Node,helpBtns:cc.Node,DKFBtns:cc.Node,roomTypeToggle:cc.Toggle,majiangNode:cc.Node,tianjinBtn:cc.Node,shishiBtn:cc.Node,huadianBtn:cc.Node,hongzhongBtn:cc.Node,changchunBtn:cc.Node,hebBtn:cc.Node,ddzNode:cc.Node,ddzBtn:cc.Node,TJddzBtn:cc.Node,niuniuNode:cc.Node,niuniuBtn:cc.Node,tenNiuniuBtn:cc.Node,tdkNode:cc.Node,tiandakengBtn:cc.Node,sssNode:cc.Node,shisanshuiBtn:cc.Node,ZJHNode:cc.Node,ZJHBtn:cc.Node,pdkNode:cc.Node,paodekuaiBtn:cc.Node},onLoad:function(){this.emageArray=[["resources/home/create/majiangbiaoqian01.png","resources/home/create/doudizhubiaoqian01.png","resources/home/create/sbt_pinshianniu01.png","resources/home/create/tiandakengbiaoqian01.png","resources/home/create/shisanshuibiaoqian01.png","resources/home/create/paodekuaibiaoqian01.png","resources/home/create/zhajinhuabiaoqian01.png"],["resources/home/create/majiangbiaoqian02.png","resources/home/create/doudizhubiaoqian02.png","resources/home/create/sbt_pinshianniu02.png","resources/home/create/tiandakengbiaoqian02.png","resources/home/create/shisanshuibiaoqian02.png","resources/home/create/paodekuaibiaoqian02.png","resources/home/create/zhajinhuabiaoqian02.png"]],this.currentItem=void 0,this.currentGameType=-1,this.btnGameType=GameData.createRoom.gameType||0,this.leftBtnFirstArray=GameData.createRoom.leftGameType||[],this.addTouchEvent(),this.GameTypeVisible(),this.refreshUIRule()},addTouchEvent:function(){for(var e=this,t=function(t){(n=e).gameTypes[t].node.on(cc.Node.EventType.TOUCH_END,function(e){o.instance.playAudioOther("button"),n.showGameType(t)})},a=0;a<this.gameTypes.length;a++){var n;t(a)}},GameTypeVisible:function(){this.tianjinBtn.active=!1,this.shishiBtn.active=!1,this.huadianBtn.active=!1,this.hongzhongBtn.active=!1,this.changchunBtn.active=!1,this.hebBtn.active=!1,this.ddzBtn.active=!1,this.TJddzBtn.active=!1,this.niuniuBtn.active=!1,this.tenNiuniuBtn.active=!1,this.tiandakengBtn.active=!1,this.shisanshuiBtn.active=!1,this.paodekuaiBtn.active=!1,this.ZJHBtn.active=!1;for(var e=f.getGameVisible(),t=0;t<e.length;t++)switch(e[t]){case y.GameType.Game_Mj_Tianjin:this.tianjinBtn.active=!0;break;case y.GameType.Game_Mj_Shishi:this.shishiBtn.active=!0;break;case y.GameType.Game_Poker_13shui:this.shisanshuiBtn.active=!0;break;case y.GameType.Game_niu_niu:this.niuniuBtn.active=!0;break;case y.GameType.Game_MJ_HuaDian:this.huadianBtn.active=!0;break;case y.GameType.Game_TDK:this.tiandakengBtn.active=!0;break;case y.GameType.Game_Poker_TianjinDDZ:this.TJddzBtn.active=!0;break;case y.GameType.Game_Mj_HZ:this.hongzhongBtn.active=!0;break;case y.GameType.Game_Poker_DDZ:this.ddzBtn.active=!0;break;case y.GameType.Game_Mj_CC:this.changchunBtn.active=!0;break;case y.GameType.Game_Mj_Heb:this.hebBtn.active=!0;break;case y.GameType.Game_Poker_paodekuai:this.paodekuaiBtn.active=!0;break;case y.GameType.Game_Poker_ZJH:this.ZJHBtn.active=!0;break;case y.GameType.Game_Niu_Niu_10:this.tenNiuniuBtn.active=!0}for(var a,n=0,i=-1,o=0,r=this.gameTypes[0].node.width,s=this.gameTypes[0].node.x,c=0;c<this.gameTypes.length;c++){var d=!1;switch(c){case 0:a=this.majiangNode;break;case 1:a=this.ddzNode;break;case 2:a=this.niuniuNode;break;case 3:a=this.tdkNode;break;case 4:a=this.sssNode;break;case 5:a=this.pdkNode;break;case 6:a=this.ZJHNode}if(a){for(var h=-1,l=0,u=a.getChildren()[0].height,m=a.getChildren()[0].y,p=0;p<a.getChildrenCount();p++){var g=a.getChildren()[p];if(g){if(0==g.active)continue;d=!0,g.y=m-l*u,l++,null==this.leftBtnFirstArray[c]&&(this.leftBtnFirstArray[c]=0),0==a.getChildren()[this.leftBtnFirstArray[c]].active&&-1==h&&(h=p,this.leftBtnFirstArray[c]=h)}}a.active=d,(this.gameTypes[c].node.active=d)&&(this.gameTypes[c].node.x=s+o*r,o++,-1==i&&(i=c),n+=this.gameTypes[c].node.width)}}n<1230&&(n=1230),this.gameTypeScrollView.content.width=n,0==this.gameTypes[this.btnGameType].node.active&&(this.btnGameType=i),this.showGameType(this.btnGameType)},showGameType:function(e){this.btnGameType=e;for(var t=this.leftBtnFirstArray[e],a=0;a<this.gameTypes.length;a++){var n=0;a==e&&(n=1);var i=this.emageArray[n][a],o=cc.textureCache.addImage(cc.url.raw(i));this.gameTypes[a].spriteFrame=null,this.gameTypes[a].spriteFrame=new cc.SpriteFrame(o)}for(var r=cc.find("panel/littleType/view/content",this.layer_create).children,s=0;s<r.length;s++)s==e?(r[s].active=!0,this.selectRoomRule(t)):r[s].active=!1},roomTypeClick:function(e,t){o.instance.playAudioOther("button"),cc.log("data = ",t),this.selectRoomRule(t)},selectRoomRule:function(e){var t,a,n=parseInt(e),i=this.btnGameType;switch(cc.log("..TabIndex:"+i+"--index:"+e),i){case 0:switch(t=cc.find("panel/littleType/view/content/majiang",this.layer_create),n){case 0:a=y.GameType.Game_Mj_Tianjin;break;case 1:a=y.GameType.Game_Mj_Shishi;break;case 2:a=y.GameType.Game_MJ_HuaDian;break;case 3:a=y.GameType.Game_Mj_HZ;break;case 4:a=y.GameType.Game_Mj_CC;break;case 5:a=y.GameType.Game_Mj_Heb}break;case 1:switch(t=cc.find("panel/littleType/view/content/doudizhu",this.layer_create),n){case 0:a=y.GameType.Game_Poker_DDZ;break;case 1:a=y.GameType.Game_Poker_TianjinDDZ}break;case 2:switch(t=cc.find("panel/littleType/view/content/niuniu",this.layer_create),n){case 0:a=y.GameType.Game_niu_niu;break;case 1:a=y.GameType.Game_Niu_Niu_10}break;case 3:switch(t=cc.find("panel/littleType/view/content/tiandakeng",this.layer_create),n){case 0:a=y.GameType.Game_TDK}break;case 4:switch(t=cc.find("panel/littleType/view/content/shisanshui",this.layer_create),n){case 0:a=y.GameType.Game_Poker_13shui}break;case 5:switch(t=cc.find("panel/littleType/view/content/paodekuai",this.layer_create),n){case 0:a=y.GameType.Game_Poker_paodekuai}break;case 6:switch(t=cc.find("panel/littleType/view/content/zhajinhua",this.layer_create),n){case 0:a=y.GameType.Game_Poker_ZJH}}if(a!=this.currentGameType&&null!=a){this.currentGameType=a;for(var o=t.children,r=0;r<o.length;r++){var s=!0;n==r&&(s=!1),o[r].getComponent("cc.Button").interactable=s}this.leftBtnFirstArray[i]=n,GameData.createRoom.gameType=i,GameData.createRoom.leftGameType=this.leftBtnFirstArray,this.updateUISelectRule()}},updateUISelectRule:function(){switch(cc.log("..currentGameType:"+this.currentGameType),this.currentGameType){case y.GameType.Game_Mj_Tianjin:this.currentItem=cc.instantiate(this.MjTianJin);break;case y.GameType.Game_Mj_Shishi:this.currentItem=cc.instantiate(this.MjShiShi);break;case y.GameType.Game_MJ_HuaDian:this.currentItem=cc.instantiate(this.MjHuanDian);break;case y.GameType.Game_Mj_HZ:this.currentItem=cc.instantiate(this.MjHongZhong);break;case y.GameType.Game_Mj_CC:this.currentItem=cc.instantiate(this.MjChangChun);break;case y.GameType.Game_Mj_Heb:this.currentItem=cc.instantiate(this.MjHeb);break;case y.GameType.Game_Poker_TianjinDDZ:this.currentItem=cc.instantiate(this.DDZTianJin);break;case y.GameType.Game_Poker_DDZ:this.currentItem=cc.instantiate(this.DDZ);break;case y.GameType.Game_niu_niu:this.currentItem=cc.instantiate(this.NiuNiu);break;case y.GameType.Game_Niu_Niu_10:this.currentItem=cc.instantiate(this.tenNiuNiu);break;case y.GameType.Game_TDK:this.currentItem=cc.instantiate(this.TDK);break;case y.GameType.Game_Poker_13shui:this.currentItem=cc.instantiate(this.ShiSanShui);break;case y.GameType.Game_Poker_paodekuai:this.currentItem=cc.instantiate(this.PDK);break;case y.GameType.Game_Poker_ZJH:this.currentItem=cc.instantiate(this.ZJH)}if(null!=this.currentItem){this.OrdScrollView.scrollToTop(.1);var e=this.OrdScrollView.content;0<e.getChildrenCount()&&e.removeAllChildren(!0),e.addChild(this.currentItem),this.refreshAgentRoomBtn(!0)}else cc.log("..item is undefined!")},refreshAgentRoomBtn:function(e){var t,a=f.getModeType();if(a)switch(this.currentGameType){case y.GameType.Game_Mj_Tianjin:a.Game_Mj_Tianjin&&(t=a.Game_Mj_Tianjin.CurrencyType);break;case y.GameType.Game_Mj_Shishi:a.Game_Mj_Shishi&&(t=a.Game_Mj_Shishi.CurrencyType);break;case y.GameType.Game_MJ_HuaDian:a.Game_MJ_HuaDian&&(t=a.Game_MJ_HuaDian.CurrencyType);break;case y.GameType.Game_Mj_HZ:a.Game_Mj_HZ&&(t=a.Game_Mj_HZ.CurrencyType);break;case y.GameType.Game_Mj_CC:a.Game_Mj_CC&&(t=a.Game_Mj_CC.CurrencyType);break;case y.GameType.Game_Mj_Heb:a.Game_Mj_Heb&&(t=a.Game_Mj_Heb.CurrencyType);break;case y.GameType.Game_Poker_TianjinDDZ:a.Game_Poker_TianjinDDZ&&(t=a.Game_Poker_TianjinDDZ.CurrencyType);break;case y.GameType.Game_Poker_DDZ:a.Game_Poker_DDZ&&(t=a.Game_Poker_DDZ.CurrencyType);break;case y.GameType.Game_niu_niu:a.Game_niu_niu&&(t=a.Game_niu_niu.CurrencyType);break;case y.GameType.Game_Niu_Niu_10:a.Game_Niu_Niu_10&&(t=a.Game_Niu_Niu_10.CurrencyType);break;case y.GameType.Game_TDK:a.Game_TDK&&(t=a.Game_TDK.CurrencyType);break;case y.GameType.Game_Poker_13shui:a.Game_Poker_13shui&&(t=a.Game_Poker_13shui.CurrencyType);break;case y.GameType.Game_Poker_paodekuai:a.Game_Poker_paodekuai&&(t=a.Game_Poker_paodekuai.CurrencyType);break;case y.GameType.Game_Poker_ZJH:a.Game_Poker_ZJH&&(t=a.Game_Poker_ZJH.CurrencyType)}t!=y.currencyType.Currency_Coin&&1==e&&GameData.player.club&&0<=Object.keys(GameData.player.club).length&&2==GameData.player.club.clubAdmin?(this.DKFBtns.active=!0,this.roomTypeToggle.node.active=!0):(this.DKFBtns.active=!1,this.roomTypeToggle.node.active=!1,this.roomTypeToggle.isChecked=!1)},refreshUIRule:function(){1==GameData.createRoom.roomType?this.roomTypeToggle.isChecked=!1:2==GameData.createRoom.roomType&&(this.roomTypeToggle.isChecked=!0)},saveUIRule:function(){GameData.createRoom.roomType=this.roomTypeToggle.isChecked?2:1,GameData.saveCommonCreateRoomRule()},selectGameOk:function(e,t){if(!inCD(2e3)){o.instance.playAudioOther("button"),this.saveUIRule();var a=0;if(GameData.player.club&&0<Object.keys(GameData.player.club).length&&(a=GameData.player.club.clubID),2==t&&a<=0)createMessageBox("您还没有俱乐部!不能代开房间。",function(){});else{var n={};switch(this.currentGameType){case y.GameType.Game_Mj_Tianjin:n=this.currentItem.getComponent("createRoom").createRoom();break;case y.GameType.Game_Mj_Shishi:n=this.currentItem.getComponent("createRoom_shishi").createRoom();break;case y.GameType.Game_MJ_HuaDian:n=this.currentItem.getComponent("createRoom_huadian").createRoom();break;case y.GameType.Game_Mj_HZ:n=this.currentItem.getComponent("createRoom-hz").createRoom();break;case y.GameType.Game_Mj_CC:n=this.currentItem.getComponent("createRoom_changchun").createRoom();break;case y.GameType.Game_Mj_Heb:n=this.currentItem.getComponent("createRoom_heb").createRoom();break;case y.GameType.Game_Poker_TianjinDDZ:n=this.currentItem.getComponent("TJDDZ-createRoom").createRoom();break;case y.GameType.Game_Poker_DDZ:n=this.currentItem.getComponent("DDZ-createRoom").createRoom();break;case y.GameType.Game_niu_niu:n=this.currentItem.getComponent("NN-createRoom").createRoom();break;case y.GameType.Game_Niu_Niu_10:n=this.currentItem.getComponent("tenNN-createRoom").createRoom();break;case y.GameType.Game_TDK:n=this.currentItem.getComponent("TDK-createRoom").createRoom();break;case y.GameType.Game_Poker_13shui:n=this.currentItem.getComponent("SSSCreateRoom").createRoom();break;case y.GameType.Game_Poker_paodekuai:n=this.currentItem.getComponent("PDK-createRoom").createRoom();break;case y.GameType.Game_Poker_ZJH:n=this.currentItem.getComponent("ZJH-createRoom").createRoom()}null==n||Object.keys(n).length<=0?cc.log("..createData is undefined or null."):(n.clubId=a,n.roomType=GameData.createRoom.roomType,2==t&&(n.costType=y.CostType.Cost_Agent),n.currencyType==y.currencyType.Currency_Coin&&(n.costType=y.CostType.Cost_Table),console.log("..createData = "+JSON.stringify(n)),i.createRoom(n))}}},openPlayIntro:function(e){switch(o.instance.playAudioOther("button"),this.currentGameType){case y.GameType.Game_Mj_Tianjin:openView("PlayIntroPanel");break;case y.GameType.Game_Mj_Shishi:return;case y.GameType.Game_MJ_HuaDian:openView("PlayIntroPanel_HD",y.GameType.Game_MJ_HuaDian);break;case y.GameType.Game_Mj_HZ:openView("PlayIntroPanel_HZ",y.GameType.Game_Mj_HZ);break;case y.GameType.Game_Mj_CC:openView("PlayIntroPanel_CC",y.GameType.Game_Mj_CC);break;case y.GameType.Game_Mj_Heb:openView("PlayIntroPanel_Heb",y.GameType.Game_Mj_Heb);break;case y.GameType.Game_Poker_TianjinDDZ:openView("TJDDZ-PlayIntroPanel",y.GameType.Game_Poker_TianjinDDZ);break;case y.GameType.Game_Poker_DDZ:openView("DDZ-PlayIntroPanel",y.GameType.Game_Poker_DDZ);break;case y.GameType.Game_niu_niu:case y.GameType.Game_Niu_Niu_10:openView("NiuniuPlayIntroPanel",y.GameType.Game_niu_niu);break;case y.GameType.Game_TDK:openView("TDKPlayIntroPanel",y.GameType.Game_TDK);break;case y.GameType.Game_Poker_13shui:openSSSView("poker13PlayIntroPanel");break;case y.GameType.Game_Poker_paodekuai:openView("PDK-PlayIntroPanel",y.GameType.Game_Poker_paodekuai);break;case y.GameType.Game_Poker_ZJH:openView("PlayIntroPanel_ZJH",y.GameType.Game_Poker_ZJH)}},backToHome:function(e){var a=this;o.instance.playAudioOther("button");for(var n=this,t=function(t){a.gameTypes[t].node.off(cc.Node.EventType.TOUCH_END,function(e){n.showGameType(t)})},i=0;i<this.gameTypes.length;i++)t(i);this.layer_create.active=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],"createRoom-hz":[function(e,t,a){"use strict";cc._RF.push(t,"02628B/Wz5P1aQu0n+JS7lv","createRoom-hz");e("roomHandler");var r=e("configMgr"),s=e("gameDefine");cc.Class({extends:cc.Component,properties:{round4:cc.Toggle,round8:cc.Toggle,round16:cc.Toggle,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,mai2:cc.Toggle,mai4:cc.Toggle,mai6:cc.Toggle,huqidui:cc.Toggle,qianggang:cc.Toggle,diangang:cc.Toggle,timesNode:cc.Node,times1:cc.Toggle,times10:cc.Toggle,times20:cc.Toggle,times50:cc.Toggle,scoreNode:cc.Node,score1:cc.Toggle,score2:cc.Toggle,score3:cc.Toggle,spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.modeType=1,this.spendData=void 0,this.refreshUI()},getModeType:function(){return this.modeType},refreshUI:function(){this.round4.isChecked=1==GameDataHZ.createRoomOpts.roundRule,this.round8.isChecked=2==GameDataHZ.createRoomOpts.roundRule,this.round16.isChecked=3==GameDataHZ.createRoomOpts.roundRule,this.pay1.isChecked=1==GameDataHZ.createRoomOpts.payType,this.pay2.isChecked=2==GameDataHZ.createRoomOpts.payType,this.pay3.isChecked=3==GameDataHZ.createRoomOpts.payType,this.mai2.isChecked=2==GameDataHZ.createRoomOpts.BuyM,this.mai4.isChecked=4==GameDataHZ.createRoomOpts.BuyM,this.mai6.isChecked=6==GameDataHZ.createRoomOpts.BuyM,this.times1.isChecked=1==GameDataHZ.createRoomOpts.times,this.times10.isChecked=10==GameDataHZ.createRoomOpts.times,this.times20.isChecked=20==GameDataHZ.createRoomOpts.times,this.times50.isChecked=50==GameDataHZ.createRoomOpts.times,this.huqidui.isChecked=1==GameDataHZ.createRoomOpts.huqidui,this.qianggang.isChecked=1==GameDataHZ.createRoomOpts.qianggang,this.diangang.isChecked=1==GameDataHZ.createRoomOpts.diangang,this.showSpendUI(),this.score1.isChecked=!0,this.score2.isChecked=!1,this.score3.isChecked=!1,this.refreshTimesScore()},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..hongzhong..MJ");var e="",t="",a=r.getModeType();if(null!=a&&null!=a.Game_Mj_HZ){var n=r.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Mj_HZ.CurrencyType,this.modeType){case s.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[s.GameType.Game_Mj_HZ];break;case s.currencyType.Currency_Coin:e="金币",this.spendData=n.roomCoin[s.GameType.Game_Mj_HZ]}if(this.spendData)for(var i=0;i<Object.keys(this.spendData).length;i++){var o=0;if(this.modeType==s.currencyType.Currency_Card){o=this.spendData[i+1].cost[4].final,this.pay2.isChecked&&(o=Math.ceil(o/4),t="/人")}else o=this.spendData[i].cost;this.drowArray[i].active=0==o,this.spendUI[i].string="（"+e+"*"+o+t+"）"}else cc.log("..spendData is undefined")}}},saveRuleFromUI:function(){this.round4.isChecked?GameDataHZ.createRoomOpts.roundRule=1:this.round8.isChecked?GameDataHZ.createRoomOpts.roundRule=2:this.round16.isChecked?GameDataHZ.createRoomOpts.roundRule=3:GameDataHZ.createRoomOpts.roundRule=1,this.pay1.isChecked?GameDataHZ.createRoomOpts.payType=1:this.pay2.isChecked?GameDataHZ.createRoomOpts.payType=2:this.pay3.isChecked?GameDataHZ.createRoomOpts.payType=3:GameDataHZ.createRoomOpts.payType=1,this.mai2.isChecked?GameDataHZ.createRoomOpts.BuyM=2:this.mai4.isChecked?GameDataHZ.createRoomOpts.BuyM=4:this.mai6.isChecked?GameDataHZ.createRoomOpts.BuyM=6:GameDataHZ.createRoomOpts.BuyM=2,GameDataHZ.createRoomOpts.huqidui=!!this.huqidui.isChecked,GameDataHZ.createRoomOpts.qianggang=!!this.qianggang.isChecked,GameDataHZ.createRoomOpts.diangang=!!this.diangang.isChecked,GameDataHZ.saveCreateRoomOpts()},selectRoundRuleClick:function(e,t){if(null!=t){switch(t){case 4:this.round4.isChecked=!0,this.round8.isChecked=!1,this.round16.isChecked=!1;break;case 8:this.round8.isChecked=!0,this.round4.isChecked=!1,this.round16.isChecked=!1;break;case 16:this.round16.isChecked=!0,this.round4.isChecked=!1,this.round8.isChecked=!1}this.round4.isChecked?GameDataHZ.createRoomOpts.roundRule=1:this.round8.isChecked?GameDataHZ.createRoomOpts.roundRule=2:this.round16.isChecked&&(GameDataHZ.createRoomOpts.roundRule=3),this.refreshTimesScore()}},selectTimesClick:function(e,t){if(null!=t){switch(t){case 1:this.times1.isChecked=!0,this.times10.isChecked=!1,this.times20.isChecked=!1,this.times50.isChecked=!1;break;case 10:this.times10.isChecked=!0,this.times1.isChecked=!1,this.times20.isChecked=!1,this.times50.isChecked=!1;break;case 20:this.times20.isChecked=!0,this.times10.isChecked=!1,this.times1.isChecked=!1,this.times50.isChecked=!1;break;case 50:this.times50.isChecked=!0,this.times10.isChecked=!1,this.times20.isChecked=!1,this.times1.isChecked=!1}this.times1.isChecked?GameDataHZ.createRoomOpts.times=1:this.times10.isChecked?GameDataHZ.createRoomOpts.times=10:this.times20.isChecked?GameDataHZ.createRoomOpts.times=20:this.times50.isChecked&&(GameDataHZ.createRoomOpts.times=50),this.refreshTimesScore()}},refreshTimesScore:function(){if(this.modeType==s.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)return this.timesNode.active=!1,void(this.scoreNode.active=!1);this.timesNode.active=!0,this.scoreNode.active=!0;var e=0;switch(GameDataHZ.createRoomOpts.roundRule){case 4:e=0;break;case 8:e=1;break;case 16:e=2}var t=this.spendData[e].enter,a=cc.find("label",this.score1.node),n=cc.find("label",this.score2.node),i=cc.find("label",this.score3.node);null==GameDataHZ.createRoomOpts.times&&(GameDataHZ.createRoomOpts.times=1),a.getComponent(cc.Label).string="≥"+GameDataHZ.createRoomOpts.times*parseInt(t[0]),n.getComponent(cc.Label).string="≥"+GameDataHZ.createRoomOpts.times*parseInt(t[1]),i.getComponent(cc.Label).string="≥"+GameDataHZ.createRoomOpts.times*parseInt(t[2]),this.score1.isChecked?GameDataHZ.createRoomOpts.score=GameDataHZ.createRoomOpts.times*parseInt(t[0]):this.score2.isChecked?GameDataHZ.createRoomOpts.score=GameDataHZ.createRoomOpts.times*parseInt(t[1]):this.score3.isChecked&&(GameDataHZ.createRoomOpts.score=GameDataHZ.createRoomOpts.times*parseInt(t[2]))},createRoom:function(e){this.saveRuleFromUI(),GameData.setGameType(s.GameType.Game_Mj_HZ);var t=GameDataHZ.getRoundMax();return{gameType:s.GameType.Game_Mj_HZ,roomType:0,costType:GameDataHZ.createRoomOpts.payType,roundRule:GameDataHZ.createRoomOpts.roundRule,roundType:GameDataHZ.createRoomOpts.roundRule,roundMax:t,joinermax:2,BuyM:GameDataHZ.createRoomOpts.BuyM,huqidui:GameDataHZ.createRoomOpts.huqidui,qianggang:GameDataHZ.createRoomOpts.qianggang,diangang:GameDataHZ.createRoomOpts.diangang,clubId:0,score:GameDataHZ.createRoomOpts.score,times:GameDataHZ.createRoomOpts.times,currencyType:null,settleType:null}}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],createRoom_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"e3fee7Jj7VPBJ2eE2k117U5","createRoom_changchun");e("roomHandler");var h=e("configMgr"),l=e("gameDefine");cc.Class({extends:cc.Component,properties:{player2:cc.Toggle,player4:cc.Toggle,round_CC:cc.Node,spendRound_CC:cc.Node,round4:cc.Toggle,round8:cc.Toggle,round16:cc.Toggle,quan_CC:cc.Node,spendQuan_CC:cc.Node,quan1:cc.Toggle,quan2:cc.Toggle,quan4:cc.Toggle,dianpao:cc.Toggle,xiaojifeidan:cc.Toggle,xiadanzhanli:cc.Toggle,quemen:cc.Toggle,duibaofanbei:cc.Toggle,baotype:cc.Toggle,qiDui:cc.Toggle,baseNode:cc.Node,base_1:cc.Toggle,base_2:cc.Toggle,base_3:cc.Toggle,spend:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.refreshUI(),this.addTouchListener()},onEnter:function(){},addTouchListener:function(){},getModeType:function(){return this.modeType},refreshUI:function(){cc.log("~~~~~~~~~~~~~~~~~~~~~~~~~GameData.createRoomOpts~~~~~~~~~~~~~~~~~~~~~~~~"+JSON.stringify(profileChangChun.createRoomOpts)),this.round_CC.active=2==profileChangChun.createRoomOpts.joinermax,this.quan_CC.active=4==profileChangChun.createRoomOpts.joinermax,this.spendRound_CC.active=2==profileChangChun.createRoomOpts.joinermax,this.spendQuan_CC.active=4==profileChangChun.createRoomOpts.joinermax,this.player2.isChecked=2==profileChangChun.createRoomOpts.joinermax,this.player4.isChecked=4==profileChangChun.createRoomOpts.joinermax,this.round4.isChecked=4==profileChangChun.createRoomOpts.roundMax,this.round8.isChecked=8==profileChangChun.createRoomOpts.roundMax,this.round16.isChecked=16==profileChangChun.createRoomOpts.roundMax,this.quan1.isChecked=1==profileChangChun.createRoomOpts.roundMax,this.quan2.isChecked=2==profileChangChun.createRoomOpts.roundMax,this.quan4.isChecked=4==profileChangChun.createRoomOpts.roundMax,this.dianpao.isChecked=1==profileChangChun.createRoomOpts.dianpao,this.xiaojifeidan.isChecked=1==profileChangChun.createRoomOpts.xiaojifeidan,this.xiadanzhanli.isChecked=1==profileChangChun.createRoomOpts.xiadanzhanli,this.quemen.isChecked=1==profileChangChun.createRoomOpts.quemen,this.duibaofanbei.isChecked=1==profileChangChun.createRoomOpts.duibaofanbei,this.baotype.isChecked=0==profileChangChun.createRoomOpts.baotype,this.qiDui.isChecked=1==profileChangChun.createRoomOpts.qiDui,this.base_1.isChecked=0==profileChangChun.createRoomOpts.scoreLv,this.base_2.isChecked=1==profileChangChun.createRoomOpts.scoreLv,this.base_3.isChecked=2==profileChangChun.createRoomOpts.scoreLv,this.modeType=1,this.spendData=void 0,this.showSpendUI()},roundNodeActive:function(e){this.round_CC.active=!!this.player2.isChecked,this.quan_CC.active=!!this.player4.isChecked,this.spendRound_CC.active=!!this.player2.isChecked,this.spendQuan_CC.active=!!this.player4.isChecked,this.showSpendUI()},createRoom:function(e){this.saveRuleFromUI(),GameData.setGameType(l.GameType.Game_Mj_CC);var t={gameType:l.GameType.Game_Mj_CC,roundMax:profileChangChun.createRoomOpts.roundMax,roundType:profileChangChun.createRoomOpts.roundType,roundRule:profileChangChun.createRoomOpts.roundRule,bossType:profileChangChun.createRoomOpts.bossType,roomType:profileChangChun.createRoomOpts.roomType,costType:profileChangChun.createRoomOpts.costType,joinermax:profileChangChun.createRoomOpts.joinermax,clubId:0,anBao:profileChangChun.createRoomOpts.baotype,dianPaoBaoFu:profileChangChun.createRoomOpts.dianpao,xiaoJiFeiDan:profileChangChun.createRoomOpts.xiaojifeidan,xiaDanZhanLi:profileChangChun.createRoomOpts.xiadanzhanli,queMen:profileChangChun.createRoomOpts.quemen,duiBaoDouble:profileChangChun.createRoomOpts.duibaofanbei,qiDui:profileChangChun.createRoomOpts.qiDui,scorelv:profileChangChun.createRoomOpts.scoreLv,currencyType:null,settleType:null},a=h.getModeType();return null==a||null==a.Game_Mj_CC?t:(t.currencyType=a.Game_Mj_CC.CurrencyType,t.settleType=a.Game_Mj_CC.SettleType,GameData.room.opts=t)},saveRuleFromUI:function(){this.player2.isChecked?(profileChangChun.createRoomOpts.joinermax=2,profileChangChun.createRoomOpts.roundType=1,this.round4.isChecked?(profileChangChun.createRoomOpts.roundMax=4,profileChangChun.createRoomOpts.roundRule=61):this.round8.isChecked?(profileChangChun.createRoomOpts.roundMax=8,profileChangChun.createRoomOpts.roundRule=62):this.round16.isChecked&&(profileChangChun.createRoomOpts.roundMax=16,profileChangChun.createRoomOpts.roundRule=63)):this.player4.isChecked&&(profileChangChun.createRoomOpts.joinermax=4,profileChangChun.createRoomOpts.roundType=2,this.quan1.isChecked?(profileChangChun.createRoomOpts.roundRule=64,profileChangChun.createRoomOpts.roundMax=1):this.quan2.isChecked?(profileChangChun.createRoomOpts.roundRule=65,profileChangChun.createRoomOpts.roundMax=2):this.quan4.isChecked&&(profileChangChun.createRoomOpts.roundRule=66,profileChangChun.createRoomOpts.roundMax=4)),this.base_1.isChecked?profileChangChun.createRoomOpts.scoreLv=0:this.base_2.isChecked?profileChangChun.createRoomOpts.scoreLv=1:this.base_3.isChecked?profileChangChun.createRoomOpts.scoreLv=2:profileChangChun.createRoomOpts.scoreLv=0,profileChangChun.createRoomOpts.dianpao=this.dianpao.isChecked?1:0,profileChangChun.createRoomOpts.xiaojifeidan=this.xiaojifeidan.isChecked?1:0,profileChangChun.createRoomOpts.xiadanzhanli=this.xiadanzhanli.isChecked?1:0,profileChangChun.createRoomOpts.quemen=this.quemen.isChecked?1:0,profileChangChun.createRoomOpts.duibaofanbei=this.duibaofanbei.isChecked?1:0,profileChangChun.createRoomOpts.baotype=this.baotype.isChecked?0:1,profileChangChun.createRoomOpts.qiDui=this.qiDui.isChecked?1:0,profileChangChun.createRoomOpts.bossType=1,profileChangChun.createRoomOpts.costType=l.CostType.Cost_Creator,profileChangChun.saveCreateRoomOpts()},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..changchun..MJ");var e="",t=h.getModeType();if(null!=t&&null!=t.Game_Mj_CC){var a=h.getServerConfig();if(null!=a){switch(this.modeType=t.Game_Mj_CC.CurrencyType,this.modeType){case l.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[l.GameType.Game_Mj_CC];break;case l.currencyType.Currency_Coin:e="金币",this.spendData=a.roomCoin[l.GameType.Game_Mj_CC]}if(this.spendData){for(var n=0;n<this.drowArray.length;n++){var i=this.drowArray[n];i&&(i.active=!1)}var o=2;this.player2.isChecked?o=2:this.player4.isChecked&&(o=4);var r=60,s=63;1==this.player2.isChecked?(r=60,s=63):1==this.player4.isChecked&&(r=63,s=66);for(var c=r;c<s;c++){var d=0;this.modeType==l.currencyType.Currency_Card?(d=this.spendData[c+1].cost[o].final,this.spend[c-60].string="（"+e+"*"+d+"）"):this.modeType==l.currencyType.Currency_Coin&&(d=this.spendData[c-60].cost[o].final,this.spend[c-60].string=""),d<=0&&(this.drowArray[c-60].active=!0)}this.refreshBaseScoreLv()}else cc.log("..spendData is undefined")}}},refreshBaseScoreLv:function(){if(this.modeType==l.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)this.baseNode.active=!1;else{this.baseNode.active=!0;var e=2,t=0;this.player2.isChecked?(e=2,this.round4.isChecked?t=0:this.round8.isChecked?t=1:this.round16.isChecked&&(t=2)):this.player4.isChecked&&(e=4,this.quan1.isChecked?t=3:this.quan2.isChecked?t=4:this.quan4.isChecked&&(t=5));var a=this.spendData[t];if(null!=a){var n=a.cost[e],i=a.enter[e],o=cc.find("label",this.base_1.node),r=cc.find("label",this.base_2.node),s=cc.find("label",this.base_3.node);o.getComponent(cc.Label).string="初级场：台费"+n[0]+" 进入条件≥"+i[0]+" 倍数 100",r.getComponent(cc.Label).string="中级场：台费"+n[1]+" 进入条件≥"+i[1]+" 倍数 200",s.getComponent(cc.Label).string="高级场：台费"+n[2]+" 进入条件≥"+i[2]+" 倍数 500"}}}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],createRoom_heb:[function(e,t,a){"use strict";cc._RF.push(t,"2216eM+ladBIqNVtnBHR4sr","createRoom_heb");e("roomHandler");var h=e("configMgr"),l=e("gameDefine");cc.Class({extends:cc.Component,properties:{player2:cc.Toggle,player4:cc.Toggle,round:cc.Node,spendRound:cc.Node,round4:cc.Toggle,round8:cc.Toggle,round16:cc.Toggle,quan:cc.Node,spendQuan:cc.Node,quan1:cc.Toggle,quan2:cc.Toggle,quan4:cc.Toggle,dianpao:cc.Toggle,quemen:cc.Toggle,duibaofanbei:cc.Toggle,baotype:cc.Toggle,baseNode:cc.Node,base_1:cc.Toggle,base_2:cc.Toggle,base_3:cc.Toggle,spend:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.refreshUI(),this.addTouchListener()},onEnter:function(){},addTouchListener:function(){},getModeType:function(){return this.modeType},refreshUI:function(){cc.log("~~~~~~~~~~~~~~~~~~~~~~~~~GameData.createRoomOpts~~~~~~~~~~~~~~~~~~~~~~~~"+JSON.stringify(profileHeb.createRoomOpts)),this.round.active=2==profileHeb.createRoomOpts.joinermax,this.quan.active=4==profileHeb.createRoomOpts.joinermax,this.spendRound.active=2==profileHeb.createRoomOpts.joinermax,this.spendQuan.active=4==profileHeb.createRoomOpts.joinermax,this.player2.isChecked=2==profileHeb.createRoomOpts.joinermax,this.player4.isChecked=4==profileHeb.createRoomOpts.joinermax,this.round4.isChecked=4==profileHeb.createRoomOpts.roundMax,this.round8.isChecked=8==profileHeb.createRoomOpts.roundMax,this.round16.isChecked=16==profileHeb.createRoomOpts.roundMax,this.quan1.isChecked=1==profileHeb.createRoomOpts.roundMax,this.quan2.isChecked=2==profileHeb.createRoomOpts.roundMax,this.quan4.isChecked=4==profileHeb.createRoomOpts.roundMax,this.dianpao.isChecked=1==profileHeb.createRoomOpts.dianpao,this.quemen.isChecked=1==profileHeb.createRoomOpts.quemen,this.duibaofanbei.isChecked=1==profileHeb.createRoomOpts.duibaofanbei,this.baotype.isChecked=0==profileHeb.createRoomOpts.baotype,this.base_1.isChecked=0==profileChangChun.createRoomOpts.scoreLv,this.base_2.isChecked=1==profileChangChun.createRoomOpts.scoreLv,this.base_3.isChecked=2==profileChangChun.createRoomOpts.scoreLv,this.modeType=1,this.spendData=void 0,this.showSpendUI()},roundNodeActive:function(e){this.round.active=!!this.player2.isChecked,this.quan.active=!!this.player4.isChecked,this.spendRound.active=!!this.player2.isChecked,this.spendQuan.active=!!this.player4.isChecked,this.showSpendUI()},createRoom:function(e){this.saveRuleFromUI(),GameData.setGameType(l.GameType.Game_Mj_Heb);var t={gameType:l.GameType.Game_Mj_Heb,roundMax:profileHeb.createRoomOpts.roundMax,roundType:profileHeb.createRoomOpts.roundType,roundRule:profileHeb.createRoomOpts.roundRule,bossType:profileHeb.createRoomOpts.bossType,roomType:profileHeb.createRoomOpts.roomType,costType:profileHeb.createRoomOpts.costType,joinermax:profileHeb.createRoomOpts.joinermax,clubId:0,anBao:profileHeb.createRoomOpts.baotype,dianPaoBaoFu:profileHeb.createRoomOpts.dianpao,queMen:profileHeb.createRoomOpts.quemen,duiBaoDouble:profileHeb.createRoomOpts.duibaofanbei,scorelv:profileHeb.createRoomOpts.scoreLv,currencyType:null,settleType:null},a=h.getModeType();return null==a||null==a.Game_Mj_Heb?t:(t.currencyType=a.Game_Mj_Heb.CurrencyType,t.settleType=a.Game_Mj_Heb.SettleType,GameData.room.opts=t)},saveRuleFromUI:function(){this.player2.isChecked?(profileHeb.createRoomOpts.joinermax=2,profileHeb.createRoomOpts.roundType=1,this.round4.isChecked?(profileHeb.createRoomOpts.roundMax=4,profileHeb.createRoomOpts.roundRule=1):this.round8.isChecked?(profileHeb.createRoomOpts.roundMax=8,profileHeb.createRoomOpts.roundRule=2):this.round16.isChecked&&(profileHeb.createRoomOpts.roundMax=16,profileHeb.createRoomOpts.roundRule=3)):this.player4.isChecked&&(profileHeb.createRoomOpts.joinermax=4,profileHeb.createRoomOpts.roundType=2,this.quan1.isChecked?(profileHeb.createRoomOpts.roundRule=64,profileHeb.createRoomOpts.roundMax=1):this.quan2.isChecked?(profileHeb.createRoomOpts.roundRule=65,profileHeb.createRoomOpts.roundMax=2):this.quan4.isChecked&&(profileHeb.createRoomOpts.roundRule=66,profileHeb.createRoomOpts.roundMax=4)),this.base_1.isChecked?profileHeb.createRoomOpts.scoreLv=0:this.base_2.isChecked?profileHeb.createRoomOpts.scoreLv=1:this.base_3.isChecked?profileHeb.createRoomOpts.scoreLv=2:profileHeb.createRoomOpts.scoreLv=0,profileHeb.createRoomOpts.dianpao=this.dianpao.isChecked?1:0,profileHeb.createRoomOpts.quemen=this.quemen.isChecked?1:0,profileHeb.createRoomOpts.duibaofanbei=this.duibaofanbei.isChecked?1:0,profileHeb.createRoomOpts.baotype=this.baotype.isChecked?0:1,profileHeb.saveCreateRoomOpts()},selectSpendData:function(e){this.showSpendUI()},showSpendUI:function(){cc.log("..mode..哈尔滨..MJ");var e="",t=h.getModeType();if(null!=t&&null!=t.Game_Mj_Heb){var a=h.getServerConfig();if(null!=a){switch(this.modeType=t.Game_Mj_Heb.CurrencyType,this.modeType){case l.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[l.GameType.Game_Mj_Heb];break;case l.currencyType.Currency_Coin:e="金币",this.spendData=a.roomCoin[l.GameType.Game_Mj_Heb]}if(this.spendData){for(var n=0;n<this.drowArray.length;n++){var i=this.drowArray[n];i&&(i.active=!1)}var o=2;this.player2.isChecked?o=2:this.player4.isChecked&&(o=4);var r=60,s=63;1==this.player2.isChecked?(r=60,s=63):1==this.player4.isChecked&&(r=63,s=66);for(var c=r;c<s;c++){var d=0;this.modeType==l.currencyType.Currency_Card?(d=this.spendData[c+1].cost[o].final,this.spend[c-60].string="（"+e+"*"+d+"）"):(this.spendData[c-60].cost,d=this.spendData[c-60].cost,this.spend[c-60].string=""),d<=0&&(this.drowArray[c-60].active=!0)}this.refreshBaseScoreLv()}else cc.log("..spendData is undefined")}}},refreshBaseScoreLv:function(){if(this.modeType==l.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)this.baseNode.active=!1;else{this.baseNode.active=!0,this.player2.isChecked?(profileHeb.createRoomOpts.joinermax=2,profileHeb.createRoomOpts.roundType=1,this.round4.isChecked?(profileHeb.createRoomOpts.roundMax=4,profileHeb.createRoomOpts.roundRule=1):this.round8.isChecked?(profileHeb.createRoomOpts.roundMax=8,profileHeb.createRoomOpts.roundRule=2):this.round16.isChecked&&(profileHeb.createRoomOpts.roundMax=16,profileHeb.createRoomOpts.roundRule=3)):this.player4.isChecked&&(profileHeb.createRoomOpts.joinermax=4,profileHeb.createRoomOpts.roundType=2,this.quan1.isChecked?(profileHeb.createRoomOpts.roundRule=64,profileHeb.createRoomOpts.roundMax=1):this.quan2.isChecked?(profileHeb.createRoomOpts.roundRule=65,profileHeb.createRoomOpts.roundMax=2):this.quan4.isChecked&&(profileHeb.createRoomOpts.roundRule=66,profileHeb.createRoomOpts.roundMax=4));var e=2,t=0;this.player2.isChecked?(e=2,this.round4.isChecked?t=0:this.round8.isChecked?t=1:this.round16.isChecked&&(t=2)):this.player4.isChecked&&(e=4,this.quan1.isChecked?t=3:this.quan2.isChecked?t=4:this.quan4.isChecked&&(t=5));var a=this.spendData[t];if(null!=a){var n=a.cost[e],i=a.enter[e],o=cc.find("label",this.base_1.node),r=cc.find("label",this.base_2.node),s=cc.find("label",this.base_3.node);o.getComponent(cc.Label).string="初级场：台费"+n[0]+" 进入条件≥"+i[0]+" 倍数 100",r.getComponent(cc.Label).string="中级场：台费"+n[1]+" 进入条件≥"+i[1]+" 倍数 200",s.getComponent(cc.Label).string="高级场：台费"+n[2]+" 进入条件≥"+i[2]+" 倍数 500"}}}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],createRoom_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"d65caVX9cxIpJvabwJzalma","createRoom_huadian");e("roomHandler");var h=e("configMgr"),l=e("gameDefine");cc.Class({extends:cc.Component,properties:{player2_hd:cc.Toggle,player4_hd:cc.Toggle,round_hd:cc.Node,spendRound_hd:cc.Node,round6_hd:cc.Toggle,round12_hd:cc.Toggle,round24_hd:cc.Toggle,quan_hd:cc.Node,spendQuan_hd:cc.Node,quan1_hd:cc.Toggle,quan2_hd:cc.Toggle,quan4_hd:cc.Toggle,piao:cc.Toggle,mobaojiafen:cc.Toggle,louDianPaoDouble:cc.Toggle,dafan:cc.Toggle,xiaofan:cc.Toggle,fenzhang:cc.Toggle,bufenzhang:cc.Toggle,baseNode:cc.Node,base_1:cc.Toggle,base_2:cc.Toggle,base_3:cc.Toggle,spend_hd:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.refreshHdUI(),this.addTouchListener()},onEnter:function(){this.refreshHdUI()},addTouchListener:function(){},getModeType:function(){return this.modeType},refreshHdUI:function(){cc.log("~~~~~~~~~~~~~~~~~~~~~~~~~GameData.createRoomOpts~~~~~~~~~~~~~~~~~~~~~~~~"+JSON.stringify(profileHuaDian.createRoomOpts)),this.round_hd.active=2==profileHuaDian.createRoomOpts.joinermax,this.quan_hd.active=4==profileHuaDian.createRoomOpts.joinermax,this.spendRound_hd.active=2==profileHuaDian.createRoomOpts.joinermax,this.spendQuan_hd.active=4==profileHuaDian.createRoomOpts.joinermax,this.player2_hd.isChecked=2==profileHuaDian.createRoomOpts.joinermax,this.player4_hd.isChecked=4==profileHuaDian.createRoomOpts.joinermax,this.round6_hd.isChecked=6==profileHuaDian.createRoomOpts.roundMax,this.round12_hd.isChecked=12==profileHuaDian.createRoomOpts.roundMax,this.round24_hd.isChecked=24==profileHuaDian.createRoomOpts.roundMax,this.quan1_hd.isChecked=1==profileHuaDian.createRoomOpts.roundMax,this.quan2_hd.isChecked=2==profileHuaDian.createRoomOpts.roundMax,this.quan4_hd.isChecked=4==profileHuaDian.createRoomOpts.roundMax,this.piao.isChecked=1==profileHuaDian.createRoomOpts.piao,this.mobaojiafen.isChecked=1==profileHuaDian.createRoomOpts.mobaojiafen,this.louDianPaoDouble.isChecked=1==profileHuaDian.createRoomOpts.isLouDianPaoDouble,this.dafan.isChecked=1==profileHuaDian.createRoomOpts.isBigFan,this.xiaofan.isChecked=0==profileHuaDian.createRoomOpts.isBigFan,this.fenzhang.isChecked=1==profileHuaDian.createRoomOpts.fenZhang,this.bufenzhang.isChecked=0==profileHuaDian.createRoomOpts.fenZhang,this.base_1.isChecked=0==profileHuaDian.createRoomOpts.scoreLv,this.base_2.isChecked=1==profileHuaDian.createRoomOpts.scoreLv,this.base_3.isChecked=2==profileHuaDian.createRoomOpts.scoreLv,this.modeType=1,this.spendData=void 0,this.showSpendUI_hd()},roundNodeActive:function(e){this.round_hd.active=this.player2_hd.isChecked,this.quan_hd.active=this.player4_hd.isChecked,this.spendRound_hd.active=this.player2_hd.isChecked,this.spendQuan_hd.active=this.player4_hd.isChecked,this.showSpendUI_hd()},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(l.GameType.Game_MJ_HuaDian);var e={gameType:l.GameType.Game_MJ_HuaDian,roundMax:profileHuaDian.createRoomOpts.roundMax,roundType:profileHuaDian.createRoomOpts.roundType,roundRule:profileHuaDian.createRoomOpts.roundRule,roomType:0,costType:profileHuaDian.createRoomOpts.costType,joinermax:profileHuaDian.createRoomOpts.joinermax,clubId:0,scoreBase:profileHuaDian.createRoomOpts.scoreBase,bossType:profileHuaDian.createRoomOpts.bossType,isBigFan:profileHuaDian.createRoomOpts.isBigFan,piao:profileHuaDian.createRoomOpts.piao,anBao:1,mobaoBuf:profileHuaDian.createRoomOpts.mobaojiafen,fenZhang:profileHuaDian.createRoomOpts.fenZhang,isLouDianPaoDouble:profileHuaDian.createRoomOpts.isLouDianPaoDouble,scorelv:profileHuaDian.createRoomOpts.scoreLv,currencyType:null,settleType:null},t=h.getModeType();return null==t||null==t.Game_MJ_HuaDian?e:(e.currencyType=t.Game_MJ_HuaDian.CurrencyType,e.settleType=t.Game_MJ_HuaDian.SettleType,GameData.room.opts=e)},saveRuleFromUI:function(){this.player2_hd.isChecked?(profileHuaDian.createRoomOpts.joinermax=2,profileHuaDian.createRoomOpts.roundType=1,this.round6_hd.isChecked?(profileHuaDian.createRoomOpts.roundMax=6,profileHuaDian.createRoomOpts.roundRule=61):this.round12_hd.isChecked?(profileHuaDian.createRoomOpts.roundMax=12,profileHuaDian.createRoomOpts.roundRule=62):this.round24_hd.isChecked&&(profileHuaDian.createRoomOpts.roundRule=63,profileHuaDian.createRoomOpts.roundMax=24)):this.player4_hd.isChecked&&(profileHuaDian.createRoomOpts.joinermax=4,profileHuaDian.createRoomOpts.roundType=2,this.quan1_hd.isChecked?(profileHuaDian.createRoomOpts.roundRule=64,profileHuaDian.createRoomOpts.roundMax=1):this.quan2_hd.isChecked?(profileHuaDian.createRoomOpts.roundRule=65,profileHuaDian.createRoomOpts.roundMax=2):this.quan4_hd.isChecked&&(profileHuaDian.createRoomOpts.roundRule=66,profileHuaDian.createRoomOpts.roundMax=4)),this.base_1.isChecked?profileHuaDian.createRoomOpts.scoreLv=0:this.base_2.isChecked?profileHuaDian.createRoomOpts.scoreLv=1:this.base_3.isChecked?profileHuaDian.createRoomOpts.scoreLv=2:profileHuaDian.createRoomOpts.scoreLv=0,profileHuaDian.createRoomOpts.piao=this.piao.isChecked?1:0,profileHuaDian.createRoomOpts.mobaojiafen=this.mobaojiafen.isChecked?1:0,profileHuaDian.createRoomOpts.isLouDianPaoDouble=this.louDianPaoDouble.isChecked?1:0,profileHuaDian.createRoomOpts.isBigFan=this.dafan.isChecked?1:0,profileHuaDian.createRoomOpts.fenZhang=this.fenzhang.isChecked?1:0,profileHuaDian.saveCreateRoomOpts()},selectSpendData:function(e){this.showSpendUI_hd()},showSpendUI_hd:function(){cc.log("..mode..huadian..MJ");var e="",t=h.getModeType();if(null!=t&&null!=t.Game_MJ_HuaDian){var a=h.getServerConfig();if(null!=a){switch(this.modeType=t.Game_MJ_HuaDian.CurrencyType,this.modeType){case l.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[l.GameType.Game_MJ_HuaDian];break;case l.currencyType.Currency_Coin:e="金币",this.spendData=a.roomCoin[l.GameType.Game_MJ_HuaDian]}if(this.spendData){for(var n=0;n<this.drowArray.length;n++){var i=this.drowArray[n];i&&(i.active=!1)}var o=2;this.player2_hd.isChecked?o=2:this.player4_hd.isChecked&&(o=4);var r=60,s=63;1==this.player2_hd.isChecked?(r=60,s=63):1==this.player4_hd.isChecked&&(r=63,s=66);for(var c=r;c<s;c++){var d=0;this.modeType==l.currencyType.Currency_Card?(d=this.spendData[c+1].cost[o].final,this.spend_hd[c-60].string="（"+e+"*"+d+"）"):this.modeType==l.currencyType.Currency_Coin&&(d=this.spendData[c-60].cost[o].final,this.spend_hd[c-60].string=""),d<=0&&(this.drowArray[c-60].active=!0)}this.refreshBaseScoreLv()}else cc.log("..spendData is undefined")}}},refreshBaseScoreLv:function(){if(this.modeType==l.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)this.baseNode.active=!1;else{this.baseNode.active=!0;var e=2,t=0;this.player2_hd.isChecked?(e=2,this.round6_hd.isChecked?t=0:this.round12_hd.isChecked?t=1:this.round24_hd.isChecked&&(t=2)):this.player4_hd.isChecked&&(e=4,this.quan1_hd.isChecked?t=3:this.quan2_hd.isChecked?t=4:this.quan4_hd.isChecked&&(t=5));var a=this.spendData[t];if(null!=a){var n=a.cost[e],i=a.enter[e],o=cc.find("label",this.base_1.node),r=cc.find("label",this.base_2.node),s=cc.find("label",this.base_3.node);o.getComponent(cc.Label).string="初级场：台费"+n[0]+" 进入条件≥"+i[0]+" 倍数 100",r.getComponent(cc.Label).string="中级场：台费"+n[1]+" 进入条件≥"+i[1]+" 倍数 200",s.getComponent(cc.Label).string="高级场：台费"+n[2]+" 进入条件≥"+i[2]+" 倍数 500"}}}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],createRoom_shishi:[function(e,t,a){"use strict";cc._RF.push(t,"462b6e177FI860+tRRrdalz","createRoom_shishi");e("roomHandler");var d=e("configMgr"),h=e("gameDefine");cc.Class({extends:cc.Component,properties:{round4:cc.Toggle,round8:cc.Toggle,round16:cc.Toggle,turn1:cc.Toggle,mingyou:cc.Toggle,anyou:cc.Toggle,player2:cc.Toggle,player3:cc.Toggle,player4:cc.Toggle,danpei:cc.Toggle,tongpei:cc.Toggle,fengtou:cc.Toggle,shuangjin:cc.Toggle,chashui:cc.Toggle,qg_zimo:cc.Toggle,qg_pinghu:cc.Toggle,pay1_ord:cc.Toggle,pay2_ord:cc.Toggle,pay3_ord:cc.Toggle,payOrdNode:cc.Node,socre1Btn:cc.Toggle,socre2Btn:cc.Toggle,scoreGrop:cc.Node,you1Btn:cc.Toggle,you2Btn:cc.Toggle,you3Btn:cc.Toggle,anyouGroup:cc.Node,scollView:cc.ScrollView,spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.ToggleObjArry={},this.modeType=1,this.spendData=void 0,this.player2.isChecked=!1,this.player3.isChecked=!1,this.player4.isChecked=!0,this.refreshUI(),this.pushBtnsToArry()},getModeType:function(){return this.modeType},pushBtnsToArry:function(){this.ToggleObjArry.round4=this.round4,this.ToggleObjArry.round8=this.round8,this.ToggleObjArry.round16=this.round16,this.ToggleObjArry.turn1=this.turn1,this.ToggleObjArry.mingyou=this.mingyou,this.ToggleObjArry.anyou=this.anyou,this.ToggleObjArry.player2=this.player2,this.ToggleObjArry.player3=this.player3,this.ToggleObjArry.player4=this.player4,this.ToggleObjArry.danpei=this.danpei,this.ToggleObjArry.tongpei=this.tongpei,this.ToggleObjArry.fengtou=this.fengtou,this.ToggleObjArry.shuangjin=this.shuangjin,this.ToggleObjArry.chashui=this.chashui,this.ToggleObjArry.pay1_ord=this.pay1_ord,this.ToggleObjArry.pay2_ord=this.pay2_ord,this.ToggleObjArry.pay3_ord=this.pay3_ord,this.ToggleObjArry.socre1Btn=this.socre1Btn,this.ToggleObjArry.socre2Btn=this.socre2Btn,this.ToggleObjArry.you1Btn=this.you1Btn,this.ToggleObjArry.you2Btn=this.you2Btn,this.ToggleObjArry.you3Btn=this.you3Btn,this.ToggleObjArry.qg_zimo=this.qg_zimo,this.ToggleObjArry.qg_pinghu=this.qg_pinghu},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(h.GameType.Game_Mj_Shishi);var e=!1,t=!1;GameDataShiShi.createRoomOpts.youJin==YoujinType.Ming&&(e=GameDataShiShi.createRoomOpts.qg_zimo,t=GameDataShiShi.createRoomOpts.qg_pinghu);var a={gameType:GameData.client.gameType,roundRule:GameDataShiShi.createRoomOpts.roundRule,roomType:0,costType:GameDataShiShi.createRoomOpts.payType,joinermax:GameDataShiShi.createRoomOpts.joinermax,clubId:0,dianpao:GameDataShiShi.createRoomOpts.dianpao,fengtou:GameDataShiShi.createRoomOpts.fengtou,scoreBase:GameDataShiShi.createRoomOpts.scoreBase,youJin:GameDataShiShi.createRoomOpts.youJin,playeruid:GameData.player.uid,shuangjin:GameDataShiShi.createRoomOpts.shuangjin,water:GameDataShiShi.createRoomOpts.chashui,qg_zimo:e,qg_pinghu:t,currencyType:null,settleType:null},n=d.getModeType();return null==n||null==n.Game_Mj_Shishi||(a.currencyType=n.Game_Mj_Shishi.CurrencyType,a.settleType=n.Game_Mj_Shishi.SettleType),a},showSpendUI:function(){cc.log("..mode..shishiMJ");var e="",t="",a=d.getModeType();if(null!=a&&null!=a.Game_Mj_Shishi){var n=d.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Mj_Shishi.CurrencyType,this.modeType){case h.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[h.GameType.Game_Mj_Shishi];break;case h.currencyType.Currency_Coin:e="金币",this.spendData=n.roomCoin[h.GameType.Game_Mj_Shishi]}if(this.spendData)for(var i=0;i<Object.keys(this.spendData).length;i++){var o=0;if(this.modeType==h.currencyType.Currency_Card){var r=this.spendData[i+1].cost,s=2;this.player2.isChecked?s=2:this.player3.isChecked?s=3:this.player4.isChecked&&(s=4),o=r[s].final,this.pay2_ord.isChecked&&(o=Math.ceil(o/s),t="/人")}else o=this.spendData[i].cost;if(cc.log("..final:"+o),cc.log("..key:"+i),this.drowArray[i].active=o<=0,this.spendUI[i].string="（"+e+"*"+o+t+"）",3<=i){var c=!0;if(3==i)c=!!this.socre1Btn.isChecked;else{if(4!=i)continue;c=!!this.socre2Btn.isChecked}0==this.scoreGrop.active&&(c=!1),this.spendUI[i].node.active=c,this.drowArray[i].active=c,0<o&&(this.drowArray[i].active=!1)}}else cc.log("..spendData is undefined")}}},saveRuleFromUI:function(){this.round4.isChecked?GameDataShiShi.createRoomOpts.roundRule=1:this.round8.isChecked?GameDataShiShi.createRoomOpts.roundRule=2:this.round16.isChecked&&(GameDataShiShi.createRoomOpts.roundRule=3),this.turn1.isChecked?this.socre1Btn.isChecked?(GameDataShiShi.createRoomOpts.scoreBase=50,GameDataShiShi.createRoomOpts.roundRule=4):(GameDataShiShi.createRoomOpts.scoreBase=100,GameDataShiShi.createRoomOpts.roundRule=5):GameDataShiShi.createRoomOpts.scoreBase=0,this.player2.isChecked?GameDataShiShi.createRoomOpts.joinermax=2:this.player3.isChecked?GameDataShiShi.createRoomOpts.joinermax=3:(this.player4.isChecked,GameDataShiShi.createRoomOpts.joinermax=4),this.mingyou.isChecked?GameDataShiShi.createRoomOpts.youJin=YoujinType.Ming:this.anyou.isChecked&&(this.you1Btn.isChecked?GameDataShiShi.createRoomOpts.youJin=YoujinType.An1:this.you2Btn.isChecked?GameDataShiShi.createRoomOpts.youJin=YoujinType.An2:this.you3Btn.isChecked&&(GameDataShiShi.createRoomOpts.youJin=YoujinType.An3)),GameDataShiShi.createRoomOpts.qg_zimo=this.qg_zimo.isChecked,GameDataShiShi.createRoomOpts.qg_pinghu=this.qg_pinghu.isChecked,this.danpei.isChecked?GameDataShiShi.createRoomOpts.dianpao=1:(this.tongpei.isChecked,GameDataShiShi.createRoomOpts.dianpao=2),GameDataShiShi.createRoomOpts.payType=1,this.payOrdNode.active&&(this.pay1_ord.isChecked?GameDataShiShi.createRoomOpts.payType=1:this.pay2_ord.isChecked?GameDataShiShi.createRoomOpts.payType=2:this.pay3_ord.isChecked&&(GameDataShiShi.createRoomOpts.payType=3)),this.fengtou.isChecked?GameDataShiShi.createRoomOpts.fengtou=!0:GameDataShiShi.createRoomOpts.fengtou=!1,this.shuangjin.isChecked?GameDataShiShi.createRoomOpts.shuangjin=!0:GameDataShiShi.createRoomOpts.shuangjin=!1,this.chashui.isChecked?GameDataShiShi.createRoomOpts.chashui=!0:GameDataShiShi.createRoomOpts.chashui=!1,GameDataShiShi.saveCreateRoomOpts()},refreshUI:function(){this.round4.isChecked=1==GameDataShiShi.createRoomOpts.roundRule,this.round8.isChecked=2==GameDataShiShi.createRoomOpts.roundRule,this.round16.isChecked=3==GameDataShiShi.createRoomOpts.roundRule,this.turn1.isChecked=4==GameDataShiShi.createRoomOpts.roundRule||5==GameDataShiShi.createRoomOpts.roundRule,this.turn1.isChecked?(this.socre1Btn.isChecked=50==GameDataShiShi.createRoomOpts.scoreBase,this.socre2Btn.isChecked=100==GameDataShiShi.createRoomOpts.scoreBase):(this.socre1Btn.isChecked=!0,this.socre2Btn.isChecked=!1),this.pay1_ord.isChecked=1==GameDataShiShi.createRoomOpts.payType,this.pay2_ord.isChecked=2==GameDataShiShi.createRoomOpts.payType,this.pay3_ord.isChecked=3==GameDataShiShi.createRoomOpts.payType,this.player2.isChecked=2==GameDataShiShi.createRoomOpts.joinermax,this.player3.isChecked=3==GameDataShiShi.createRoomOpts.joinermax,this.player4.isChecked=4==GameDataShiShi.createRoomOpts.joinermax,this.danpei.isChecked=1==GameDataShiShi.createRoomOpts.dianpao,this.tongpei.isChecked=1!=GameDataShiShi.createRoomOpts.dianpao,this.mingyou.isChecked=GameDataShiShi.createRoomOpts.youJin==YoujinType.Ming,this.anyou.isChecked=GameDataShiShi.createRoomOpts.youJin!=YoujinType.Ming,this.anyou.isChecked&&(this.you1Btn.isChecked=GameDataShiShi.createRoomOpts.youJin==YoujinType.An1,this.you2Btn.isChecked=GameDataShiShi.createRoomOpts.youJin==YoujinType.An2,this.you3Btn.isChecked=GameDataShiShi.createRoomOpts.youJin==YoujinType.An3);var e=!1;this.mingyou.isChecked&&(e=!0),this.qg_zimo.node.active=e,this.qg_pinghu.node.active=e,this.fengtou.isChecked=GameDataShiShi.createRoomOpts.fengtou,this.shuangjin.isChecked=GameDataShiShi.createRoomOpts.shuangjin,this.chashui.isChecked=GameDataShiShi.createRoomOpts.chashui,this.qg_zimo.isChecked=GameDataShiShi.createRoomOpts.qg_zimo,this.qg_pinghu.isChecked=GameDataShiShi.createRoomOpts.qg_pinghu,this.scoreGrop.active=this.turn1.isChecked,this.spendUI[3].node.active=this.turn1.isChecked,this.spendUI[4].node.active=this.turn1.isChecked,this.anyouGroup.active=this.anyou.isChecked,this.showSpendUI()},youjinActive:function(){this.anyouGroup.active=this.anyou.isChecked;var e=!1;this.mingyou.isChecked&&(e=!0),this.qg_zimo.node.active=e,this.qg_pinghu.node.active=e},yikeActive:function(){cc.log("..yi..ke"),this.scoreGrop.active=this.turn1.isChecked,this.showSpendUI()},openScrollViewChildListenr:function(){for(var e in this.ToggleObjArry)this.ToggleObjArry[e].node.on(cc.Node.EventType.TOUCH_START,this.closeScrollView,this),this.ToggleObjArry[e].node.on(cc.Node.EventType.TOUCH_MOVE,this.closeScrollView,this),this.ToggleObjArry[e].node.on(cc.Node.EventType.TOUCH_END,this.openScrollView,this),this.ToggleObjArry[e].node.on(cc.Node.EventType.TOUCH_CANCEL,this.openScrollView,this)},offScrollViewChildListenr:function(){for(var e in this.ToggleObjArry)this.ToggleObjArry[e].node.off(cc.Node.EventType.TOUCH_START,this.closeScrollView,this),this.ToggleObjArry[e].node.off(cc.Node.EventType.TOUCH_MOVE,this.closeScrollView,this),this.ToggleObjArry[e].node.off(cc.Node.EventType.TOUCH_END,this.openScrollView,this),this.ToggleObjArry[e].node.off(cc.Node.EventType.TOUCH_CANCEL,this.openScrollView,this)},closeScrollView:function(){this.scollView.node.off(cc.Node.EventType.TOUCH_MOVE,this.scollView._onTouchMoved,this.scollView,!0)},openScrollView:function(){this.scollView.node.on(cc.Node.EventType.TOUCH_MOVE,this.scollView._onTouchMoved,this.scollView,!0)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],createRoom:[function(e,t,a){"use strict";cc._RF.push(t,"a9facnOZRdG0ZHJOj/lJ5G/","createRoom");e("roomHandler");var s=e("configMgr"),c=e("gameDefine");e("SoundMngr");cc.Class({extends:cc.Component,properties:{round4:cc.Toggle,round8:cc.Toggle,round16:cc.Toggle,turn1:cc.Toggle,turn2:cc.Toggle,turn4:cc.Toggle,spendUI:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]},scoreNode:cc.Node,score1:cc.Toggle,score2:cc.Toggle,score5:cc.Toggle,timesNode:cc.Node,times1:cc.Toggle,times2:cc.Toggle,times5:cc.Toggle,limitLabel:cc.Label,hun:cc.Toggle,zi:cc.Toggle,feng:cc.Toggle,chan:cc.Toggle,longwufan:cc.Toggle,doubleGang:cc.Toggle,huierModel:cc.Toggle,jingang4:cc.Toggle,jingang8:cc.Toggle,zuo2:cc.Toggle,lianzhuang:cc.Toggle,buzuobula:cc.Toggle,payNode:cc.Node,pay1:cc.Toggle,pay2:cc.Toggle,pay3:cc.Toggle,player2:cc.Toggle,player3:cc.Toggle,player4:cc.Toggle,PlayInfo:cc.Prefab},onLoad:function(){this.ToggleObjArry={},this.modeType=1,this.spendData=void 0,this.refreshRuleUI()},getModeType:function(){return this.modeType},refreshRuleUI:function(){this.round4.isChecked=1==GameData.createRoomOpts.roundRule,this.round8.isChecked=2==GameData.createRoomOpts.roundRule,this.round16.isChecked=3==GameData.createRoomOpts.roundRule,this.turn1.isChecked=4==GameData.createRoomOpts.roundRule,this.turn2.isChecked=5==GameData.createRoomOpts.roundRule,this.turn4.isChecked=6==GameData.createRoomOpts.roundRule,this.hun.isChecked=1==GameData.createRoomOpts.huierDiao,this.zi.isChecked=1==GameData.createRoomOpts.daZi,this.feng.isChecked=1==GameData.createRoomOpts.daiFeng,this.chan.isChecked=1==GameData.createRoomOpts.daiChan,this.longwufan.isChecked=1==GameData.createRoomOpts.longwufan,this.doubleGang.isChecked=1==GameData.createRoomOpts.doubleGang,this.huierModel.isChecked=1==GameData.createRoomOpts.huierModel,this.jingang4.isChecked=8==GameData.createRoomOpts.jGangScore,this.jingang8.isChecked=8==GameData.createRoomOpts.jGangScore,this.zuo2.isChecked=1==GameData.createRoomOpts.laType,this.lianzhuang.isChecked=2==GameData.createRoomOpts.laType,this.buzuobula.isChecked=3==GameData.createRoomOpts.laType,this.score1.isChecked=1==GameData.createRoomOpts.times,this.score2.isChecked=2==GameData.createRoomOpts.times,this.score5.isChecked=5==GameData.createRoomOpts.times,this.player2.isChecked=2==GameData.createRoomOpts.joinermax,this.player3.isChecked=3==GameData.createRoomOpts.joinermax,this.player4.isChecked=4==GameData.createRoomOpts.joinermax,this.pay1.isChecked=1==GameData.createRoomOpts.payType,this.pay2.isChecked=2==GameData.createRoomOpts.payType,this.pay3.isChecked=3==GameData.createRoomOpts.payType,this.times1.isChecked=0==GameData.createRoomOpts.score,this.times2.isChecked=1==GameData.createRoomOpts.score,this.times5.isChecked=2==GameData.createRoomOpts.score,this.showDoubleGang(),this.showSpendUI(),this.refreshTimesScore()},selectRoundRuleClick:function(e,t){if(null!=t){switch(t){case 4:this.round4.isChecked=!0,this.round8.isChecked=!1,this.round16.isChecked=!1,this.turn1.isChecked=!1,this.turn2.isChecked=!1,this.turn4.isChecked=!1;break;case 8:this.round8.isChecked=!0,this.round4.isChecked=!1,this.round16.isChecked=!1,this.turn1.isChecked=!1,this.turn2.isChecked=!1,this.turn4.isChecked=!1;break;case 16:this.round16.isChecked=!0,this.round4.isChecked=!1,this.round8.isChecked=!1,this.turn1.isChecked=!1,this.turn2.isChecked=!1,this.turn4.isChecked=!1;break;case 21:this.turn1.isChecked=!0,this.round4.isChecked=!1,this.round8.isChecked=!1,this.round16.isChecked=!1,this.turn2.isChecked=!1,this.turn4.isChecked=!1;break;case 22:this.turn2.isChecked=!0,this.round4.isChecked=!1,this.round8.isChecked=!1,this.round16.isChecked=!1,this.turn1.isChecked=!1,this.turn4.isChecked=!1;break;case 24:this.turn4.isChecked=!0,this.round4.isChecked=!1,this.round8.isChecked=!1,this.round16.isChecked=!1,this.turn1.isChecked=!1,this.turn2.isChecked=!1}this.round4.isChecked?GameData.createRoomOpts.roundRule=1:this.round8.isChecked?GameData.createRoomOpts.roundRule=2:this.round16.isChecked?GameData.createRoomOpts.roundRule=3:this.turn1.isChecked?GameData.createRoomOpts.roundRule=4:this.turn2.isChecked?GameData.createRoomOpts.roundRule=5:this.turn4.isChecked?GameData.createRoomOpts.roundRule=6:GameData.createRoomOpts.roundRule=2,this.refreshTimesScore()}},selectScroeClick:function(e,t){if(null!=t){switch(t){case 1:this.score1.isChecked=!0,this.score2.isChecked=!1,this.score5.isChecked=!1;break;case 2:this.score2.isChecked=!0,this.score1.isChecked=!1,this.score5.isChecked=!1;break;case 5:this.score5.isChecked=!0,this.score1.isChecked=!1,this.score2.isChecked=!1}this.score1.isChecked?GameData.createRoomOpts.times=1:this.score2.isChecked?GameData.createRoomOpts.times=2:this.score5.isChecked?GameData.createRoomOpts.times=5:GameData.createRoomOpts.times=1,this.refreshTimesScore()}},saveRuleFromUI:function(){this.round4.isChecked?(GameData.createRoomOpts.roundRule=1,GameData.createRoomOpts.roundType=c.roundType.round,GameData.createRoomOpts.roundMax=4):this.round8.isChecked?(GameData.createRoomOpts.roundRule=2,GameData.createRoomOpts.roundType=c.roundType.round,GameData.createRoomOpts.roundMax=8):this.round16.isChecked?(GameData.createRoomOpts.roundRule=3,GameData.createRoomOpts.roundType=c.roundType.round,GameData.createRoomOpts.roundMax=16):this.turn1.isChecked?(GameData.createRoomOpts.roundRule=4,GameData.createRoomOpts.roundType=c.roundType.quan,GameData.createRoomOpts.roundMax=1):this.turn2.isChecked?(GameData.createRoomOpts.roundRule=5,GameData.createRoomOpts.roundType=c.roundType.quan,GameData.createRoomOpts.roundMax=2):this.turn4.isChecked?(GameData.createRoomOpts.roundRule=6,GameData.createRoomOpts.roundType=c.roundType.quan,GameData.createRoomOpts.roundMax=4):(GameData.createRoomOpts.roundRule=2,GameData.createRoomOpts.roundType=c.roundType.round,GameData.createRoomOpts.roundMax=8),GameData.createRoomOpts.huierDiao=!!this.hun.isChecked,GameData.createRoomOpts.daZi=!!this.zi.isChecked,GameData.createRoomOpts.daiFeng=!!this.feng.isChecked,GameData.createRoomOpts.daiChan=!!this.chan.isChecked,GameData.createRoomOpts.longwufan=!!this.longwufan.isChecked,GameData.createRoomOpts.huierModel=this.huierModel.isChecked?1:0,this.jingang4.isChecked||this.jingang8.isChecked,GameData.createRoomOpts.jGangScore=8,this.zuo2.isChecked?(GameData.createRoomOpts.laType=1,GameData.createRoomOpts.doubleGang=!!this.doubleGang.isChecked,this.doubleGang.node.active=!0):this.lianzhuang.isChecked?(GameData.createRoomOpts.laType=2,GameData.createRoomOpts.doubleGang=!!this.doubleGang.isChecked,this.doubleGang.node.active=!0):this.buzuobula.isChecked?(GameData.createRoomOpts.laType=3,GameData.createRoomOpts.doubleGang=!1,this.doubleGang.node.active=!1):(GameData.createRoomOpts.laType=1,GameData.createRoomOpts.doubleGang=!1,this.doubleGang.node.active=!0),this.score1.isChecked?GameData.createRoomOpts.times=1:this.score2.isChecked?GameData.createRoomOpts.times=2:this.score5.isChecked?GameData.createRoomOpts.times=5:GameData.createRoomOpts.times=1,this.player2.isChecked?GameData.createRoomOpts.joinermax=2:this.player3.isChecked?GameData.createRoomOpts.joinermax=3:(this.player4.isChecked,GameData.createRoomOpts.joinermax=4),this.pay1.isChecked?GameData.createRoomOpts.payType=1:this.pay2.isChecked?GameData.createRoomOpts.payType=2:this.pay3.isChecked?GameData.createRoomOpts.payType=3:GameData.createRoomOpts.payType=1,this.times1.isChecked?GameData.createRoomOpts.score=0:this.times2.isChecked?GameData.createRoomOpts.score=1:this.times5.isChecked&&(GameData.createRoomOpts.score=2),GameData.saveCreateRoomOpts()},createRoom:function(){this.saveRuleFromUI(),GameData.setGameType(c.GameType.Game_Mj_Tianjin);var e={gameType:GameData.client.gameType,roundRule:GameData.createRoomOpts.roundRule,roundType:GameData.createRoomOpts.roundType,roundMax:GameData.createRoomOpts.roundMax,roomType:0,costType:GameData.createRoomOpts.payType,joinermax:GameData.createRoomOpts.joinermax,clubId:0,playeruid:GameData.player.uid,feng:GameData.createRoomOpts.daiFeng,chan:GameData.createRoomOpts.daiChan,doubleGang:GameData.createRoomOpts.doubleGang,huierModel:GameData.createRoomOpts.huierModel,hd:GameData.createRoomOpts.huierDiao,longwufan:GameData.createRoomOpts.longwufan,score:GameData.createRoomOpts.score,times:GameData.createRoomOpts.times,jingang:GameData.createRoomOpts.jGangScore,lazhuang:GameData.createRoomOpts.laType,scorelv:GameData.createRoomOpts.score,currencyType:null,settleType:null},t=s.getModeType();return null==t||null==t.Game_Mj_Tianjin||(e.currencyType=t.Game_Mj_Tianjin.CurrencyType,e.settleType=t.Game_Mj_Tianjin.SettleType),e},selectSpendData:function(e){this.showSpendUI(),this.refreshTimesScore()},refreshTimesScore:function(){if(this.modeType==c.currencyType.Currency_Card||null==this.spendData||this.spendData.length<=0)return this.timesNode.active=!1,void(this.payNode.active=!0);this.timesNode.active=!0,this.payNode.active=!1;var e=2;this.player2.isChecked?e=2:this.player3.isChecked?e=3:this.player4.isChecked&&(e=4);var t=this.spendData[GameData.createRoomOpts.roundRule-1].cost[e],a=this.spendData[GameData.createRoomOpts.roundRule-1].enter[e];null==GameData.createRoomOpts.times&&(GameData.createRoomOpts.times=1),this.times1.isChecked?GameData.createRoomOpts.score=0:this.times2.isChecked?GameData.createRoomOpts.score=1:this.times5.isChecked&&(GameData.createRoomOpts.score=2);var n=cc.find("label",this.times1.node),i=cc.find("label",this.times2.node),o=cc.find("label",this.times5.node);n.getComponent(cc.Label).string="初级场：台费"+t[0]+" 进入条件≥"+a[0]+" 倍数 100",i.getComponent(cc.Label).string="中级场：台费"+t[1]+" 进入条件≥"+a[1]+" 倍数 200",o.getComponent(cc.Label).string="高级场：台费"+t[2]+" 进入条件≥"+a[2]+" 倍数 500"},showSpendUI:function(){cc.log("..mode..tianjing..MJ");var e="",t="",a=s.getModeType();if(null!=a&&null!=a.Game_Mj_Tianjin){var n=s.getServerConfig();if(null!=n){switch(this.modeType=a.Game_Mj_Tianjin.CurrencyType,this.modeType){case c.currencyType.Currency_Card:e="房卡",this.spendData=n.roomCard[c.GameType.Game_Mj_Tianjin];break;case c.currencyType.Currency_Coin:e="金",this.spendData=n.roomCoin[c.GameType.Game_Mj_Tianjin]}if(null!=this.spendData){var i=2;this.player2.isChecked?i=2:this.player3.isChecked?i=3:this.player4.isChecked&&(i=4);for(var o=0;o<Object.keys(this.spendData).length;o++){var r=0;this.modeType==c.currencyType.Currency_Card?(r=this.spendData[o+1].cost[i].final,r=Math.ceil(r/i),t="/人",this.spendUI[o].string="（"+e+"*"+r+t+"）"):this.modeType==c.currencyType.Currency_Coin&&(r=this.spendData[o].cost[i].final,t="/局",3<=o&&(t="/圈"),this.spendUI[o].string=""),this.drowArray[o].active=r<=0}}else cc.log("..spendData is undefined")}}},selectLaZhuang:function(e){this.showDoubleGang()},showDoubleGang:function(){this.buzuobula.isChecked?(this.doubleGang.isChecked=!1,this.doubleGang.node.active=!1):this.doubleGang.node.active=!0},skipToPlayInfo:function(e,t){c.ruleType.isRuleType=!0,c.ruleType.type=3,1==t?c.ruleType.py=1e3:2==t&&(c.ruleType.py=883),openView("PlayIntroPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],debugView:[function(e,t,a){"use strict";cc._RF.push(t,"99255egnbxGbYxndBak3K6V","debugView");e("gameDefine"),e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,wildCards:cc.EditBox},onClose:function(){this.node.active=!1},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){cc.log("debug rtn: ",JSON.stringify(e))})},onSetWildcard:function(){var e=this.wildCards.string,t={roomid:GameData.room.id,cards:parseInt(e)};GameNet.getInstance().request("game.debugHandler.setWildCards",t,function(e){})}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine"}],debug_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"62c63kFTilNAKTGfpJ1X1MW","debug_changchun");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,editBaoCards:cc.EditBox,editNextCard:cc.EditBox,cardInput:cc.EditBox,parents:{default:[],type:cc.Node},debugBtn:cc.Node},onLoad:function(){var e=n.getSetCardsOpen();this.debugBtn.active=e},onClose:function(){this.node.getComponent("roomMain_changchun").showDebugLayer()},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){})},onSetBaoCards:function(){for(var e=this.editBaoCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setWildCards",n,function(e){})},onSetNextCard:function(){for(var e=this.editNextCard.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setWildCards",n,function(e){})},testAllCardShow:function(){for(var e=0;e<this.parents.length;e++){var t=this.parents[e];"layer_down"!=t.name&&(cc.find("cardHand",t).active=!1)}var a=this.cardInput.string;this.testHand(a),this.testPeng(a),this.testDis(a)},testHand:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];if("layer_down"==a.name)for(var n=cc.find("cardHand",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("cardHand"+i);this.showCardContent(o,"mj_card_xia_shou",e)}}},testDis:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];a.active=!0;for(var n=cc.find("cardDis",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("card_face"+(i+1));o.active=!0,"layer_down"==a.name?this.showCardContent(o,"mj_card_xia_chu",e):"layer_right"==a.name?this.showCardContent(o,"mj_card_you_chu",e):"layer_left"==a.name?this.showCardContent(o,"mj_card_zuo_chu",e):"layer_up"==a.name&&this.showCardContent(o,"mj_card_shang_chu",e)}}},testPeng:function(e){for(var t=0;t<this.parents.length;t++)for(var a=this.parents[t],n=0;n<GameData.room.opts.joinermax;n++){var i=cc.find("cardPeng/cardPeng"+(n+1),a);i.active=!0;for(var o=0;o<4;o++){var r=i.getChildByName("card_face"+(o+1));r.active=!0,"layer_down"==a.name?this.showCardContent(r,"mj_card_xia_peng",e):"layer_right"==a.name?this.showCardContent(r,"mj_card_you_peng",e):"layer_left"==a.name?this.showCardContent(r,"mj_card_zuo_peng",e):"layer_up"==a.name&&this.showCardContent(r,"mj_card_shang_chu",e)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i="resources/mjcard/"+t+"_"+n.index+"_"+a+".png";cc.log("load Card URL :"+i);var o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}else cc.log("missing card Component, please add it")}}),cc._RF.pop()},{configMgr:"configMgr"}],debug_heb:[function(e,t,a){"use strict";cc._RF.push(t,"133cd/i7apJqbXgLkH0QUYW","debug_heb");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,editBaoCards:cc.EditBox,editNextCard:cc.EditBox,cardInput:cc.EditBox,parents:{default:[],type:cc.Node},debugBtn:cc.Node},onLoad:function(){var e=n.getSetCardsOpen();this.debugBtn.active=e},onClose:function(){this.node.getComponent("roomMain_heb").showDebugLayer()},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){})},onSetBaoCards:function(){for(var e=this.editBaoCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setWildCards",n,function(e){})},onSetNextCard:function(){for(var e=this.editNextCard.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setWildCards",n,function(e){})},testAllCardShow:function(){for(var e=0;e<this.parents.length;e++){var t=this.parents[e];"layer_down"!=t.name&&(cc.find("cardHand",t).active=!1)}var a=this.cardInput.string;this.testHand(a),this.testPeng(a),this.testDis(a)},testHand:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];if("layer_down"==a.name)for(var n=cc.find("cardHand",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("cardHand"+i);this.showCardContent(o,"mj_card_xia_shou",e)}}},testDis:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];a.active=!0;for(var n=cc.find("cardDis",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("card_face"+(i+1));o.active=!0,"layer_down"==a.name?this.showCardContent(o,"mj_card_xia_chu",e):"layer_right"==a.name?this.showCardContent(o,"mj_card_you_chu",e):"layer_left"==a.name?this.showCardContent(o,"mj_card_zuo_chu",e):"layer_up"==a.name&&this.showCardContent(o,"mj_card_shang_chu",e)}}},testPeng:function(e){for(var t=0;t<this.parents.length;t++)for(var a=this.parents[t],n=0;n<GameData.room.opts.joinermax;n++){var i=cc.find("cardPeng/cardPeng"+(n+1),a);i.active=!0;for(var o=0;o<4;o++){var r=i.getChildByName("card_face"+(o+1));r.active=!0,"layer_down"==a.name?this.showCardContent(r,"mj_card_xia_peng",e):"layer_right"==a.name?this.showCardContent(r,"mj_card_you_peng",e):"layer_left"==a.name?this.showCardContent(r,"mj_card_zuo_peng",e):"layer_up"==a.name&&this.showCardContent(r,"mj_card_shang_chu",e)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i="resources/mjcard/"+t+"_"+n.index+"_"+a+".png";cc.log("load Card URL :"+i);var o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}else cc.log("missing card Component, please add it")}}),cc._RF.pop()},{configMgr:"configMgr"}],debug_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"c62adr13/NPcaVjVCsOkZgx","debug_huadian");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,editBaoCards:cc.EditBox,cardInput:cc.EditBox,parents:{default:[],type:cc.Node},debugBtn:cc.Node},onLoad:function(){var e=n.getSetCardsOpen();this.debugBtn.active=e},onClose:function(){this.node.getComponent("roomMain_huadian").showDebugLayer()},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){})},onSetBaoCards:function(){for(var e=this.editBaoCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setWildCards",n,function(e){})},testAllCardShow:function(){for(var e=0;e<this.parents.length;e++){var t=this.parents[e];"layer_down"!=t.name&&(cc.find("cardHand",t).active=!1)}var a=this.cardInput.string;this.testHand(a),this.testPeng(a),this.testDis(a)},testHand:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];if("layer_down"==a.name)for(var n=cc.find("cardHand",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("cardHand"+i);this.showCardContent(o,"mj_card_xia_shou",e)}}},testDis:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];a.active=!0;for(var n=cc.find("cardDis",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("card_face"+(i+1));o.active=!0,"layer_down"==a.name?this.showCardContent(o,"mj_card_xia_chu",e):"layer_right"==a.name?this.showCardContent(o,"mj_card_you_chu",e):"layer_left"==a.name?this.showCardContent(o,"mj_card_zuo_chu",e):"layer_up"==a.name&&this.showCardContent(o,"mj_card_shang_chu",e)}}},testPeng:function(e){for(var t=0;t<this.parents.length;t++)for(var a=this.parents[t],n=0;n<GameData.room.opts.joinermax;n++){var i=cc.find("cardPeng/cardPeng"+(n+1),a);i.active=!0;for(var o=0;o<4;o++){var r=i.getChildByName("card_face"+(o+1));r.active=!0,"layer_down"==a.name?this.showCardContent(r,"mj_card_xia_peng",e):"layer_right"==a.name?this.showCardContent(r,"mj_card_you_peng",e):"layer_left"==a.name?this.showCardContent(r,"mj_card_zuo_peng",e):"layer_up"==a.name&&this.showCardContent(r,"mj_card_shang_chu",e)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i="resources/mjcard/"+t+"_"+n.index+"_"+a+".png";cc.log("load Card URL :"+i);var o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}else cc.log("missing card Component, please add it")}}),cc._RF.pop()},{configMgr:"configMgr"}],debug:[function(e,t,a){"use strict";cc._RF.push(t,"7d27fIayxdKK7YGYWL/9spU","debug");var n=e("gameDefine"),i=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,cardInput:cc.EditBox,wildCards:cc.EditBox,parents:{default:[],type:cc.Node},debugBtn:cc.Node},onLoad:function(){var e=i.getSetCardsOpen();this.debugBtn.active=e},onClose:function(){switch(GameData.client.gameType){case n.GameType.Game_Poker_DDZ:this.node.getComponent("DDZ-roomMain").showDebugLayer();break;case n.GameType.Game_Poker_TianjinDDZ:this.node.getComponent("TJDDZ-roomMain").showDebugLayer();break;case n.GameType.Game_Mj_Shishi:this.node.getComponent("roomMain-shishi").showDebugLayer();break;case n.GameType.Game_Mj_Tianjin:this.node.getComponent("roomMain").showDebugLayer();break;case n.GameType.Game_Poker_paodekuai:this.node.getComponent("PDK-roomMain").showDebugLayer()}},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){cc.log("debug rtn: ",JSON.stringify(e))})},onSetWildcard:function(){var e=this.wildCards.string,t={roomid:GameData.room.id,cards:parseInt(e)};GameNet.getInstance().request("game.debugHandler.setWildCards",t,function(e){})},testAllCardShow:function(){for(var e=0;e<this.parents.length;e++){var t=this.parents[e];"layer_down"!=t.name&&(cc.find("cardHand",t).active=!1)}var a=this.cardInput.string;this.testHand(a),this.testPeng(a),this.testDis(a)},testHand:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];if("layer_down"==a.name)for(var n=cc.find("cardHand",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("cardHand"+i);this.showCardContent(o,"mj_card_xia_shou",e)}}},testDis:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];a.active=!0;for(var n=cc.find("cardDis",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("card_face"+(i+1));o.active=!0,"layer_down"==a.name?this.showCardContent(o,"mj_card_xia_chu",e):"layer_right"==a.name?this.showCardContent(o,"mj_card_you_chu",e):"layer_left"==a.name?this.showCardContent(o,"mj_card_zuo_chu",e):"layer_up"==a.name&&this.showCardContent(o,"mj_card_shang_chu",e)}}},testPeng:function(e){for(var t=0;t<this.parents.length;t++)for(var a=this.parents[t],n=0;n<GameData.room.joinermax;n++){var i=cc.find("cardPeng/cardPeng"+(n+1),a);i.active=!0;for(var o=0;o<4;o++){var r=i.getChildByName("card_face"+(o+1));r.active=!0,"layer_down"==a.name?this.showCardContent(r,"mj_card_xia_peng",e):"layer_right"==a.name?this.showCardContent(r,"mj_card_you_peng",e):"layer_left"==a.name?this.showCardContent(r,"mj_card_zuo_peng",e):"layer_up"==a.name&&this.showCardContent(r,"mj_card_shang_chu",e)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i="resources/mjcard/"+t+"_"+n.index+"_"+a+".png";cc.log("load Card URL :"+i);var o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}else cc.log("missing card Component, please add it")}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine"}],directionView:[function(e,t,a){"use strict";cc._RF.push(t,"bfdc6nVkMJJ+IxZhMaKLcQR","directionView");var i=e("gameConfig"),n=e("SoundMngr"),o=e("gameDefine"),r=e("roomHandler");cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,leftCardNumLabel:cc.Label,lastRoundLabel:cc.RichText,quanNode:cc.Node,juNode:cc.Node},onLoad:function(){registEvent("onRoomInfo",this,this.onShow),registEvent("onGameTurn",this,this.onShowTurn)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.onShow),unregistEvent("onGameTurn",this,this.onShowTurn)},onEnable:function(){this.onShow(),this.startCountDown()},onShow:function(){this.showPosition(),this.showLeftCard(),this.showRoundType(),this.showRoundString()},onShowTurn:function(){r.room.status==o.RoomState.GAMEING?this.startCountDown():this.stopCountDown(),this.showTurn()},startCountDown:function(){this._countdown_index=10,this.schedule(this.runCountDown,1)},stopCountDown:function(){this.unschedule(this.runCountDown)},showPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:1==e?t=270:2==e?t=180:3==e&&(t=0),this.direction_pos.node.rotation=t},showTurn:function(){var e=i.getGameData().game.turn,t=GameData.getPlayerIndex(e);if(!(t<0)){var a;a=0==t?"dong":3==t?"nan":2==t?"xi":1==t?"bei":"dong";var n=cc.textureCache.addImage(cc.url.raw("resources/table/"+a+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(n),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1,null!=(a=GameData.getPlayerPosByUid(e))&&(cc.find(a,this.direction_turn).active=!0)}},runCountDown:function(){if(this.showCountDown(this._countdown_index.toString()),this._countdown_index<=0)this._countdown_index=10;else{var e=i.getGameData().game.turn;3==this._countdown_index&&e==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--}},showCountDown:function(e){var t=e.split("");if(0!=t.length){var a,n;if(1==t.length)a=cc.url.raw("resources/number/jinzi0.png"),n=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=t.length)return;a=cc.url.raw("resources/number/jinzi"+t[0]+".png"),n=cc.url.raw("resources/number/jinzi"+t[1]+".png")}var i=cc.textureCache.addImage(a),o=cc.textureCache.addImage(n);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i),this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},showRoundString:function(){var e=r.room.roundNum,t=r.room.opts.roundMax;this.lastRoundLabel.string=e+"/"+t},showLeftCard:function(){var e=i.getGameData().game.cardleft;this.leftCardNumLabel.string=e},showRoundType:function(){r.room.opts.roundType==o.roundType.quan?(this.quanNode.active=!0,this.juNode.active=!1):(this.quanNode.active=!1,this.juNode.active=!0)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameConfig:"gameConfig",gameDefine:"gameDefine",roomHandler:"roomHandler"}],dissolveView:[function(e,t,a){"use strict";cc._RF.push(t,"2e3742Ny9xN/a6gZK4R06wq","dissolveView");var h=e("roomHandler");e("gameDefine");cc.Class({extends:cc.Component,properties:{headPanel:cc.Node,headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){registEvent("onRoomInfo",this,this.onRoomInfoHandler),registEvent("onRoomDissolve",this,this.onRoomDissolveHandler),registEvent("showDissolve",this,this.showDissolveLayer)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.onRoomInfoHandler),unregistEvent("onRoomDissolve",this,this.onRoomDissolveHandler),unregistEvent("showDissolve",this,this.showDissolveLayer)},onEnable:function(){this.lastTimeLabel.string="",this.openDisAgree=!1,this.initHeaderUI(),this.showDissolveText()},onRoomInfoHandler:function(e){null!=e&&(h.onRoomInfoSetData(e.detail),this.initHeaderUI())},onRoomDissolveHandler:function(e){null!=e&&(h.onRoomDissolveSetData(e.detail),this.initHeaderUI(),this.showDissolveText())},showDissolveLayer:function(e){cc.log("..showDissolve:"+e.detail),this.node.active=e.detail},initHeaderUI:function(){var e=h.getRoomData();if(null!=e){for(var t=0;t<this.headPanel.getChildrenCount();t++){var a=this.headPanel.getChildren()[t];a&&(a.active=!1)}for(var n=0;n<e.opts.joinermax;n++){var i=GameData.joiners[n];if(null!=i){var o=this.headPanel.getChildren()[n];null==o&&((o=cc.instantiate(this.headerNode)).parent=this.headPanel,o.name="headNode"+n,o.y=this.headerNode.y,o.x=this.headerNode.x+n*(this.headerNode.width+50)),o.tag=i.uid,o.active=!0;var r=i.name;cc.find("nameLabel",o).getComponent(cc.Label).string=getShortStr(r,4);var s=i.headimgurl,c=cc.find("headimg",o).getComponent(cc.Sprite);this.showHeaderIcon(c,s);var d=h.isPlayerOnline(i.uid);this.showLostIcon(o,d),this.showAgreeIcon(o,!1)}}}},showHeaderIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},showLostIcon:function(e,t){cc.find("lost",e).active=!t},showAgreeIcon:function(e,t){cc.find("duigou",e).active=t},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree){var t=GameData.getPlayerByUid(e);if(t){var a=this,n=t.name;createMessageBox("因［"+n+"］拒绝解散房间，游戏需继续进行",function(){a.openDisAgree=!1}),this.openDisAgree=!0}}},showDissolveText:function(){var e=h.getRoomDissolveData();if(!(null==e||Object.keys(e).length<=0)){var t,a,n=!(GameData.showResult=!1);for(var i in e.select){var o=e.select[i];if("apply"==o)(t=GameData.getPlayerByUid(i))&&(this.dissolvePerson.string="["+t.name+"]发起投票解散对局",(a=this.headPanel.getChildByTag(parseInt(i)))&&this.showAgreeIcon(a,!0));else if("agree"==o)(a=this.headPanel.getChildByTag(parseInt(i)))&&this.showAgreeIcon(a,!0);else if("disagree"==o)return sendEvent("showDissolve",!1),void this.handleSomebodyDisagree(i);"agree"!=o&&"apply"!=o||i!=GameData.player.uid||(n=!1)}this.alreadyAgree(n),sendEvent("showDissolve",!0),this.handleVoteResult(),this.handleRoomDisbandTimer()}},handleVoteResult:function(){var e=h.getRoomDissolveData();null!=e&&0==e.isStart&&(sendEvent("showDissolve",!1),this.unschedule(this.updateLastTime),setTimeout(function(){GameData.roomClose&&sendEvent("onShowView","summaryView")},100))},handleRoomDisbandTimer:function(){var e=h.getRoomDissolveData();null!=e&&(this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1))},updateLastTime:function(){var e=h.getRoomData();null!=e&&(this.lastTime--,this.lastTimeLabel.string="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1),this.lastTime<=0&&(h.deleteRoom(e.id,"close"),this.unschedule(this.updateLastTime)))},requestDissolveAgree:function(){var e=h.getRoomData();null!=e&&h.deleteRoom(e.id,"agree")},requestDissolveDisagree:function(){var e=h.getRoomData();null!=e&&h.deleteRoom(e.id,"disagree")}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],dunhua:[function(e,t,a){"use strict";cc._RF.push(t,"a79caX0NsxAsoNqvO+5gh8a","dunhua");var n=e("gameDefine"),i={gameName:"摸摸敦化麻将",areaType:n.AreaType.Area_DunHua,serverIP:"changchun.mahjong.ry-play.com",serverPort:3010,versionText:"敦化测试版本",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/dunhua",wxWelcomeText:"摸摸敦化麻将欢迎你！",loginLogo:"resources/login/ruoyudunhua.png",Poster:[],GameVisible:[n.GameType.Game_Mj_CC,n.GameType.Game_TDK],SetCardsOpen:!1,MatchGameType:[],FightGameType:[],CurrencyType:n.currencyType.Currency_Card,ModeType:{Game_Mj_CC:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e4]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]}},fight:{},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}]},roomCard:{1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},10:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},11:{10:{name:"10",cost:{2:{final:0},3:{final:0}}},20:{name:"20",cost:{2:{final:0},3:{final:0}}},30:{name:"30",cost:{2:{final:0},3:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],errorCode:[function(e,t,a){"use strict";cc._RF.push(t,"8736egJLD1PHaj3JVZE0dTz","errorCode");t.exports={Success:0,Fail:1,verifyPlayerFail:2,emailUsed:3,emailValid:4,invalidMail:5,playerNotFound:6,guestCanNotRecommend:7,canNotLogin:8,alreadyInGame:9,keepInGame:10,accountHasSeal:12,versionError:17,packetVersionError:18,codeVersionError:19,notEnoughCard:20,notEnoughCoin:21,notEnoughPoint:22,sqlError:30,lessMoney:31,lessCoin:32,clientRestart:33,clientUpdate:34,bindError:35,joinRoomOK:36,cfgVersionChange:37,alreadyInRoom:38,roomFull:39,slotNotFound:40,roomNotFound:41,AgentRoomMax:43,zjhCfgChange:50,zjhDateEnd:51,zjhCfgStop:52,roomInPlay:53,playerNotWaitStart:54,joinActOK:60,canNotJoinActInPlay:61,joinWrongAct:62,alreadyInAct:63,actClosed:64,invalidActPos:65,invalidActRoom:66,actEnd:67,invaliReward:68,canNotAddSelf:80,isMemberAlready:81,memberNotFound:82,addMemberOK:83,removeMemberOK:84,membersNumLimit:85,memberofNumLimit:86,authAddPlayerExist:87,notHaveWXOpenId:88,rpcErr:100,loginToMuch:101,errorState:102,serverFull:103,LessClubMoney:110,LessCard:111,LessCoin:112,ClubNotFound:113,HasJoinedClub:114,ApplyJoinClubSuc:115,NoJoinThisClub:116,HasReqJoinClub:117,AgentMoneyNotEnough:118,ClubLevelTooLow:119,AgentMoneyDataError:120,findAgentDBError:121,HasInvited:122,NotFindInviteDB:123,NotFindApplyDB:124,waitOthers:130,NotPokerDis:200,HandPatternsError:201,NotHavePokerDis:202,MaxCardPut:203,NotHaveThreePoker:204,WarningDiscard:300},cc._RF.pop()},{}],"es6-promise":[function(z,a,n){(function(j,U){"use strict";cc._RF.push(a,"b5ef5PgiPVOWKPtWWEtJ+Se","es6-promise");var e,t,F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=function(){function d(e){return"function"==typeof e}function t(){var e=setTimeout;return function(){return e(a,1)}}function a(){for(var e=0;e<_;e+=2){(0,k[e])(k[e+1]),k[e]=void 0,k[e+1]=void 0}_=0}function s(e,t){var a=this,n=new this.constructor(r);void 0===n[H]&&v(n);var i=a._state;if(i){var o=arguments[i-1];S(function(){return y(i,n,o,a._result)})}else g(a,n,e,t);return n}function c(e){if(e&&"object"==(void 0===e?"undefined":F(e))&&e.constructor===this)return e;var t=new this(r);return u(t,e),t}function r(){}function h(e){try{return e.then}catch(e){return B.error=e,B}}function l(e,t,a){var n,i,o,r;t.constructor===e.constructor&&a===s&&t.constructor.resolve===c?(o=e,(r=t)._state===L?m(o,r._result):r._state===O?p(o,r._result):g(r,void 0,function(e){return u(o,e)},function(e){return p(o,e)})):a===B?(p(e,B.error),B.error=null):void 0===a?m(e,t):d(a)?(n=t,i=a,S(function(t){var a=!1,e=function(e,t,a,n){try{e.call(t,a,n)}catch(e){return e}}(i,n,function(e){a||(a=!0,n!==e?u(t,e):m(t,e))},function(e){a||(a=!0,p(t,e))},t._label);!a&&e&&(a=!0,p(t,e))},e)):m(e,t)}function u(e,t){var a,n;e===t?p(e,new TypeError("You cannot resolve a promise with itself")):(n=void 0===(a=t)?"undefined":F(a),null===a||"object"!==n&&"function"!==n?m(e,t):l(e,t,h(t)))}function n(e){e._onerror&&e._onerror(e._result),f(e)}function m(e,t){e._state===A&&(e._result=t,e._state=L,0!==e._subscribers.length&&S(f,e))}function p(e,t){e._state===A&&(e._state=O,e._result=t,S(n,e))}function g(e,t,a,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+L]=a,i[o+O]=n,0===o&&e._state&&S(f,e)}function f(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,r=0;r<t.length;r+=3)n=t[r],i=t[r+a],n?y(a,n,i,o):i(o);e._subscribers.length=0}}function y(e,t,a,n){var i=d(a),o=void 0,r=void 0,s=void 0,c=void 0;if(i){if((o=function(e,t){try{return e(t)}catch(e){return B.error=e,B}}(a,n))===B?(c=!0,r=o.error,o.error=null):s=!0,t===o)return void p(t,new TypeError("A promises callback cannot return that same promise."))}else o=n,s=!0;t._state!==A||(i&&s?u(t,o):c?p(t,r):e===L?m(t,o):e===O&&p(t,o))}function v(e){e[H]=M++,e._state=void 0,e._result=void 0,e._subscribers=[]}var e,i,o,C,D=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},_=0,G=void 0,w=void 0,S=function(e,t){k[_]=e,k[_+1]=t,2===(_+=2)&&(w?w(a):I())},T="undefined"!=typeof window?window:void 0,N=T||{},b=N.MutationObserver||N.WebKitMutationObserver,R="undefined"==typeof self&&void 0!==j&&"[object process]"==={}.toString.call(j),P="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,k=new Array(1e3),I=void 0;I=R?function(){return j.nextTick(a)}:b?(i=0,o=new b(a),C=document.createTextNode(""),o.observe(C,{characterData:!0}),function(){C.data=i=++i%2}):P?((e=new MessageChannel).port1.onmessage=a,function(){return e.port2.postMessage(0)}):void 0===T&&"function"==typeof z?function(){try{var e=Function("return this")().require("vertx");return void 0!==(G=e.runOnLoop||e.runOnContext)?function(){G(a)}:t()}catch(e){return t()}}():t();var H=Math.random().toString(36).substring(2),A=void 0,L=1,O=2,B={error:null},M=0,E=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(r),this.promise[H]||v(this.promise),D(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?m(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&m(this.promise,this._result))):p(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===A&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(t,e){var a=this._instanceConstructor,n=a.resolve;if(n===c){var i=h(t);if(i===s&&t._state!==A)this._settledAt(t._state,e,t._result);else if("function"!=typeof i)this._remaining--,this._result[e]=t;else if(a===x){var o=new a(r);l(o,t,i),this._willSettleAt(o,e)}else this._willSettleAt(new a(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},e.prototype._settledAt=function(e,t,a){var n=this.promise;n._state===A&&(this._remaining--,e===O?p(n,a):this._result[t]=a),0===this._remaining&&m(n,this._result)},e.prototype._willSettleAt=function(e,t){var a=this;g(e,void 0,function(e){return a._settledAt(L,t,e)},function(e){return a._settledAt(O,t,e)})},e}(),x=function(){function t(e){this[H]=M++,this._result=this._state=void 0,this._subscribers=[],r!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(t,e){try{e(function(e){u(t,e)},function(e){p(t,e)})}catch(e){p(t,e)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var a=this.constructor;return this.then(function(e){return a.resolve(t()).then(function(){return e})},function(e){return a.resolve(t()).then(function(){throw e})})},t}();return x.prototype.then=s,x.all=function(e){return new E(this,e).promise},x.race=function(i){var o=this;return new o(D(i)?function(e,t){for(var a=i.length,n=0;n<a;n++)o.resolve(i[n]).then(e,t)}:function(e,t){return t(new TypeError("You must pass an array to race."))})},x.resolve=c,x.reject=function(e){var t=new this(r);return p(t,e),t},x._setScheduler=function(e){w=e},x._setAsap=function(e){S=e},x._asap=S,x.polyfill=function(){var e=void 0;if(void 0!==U)e=U;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var a=null;try{a=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===a&&!t.cast)return}e.Promise=x},x.Promise=x},"object"==((e=void 0)===n?"undefined":F(n))&&void 0!==a?a.exports=t():"function"==typeof define&&define.amd?define(t):e.ES6Promise=t(),cc._RF.pop()}).call(this,z("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],gameConfig:[function(e,t,a){"use strict";cc._RF.push(t,"877fc/RIkNDfKDN0CFnz4si","gameConfig");var n=e("gameDefine"),i=e("roomHandler");t.exports={getConfig:function(){switch(i.room.opts.gameType){case n.GameType.Game_Mj_HZ:return e("TuiDaoHu");default:return null}},getName:function(){return this.getConfig().name},getLanguage:function(){return this.getConfig().language},getViews:function(e){return this.getConfig().views[e]},getView:function(e){return this.getConfig().prefabs[e]},getChatData:function(){return this.getConfig().chat},getRuleStr:function(){return this.getConfig().getRuleStr(i.room.opts)},getWildIcon:function(){return this.getConfig().resources.wildIcon},getActionData:function(e){return this.getConfig().actions[e]},getGameData:function(){return this.getConfig().getDataHandler()},getGameRule:function(){return this.getConfig().getRuleHandler()},getGameProtocol:function(){return this.getConfig().getProtocolHandler()}},cc._RF.pop()},{TuiDaoHu:"TuiDaoHu",gameDefine:"gameDefine",roomHandler:"roomHandler"}],gameDefine:[function(e,t,a){"use strict";cc._RF.push(t,"884a2VSt+dCWYwN5SkzFflj","gameDefine");t.exports={AreaType:{Area_Test:0,Area_TianJin:1,Area_ShiShi:2,Area_HuaDian:3,Area_DunHua:4,Area_HEB:5,Area_Hebei:6,Area_Changchun:7,Area_Appstore:100,Area_Coin:101},GameType:{Game_Mj_Tianjin:1,Game_Mj_Shishi:2,Game_Poker_13shui:3,Game_niu_niu:5,Game_MJ_HuaDian:6,Game_TDK:7,Game_Poker_TianjinDDZ:8,Game_Mj_HZ:9,Game_Mj_CC:10,Game_Poker_paodekuai:11,Game_Mj_AS:12,Game_Mj_Heb:13,Game_Poker_DDZ:102,Game_Poker_ZJH:103,Game_Niu_Niu_10:104,Game_Niu_Hundred:105,Game_Poker_HHDZ:106,Game_Mahjong_TuiDaoHu:500},roomType:{Room_Common:1,Room_Club:2,Room_Contest:3,Room_Match:4},RoomState:{WAIT:0,READY:1,GAMEING:2},CurSelectType:{group:1,match:2,competition:3},ruleType:{isRuleType:!1,type:1,py:1},currencyType:{Currency_Card:1,Currency_Coin:2},settleType:{Settle_None:1,Settle_Coin:2,Settle_Point:3},roundType:{round:1,quan:2,ke:3},CostType:{Cost_None:0,Cost_Creator:1,Cost_AA:2,Cost_Winner:3,Cost_Agent:4,Cost_Table:5},shopCostType:{Shop_Cost_Cash:0,Shop_Cost_Card:1,Shop_Cost_Coin:2,Shop_Cost_Point:3},shopGetType:{Shop_Get_Coin:0,Shop_Get_Item:1},withdrawState:{wait:0,succeed:1,fail:2},agentRole:{agentPower:1,agent:2,push:3,ordinary:4},taskRewardType:{coin:1}},cc._RF.pop()},{}],getLottery:[function(e,t,a){"use strict";cc._RF.push(t,"0a070DxEXFDGZnSpKQa5CUx","getLottery");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{gongzhonghao:cc.Label},onLoad:function(){this.showNumLabel()},showNumLabel:function(){var e=n.getAgentWeChat();e&&(this.gongzhonghao.string=e.accounts.number)},close:function(){closeView(this.node.name)}}),cc._RF.pop()},{configMgr:"configMgr"}],goodsType:[function(e,t,a){"use strict";cc._RF.push(t,"b8e3eUp7hhJu4ISXswC3E4M","goodsType");var n=e("SoundMngr"),i=e("gameDefine"),o=e("shopHandler"),r=e("configMgr");cc.Class({extends:cc.Component,properties:{buttonId:0,costStr:cc.Label,getStr:cc.Label,headIcon:cc.Sprite,getType:0},onLoad:function(){},getButtonId:function(e){this.buttonId=e},clickConsume:function(){if(n.instance.playAudioOther("button"),cc.log("this.buttonId = "+this.buttonId),1==r.getSetCardsOpen()){var e=this,t="是否确认使用"+this.costNum+"兑换"+this.getNum;createMessageBox(t,function(){o.exchange(e.buttonId)},function(){})}else if(this.getType==i.shopGetType.Shop_Get_Coin){e=this,t="是否确认使用"+this.costNum+"兑换"+this.getNum;createMessageBox(t,function(){o.exchange(e.buttonId)},function(){})}else createMessageBox("兑换功能尚未开放",function(){})},initUI:function(e){switch(this.costNum="",e.costType){case i.shopCostType.Shop_Cost_Point:this.costNum=e.costNum+"积分";break;case i.shopCostType.Shop_Cost_Card:this.costNum=e.costNum+"房卡";break;case i.shopCostType.Shop_Cost_Coin:this.costNum=e.costNum+"金币";break;case i.shopCostType.Shop_Cost_Cash:this.costNum=e.costNum+"现金"}this.costStr.string=this.costNum,this.getNum="",e.desc&&(this.getNum=e.desc),this.getStr.string=this.getNum,this.setHeadIcon(e.icon),this.getType=e.getType},setHeadIcon:function(n){var i=this;cc.loader.loadRes("shop/shopPlist",cc.SpriteAtlas,function(e,t){var a=t.getSpriteFrame(n);i.headIcon.spriteFrame=a})}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",shopHandler:"shopHandler"}],groupType:[function(e,t,a){"use strict";cc._RF.push(t,"94c04TiLw1FDpt8OAZS0m5p","groupType"),cc.Class({extends:cc.Component,properties:{groupType:cc.Node,cardType_1:cc.Node,cardType_2:cc.Node,cardType_3:cc.Node,id:0,selected:!1},onLoad:function(){this.commendTypeUrl={WuLong:"wulong",DuiZi:"duizi",LiangDui:"lingdui",SanTiao:"santiao",ShunZi:"shunzi",TongHua:"tonghua",HuLu:"hulu",TieZhi:"tiezhi",TongHuaShun:"tonghuasun",WuTong:"wutong"}},showRecommend:function(e){this.commendType=[],this.commendType=e[this.id],cc.log("commendType: ",JSON.stringify(this.commendType));for(var t=0;t<this.commendType.length;t++)for(var a in CommonType)if(CommonType[a].id==this.commendType[t].type){var n=cc.find("cardType_"+(3-t),this.groupType),i=cc.textureCache.addImage(cc.url.raw("resources/shisanshui/tableUI/selectCardType/"+this.commendTypeUrl[a]+".png"));n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i);break}},showRecommendCard:function(){WriteLog("showRecommendCard");var e=this.groupType.parent.parent.parent.parent.parent,o=e.parent,r=cc.find("cardType",e),t=function(e,t){var a=cc.find(e,r);0<cardPoker13[t].length&&o.parent.getComponent("SSSRoomTable").setResetCard(a,t)},a=function(e,t,a,n){cc.log("cards: ",JSON.stringify(e));var i=cc.find(a,r);cardPoker13[n].length<=0&&(o.parent.getComponent("SSSRoomTable").setCheckedCards(e),o.parent.getComponent("SSSRoomTable").showCardRow(n,i,t))};t("upCardNode","up"),t("midCardNode","mid"),t("downCardNode","down"),a(this.commendType[0].cards,5,"downCardNode","down"),a(this.commendType[1].cards,5,"midCardNode","mid"),a(this.commendType[2].cards,3,"upCardNode","up")},onGroupBtnCliked:function(){console.log("group id: ",this.id);var e=this.groupType.getContentSize().width+50;this.selected=!0;var t=this.groupType.parent,a=t.parent.parent.getComponent(cc.ScrollView),n=cc.moveTo(.1,cc.p(0-e*this.id,a.getContentPosition().y));t.runAction(n),cc.find("twinkle",this.groupType).active=!0,cc.log("onGroupBtnClied event: ",a.getContentPosition()),this.showRecommendCard()}}),cc._RF.pop()},{}],haerbin:[function(e,t,a){"use strict";cc._RF.push(t,"2d33cQ0uWZPt60L3sD7agU4","haerbin");var n=e("gameDefine"),i={gameName:"若宇摸摸棋牌",areaType:n.AreaType.Area_HEB,serverIP:"mahjong.ry-play.com",serverPort:3010,versionText:"",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rymmqp",wxWelcomeText:"还等啥!我在摸摸棋牌等你!",loginLogo:"resources/login/momoqipailogo.png",Poster:[],GameVisible:[n.GameType.Game_TDK,n.GameType.Game_Mj_Heb,n.GameType.Game_Poker_DDZ,n.GameType.Game_Poker_paodekuai],SetCardsOpen:!1,MatchGameType:[n.GameType.Game_TDK,n.GameType.Game_Mj_Heb,n.GameType.Game_Poker_DDZ],FightGameType:[],ModeType:{Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Point]},Game_Mj_Heb:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Point]},Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Point]},Game_Poker_paodekuai:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Point]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]}},fight:{},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],6:[{name:"6局",roundType:1,roundMax:4,cost:{2:{final:10},4:{final:20}},enter:{2:[100,200,500],4:[200,400,1e3]}},{name:"12局",roundType:1,roundMax:4,cost:{2:{final:20},4:{final:30}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"24局",roundType:1,roundMax:4,cost:{2:{final:30},4:{final:40}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:40},4:{final:50}},enter:{2:[200,200,5e4],4:[200,400,1e3]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:50},4:{final:60}},enter:{2:[300,300,6e4],4:[300,500,2e3]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:60},4:{final:70}},enter:{2:[400,400,7e4],4:[400,600,3e3]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}],10:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],13:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}]},roomCard:{1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:1},4:{final:1}}},62:{name:"12局",cost:{2:{final:1},4:{final:1}}},63:{name:"24局",cost:{2:{final:2},4:{final:2}}},64:{name:"1圈",cost:{2:{final:1},4:{final:1}}},65:{name:"2圈",cost:{2:{final:1},4:{final:1}}},66:{name:"4圈",cost:{2:{final:2},4:{final:2}}}},7:{71:{name:"15局",cost:{3:{final:1},4:{final:1},5:{final:1},6:{final:1}}},72:{name:"30局",cost:{3:{final:2},4:{final:2},5:{final:2},6:{final:2}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},10:{61:{name:"4局",cost:{2:{final:1}}},62:{name:"8局",cost:{2:{final:2}}},63:{name:"16局",cost:{2:{final:4}}},64:{name:"1圈",cost:{4:{final:2}}},65:{name:"2圈",cost:{4:{final:4}}},66:{name:"4圈",cost:{4:{final:8}}}},11:{10:{name:"10",cost:{2:{final:1},3:{final:1}}},20:{name:"20",cost:{2:{final:1},3:{final:1}}},30:{name:"30",cost:{2:{final:2},3:{final:2}}}},13:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:1}}},10:{name:"10局",cost:{3:{final:1}}},20:{name:"20局",cost:{3:{final:2}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],headView:[function(e,t,a){"use strict";cc._RF.push(t,"0f5fbVmJ8dLM6gzZzdu4YoJ","headView");e("gameDefine");var v=e("SoundMngr"),r=e("roomHandler");cc.Class({extends:cc.Component,properties:{lostNode:cc.Node,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){registEvent("onRoomInfo",this,this.onRoomInfoHandler),registEvent("onGameInfo",this,this.onGameInfoHandler),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("dynChat",this,this.onDynChatHandler)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.onRoomInfoHandler),unregistEvent("onGameInfo",this,this.onGameInfoHandler),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("dynChat",this,this.onDynChatHandler)},onEnable:function(){this.headers=[],this._curGameData=r.getCurGameDataOnType(),this.showPlayers(),this.updatePlayerOnLine(),this.updatePlayerZhuang(),this.updatePlayerTurn(),this.updatePlayerScore(),this.addDynAnimation()},onRoomInfoHandler:function(){this.showPlayers(),this.updatePlayerScore(),this.updatePlayerOnLine()},onGameInfoHandler:function(){this.updatePlayerZhuang(),this.updatePlayerTurn()},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showPlayers:function(){this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player)},showPlayer:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=t.getChildByName("playerNode");null==n&&((n=cc.instantiate(this.playerTemplate)).name="playerNode",n.parent=t),t.active=!0;var i=n.getComponent("playerTemplate");if(i){i.setPlayer(a),i.setName(a.name),i.setHeadIcon(a.headimgurl);var o=r.isPlayerOnline(a.uid);i.setIsOnline(o)}this.headers.push(n)}else t.active=!1},updatePlayerOnLine:function(){for(var e=["left","right","up","down"],t=0;t<e.length;t++){var a=e[t],n=GameData.getPlayerByPos(a);n&&!r.isPlayerOnline(n.uid)?this.showLostIcon(a,!1):this.showLostIcon(a,!0)}},showLostIcon:function(e,t){var a=cc.find(e,this.lostNode);a&&(a.active=!t)},updatePlayerZhuang:function(){if(null!=this._curGameData){var e=this._curGameData.getGameInfoData();if(null!=e)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(a){var n=a.getComponent("playerTemplate"),i=e.zhuangUid==n.uid;n.showZhuang(i)}}}},updatePlayerTurn:function(){if(null!=this._curGameData){var e=this._curGameData.getGameInfoData();if(null!=e)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(a){var n=a.getComponent("playerTemplate").uid,i=cc.find("liuguang",a);i&&(i.active=e.turn==n)}}}},updatePlayerScore:function(){var e=r.getScoreData();if(null!=e)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(a){var n=a.getComponent("playerTemplate").uid,i=null==e[n]?0:e[n];a.getComponent("playerTemplate").setCoin(i)}}},onDynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},onRoomChatHandler:function(e){for(var t=e.detail.uid,a=e.detail.msg.type,n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o,r=GameData.tablePos[t],s=cc.find("chat_"+r,i);if(null!=s){var c=cc.find("word",s),d=cc.find("emo",s),h=cc.find("yuyinNode",s),l=cc.find("word/bg",s),u=cc.find("word/Label",s).getComponent(cc.Label);if("word"==a)o=e.detail.msg.data,u.string=o,l.width=20+24*o.length,c.getComponent("HideComponent").show(3);else if("fast"==a){var m=e.detail.msg.data.sound;o=e.detail.msg.data.content;var p=getShortStr(o,20);u.string=p,l.width=30*p.length;var g=GameData.getPlayerSexByUid(t);v.instance.playAudioChat(m,g),c.getComponent("HideComponent").show(3)}else if("emo"==a){var f=e.detail.msg.data;d.getComponent(cc.Animation).play(f),d.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var y=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",y):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(y)),cc.find("yuyinAnimNode/yuyinAnim",h).getComponent(cc.Animation).play("yuyinduihua"),h.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],hebei:[function(e,t,a){"use strict";cc._RF.push(t,"91b90Bid/dBU6QR1VS10vqs","hebei");var n=e("gameDefine"),i={gameName:"若宇摸摸棋牌",areaType:n.AreaType.Area_Hebei,serverIP:"mahjong.ry-play.com",serverPort:3010,versionText:"",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rymmqphb",wxWelcomeText:"还等啥!我在摸摸棋牌等你!",loginLogo:"resources/login/momoqipailogo.png",Poster:[],GameVisible:[n.GameType.Game_TDK,n.GameType.Game_Poker_paodekuai,n.GameType.Game_Poker_DDZ],SetCardsOpen:!1,MatchGameType:[n.GameType.Game_TDK,n.GameType.Game_Poker_DDZ],FightGameType:[],ModeType:{Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]}},fight:{},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:{final:100},3:{final:100},4:{final:100}},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],6:[{name:"6局",roundType:1,roundMax:4,cost:{2:{final:10},4:{final:20}},enter:{2:[100,200,500],4:[200,400,1e3]}},{name:"12局",roundType:1,roundMax:4,cost:{2:{final:20},4:{final:30}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"24局",roundType:1,roundMax:4,cost:{2:{final:30},4:{final:40}},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:40},4:{final:50}},enter:{2:[200,200,5e4],4:[200,400,1e3]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:50},4:{final:60}},enter:{2:[300,300,6e4],4:[300,500,2e3]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:60},4:{final:70}},enter:{2:[400,400,7e4],4:[400,600,3e3]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}],10:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],13:[{name:"4局",roundType:1,roundMax:4,cost:{2:{final:100},4:{final:200}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:{final:200},4:{final:300}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:{final:300},4:{final:400}},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:{final:400},4:{final:500}},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:{final:500},4:{final:600}},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:{final:600},4:{final:700}},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:{final:100}},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:{final:100}},enter:{3:[1e4,2e4,4e4]}}]},roomCard:{1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:1},4:{final:1}}},62:{name:"12局",cost:{2:{final:1},4:{final:1}}},63:{name:"24局",cost:{2:{final:2},4:{final:2}}},64:{name:"1圈",cost:{2:{final:1},4:{final:1}}},65:{name:"2圈",cost:{2:{final:1},4:{final:1}}},66:{name:"4圈",cost:{2:{final:2},4:{final:2}}}},7:{71:{name:"15局",cost:{3:{final:1},4:{final:1},5:{final:1},6:{final:1}}},72:{name:"30局",cost:{3:{final:2},4:{final:2},5:{final:2},6:{final:2}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},10:{61:{name:"4局",cost:{2:{final:1}}},62:{name:"8局",cost:{2:{final:2}}},63:{name:"16局",cost:{2:{final:4}}},64:{name:"1圈",cost:{4:{final:2}}},65:{name:"2圈",cost:{4:{final:4}}},66:{name:"4圈",cost:{4:{final:8}}}},11:{10:{name:"10",cost:{2:{final:1},3:{final:1}}},20:{name:"20",cost:{2:{final:1},3:{final:1}}},30:{name:"30",cost:{2:{final:2},3:{final:2}}}},13:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:1}}},10:{name:"10局",cost:{3:{final:1}}},20:{name:"20局",cost:{3:{final:2}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],hhdz_bet:[function(e,t,a){"use strict";cc._RF.push(t,"8652djMvtZK857SJOt7+6BN","hhdz_bet");e("roomUtil");var n=e("hhdz_roomUtil");cc.Class({extends:cc.Component,properties:{_betId:void 0},onLoad:function(){},onDestroy:function(){},onEnable:function(){this._betId=void 0},setBetId:function(e){null!=e&&(this._betId=e,this.loadBetImg())},setBetPosition:function(e){null!=e&&(this.node.active=!0,this.node.scale=.5,this.node.position=e)},loadBetImg:function(){if(null!=this._betId){var e=n.getBetImgUrl(this._betId),t=cc.textureCache.addImage(cc.url.raw(e));t&&(this.node.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))}},runActionToTable:function(e,t){if(null!=e&&null!=t){this.node.active=!0,this.node.scale=1.1,this.node.position=e;var a=cc.scaleTo(.5,.8),n=cc.scaleTo(1,.5),i=cc.moveTo(.5,t);this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.spawn(a,i),n))}},runActionToPlayer:function(e){if(null!=e){var t=this,a=cc.moveTo(.5,e),n=cc.callFunc(function(){t.node.active=!1});this.node.stopAllActions(),this.node.runAction(cc.sequence(a,n))}}}),cc._RF.pop()},{hhdz_roomUtil:"hhdz_roomUtil",roomUtil:"roomUtil"}],hhdz_data:[function(e,t,a){"use strict";cc._RF.push(t,"38713mm/uxMAIlV173wLO7k","hhdz_data");e("gameDefine");var n=e("errorCode"),i={tableInfo:{tablePlayer:[],winHistory:[],cardHistory:[]},resultInfo:{card:{red:{},black:{},winner:void 0},winLoseInfo:[]},time:0,roomStatus:e("hhdz_roomUtil").GameStatus.WaitStart};(t.exports=i).getTableInfoData=function(){return this.tableInfo},i.getStartPourTime=function(){return this.time},i.getResultInfoData=function(){return this.resultInfo},i.getRoomStatus=function(){return this.roomStatus},i.setPour=function(e,t){GameNet.getInstance().request("room.redBlackWarHandler.setPour",{type:e,index:t},function(e){e.result==n.Success&&sendEvent("rbw-selfSetPour",{index:t})})},i.registMessage_hhdz=function(){cc.log("....hhdz data registMessage.");var t=this;GameNet.getInstance().setCallBack("rbw-roomStatus",function(e){t.roomStatus=e.status,sendEvent("rbw-roomStatus")}),GameNet.getInstance().setCallBack("rbw-dealCard",function(e){sendEvent("rbw-dealCard")}),GameNet.getInstance().setCallBack("rbw-startPour",function(e){t.time=e.time,sendEvent("rbw-startPour")}),GameNet.getInstance().setCallBack("rbw-tableInfo",function(e){t.tableInfo.tablePlayer=e.tablePlayer,t.tableInfo.winHistory=e.winHistory,t.tableInfo.cardHistory=e.cardHistory,sendEvent("rbw-tableInfo")}),GameNet.getInstance().setCallBack("rbw-result",function(e){t.resultInfo.card.red=e.card.red,t.resultInfo.card.black=e.card.black,t.resultInfo.card.winner=e.card.winner,t.resultInfo.winLoseInfo=e.winLoseInfo,t.resultInfo.self=e.self,sendEvent("rbw-result")}),GameNet.getInstance().setCallBack("rbw-onSetPour",function(e){sendEvent("rbw-onSetPour",e)})},i.checkPlayerSame=function(){var e=this.tableInfo.tablePlayer;if(null==e||e.length<=0)return!1;var t=!1,a=void 0,n=void 0;return e[0]&&(a=e[0].uid),e[1]&&(n=e[1].uid),a==n&&(t=!0),t},i.arrayChangeObject=function(e){for(var t={},a=0;a<e.length;a++){var n=e[a],i=room_hz.getArrayElementNumber(e,n);t[n]=i}return t},i.getArrayElementNumber=function(e,t){var a=0;if(null==e)return a;for(var n=0;n<e.length;n++)e[n]==t&&a++;return a},cc._RF.pop()},{errorCode:"errorCode",gameDefine:"gameDefine",hhdz_roomUtil:"hhdz_roomUtil"}],hhdz_head:[function(e,t,a){"use strict";cc._RF.push(t,"a3398kfPJhFTo96t7pBJNxv","hhdz_head");e("roomUtil"),e("hhdz_roomUtil");cc.Class({extends:cc.Component,properties:{iconNode:cc.Sprite,nameNode:cc.Label,coinNode:cc.Label,_player:void 0,_initPos:void 0},onLoad:function(){},onDestroy:function(){},onEnable:function(){this._initPos=this.node.position,this.updateHeadInfo()},setPlayerData:function(e){null!=e&&(this._player=e,this.updateHeadInfo())},setPlayerIcon:function(e){if(!(null==e||e.length<=0)){var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.iconNode=new cc.SpriteFrame(t))})}},setPlayerName:function(e){void 0===e&&(e=""),this.nameNode.string=getShortStr(e,4)},setPlayerCoin:function(e){void 0===e&&(e=0),this.coinNode.string=e},updateHeadInfo:function(){null!=this._player&&(cc.log("..updateHeadInfo."),this.setPlayerIcon(this._player.headimgurl),this.setPlayerName(this._player.name),this.setPlayerCoin(this._player.coin))},runAddJetonAction:function(){this.node.position=this._initPos;var e=cc.moveTo(.2,cc.p(this._initPos.x+20,this._initPos.y)),t=cc.moveTo(.2,this._initPos);this.node.stopAllActions(),this.node.runAction(cc.sequence(e,t))},onHeadBtnClick:function(e){cc.log("..onHeadBtnClick:"+this._player.uid)}}),cc._RF.pop()},{hhdz_roomUtil:"hhdz_roomUtil",roomUtil:"roomUtil"}],hhdz_roomHead:[function(e,t,a){"use strict";cc._RF.push(t,"32b418e2DZFh7qWcYlT67OB","hhdz_roomHead");e("roomUtil");var i=e("hhdz_roomUtil"),c=e("hhdz_data");cc.Class({extends:cc.Component,properties:{HeadLayer:cc.Node,UIHead:cc.Prefab,_headArray:[]},onLoad:function(){registEvent("rbw-tableInfo",this,this.onTableInfoHandler),registEvent("rbw-onSetPour",this,this.onOnSetPourHandler),registEvent("rbw-selfSetPour",this,this.onSelfSetPourHandler),registEvent("rbw-result",this,this.onResultHandler)},onDestroy:function(){unregistEvent("rbw-tableInfo",this,this.onTableInfoHandler),unregistEvent("rbw-onSetPour",this,this.onOnSetPourHandler),unregistEvent("rbw-selfSetPour",this,this.onSelfSetPourHandler),unregistEvent("rbw-result",this,this.onResultHandler)},onEnable:function(){this._headArray=[],this.updateSelfHead(),this.updatePlayersHead()},onTableInfoHandler:function(){this.updatePlayersHead()},onOnSetPourHandler:function(e){null!=e&&null!=e.detail&&this.tablePlayerChangeCoin(e.detail)},onSelfSetPourHandler:function(e){null!=e&&null!=e.detail&&this.SelfHeadChangeCoin(e.detail.index)},onResultHandler:function(){var e=c.getResultInfoData();null!=e&&null!=e.self&&(GameData.player.coin+=e.self,GameData.player.coin<0&&(GameData.player.coin=0),this.updateSelfHead())},tablePlayerChangeCoin:function(e){if(null!=e)for(var t=0;t<this._headArray.length;t++){var a=this._headArray[t];if(null!=a){var n=a.getComponent("hhdz_head");null!=n&&null!=n._player&&n._player.uid==e.uid&&(n._player.coin-=i.getBetValue(e.index),n._player.coin<0&&(n._player.coin=0),n.setPlayerCoin(n._player.coin))}}},SelfHeadChangeCoin:function(e){if(null!=e){var t=cc.find("headNode_self",this.HeadLayer);if(null!=t){var a=t.getChildByName("uiHead");if(null!=a)null!=a.getComponent("hhdz_head")&&(GameData.player.coin-=i.getBetValue(e),GameData.player.coin<0&&(GameData.player.coin=0),this.updateSelfHead())}}},updateSelfHead:function(){var e=cc.find("headNode_self",this.HeadLayer);if(null!=e){var t=e.getChildByName("uiHead");null==t&&((t=cc.instantiate(this.UIHead)).parent=e,t.name="uiHead");var a=t.getComponent("hhdz_head");a&&a.setPlayerData(GameData.player)}},updatePlayersHead:function(){this._headArray=[];var e=c.getTableInfoData();if(null!=e){var t=e.tablePlayer;if(!(null==t||t.length<=0))for(var a=!1,n=0;n<t.length;n++){var i=cc.find("headNode_"+n,this.HeadLayer);if(null!=i){a=!1;var o=t[n];if(o){var r=i.getChildByName("uiHead");null==r&&((r=cc.instantiate(this.UIHead)).parent=i,r.name="uiHead");var s=r.getComponent("hhdz_head");s&&s.setPlayerData(o),a=!0,this._headArray.push(r)}i.active=a}}}},getHeadPositionByUId:function(e){for(var t=0;t<this._headArray.length;t++){var a=this._headArray[t];if(null!=a){var n=a.getComponent("hhdz_head");if(null!=n&&null!=n._player&&n._player.uid==e)return a.parent.position}}return null},getSelfHeadPosition:function(){var e=cc.find("headNode_self",this.HeadLayer);return e?e.position:null}}),cc._RF.pop()},{hhdz_data:"hhdz_data",hhdz_roomUtil:"hhdz_roomUtil",roomUtil:"roomUtil"}],hhdz_roomMain:[function(e,t,a){"use strict";cc._RF.push(t,"38552xu9QdOYrDLr0yoBKDf","hhdz_roomMain");var n=e("stateMachine"),i=(e("hhdz_roomUtil"),e("hhdz_data"));cc.Class({extends:n,properties:{},onLoad:function(){registEvent("rbw-roomStatus",this,this.setRoomStatus)},onDestroy:function(){unregistEvent("rbw-roomStatus",this,this.setRoomStatus)},onEnable:function(){},setRoomStatus:function(){i.getRoomStatus()}}),cc._RF.pop()},{hhdz_data:"hhdz_data",hhdz_roomUtil:"hhdz_roomUtil",stateMachine:"stateMachine"}],hhdz_roomUtil:[function(e,t,a){"use strict";cc._RF.push(t,"633f5ZMFTlFTaNJPtkDUUI4","hhdz_roomUtil");var n={AllCards:[102,103,104,105,106,107,108,109,110,111,112,113,114,202,203,204,205,206,207,208,209,210,211,212,213,214,302,303,304,305,306,307,308,309,310,311,312,313,314,402,403,404,405,406,407,408,409,410,411,412,413,414],CardType:{Common:0,DuiZi:1,ShunZi:2,JinHua:3,ShunJin:4,BaoZi:5},GameStatus:{WaitStart:0,SendCard:1,StartPour:2,ShowCard:3},Pour:[100,500,1e3,2e3,5e3],WaitTime:15e3,StepTime:2e3,WinTimes:{RedBlackTimes:1.9,BaoZiTimes:10,ShunJinTimes:5,JinHuaTimes:3,ShunZiTimes:2,DuiZi9Times:1},WinnerType:{Red:0,Black:1}};(t.exports=n).getPokerImgUrl=function(e){return null==e?null:"resources/hhdz/table/pokers/poker_"+e+".png"},n.getWinnerFlagImg=function(e){switch(e){case this.WinnerType.Red:return"resources/hhdz/table/runChart/red.png";case this.WinnerType.Black:return"resources/hhdz/table/runChart/black.png";default:return null}},n.getBetImgUrl=function(e){return"resources/hhdz/table/"+this.getBetValue(e)+".png"},n.getBetValue=function(e){var t=this.Pour[e];return void 0===t&&(t=this.Pour[0]),t},n.getFakeJetonData=function(){for(var e=[],t=0;t<3;t++){for(var a=[],n=10,i=0;i<this.Pour.length&&!(n<=0);i++){var o=getRandomInt(1,n);n<o&&(o=n),n-=o;var r={};r.lv=i,r.number=o,a.push(r)}e.push(a)}return e},n.getOnLineFakeAddJetonData=function(){for(var e={},t=getRandomInt(500,1500),a=getRandomInt(1,5),n=[],i=0;i<a;i++){var o=getRandomInt(0,4),r=getRandomInt(0,2);n.push(o),n.push(r)}return e.time=t,e.data=n,e},cc._RF.pop()},{}],hhdz_runChart:[function(e,t,a){"use strict";cc._RF.push(t,"d090e8YjiJHarwzoKoNH/w4","hhdz_runChart");e("roomUtil");var i=e("hhdz_roomUtil"),n=e("hhdz_data");cc.Class({extends:cc.Component,properties:{scrollView:cc.ScrollView,item:cc.Node,_historyData:void 0},onLoad:function(){registEvent("rbw-tableInfo",this,this.onTableInfoHandler)},onDestroy:function(){unregistEvent("rbw-tableInfo",this,this.onTableInfoHandler)},onEnable:function(){this.setHistoryData()},onTableInfoHandler:function(){this.setHistoryData()},setHistoryData:function(){var e=n.getTableInfoData();null!=e&&null!=e.winHistory&&(this._historyData=e.winHistory,this.updateRunChart())},loadItemImg:function(e,t){if(null!=e&&null!=t){var a=i.getWinnerFlagImg(t);if(null!=a){var n=cc.textureCache.addImage(cc.url.raw(a));n&&(e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n))}}},updateRunChart:function(){if(null!=this._historyData){for(var e=this.scrollView.content,t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}var n=parseInt(this._historyData.length/6);0<this._historyData.length%6&&n++;var i=40*n;i<800&&(i=500),e.width=i;for(var o=void 0,r=0,s=0,c=0,d=this._historyData.length;0<=d;d--){var h=this._historyData[d];if(null!=h&&!isNaN(h)){var l=e.getChildren()[c];null==l&&((l=cc.instantiate(this.item)).parent=e),l.active=!0,cc.log("------------"),cc.log("..last:"+o),null!=o&&(o!=h||6<=r)&&(r=0,s++),o=h,l.x=this.item.x+40*s,l.y=this.item.y+40*r,cc.log("..winner:"+h),cc.log("..line:"+s),cc.log("..number:"+r),r++,c++,parseInt(l.name)!=h&&(l.name=h.toString(),this.loadItemImg(l,h))}}}},onClose:function(){this.node.active=!1}}),cc._RF.pop()},{hhdz_data:"hhdz_data",hhdz_roomUtil:"hhdz_roomUtil",roomUtil:"roomUtil"}],hhdz_table:[function(e,t,a){"use strict";cc._RF.push(t,"efa2bcXO5NFCbXZKbNWJsyH","hhdz_table");var o=e("SoundMngr"),n=e("gameDefine"),r=(e("ruleHandler"),e("roomHandler"),e("hhdz_roomUtil")),u=e("hhdz_data"),i=cc.Class({extends:cc.Component,properties:{BetLayer:cc.Node,JetonLayer:cc.Node,PokerLayer:cc.Node,CountDownLayer:cc.Node,CountDownLabel:cc.Label,winnerStrNode:cc.Node,OnLineNode:cc.Node,UIBet:cc.Prefab,_selectBetId:void 0,_jetonMax:void 0,_jetonPond:[],_jetonIndex:0,_jetonValueArray:[],_countDown:0},onLoad:function(){registEvent("rbw-dealCard",this,this.onDealCardHandler),registEvent("rbw-startPour",this,this.onStartPourHandler),registEvent("rbw-onSetPour",this,this.onOnSetPourHandler),registEvent("rbw-result",this,this.onResultHandler)},onDestroy:function(){unregistEvent("rbw-dealCard",this,this.onDealCardHandler),unregistEvent("rbw-startPour",this,this.onStartPourHandler),unregistEvent("rbw-onSetPour",this,this.onOnSetPourHandler),unregistEvent("rbw-result",this,this.onResultHandler)},onEnable:function(){this._selectBetId=void 0,this._jetonMax=100,this._jetonPond=[],this._jetonIndex=0,this._jetonValueArray=[],this.initUIShow(),this.updateTableJetonValue(),this.addFakeJetonToTable()},initUIShow:function(){this.CountDownLayer.active=!1,this.winnerStrNode.active=!1,this.setAddJetonInteractable(!1),this.initUIPokerBack()},onDealCardHandler:function(){this.winnerStrNode.active=!1,this.initUIPokerBack()},onStartPourHandler:function(){this.handleStartPourTimer()},onOnSetPourHandler:function(e){null!=e&&null!=e.detail&&this.tablePlayerAddJeton(e.detail)},onResultHandler:function(){var e=u.getResultInfoData();if(null!=e){var n=e.card;if(null!=n){var i=this;new Promise(function(e,t){i.openPoker("red");var a=i.openPoker("black");cc.log("..openPokerTime:"+a),e(a)}).then(function(e){return a=e,new Promise(function(t,e){setTimeout(function(){var e=i.runWinnerAction(n.winner);t(e)},1e3*a)});var a}).then(function(e){return a=e,new Promise(function(e,t){setTimeout(function(){i.takeBackJetonNode()},1e3*a)});var a}).then(function(){})}}},initUIPokerBack:function(){for(var e=0;e<3;e++){var t=cc.find("red/poker_"+e,this.PokerLayer);t&&this.loadPokerImg(t,"back");var a=cc.find("black/poker_"+e,this.PokerLayer);a&&this.loadPokerImg(a,"back")}},handleStartPourTimer:function(){var e=u.getStartPourTime();if(!(null==e||e<=0)){this._countDown=parseInt(e/1e3),this.setAddJetonInteractable(!0),this.schedule(this.updateLastTime,1);var t=this;setTimeout(function(){t.onLineFakeAddJeton()},2e3)}},updateLastTime:function(){if(null==this._countDown||this._countDown<=0)return this.CountDownLayer.active=!1,this.setAddJetonInteractable(!1),void this.unschedule(this.updateLastTime);this.CountDownLabel.string=this._countDown--,this.CountDownLayer.active=!0},updateTableJetonValue:function(){for(var e=0;e<3;e++){var t=cc.find("value_"+e,this.JetonLayer);t&&(void 0===this._jetonValueArray[e]&&(this._jetonValueArray[e]=0),t.getComponent(cc.Label).string=this._jetonValueArray[e])}},addFakeJetonToTable:function(){var e=r.getFakeJetonData();if(cc.log("..fake:"+JSON.stringify(e)),null!=e)for(var t=0;t<e.length;t++){var a=e[t];if(null!=a){if(null==cc.find("region_"+t,this.JetonLayer))return;for(var n=0;n<a.length;n++){var i=a[n];if(null!=i)for(var o=0;o<i.number;o++)this.addJetonNode(i.lv,t,void 0)}}}},tablePlayerAddJeton:function(e){var t=this.node.getComponent("hhdz_roomHead");if(null!=t){var a=t._headArray;if(null!=a)for(var n=0;n<a.length;n++)if(1!=n||!u.checkPlayerSame()){var i=a[n];if(null!=a){var o=i.getComponent("hhdz_head");if(null!=o){var r=o._player;null!=r&&r.uid==e.uid&&(o.runAddJetonAction(),this.addJetonNode(e.index,e.type,i.parent.position))}}}}},setBetsScale:function(){for(var e=0;e<5;e++){var t=cc.find("bet_"+e,this.BetLayer);if(t){if(e==this._selectBetId){t.scale=1.1;continue}t.scale=1}}},setAddJetonInteractable:function(e){for(var t=0;t<5;t++){var a=cc.find("bet_"+t,this.BetLayer);a&&(a.scale=1,a.getComponent(cc.Button).interactable=e)}this._selectBetId=void 0;for(var n=0;n<3;n++){var i=cc.find("region_"+n,this.JetonLayer);i&&(i.getComponent(cc.Button).interactable=e)}},addJetonNode:function(e,t,a){if(null!=e&&null!=t){var n=cc.find("region_"+t,this.JetonLayer);if(null!=n){this._jetonIndex>this._jetonMax&&(this._jetonIndex=0);var i=this._jetonPond[this._jetonIndex];null==i&&(cc.log("..create uiBet."),(i=cc.instantiate(this.UIBet)).parent=this.JetonLayer,this._jetonPond.push(i)),this._jetonIndex++;var o=i.getComponent("hhdz_bet");if(null!=o){o.setBetId(e),this.addJetonValue(e,t);var r={x:getRandomInt(n.position.x-n.width/2,n.position.x+n.width/2),y:getRandomInt(n.position.y-n.height/2,n.position.y+n.height/2)};a?o.runActionToTable(a,r):o.setBetPosition(r)}}}},JetonRunMove:function(e,t,a){if(null!=e&&null!=t&&null!=a)for(var n=e;n<e+t;n++){var i=this._jetonPond[n];if(i){var o=i.getComponent("hhdz_bet");o&&o.runActionToPlayer(a)}}},takeBackJetonNode:function(){var e=this.node.getComponent("hhdz_roomHead");if(null!=e){var t=u.getResultInfoData();if(null!=t){var a=t.winLoseInfo;if(null!=a){void 0===this._jetonPond&&(this._jetonPond=[]);for(var n=[],i=0;i<a.length;i++){var o=a[i];if(null!=o&&0<parseInt(o.score)){var r=e.getHeadPositionByUId(o.uid);if(null==r)continue;n.push(r)}}if(t.self&&0<t.self){var s=e.getSelfHeadPosition();s&&n.push(s)}n.push(this.OnLineNode.position);for(var c=this._jetonPond.length,d=parseInt(c/n.length),h=0,l=0;l<n.length;l++)l==n.length-1&&(d=c),this.JetonRunMove(h,d,n[l]),c-=d,h+=d;this._jetonIndex=0,this._jetonValueArray=[],this.updateTableJetonValue()}}}},addJetonValue:function(e,t){null!=e&&null!=t&&(this._jetonValueArray[t]<0&&(this._jetonValueArray[t]=0),this._jetonValueArray[t]+=r.getBetValue(e),this.updateTableJetonValue())},loadPokerImg:function(e,t){if(null!=e&&null!=t){var a=r.getPokerImgUrl(t);if(null!=a){var n=cc.textureCache.addImage(cc.url.raw(a));n&&(e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n))}}},pokerRunFlipAndLoadImg:function(e,t){var a=this,n=cc.scaleTo(.3,0,1),i=cc.scaleTo(.3,1,1),o=cc.callFunc(function(){a.loadPokerImg(e,t)});return e.stopAllActions(),e.runAction(cc.sequence(n,o,i)),.6},runWinnerAction:function(e){var t=null;switch(e){case r.WinnerType.Red:t="红方";break;case r.WinnerType.Black:t="黑方"}if(null!=t){this.winnerStrNode.getComponent(cc.Label).string=t,this.winnerStrNode.active=!0,this.winnerStrNode.opacity=0;var a=cc.fadeIn(.5),n=cc.delayTime(.5);return this.winnerStrNode.stopAllActions(),this.winnerStrNode.runAction(cc.sequence(a,n)),1.5}},openPoker:function(t){var e=u.getResultInfoData();if(null!=e){var a=e.card;if(null!=a){var r=a[t];if(null!=r){null==r.card&&(r.card=[]);var s=this,n=0;i(t,0,0).then(function(e){return cc.log("..data.1:"+JSON.stringify(e)),n+=e.time,i(t,e.index,e.time)}).then(function(e){return cc.log("..data.2:"+JSON.stringify(e)),n+=e.time,i(t,e.index,e.time)}).then(function(e){return n+=e.time,cc.log("..return:"+n),n})}}}function i(i,o,e){return void 0===e&&(e=0),new Promise(function(a,n){setTimeout(function(){cc.log("..success runFunc.");var e={},t=cc.find(i+"/poker_"+o,s.PokerLayer);t?(e.time=s.pokerRunFlipAndLoadImg(t,r.card[o]),e.index=++o,a(e)):(e.time=0,e.index=++o,n(e))},1e3*e)})}},onLineFakeAddJeton:function(){if(!(null==this._countDown||this._countDown<=1)){var e=r.getOnLineFakeAddJetonData();if(null!=e){void 0===e.data&&(e.data=[]);for(var t=this,a=0;a<e.data.length;)this.addJetonNode(e.data[a],e.data[a+1],this.OnLineNode.position),a+=2;e.time<1&&(e.time=1),setTimeout(function(){t.onLineFakeAddJeton()},parseInt(e.time))}}},onBetBtnClick:function(e,t){o.instance.playAudioOther("button"),null!=t&&t!=this._selectBetId&&(this._selectBetId=t,this.setBetsScale())},onJetonBtnClick:function(e,t){if((o.instance.playAudioOther("button"),null!=t)&&(null!=this._selectBetId&&null!=cc.find("region_"+t,this.JetonLayer))){var a=cc.find("bet_"+this._selectBetId,this.BetLayer);if(null!=a){var n=r.getBetValue(this._selectBetId);if(null==n||GameData.player.coin<n)createMoveMessage("金币不足！");else{var i=a.position;this.addJetonNode(this._selectBetId,t,i),u.setPour(t,this._selectBetId)}}}},onLeaveBtnClick:function(e){o.instance.playAudioOther("button")},onSetingBtnClick:function(e){o.instance.playAudioOther("button"),openView("SettingsPanel")},onRunChartBtnClick:function(e){o.instance.playAudioOther("button"),openView("hhdz-runChart",n.GameType.Game_Poker_HHDZ,null)}});t.exports=i,cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",hhdz_data:"hhdz_data",hhdz_roomUtil:"hhdz_roomUtil",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],home:[function(e,t,a){"use strict";cc._RF.push(t,"3b0a0dOmglLsoM0+9JDMOm7","home");var i=e("SoundMngr"),o=e("roomHandler"),n=e("matchHandler"),h=e("gameDefine"),r=e("configMgr"),l=e("competitionHandler"),s=e("missionHandler");cc.Class({extends:cc.Component,properties:{head_node:cc.Node,head_name:cc.Label,head_identify_num:cc.Label,head_gold_num:cc.Label,roomcard_num:cc.Label,curSelectUI:cc.Node,shopBtn:cc.Node,taskBtn:cc.Node,agentBtn:cc.Node,recordBtn:cc.Node,serviceBtn:cc.Node,settingBtn:cc.Node,explainBtn:cc.Node,moreBtn:cc.Node,moreBase:cc.Node,groupToggle:cc.Toggle,matchToggle:cc.Toggle,competitionToggle:cc.Toggle,paoMadengLabel:cc.Label,_paoMadengX:0,playerTemplate:cc.Prefab,UIGroup:cc.Prefab,UIMatch:cc.Prefab,UICompetition:cc.Prefab},onLoad:function(){registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showDDZTableLayer),registEvent("tjddz-onGameStart",this,this.showTJDDZTableLayer),registEvent("pdk-onGameStart",this,this.showPDKTableLayer),registEvent("openScore",this,this.showTableLayer),registEvent("onPlayerUpdate",this,this.roomcardRefresh),registEvent("refreshActivityRedPoint",this,this.refreshActivityRedPoint),registEvent("onServerNotice",this,handlerServerNotice),registEvent("onMatchData",this,this.onMatchHandler),registEvent("OnPasteboardChanged",this,this.OnPasteboardChanged),registEvent("playerMissionData",this,this.onPlayerMissionHandler),cc.game.addPersistRootNode(cc.find("lampNode")),this.curSelectType=h.CurSelectType.group;var e=cc.sys.localStorage.getItem("homeCurSelectType");e&&(this.curSelectType=JSON.parse(e).type),this.refreshCurrentOpenPrefab(this.curSelectType),this.runPaoMadeng(),this.refreshPlayerInfo(),this.refreshNoticeShow(),this.openPosterView(),this.onMatchHandler(),ReplayDataCenter.openRoundPanel&&openView("RecordPanel"),ReplayDataCenter.openReplayPanel&&openView("RoundPanel"),this.OnPasteboardChanged()},onEnable:function(){i.instance.playMusic("sound/wait"),this.refreshAgentRoomBtn(),GameData.player.agentFlag||sendEvent("refreshActivityRedPoint"),this.onPlayerMissionHandler()},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showDDZTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTJDDZTableLayer),unregistEvent("pdk-onGameStart",this,this.showPDKTableLayer),unregistEvent("openScore",this,this.showTableLayer),unregistEvent("onPlayerUpdate",this,this.roomcardRefresh),unregistEvent("refreshActivityRedPoint",this,this.refreshActivityRedPoint),unregistEvent("onServerNotice",this,handlerServerNotice),unregistEvent("onMatchData",this,this.onMatchHandler),unregistEvent("OnPasteboardChanged",this,this.OnPasteboardChanged),unregistEvent("playerMissionData",this,this.onPlayerMissionHandler)},showTableLayer:function(){cc.director.loadScene("table")},showDDZTableLayer:function(){},showTJDDZTableLayer:function(){cc.director.loadScene("table-TJDDZ")},showPDKTableLayer:function(){cc.director.loadScene("table-PDK")},refreshPlayerInfo:function(){isChinese(GameData.player.name)?this.head_name.string=getShortStr(GameData.player.name,5):this.head_name.string=getShortStr(GameData.player.name,10);var e=cc.instantiate(this.playerTemplate);e.getComponent("playerTemplate").setPlayer(GameData.player),e.getComponent("playerTemplate").setName(""),e.getComponent("playerTemplate").showZhuang(!1),e.getComponent("playerTemplate").setHeadIcon(GameData.player.headimgurl),this.head_node.addChild(e),this.head_identify_num.string=GameData.player.uid,this.roomcardRefresh()},roomcardRefresh:function(){this.roomcard_num.string=GameData.player.card,null==GameData.player.coin&&null==GameData.player.coin||(this.head_gold_num.string=ConversionCoinValue(GameData.player.coin,0))},refreshNoticeShow:function(){if(GameData.serverNoticeData&&0<GameData.serverNoticeData.length){var e=(new Date).valueOf(),t=GameData.serverNoticeData[0].lastTime;0==ComparingDate(e,t)&&(GameData.isRoomRunlampt||openView("RunlampPanel"),this.schedule(lampHandler,1),GameData.isRoomRunlampt=!0)}if(GameData.serverNoticeData&&1<GameData.serverNoticeData.length){e=(new Date).valueOf(),t=GameData.serverNoticeData[0].lastTime;if(0==ComparingDate(e,t)){if(!GameData.isRoomRunlampt){var a=cc.sequence(cc.delayTime(15),cc.callFunc(function(){openView("RunlampPanel1")}));this.node.runAction(a)}this.schedule(lampHandler1,1),GameData.isRoomRunlampt1=!0}}},fangkaAddCBack:function(e){i.instance.playAudioOther("button"),openView("kefuweixin")},goldAddClick:function(e){i.instance.playAudioOther("button");openView("shoppingPanel",void 0,function(e){if(e){var t=e.getComponent("shoppingPanel");t&&t.showPanel(2)}})},loadSpriteImg:function(e,t){if(!(null==e||null==t||t.length<=0)){var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.spriteFrame=new cc.SpriteFrame(a))}},refreshActivityRedPoint:function(){},runPaoMadeng:function(){this._paoMadengX=this.paoMadengLabel.node.x,GameData.configData.paomadengIndex=0,this.gotoPaoMadeng(),this.schedule(this.gotoPaoMadeng,10)},gotoPaoMadeng:function(){if(GameData.configData.paomadeng){var e=GameData.configData.paomadeng[GameData.configData.paomadengIndex].content;e=e.replace(/[\n]/gi,""),this.paoMadengLabel.string=e,this.paoMadengLabel.node.x=this._paoMadengX;var t=cc.moveTo(10,cc.p(this._paoMadengX-570-this.paoMadengLabel.node.width,this.paoMadengLabel.node.y));this.paoMadengLabel.node.runAction(t),GameData.configData.paomadengIndex++,GameData.configData.paomadengIndex==GameData.configData.paomadeng.length&&(GameData.configData.paomadengIndex=0)}},refreshAgentRoomBtn:function(){},setMoreBaseShow:function(e){this.moreBase.active=e},showUIClub:function(){i.instance.playAudioOther("button"),GameData.player.club&&0<Object.keys(GameData.player.club).length?openView("PanelClub"):createMessageBox("您还没有俱乐部，请联系您的代理或推广员",function(){})},openRecordPanel:function(e){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("RecordPanel")},openSettingsPanel:function(e){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("SettingsPanel")},shareBtnClick:function(){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("SharePanel")},selectClubClick:function(){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("selectclubPanel")},openShoppingPanel:function(){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("shoppingPanel")},openTaskClick:function(){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("UITask")},openRankClick:function(){i.instance.playAudioOther("button"),this.setMoreBaseShow(!1),openView("UICoinRankingList")},openPushGameClick:function(){if(this.setMoreBaseShow(!1),!inCD(3e3))switch(i.instance.playAudioOther("button"),GameData.player.agentRole){case h.agentRole.agentPower:return void createMoveMessage("您已经是总代理，请前往公众号查看。");case h.agentRole.agent:return void createMoveMessage("您已经是代理，请前往公众号查看。");case h.agentRole.push:return void createMoveMessage("您已经是推广员，请前往公众号查看。");case h.agentRole.ordinary:var e=parseInt((new Date).valueOf()/1e3),t=GameData.player.qrcodeTime;null==t&&(t=0),0<t&&0<t-e?openView("UIPushGame"):GameNet.getInstance().request("game.playerHandler.reqPlayerQrcode",null,function(e){e.qrcodeUrl?(GameData.player.qrcodeUrl=e.qrcodeUrl,GameData.player.qrcodeTime=e.qrcodeTime,openView("UIPushGame")):createMoveMessage("请求数据失败。")});break;default:createMoveMessage("请求数据失败。")}},agentRoomClick:function(){this.setMoreBaseShow(!1),i.instance.playAudioOther("button"),null==GameData.player.club||Object.keys(GameData.player.club).length<=0||2!=GameData.player.club.clubAdmin?createMoveMessage("您还不是代理，无法代开房！"):(o.reqAgentRoom(),o.reqAgentResultRoom(),openView("agentPanel"))},showNotice:function(){i.instance.playAudioOther("button"),openView("NoticePanel")},showCreateRoomDDZ:function(){i.instance.playAudioOther("button"),openView("DDZ-CreateHome")},openPosterView:function(e){var t=new Date;if(e&&e.target)i.instance.playAudioOther("button");else{var a=cc.sys.localStorage.getItem("posterTime");if(null!=a){var n=new Date(parseInt(JSON.parse(a).time));if(ComparingDateInSameDay(n,t))return}}null==r.getPoster()||r.getPoster().length<=0||(openView("PosterPanel"),cc.sys.localStorage.setItem("posterTime",JSON.stringify({time:t.valueOf()})))},onMatchHandler:function(){n.onMatch&&openView("UIMatch")},moreBtnClick:function(){i.instance.playAudioOther("button");var e=this.moreBase.active;if(this.setMoreBaseShow(!e),!e){var t=cc.scaleTo(.08,1.1),a=cc.scaleTo(.05,1);this.moreBase.stopAllActions(),this.moreBase.runAction(cc.sequence(t,a))}},groupBtnClick:function(){this.refreshToggleBtnChecked(),inCD(500)||(i.instance.playAudioOther("button"),cc.log("..groupBtnClick"),this.curSelectType!=h.CurSelectType.group&&this.refreshCurrentOpenPrefab(h.CurSelectType.group))},matchBtnClick:function(){if(this.refreshToggleBtnChecked(),!inCD(500)){i.instance.playAudioOther("button"),cc.log("..matchBtnClick");var e=r.getMatchGameType();null==e||e.length<=0?createMoveMessage("暂未开启。"):this.curSelectType!=h.CurSelectType.match&&this.refreshCurrentOpenPrefab(h.CurSelectType.match)}},competitionBtnClick:function(){if(this.refreshToggleBtnChecked(),!inCD(500)){i.instance.playAudioOther("button"),cc.log("..competitionBtnClick");var e=r.getFightGameType();null==e||e.length<=0?createMoveMessage("暂未开启。"):this.curSelectType!=h.CurSelectType.competition&&this.refreshCurrentOpenPrefab(h.CurSelectType.competition)}},refreshCurrentOpenPrefab:function(e){var t=void 0;switch(e){case h.CurSelectType.group:t=cc.instantiate(this.UIGroup);break;case h.CurSelectType.match:t=cc.instantiate(this.UIMatch);break;case h.CurSelectType.competition:l.getActivityList(),t=cc.instantiate(this.UICompetition)}if(cc.log("..type:"+e),null!=t){var a="template_"+e,n=this.curSelectUI.getChildByName(a);null==n&&((n=t).parent=this.curSelectUI,n.name=a),n.active=!0;var i=cc.director.getWinSize();if(this.curSelectType&&e!=this.curSelectType){var o=this.curSelectUI.getChildByName("template_"+this.curSelectType);if(o){var r=cc.moveTo(.3,cc.p(-i.width,0));o.stopAllActions(),o.runAction(cc.sequence(r.easing(cc.easeIn(5)),cc.callFunc(function(){o.active=!1}))),n.x=i.width;var s=cc.delayTime(.05),c=cc.moveTo(.3,cc.p(-20,0)),d=cc.moveTo(.08,cc.p(0,0));n.stopAllActions(),n.runAction(cc.sequence(s,c.easing(cc.easeIn(6)),d))}}this.curSelectType=e,this.refreshToggleBtnChecked(),this.saveHomeCurSelectType()}},refreshToggleBtnChecked:function(){switch(this.curSelectType){case h.CurSelectType.group:this.groupToggle.isChecked=!0,this.matchToggle.isChecked=!1,this.competitionToggle.isChecked=!1;break;case h.CurSelectType.match:this.matchToggle.isChecked=!0,this.groupToggle.isChecked=!1,this.competitionToggle.isChecked=!1;break;case h.CurSelectType.competition:this.competitionToggle.isChecked=!0,this.groupToggle.isChecked=!1,this.matchToggle.isChecked=!1}},saveHomeCurSelectType:function(){if(null!=this.curSelectType){var e={type:this.curSelectType};cc.sys.localStorage.setItem("homeCurSelectType",JSON.stringify(e))}},OnPasteboardChanged:function(e){WriteLog("home.js OnPasteboardChanged"),this.getRoomIdByPasteboard()},getRoomIdByPasteboard:function(){WriteLog("home.js getRoomIdByPasteboard");var e=getTextClipboard();if(e){var t=e.indexOf("房间号:");if(-1!=t){if(-1!=e.indexOf("【复制】这条信息后,打开游戏进入牌局。")){var a="房间号:".length,n=e.substring(t+a,t+a+6);if(!(n<1e5||999999<n))cc.sys.localStorage.getItem("selfAgentRoomId")!=n&&o.enterRoom(n)}}}},onPlayerMissionHandler:function(){var e=!s.checkAllComplete(GameData.player.mission);this.taskBtn.active=e}}),cc._RF.pop()},{SoundMngr:"SoundMngr",competitionHandler:"competitionHandler",configMgr:"configMgr",gameDefine:"gameDefine",matchHandler:"matchHandler",missionHandler:"missionHandler",roomHandler:"roomHandler"}],hongzhongData:[function(e,t,a){"use strict";cc._RF.push(t,"4e356RRo1RCgqnuECI8xACf","hongzhongData");e("gameDefine");var n=e("errorCode"),o={cards:{},game:{roundType:0,roundNum:0,roundmax:0,zhuangUid:0,cardleft:0,turn:0,wildcard:[],lastdisUid:0,lastdisCard:0,winnerUid:0,winnerType:0,obtain:0},passAction:{lastUid:0,fromCard:0,action:[],checkCards:[]},actionType:!1,actionEffect:{uid:null,card:null,action:null},scores:{}};(t.exports=o).requestDisCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.discard",{card:e},function(e){cc.log("room.hzhmjHandler.discard:%d",e.result),t(e)})},o.requestPass=function(t){GameNet.getInstance().request("room.hzhmjHandler.pass",{},function(e){cc.log("room.hzhmjHandler.pass response:%d",e.result),e.result==n.Fail&&createMoveMessage("请等待其他玩家选择"),t(e)})},o.requestChiCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.chi",{cards:e.cards},function(e){cc.log("room.hzhmjHandler.chi response:%d",e.result),t(e)})},o.requestPengCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.peng",{},function(e){cc.log("room.hzhmjHandler.peng response:%d",e.result),t(e)})},o.requestAnGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangAn",{card:e.cards},function(e){cc.log("room.hzhmjHandler.gangAn response:%d",e.result),t(e)})},o.requestMingGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangMing",{},function(e){cc.log("room.hzhmjHandler.gangMing response:%d",e.result),t(e)})},o.requestBuGangCard=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.gangBu",{card:e.cards},function(e){cc.log("room.hzhmjHandler.gangBu response:%d",e.result),t(e)})},o.requestDianPao=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.dianPao",{},function(e){cc.log("room.hzhmjHandler.dianPao response:%d",e.result),t(e)})},o.requestHu=function(e,t){GameNet.getInstance().request("room.hzhmjHandler.hu",{},function(e){cc.log("room.hzhmjHandler.hu response:%d",e.result),t(e)})},o.getGameInfoData=function(){return this.game},o.getPlayerCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e]},o.getChiCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].chi},o.getPengCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].peng},o.getGangCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].gang},o.getHandCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].hand},o.getHandCardNum=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].handnum},o.getDisCards=function(e){return null==this.cards[e]&&(this.cards[e]={}),this.cards[e].dis},o.getPassActionsData=function(){return this.passAction},o.getActionsType=function(){return this.actionType},o.getActionEffectData=function(){return this.actionEffect},o.getGameScoreData=function(){return this.scores},o.onGameInfoSetData=function(e){null!=e&&(this.game.roundType=e.roundType,this.game.roundNum=e.roundNum,this.game.roundmax=e.roundmax,this.game.zhuangUid=e.zhuang,this.game.cardleft=e.cardleft,this.game.turn=e.turn,this.game.wildcard=e.wildcard,this.game.lastdisUid=e.disuid,this.game.lastdisCard=e.discard,GameData.game.turn=e.turn)},o.onGameStartSetData=function(e){null!=e&&(this.game.gameStart=!0,this.passAction.lastUid=0,this.passAction.fromCard=0,this.passAction.action=[],this.passAction.checkCards=[])},o.onGameScoreSetData=function(e){null!=e&&(this.scores=e,this.game.gameStart=!1)},o.onGamePassSetData=function(e){null!=e&&(this.passAction.lastUid=e.uid,this.passAction.fromCard=e.card,this.passAction.action=e.act,this.actionType=!1)},o.onGameActionSetData=function(e){null!=e&&(this.passAction.action=e.act,this.actionType=!0)},o.initCardHandSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].hand=e.hand,this.game.obtain=e.obtain)},o.initCardHandNumSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].handnum=e.num)},o.initCardChiSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].chi=e.chi)},o.initCardPengSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].peng=e.peng)},o.initCardGangSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].gang=e.gang)},o.initCardDisSetData=function(e){null!=e&&(null==this.cards[e.uid]&&(this.cards[e.uid]={}),this.cards[e.uid].dis=e.dis)},o.setActionEffect=function(e,t){null!=e&&null!=t&&(this.actionEffect.uid=t.player,this.actionEffect.card=t.card,this.actionEffect.action=e)},o.onCardDisSetData=function(e){this.setActionEffect("dis",e)},o.onCardChiSetData=function(e){this.setActionEffect("chi",e)},o.onCardPengSetData=function(e){this.setActionEffect("peng",e)},o.onCardGangMingSetData=function(e){this.setActionEffect("gang",e)},o.onCardGangAnSetData=function(e){this.setActionEffect("gang",e)},o.onCardGangBuSetData=function(e){this.setActionEffect("gang",e)},o.onCardHuSetData=function(e){this.setActionEffect("hu",e)},o.registMessage_hz=function(){cc.log("....hongzhong data registMessage.");var t=this;GameNet.getInstance().setCallBack("hzhmj-onGameInfo",function(e){t.onGameInfoSetData(e),sendEvent("onGameInfo",e),sendEvent("onGameTurn"),sendEvent("updateCards")}),GameNet.getInstance().setCallBack("hzhmj-initCardHand",function(e){t.initCardHandSetData(e),sendEvent("initCardHand",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardHandNum",function(e){t.initCardHandNumSetData(e),sendEvent("initCardHandNum",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardChi",function(e){t.initCardChiSetData(e),sendEvent("initCardChi",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardPeng",function(e){t.initCardPengSetData(e),sendEvent("initCardPeng",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardGang",function(e){t.initCardGangSetData(e),sendEvent("initCardGang",e)}),GameNet.getInstance().setCallBack("hzhmj-initCardDis",function(e){t.initCardDisSetData(e),sendEvent("initCardDis",e)}),GameNet.getInstance().setCallBack("hzhmj-onGamePass",function(e){t.onGamePassSetData(e),sendEvent("onGamePass",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameAction",function(e){t.onGameActionSetData(e),sendEvent("onGameAction",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardDis",function(e){t.setActionEffect("dis",e),sendEvent("onCardDis",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardChi",function(e){t.setActionEffect("chi",e),sendEvent("onCardChi",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardPeng",function(e){t.setActionEffect("peng",e),sendEvent("onCardPeng",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangAn",function(e){t.setActionEffect("gang",e),sendEvent("onCardGangAn",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangMing",function(e){t.setActionEffect("gang",e),sendEvent("onCardGangMing",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardGangBu",function(e){t.setActionEffect("gang",e),sendEvent("onCardGangBu",e)}),GameNet.getInstance().setCallBack("hzhmj-onCardHu",function(e){t.setActionEffect("hu",e),sendEvent("onCardHu",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameStart",function(e){t.onGameStartSetData(e),sendEvent("onGameStart",e)}),GameNet.getInstance().setCallBack("hzhmj-onGameScore",function(e){t.onGameScoreSetData(e),sendEvent("onGameScore",e)})},o.arrayChangeObject=function(e){for(var t={},a=0;a<e.length;a++){var n=e[a],i=o.getArrayElementNumber(e,n);t[n]=i}return t},o.getArrayElementNumber=function(e,t){var a=0;if(null==e)return a;for(var n=0;n<e.length;n++)e[n]==t&&a++;return a},cc._RF.pop()},{errorCode:"errorCode",gameDefine:"gameDefine"}],huadian:[function(e,t,a){"use strict";cc._RF.push(t,"6a772XfqwlFIpr88iX/nQCO","huadian");var n=e("gameDefine"),i={areaType:n.AreaType.Area_HuaDian,serverIP:"mahjong.ry-huadian.com",serverPort:3010,gameName:"摸摸桦甸麻将",versionText:"",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/huadian2",wxWelcomeText:"摸摸桦甸麻将,欢迎您的加入!",loginLogo:"resources/login/ruoyuhuadian.png",Poster:["resources/poster/huandian/poster_HD_1.png"],GameVisible:[n.GameType.Game_MJ_HuaDian,n.GameType.Game_Poker_DDZ,n.GameType.Game_TDK,n.GameType.Game_Mj_CC],ModeType:{Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_MJ_HuaDian:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]},Game_Mj_CC:{CurrencyType:n.currencyType.Currency_Card,SettleType:[]}},SetCardsOpen:!1,MatchGameType:[],serverConfig:{roomCard:{6:{61:{name:"6局",cost:{2:{final:1},4:{final:1}}},62:{name:"12局",cost:{2:{final:1},4:{final:1}}},63:{name:"24局",cost:{2:{final:2},4:{final:2}}},64:{name:"1圈",cost:{2:{final:1},4:{final:1}}},65:{name:"2圈",cost:{2:{final:1},4:{final:1}}},66:{name:"4圈",cost:{2:{final:2},4:{final:2}}}},7:{71:{name:"15局",cost:{3:{final:1},4:{final:1},5:{final:1},6:{final:1}}},72:{name:"30局",cost:{3:{final:2},4:{final:2},5:{final:2},6:{final:2}}}},10:{61:{name:"4局",cost:{2:{final:1}}},62:{name:"8局",cost:{2:{final:1}}},63:{name:"16局",cost:{2:{final:2}}},64:{name:"1圈",cost:{4:{final:1}}},65:{name:"2圈",cost:{4:{final:1}}},66:{name:"4圈",cost:{4:{final:2}}}},102:{6:{name:"6局",cost:{3:{final:1}}},10:{name:"10局",cost:{3:{final:1}}},20:{name:"20局",cost:{3:{final:2}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],"hundredNiu-roomBase":[function(e,t,a){"use strict";cc._RF.push(t,"27dc8095nNF/LnzXyKwJCbc","hundredNiu-roomBase");var n=e("gameDefine"),i=e("roomHandler"),o=e("hundredNiuHandler");cc.Class({extends:cc.Component,properties:{batteryNode:cc.Node},onLoad:function(){registEvent("nativePower",this,this.onNativePowerHandler),this.electricQuantity()},onDestroy:function(){unregistEvent("nativePower",this,this.onNativePowerHandler)},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){jsclient.native.HelloOC("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},backBtnClick:function(){var e=o.getselfChipsSum();GameData.player.uid==o.zhuangUid?openView("hundred_backPanel",n.GameType.Game_Niu_Hundred,function(e){e.getComponent("hundred_backPanel").showBackUI("zhuang")}):0<e?openView("hundred_backPanel",n.GameType.Game_Niu_Hundred,function(e){e.getComponent("hundred_backPanel").showBackUI("xian")}):i.quitRoom(i.room.id)},clickGetDealerList:function(){GameNet.getInstance().request("room.niuHundredHandler.zhuanglist",{},function(t){0==t.result?openView("hundred_shangzhuangPanel",n.GameType.Game_Niu_Hundred,function(e){e.getComponent("hundred_dealerPanel").showUI(t.zhuanglist)}):cc.log("request zhuanglist error")})},clickGetPlayerList:function(){GameNet.getInstance().request("room.niuHundredHandler.playerlist",{},function(t){0==t.result?openView("hundred_sankePanel",n.GameType.Game_Niu_Hundred,function(e){e.getComponent("hundred_sankePanel").showUI(t.data)}):cc.log("request playerlist error")})},clickGetTrendPanel:function(){GameNet.getInstance().request("room.niuHundredHandler.trendlist",{},function(t){0==t.result?openView("hundred_trendPanel",n.GameType.Game_Niu_Hundred,function(e){e.getComponent("hundred_trendPanel").showUI(t.trendlist)}):cc.log("request trendlist error")})},goToShop:function(){openView("shoppingPanel",void 0,function(e){e.getComponent("shoppingPanel").showPanel(2)})},showSettingLayer:function(e,t){openView("niuniu_settingPrefab",n.GameType.Game_niu_niu)},showRulePanel:function(){openView("hundred_rulePanel",n.GameType.Game_Niu_Hundred)}}),cc._RF.pop()},{gameDefine:"gameDefine",hundredNiuHandler:"hundredNiuHandler",roomHandler:"roomHandler"}],"hundredNiu-roomMain":[function(e,t,a){"use strict";cc._RF.push(t,"a8fb5zqz0tOQrXU5hMsq/yk","hundredNiu-roomMain");var n=e("SoundMngr"),i=e("stateMachine"),o=e("hundredNiuHandler"),r=e("niuniuPokerHandler");cc.Class({extends:i,properties:{},onLoad:function(){i.prototype.onLoad.call(this),this.handlerMsg(),this.getGameRoundInfo(),n.instance.playMusic("shisanshui/sound/sss_table_bg1")},handlerMsg:function(){registEvent("niuhun-onGameInfo",this,this.getGameRoundInfo),this.registState(r.HUNDREDNIUSTATUS.CHIPS,this,this.startChipsFunction,this.onChipsFunction,this.endChipsFunction),this.registState(r.HUNDREDNIUSTATUS.SETTLE,this,this.startSettleFunction,this.onSettleFunction,this.endSettleFunction)},onDestroy:function(){unregistEvent("niuhun-onGameInfo",this,this.getGameRoundInfo),this.unregistState(r.HUNDREDNIUSTATUS.CHIPS,this,this.startChipsFunction,this.onChipsFunction,this.endChipsFunction),this.unregistState(r.HUNDREDNIUSTATUS.SETTLE,this,this.startSettleFunction,this.onSettleFunction,this.endSettleFunction),GameData.initGameData(),o.initHundredData()},getGameRoundInfo:function(){cc.log("roommain getGameRoundInfo"),this.setState(o.status)},startChipsFunction:function(e){console.log("stateMachine startChipsAnimation"),this.node.getComponent("hundredNiu-roomTable").initUI(),o.gameTimes<20?e():this.node.getComponent("hundredNiu-roomTable").startAnimation(e)},onChipsFunction:function(e){console.log("stateMachine onChipsAnimation"),this.node.getComponent("hundredNiu-roomTable").gambleCountTime(e)},endChipsFunction:function(e){console.log("stateMachine endChipsAnimation"),this.node.getComponent("hundredNiu-roomTable").chipsStopAnimation(e)},startSettleFunction:function(e){cc.log("stateMachine startSettleFunction"),e()},onSettleFunction:function(e){cc.log("stateMachine onSettleFunction"),e()},endSettleFunction:function(e){cc.log("stateMachine endSettleFunction"),e()}}),cc._RF.pop()},{SoundMngr:"SoundMngr",hundredNiuHandler:"hundredNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",stateMachine:"stateMachine"}],"hundredNiu-roomTable":[function(e,t,a){"use strict";cc._RF.push(t,"53cfdx4SzFAi4NXw8z0xxcV","hundredNiu-roomTable");var p=e("SoundMngr"),d=e("gameDefine"),i=e("roomHandler"),n=e("pokerAnimationBase"),g=e("hundredNiuHandler"),h=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{playerNodes:[cc.Node],dealerNode:cc.Node,pokerCradsNode:cc.Node,pokerTypeNode:cc.Node,otherPokerTypePrefab:cc.Prefab,selfCostChips:cc.Node,allCostChips:cc.Node,chipPrefab:cc.Prefab,chipsNode:cc.Node,scoreParent:cc.Node,scoreNode:cc.Prefab,winPlayerNode:cc.Node,areaNode:cc.Node,areaWin:cc.Node,actionNode:cc.Node,countNode:cc.Node,toggleNode:cc.Node,toggle0:cc.Toggle,toggle1:cc.Toggle,toggle2:cc.Toggle,toggle3:cc.Toggle,toggle4:cc.Toggle,maskNode:cc.Node,shensuanNode:cc.Node,guideNodePrefab:cc.Prefab},onLoad:function(){this.handlerMsg(),this.pokerAnimBase=new n,this.NowZhuang=0,this.savePokerData(),this.initUI(),this.niuniuStayType=h.getGameStatus(),this.niuniuPokerType=h.getPokerType()},handlerMsg:function(){registEvent("niuhun-onGameInfo",this,this.getClipsStatus),registEvent("niuhun-onBaoZhuang",this,this.baoZhuangAnim),registEvent("niuhun-onZhuangCoin",this,this.showTipsForZhuang),registEvent("niuhun-onGameChips",this,this.changeChipsAndScore),registEvent("niuhun-onGameCoin",this,this.showChipsFlyAnimation)},onDestroy:function(){unregistEvent("niuhun-onGameInfo",this,this.getClipsStatus),unregistEvent("niuhun-onBaoZhuang",this,this.baoZhuangAnim),unregistEvent("niuhun-onZhuangCoin",this,this.showTipsForZhuang),unregistEvent("niuhun-onGameChips",this,this.changeChipsAndScore),unregistEvent("niuhun-onGameCoin",this,this.showChipsFlyAnimation),this.unscheduleAllCallbacks()},initUI:function(){this.coinFlyData(),this.initRoundData(),this.initPokerCards(),this.initChipsOnDesk()},initChipsOnDesk:function(){for(var e=this.selfCostChips.childrenCount,t=0;t<e;t++){(i=this.selfCostChips.children[t])&&(i.getComponent(cc.Label).string=0)}for(var a=this.allCostChips.childrenCount,n=0;n<a;n++){(i=this.allCostChips.children[n])&&(i.getComponent(cc.Label).string=0)}for(t=0;t<this.chipsNode.childrenCount;t++){(i=this.chipsNode.children[t]).removeAllChildren()}for(t=0;t<this.shensuanNode.childrenCount;t++){var i;(i=this.shensuanNode.children[t]).removeAllChildren()}},initRoundData:function(){this.playSign=-1,this.clipsList=[],this.clipsChoose=0,this.countNode.active=!1,this.getRoomInfo(),this.getClipsStatus()},initPokerCards:function(){for(var e=0;e<this.pokerCradsNode.childrenCount;e++)for(var t=this.pokerCradsNode.children[e],a=0;a<t.childrenCount;a++){t.children[a].active=!1,t.children[a].getComponent("niuNiuPoker").initCardInfo(null)}for(var n=0;n<this.pokerTypeNode.childrenCount;n++){var i=this.pokerTypeNode.children[n];i&&i.removeAllChildren()}for(a=0;a<this.areaWin.childrenCount;a++){this.areaWin.children[a].active=!1}},coinFlyData:function(){this._coinIndex=0,this.chipsNum=50,this._coinList=[],this._winnerIndex=0,this._winnerToLoser={winPos:[],losePos:[],winnerList:{0:[],1:[],2:[],3:[]}}},savePokerData:function(){this.pokerArr=[],this.pokerPosArr=[];for(var e=0;e<this.pokerCradsNode.childrenCount;e++)for(var t=this.pokerCradsNode.children[e],a=0;a<5;a++)this.pokerArr.push(t.children[a]),this.pokerPosArr.push(t.children[a].position)},getRoomInfo:function(){this.clipsList=h.XIAZHU[i.room.opts.scorelv];for(var e=GameData.player.coin,t=this.clipsList.length-1;0<=t;t--)if(this.clipsList[t]<.2*e){this.clipsChoose=this.clipsList[t];break}},saveClipsChoose:function(){this.toggle0.isChecked=this.clipsChoose==this.clipsList[0],this.toggle1.isChecked=this.clipsChoose==this.clipsList[1],this.toggle2.isChecked=this.clipsChoose==this.clipsList[2],this.toggle3.isChecked=this.clipsChoose==this.clipsList[3],this.toggle4.isChecked=this.clipsChoose==this.clipsList[4]},getClipsStatus:function(){var e=h.HUNDREDNIUSTATUS;g.status!=e.CHIPS||GameData.player.uid==g.zhuangUid?this.initClipsMask():(this.showClipsMask(),this.saveClipsChoose());var t=cc.find("zhuangSign",this.countNode.parent),a=GameData.player.uid==g.zhuangUid;t.active=a},showClipsMask:function(){this.toggleNode.getComponent("cc.ToggleGroup").allowSwitchOff=!1,cc.find("xuyaBtn",this.toggleNode.parent).getComponent("cc.Button").interactable=!0;for(var e=g.getselfChipsSum(),t=GameData.player.coin,a=this.clipsList.length-1;0<=a;a--){if(.2*t<=e+this.clipsList[a]){if(cc.find("mask"+a,this.maskNode).active=!0,1==(n=cc.find("toggle"+a,this.toggleNode)).getComponent("cc.Toggle").isChecked&&0!=a)cc.find("toggle"+(a-1),this.toggleNode).getComponent("cc.Toggle").isChecked=!0,this.clipsChoose=this.clipsList[a-1];n.getComponent("cc.Toggle").isChecked=!1,n.getComponent("cc.Toggle").interactable=!1}else{var n;cc.find("mask"+a,this.maskNode).active=!1,(n=cc.find("toggle"+a,this.toggleNode)).getComponent("cc.Toggle").interactable=!0}}},initClipsMask:function(){this.toggleNode.getComponent("cc.ToggleGroup").allowSwitchOff=!0;for(var e=0;e<this.maskNode.childrenCount;e++){this.maskNode.children[e].active=!0}for(var t=0;t<this.toggleNode.childrenCount;t++){var a=this.toggleNode.children[t].getComponent("cc.Toggle");a.isChecked=!1,a.interactable=!1}cc.find("xuyaBtn",this.toggleNode.parent).getComponent("cc.Button").interactable=!1},showTipsForZhuang:function(){var e=i.room.opts.scorelv,t=getMatchShangZhuangFinal(d.GameType.Game_Niu_Hundred,e);GameData.player.coin<t&&niuniuCreateMoveMessage("未满足上庄条件")},startAnimation:function(e){if(g.isStartAnimationPlayed=!0,this.NowZhuang!=g.zhuangUid){this.shangzhuangAnimation();var t=this;this.scheduleOnce(function(){t.gameStartAnimation(e)},2)}else this.gameStartAnimation(e);this.NowZhuang=g.zhuangUid},gameStartAnimation:function(e){p.instance.playHundredOther("start");var t=cc.find("/beginXiaZhu",this.actionNode);t.active=!0,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("kaishixiazhu",1);this.scheduleOnce(function(){t.active=!1,g.isStartAnimationPlayed=!1,e()},1.5)},shangzhuangAnimation:function(){p.instance.playHundredOther("shangzhuang");var e=cc.find("shangzhuang",this.actionNode);cc.find("name",e).getComponent("cc.Label").string=g.zhuangInfo.name,e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("xxxyishangzhuang",1),this.zhuangHeadAnimation();this.scheduleOnce(function(){e.active=!1},1.5)},zhuangHeadAnimation:function(){var e=cc.find("layer_ui_show/zhuangHead",this.node),t=cc.find("zhuang",e);e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",0),t.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);this.scheduleOnce(function(){e.active=!1},1.5)},chipsStopAnimation:function(e){p.instance.playHundredOther("stop");var t=cc.find("/stopXiaZhu",this.actionNode);t.active=!0,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("tingzhixiazhu",1);var a=this;this.scheduleOnce(function(){t.active=!1,a.dealAction(),e()},1.5)},showAllWinAnimation:function(e){var t=cc.find("/tongying",this.actionNode);t.active=!0;var a=t.getComponent(dragonBones.ArmatureDisplay);"zhuang"==e?a.playAnimation("zhuangjiatongchi",1):"xian"==e&&a.playAnimation("zhuangjiatongpei",1);this.scheduleOnce(function(){t.active=!1},1.5)},winnerAnimation:function(e){var t=cc.find("winAct"+e,this.winPlayerNode);t.active=!0,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);this.scheduleOnce(function(){t.active=!1},1.5)},showWinIcon:function(){for(var e=0;e<this.areaWin.childrenCount;e++){var t=this.areaWin.children[e],a=cc.find("winLb",t);if(g.pokerResult[e])t.active=!1;else{t.active=!0;var n=a.getComponent(dragonBones.ArmatureDisplay);t.getComponent(dragonBones.ArmatureDisplay).playAnimation("faguang",0),n.playAnimation("ying",1)}}},baoZhuangAnim:function(){p.instance.playHundredOther("baozhuang");var e=cc.find("/baozhuang",this.actionNode);e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("baozhuang",1);this.scheduleOnce(function(){e.active=!1},1.5)},fapaiAnimation:function(){var e=cc.find("/fapai",this.actionNode);e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",0)},selectClips:function(){this.toggle0.isChecked?this.clipsChoose=this.clipsList[0]:this.toggle1.isChecked?this.clipsChoose=this.clipsList[1]:this.toggle2.isChecked?this.clipsChoose=this.clipsList[2]:this.toggle3.isChecked?this.clipsChoose=this.clipsList[3]:this.toggle4.isChecked&&(this.clipsChoose=this.clipsList[4])},clickSetClips:function(e,t){g.requestSetChips(this.clipsChoose,t,this.toggle0.interactable),g.status!=h.HUNDREDNIUSTATUS.CHIPS||GameData.player.uid==g.zhuangUid?this.initClipsMask():this.showClipsMask()},continueChips:function(){g.requestContinueChips()},dealAction:function(){var t=this;this.fapaiAnimation(),this.pokerAnimBase.dealAction(this.pokerArr,this.dealerNode.position,this.pokerPosArr,.13,function(e){t.scheduleOnce(function(){cc.find("/fapai",t.actionNode).active=!1,t.showAreaPokerCards()},e)});for(var e=0;e<this.pokerArr.length;e++)this.scheduleOnce(function(){p.instance.playHundredOther("fapai")},.1*(e+1))},showAreaPokerCards:function(){for(var e=this.pokerCradsNode.childrenCount,t=g.pokerCards,a=e-1;0<=a;a--)this.delayTimeShowPoker(this.pokerCradsNode.children[a],t[a],a)},delayTimeShowPoker:function(t,a,n){var i=this;setTimeout(function(){var e=i.showPokerForm(n,a,!0);i.rotatePoker(t,e.newHandCards,n)},1200*(5-n))},showPokerForm:function(e,t,a){var n=[];g.pokerCards3[e]&&(n=g.pokerCards3[e]);var i=n.concat(t),o=h.unequally(i),r=g.pokerType[e];return r>this.niuniuPokerType.NIU_NONE&&r<=this.niuniuPokerType.NIU_NIU?(o.splice(3,0,0),a=!1):(o.splice(5,0,0),a=!0),{newHandCards:o,cardPos:a}},rotatePoker:function(e,t,a){for(var o=this,n=function(t,a,n){var e=cc.scaleTo(.25,0,.3),i=cc.scaleTo(.25,.3,.3);t.runAction(cc.sequence(e,i,cc.callFunc(function(){var e=t.getComponent("niuNiuPoker");o.showPokerContent(e,a),o.playCardType(n)},o)))},i=0;i<e.childrenCount;i++){var r=e.children[i];r.active=!0,n(r,t[i],a)}},showPokerContent:function(e,t){null==t?e.initCardInfo(null):0==t?e.clearCardsUI():(e.turnOver(),e.initCardInfo(t))},playCardType:function(e){var t=null;if(g.pokerType&&(t=g.pokerType[e]),this.playSign!=e&&null!=t){var a=cc.find("act"+e,this.pokerTypeNode);a.removeAllChildren();var n=this.otherPokerTypePrefab;n=cc.instantiate(n),t>this.niuniuPokerType.NIU_NONE&&t<=this.niuniuPokerType.NIU_NIU?n.position=cc.p(0,0):n.position=cc.p(-7,0),a.addChild(n),n.getComponent("pokerTypeAnimation").changeMaskBg(t),n.getComponent("pokerTypeAnimation").initFanInfo(t,1),p.instance.playNiuNiuAudio(t,2),n.getComponent("pokerTypeAnimation").pokerTypeAnim(),10<=t&&n.getComponent("pokerTypeAnimation").pokerAnimation(),this.playSign=e}},changeChipsAndScore:function(e){if(e){var t=e.detail,a=t.uid,n=t.idx,i=t.num,o=t.all,r=t.total;this.xingxingAnimation(a,n),this.addChip(i,a,n),this.addClipsNum(a,n,o,r)}},addClipsNum:function(e,t,a,n){var i=0;i=null!=a?ConversionCoinValue(a,2):null;var o=cc.find("chips"+t,this.allCostChips),r=cc.find("chips"+t,this.selfCostChips);e==GameData.player.uid&&(r.getComponent(cc.Label).string=i),o.getComponent(cc.Label).string=ConversionCoinValue(n,2)},clipFlyToTableAnimation:function(e,t){var a=cc.find("area"+t,this.areaNode),n=a.x,i=a.y,o=n-this.randomNum(-75,75),r=i-this.randomNum(-100,20),s=cc.moveTo(.4,cc.p(o,r)),c=cc.scaleTo(.1,.6,.6),d=cc.scaleTo(.1,.4,.4),h=cc.sequence(s,c,d),l=cc.callFunc(function(){e.removeFromParent(!0)},e),u=cc.fadeOut(.1);p.instance.playHundredOther("chouma"),30<this.chipsNode.getChildByName("chips"+t).childrenCount?e.runAction(cc.sequence(h,u,l)).easing(cc.easeCubicActionOut()):e.runAction(h).easing(cc.easeCubicActionOut())},randomNum:function(e,t){var a=t-e,n=Math.random()*a+e;return parseInt(n,10)},addChip:function(e,t,a){var n=e;n=1e6<e?.2*e:e;this.coinArry=[];for(var i=[0,0,0,0,0],o=0;o<i.length;o++)i[o]=this.spliceScore(n)[o];for(o=0;o<i.length;o++)for(var r=0;r<i[o];r++){var s,c=g.getPlayerPosByUid(t),d=cc.instantiate(this.chipPrefab);if(d.scaleX=.4,d.scaleY=.4,-1==c)s=cc.find("tableInfo/otherPlayer",this.node);else if(0==c)switch(this.coinArry[o]){case 50:s=this.toggle0.node;break;case 100:s=this.toggle1.node;break;case 1e3:s=this.toggle2.node;break;case 1e4:s=this.toggle3.node;break;case 2e4:s=this.toggle4.node}else{s=this.playerNodes[c];var h=cc.moveBy(.1,cc.p(-8,0)),l=cc.moveBy(.1,cc.p(8,0));c<=3||5==c?s.runAction(cc.sequence(l,h)):(4==c||6<=c)&&s.runAction(cc.sequence(h,l))}d.parent=this.chipsNode.getChildByName("chips"+a),d.getComponent("hundred_pokerPanel").setChipImg(this.coinArry[o]),d.x=s.x,d.y=s.y,d.active=!0,this.clipFlyToTableAnimation(d,a)}},spliceScore:function(e){var t=[];this.coinArry=[2e4,1e4,1e3,100,50];for(var a=0;a<this.coinArry.length;a++){var n=Math.floor(e/this.coinArry[a]);t.push(n),e-=Math.floor(e/this.coinArry[a])*this.coinArry[a]}return t},xingxingAnimation:function(e,t){var a=cc.find("xing"+t,this.shensuanNode);if(e==g.guideId&&0==a.childrenCount){var n=cc.instantiate(this.guideNodePrefab);a.addChild(n),p.instance.playHundredOther("guide"),n.getComponent("hundred_fortunePanel").playXingAnimation()}},gambleCountTime:function(i){var o=this,e=function e(){g.gameTimes--;var t=cc.find("countTime1",o.countNode);if(o.countNode.active=!0,g.isStartAnimationPlayed?o.countNode.active=!1:o.countNode.active=!0,t.getComponent(cc.Label).string=g.gameTimes,0<g.gameTimes&&g.gameTimes<=3){p.instance.playHundredOther("countDown");var a=cc.scaleTo(.25,1,1),n=cc.scaleTo(.25,.6,.6);o.countNode.runAction(cc.sequence(a,n))}else g.gameTimes<=0&&(o.countNode.active=!1,o.countNode.setScale(.6),o.countNode.active=!1,t.getComponent(cc.Label).string="",g.readyLabelActive=!0,o.unschedule(e),i())};if(g.gameTimes<=0)return o.countNode.setScale(.6),void this.unschedule(e);e(),this.schedule(e,1)},confirmWinnerOrLoser:function(){h.clearArray(this._winnerToLoser.winPos),h.clearArray(this._winnerToLoser.losePos),this._winnerToLoser.winnerList={0:[],1:[],2:[],3:[]};for(var e=g.pokerResult,t=0;t<e.length;t++)e[t]?this._winnerToLoser.losePos.push(t):this._winnerToLoser.winPos.push(t);for(var a=0;a<g.betPosPlayer.length;a++)for(var n=g.betPosPlayer[a],i=0;i<n.length;i++){var o=n[i],r=g.getRoundCoinByUid(o),s=g.containsArray(g.playerInfo,o);0<r&&o!=g.zhuangUid&&(s?this._winnerToLoser.winnerList[a].push(o):o==GameData.player.uid?this._winnerToLoser.winnerList[a].push(o):this._winnerToLoser.winnerList[a].push(-1))}for(t=0;t<Object.keys(this._winnerToLoser.winnerList).length;t++){var c=this._winnerToLoser.winnerList[t];this._winnerToLoser.winnerList[t]=h.unequally(c)}},showChipsFlyAnimation:function(){this.showWinIcon(),this.confirmWinnerOrLoser(),0==this._winnerToLoser.winPos.length?(p.instance.playHundredOther("zhuangWin"),this.showAllWinAnimation("zhuang")):0==this._winnerToLoser.losePos.length&&(p.instance.playHundredOther("zhuangLose"),this.showAllWinAnimation("xian")),0<this._winnerToLoser.losePos.length?this.zhuangWinner():0<this._winnerToLoser.winPos.length&&this.xianWinAction()},zhuangWinner:function(){for(var e=g.getPlayerPosByUid(g.zhuangUid),t=this.playerNodes[e],a=this,n=0;n<this._winnerToLoser.losePos.length;n++)for(var i=this._winnerToLoser.losePos[n],o=this.chipsNode.getChildByName("chips"+i),r=0;r<o.childrenCount;r++){var s=t.x+this.randomNum(-50,50),c=t.y+this.randomNum(-20,50),d=o.children[r];this.resultChipsAnimation(d,cc.p(s,c))}p.instance.playHundredOther("result"),0<this._winnerToLoser.winPos.length?this.scheduleOnce(function(){a.zhuangToAreaAc()},1):this.scheduleOnce(function(){a.moveAboutScore()},1)},xianWinAction:function(){for(var e=this,t=this._winnerToLoser.winPos.length,a=0;a<t;a++){var n=this._winnerToLoser.winPos[a],i=this._winnerToLoser.winnerList[n].length-1;if(0!=this._winnerToLoser.winnerList[n].length)for(var o=0,r=this.chipsNode.getChildByName("chips"+n),s=0;s<r.childrenCount;s++){i<o&&(o=0);var c,d=this._winnerToLoser.winnerList[n][o];if(-1==d)c=cc.find("tableInfo/otherPlayer",this.node);else{var h=g.getPlayerPosByUid(d);c=this.playerNodes[h]}o++;var l=c.x+this.randomNum(-50,50),u=c.y+this.randomNum(-20,50),m=r.children[s];this.resultChipsAnimation(m,cc.p(l,u))}}p.instance.playHundredOther("result"),this.scheduleOnce(function(){e.moveAboutScore()},1)},zhuangToAreaAc:function(){for(var e=this,t=g.getPlayerPosByUid(g.zhuangUid),a=this.playerNodes[t],n=0;n<this._winnerToLoser.winPos.length;n++)for(var i=0;i<this.chipsNum;i++){this.createCoinNode(this._winnerToLoser.winPos[n],i).setPosition(a.getPosition())}for(n=0;n<this._coinList.length;n++){var o=this._coinList[n],r=o.getTag(),s=cc.find("area"+r,this.areaNode),c=s.getPosition().x-this.randomNum(-75,75),d=s.getPosition().y-this.randomNum(-100,20);this.resultChipsAnimation(o,cc.p(c,d))}p.instance.playHundredOther("result"),this.scheduleOnce(function(){e.xianWinAction()},1)},createCoinNode:function(e,t){var a,n=e.toString()+t.toString();if(this.chipsNode.getChildByName("coinNode"+n))a=this.chipsNode.getChildByName("coinNode"+n);else{(a=cc.instantiate(this.chipPrefab)).name="coinNode"+n,a.setTag(e);var i=this.randomNum(0,4),o=this.clipsList[i];a.getComponent("hundred_pokerPanel").setChipImg(o),a.scaleX=.5,a.scaleY=.5,this.chipsNode.addChild(a)}return a.active=!0,this._coinList.push(a),a},resultChipsAnimation:function(e,t){var a=cc.moveTo(.4,t),n=cc.fadeOut(.4),i=cc.callFunc(function(){e.active=!1,e.destroy()},e);e.runAction(cc.sequence(a,n,i)).easing(cc.easeCubicActionOut())},moveAboutScore:function(){for(var t=this,e=this.getPlayerInfoOnDesk(),a=0;a<e.length;a++)if(null!=e[a]){var n=e[a],i=g.getPlayerPosByUid(n.uid),o=n.score,r=this.scoreParent.getChildByName("score"+i),s=r.getChildByName("resultScore");null==s&&(s=cc.instantiate(this.scoreNode),4==i||6<=i?s.getComponent("hundred_runscorePanel").setAnchor(1):s.getComponent("hundred_runscorePanel").setAnchor(0),s.getComponent("hundred_runscorePanel").getScoreColor(o),s.active=!0,r.addChild(s)),0<o&&(this.winnerAnimation(i),n.uid==GameData.player.uid&&p.instance.playHundredOther("winsign"));var c=cc.moveBy(1.5,cc.p(0,60));s.runAction(c)}this.scheduleOnce(function(){for(var e=0;e<t.scoreParent.children.length;e++)t.scoreParent.children[e].removeAllChildren();g.isFlyChipsAndCoin=!1,t.changeCoinNumOnHead(),t.initUI(),g.readyLabelActive=!1},2)},getPlayerInfoOnDesk:function(){for(var e=[],t=i.coinData.coin,a=0;a<t.length;a++){var n=t[a].uid;g.containsArray(g.playerInfo,n)?e.push(t[a]):n==GameData.player.uid&&e.push(t[a])}return e},changeCoinNumOnHead:function(){for(var e=this.getPlayerInfoOnDesk(),t=0;t<this.playerNodes.length;t++){var a=this.playerNodes[t].getChildByName("rightOrLeftPlayerInfo").getComponent("niuNiuPlayerInfo");if(null!=a){var n=g.getPlayerInfoByUid(a.uid);if(null!=n){var i=0,o=n.coin,r=0;if(g.containsArray(e,a.uid))for(var s=0;s<e.length;s++)if(null!=e[s]){var c=e[s];c.uid==a.uid&&(r=c.score)}i=a.uid==GameData.player.uid?o:parseInt(o,10)+parseInt(r,10),a.setGold(i,d.GameType.Game_Niu_Hundred)}}}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",hundredNiuHandler:"hundredNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",pokerAnimationBase:"pokerAnimationBase",roomHandler:"roomHandler"}],"hundredNiu-roomWait":[function(e,t,a){"use strict";cc._RF.push(t,"42322CIdbZGS63ZLBSGAMe8","hundredNiu-roomWait");var c=e("gameDefine"),n=e("roomHandler"),d=e("hundredNiuHandler"),i=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{playerHeads:[cc.Node],twoPlayerPrefab:cc.Prefab,dragonBonesNode:cc.Prefab,lastTimeLabel:cc.Label,readyNode:cc.Node},onLoad:function(){this.headers=new Array,this.handlerMsg(),this.initTabelUI(),this.showPlayers(),this.addDynAnimation()},handlerMsg:function(){registEvent("onPrepareInfo",this,this.beginUI),registEvent("dynChat",this,this.dynChatHandler),registEvent("onJoinerLost",this,this.showPlayers),registEvent("niuhun-onGameInfo",this,this.beginUI),registEvent("onJoinerConnect",this,this.showPlayers),registEvent("onPlayerUpdate",this,this.refreshPlayers),registEvent("niuhun-onGameStart",this,this.showPlayers)},onDestroy:function(){unregistEvent("onPrepareInfo",this,this.beginUI),unregistEvent("dynChat",this,this.dynChatHandler),unregistEvent("onJoinerLost",this,this.showPlayers),unregistEvent("niuhun-onGameInfo",this,this.beginUI),unregistEvent("onJoinerConnect",this,this.showPlayers),unregistEvent("onPlayerUpdate",this,this.refreshPlayers),unregistEvent("niuhun-onGameStart",this,this.showPlayers)},initTabelUI:function(){this.lastTimeLabel.node.active=!1,this.beginUI(),this.showPlayers()},refreshPlayers:function(){d.isFlyChipsAndCoin||this.showPlayers()},showPlayers:function(){this.headers=[],this.initPlayerHeads(),this.showPlayer()},initPlayerHeads:function(){for(var e=0;e<this.playerHeads.length;e++){var t=this.playerHeads[e].getChildByName("rightOrLeftPlayerInfo").getComponent("niuNiuPlayerInfo");t.setName(""),t.setPlayer({}),t.initHeadIcon(),t.setIsOnline(!0),t.showHeadBg(!0),t.setCoinShow(!1),t.HeadBtnIsClick(!1),t.showZhuangNumNode(!1),t.setGold("",c.GameType.Game_Niu_Hundred),1==e||2==e||7==e?t.showZhuang(!0):t.showZhuang(!1)}},showPlayer:function(){this.showSelfInfo(),this.showOtherPlayer()},showSelfInfo:function(){if(null!=GameData.player&&null!=GameData.player){var e=GameData.player;this.showHeadInfo(e,this.playerHeads[0],0)}},showOtherPlayer:function(){if(null!=d.playerInfo&&null!=d.playerInfo)for(var e=d.playerInfo,t=0;t<e.length;t++){var a=e[t];null!=a&&this.showHeadInfo(a,this.playerHeads[t+1],t+1)}},showHeadInfo:function(e,t,a){var n=t.getChildByName("rightOrLeftPlayerInfo"),i=n.getComponent("niuNiuPlayerInfo"),o=d.zhuangUid,r=e.uid==o,s=e.uid==d.zhuangPlayers.uid;r&&0!=a&&e.uid!=d.zhuangPlayers.uid&&(i.lianZhuangNum(5-d.lianzhuangNum),i.showZhuangNumNode(r)),i.HeadBtnIsClick(!0),i.setPlayer(e),i.setName(e.name),i.setHeadIcon(e.headimgurl),i.setLabelNodePos(r,s),i.setGold(e.coin,c.GameType.Game_Niu_Hundred),3<=a&&a<=6||e.uid==d.zhuangPlayers.uid?i.setCoinShow(!1):i.setCoinShow(!0),this.headers.push(n)},beginUI:function(){if(cc.log("===========roomHandler.room.status = "+n.room.status),cc.log("-----------roomHandler.readyCountDown = "+n.readyCountDown),d.status==i.HUNDREDNIUSTATUS.CHIPS)return this.readyNode.active=!1,this.lastTimeLabel.string="",this.lastTimeLabel.node.active=!1,void this.unschedule(this.updateLastTime);0<n.readyCountDown&&(n.room.status==c.RoomState.WAIT?this.readyAnimation():this.beginCountDown())},beginCountDown:function(){cc.log("beginCountDownbeginCountDownbeginCountDownbeginCountDown"),this.lastTimeLabel.string="",this.lastTimeLabel.node.active=!0,this.handleCloseTimer()},handleCloseTimer:function(){cc.log("ready start count: roomHandler.readyCountDown = "+n.readyCountDown),this.updateLastTime(),this.schedule(this.updateLastTime,1)},updateLastTime:function(){n.readyCountDown--,n.readyCountDown<=0||d.readyLabelActive?this.lastTimeLabel.string="":this.lastTimeLabel.string="休息一下："+n.readyCountDown,n.readyCountDown<=0&&(this.lastTimeLabel.string="",this.lastTimeLabel.node.active=!1,this.unschedule(this.updateLastTime))},readyAnimation:function(){this.readyNode.active=!0,cc.find("readyAnim",this.readyNode).getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",0)},getHeadPositionOnUid:function(e){var t;if(cc.log("playerPosition = "+d.getPlayerPosByUid(e)),-1==d.getPlayerPosByUid(e))t=cc.find("tableInfo/otherPlayer",this.node);else{var a=d.getPlayerPosByUid(e);t=this.headers[a].parent}return t.position},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")}}),cc._RF.pop()},{gameDefine:"gameDefine",hundredNiuHandler:"hundredNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],hundredNiuHandler:[function(e,t,a){"use strict";cc._RF.push(t,"93b8aJSy9BKL4ytRVTatl/F","hundredNiuHandler");var i=e("roomHandler"),o=e("niuniuPokerHandler"),r={status:0,gameTimes:0,isStartAnimationPlayed:!1,readyLabelActive:!1,zhuangUid:0,zhuangInfo:{},lianzhuangNum:0,chipsList:[],playerInfo:[],guideId:0,guideInfo:{},pokerCards:[],pokerCards3:[],pokerType:[],pokerResult:[],betPosPlayer:[],isFlyChipsAndCoin:!1,selfChipsNum:{0:0,1:0,2:0,3:0},zhuangPlayers:{uid:0,name:"系统庄",sex:2,headimgurl:"http://47.104.25.227/bots_head/24.png"}};(t.exports=r).initHundredData=function(e){this.status=0,this.gameTimes=0,this.isStartAnimationPlayed=!1,this.readyLabelActive=!1,this.zhuangUid=0,this.zhuangInfo={},this.lianzhuangNum=0,this.chipsList=[],this.playerInfo=[],this.guideId=0,this.guideInfo={},this.pokerCards=[],this.pokerCards3=[],this.pokerType=[],this.pokerResult=[],this.betPosPlayer=[],this.isFlyChipsAndCoin=!1,this.selfChipsNum={0:0,1:0,2:0,3:0}},r.getPlayerPosByUid=function(e){if(e==GameData.player.uid&&e!=this.zhuangUid)return 0;if(!r.containsArray(this.playerInfo,e))return-1;for(var t=0;t<this.playerInfo.length;t++){var a=this.playerInfo[t];if(a&&a.uid==e)return t+1}},r.getRoundCoinByUid=function(e){var t=i.coinData.coin;if(t.length<=0)return null;if(!r.containsArray(t,e))return null;for(var a=0;a<t.length;a++){var n=t[a];if(n&&n.uid==e)return n.score}},r.getPlayerInfoByUid=function(e){if(e==GameData.player.uid)return GameData.player;if(!r.containsArray(this.playerInfo,e))return null;for(var t=0;t<this.playerInfo.length;t++){var a=this.playerInfo[t];if(a&&a.uid==e)return a}},r.containsArray=function(e,t){for(var a=e.length;a--;)if(e[a]&&e[a].uid==t)return!0;return!1},r.getselfChipsSum=function(){var e=0;for(var t in this.selfChipsNum)e+=this.selfChipsNum[t];return e},r.requestSetChips=function(e,t,n){var a={num:e,idx:t};GameNet.getInstance().request("room.niuHundredHandler.setChips",a,function(e){var t=o.ERRORTYPE;if(e&&null!=e.result&&1!=e.result&&e.result!=t.SUCCESSE){var a="";switch(e.result){case t.Niu100_Chips_Zhuang:a="庄家无法下注";break;case t.Niu100_Chips_State:case 1:a="等候下一局下注";break;case t.Niu100_Chips_Continue:a="上一局无下注记录";break;case t.Niu100_Chips_PlayerMax:a="已超过自身下注上限";break;case t.Niu100_Chips_ZhuangMax:a="已超过四门下注上限"}if("已超过自身下注上限"==a&&n)return;niuniuCreateMoveMessage(a)}})},r.requestContinueChips=function(){GameNet.getInstance().request("room.niuHundredHandler.continueChips",{},function(e){var t=o.ERRORTYPE;if(e&&null!=e.result&&e.result!=t.SUCCESSE){var a="";switch(e.result){case t.Niu100_Chips_Zhuang:a="庄家无法下注";break;case t.Niu100_Chips_State:case 1:a="等候下一局下注";break;case t.Niu100_Chips_Continue:a="上一局无下注记录";break;case t.Niu100_Chips_PlayerMax:a="已超过自身下注上限";break;case t.Niu100_Chips_ZhuangMax:a="已超过四门下注上限"}niuniuCreateMoveMessage(a)}})},r.requestAlwaysChips=function(e){GameNet.getInstance().request("room.niuHundredHandler.alwaysChips",function(e){})},r.registMessage=function(){var o=this;GameNet.getInstance().setCallBack("niuhun-onGameStart",function(e){if(o.playerInfo=[],null!=e.zhuang&&(null!=e.zhuang.player?(o.playerInfo.push(e.zhuang.player),o.zhuangUid=e.zhuang.player.uid,o.zhuangInfo=e.zhuang.player,o.lianzhuangNum=e.zhuang.count):(o.playerInfo.push(o.zhuangPlayers),o.zhuangInfo=o.zhuangPlayers,o.zhuangUid=o.zhuangPlayers.uid)),e.players)for(var t=0;t<e.players.length;t++)o.playerInfo.push(e.players[t]);e.guide&&(null!=e.guide.player?o.guideId=e.guide.player.uid:o.guideId=0,o.guideInfo=e.guide,o.playerInfo.push(e.guide.player)),sendEvent("niuhun-onGameStart",e)}),GameNet.getInstance().setCallBack("niuhun-onBaoZhuang",function(e){sendEvent("niuhun-onBaoZhuang")}),GameNet.getInstance().setCallBack("niuhun-onGameEnd",function(e){o.isFlyChipsAndCoin=!0,o.selfChipsNum={0:0,1:0,2:0,3:0},sendEvent("niuhun-onGameEnd",e)}),GameNet.getInstance().setCallBack("niuhun-onGameInfo",function(e){o.status=e.status,o.gameTimes=e.timer,o.chipsList=e.chips,sendEvent("niuhun-onGameInfo",e)}),GameNet.getInstance().setCallBack("niuhun-onCardInfo",function(e){o.pokerType=[],o.pokerCards=[],o.pokerCards3=[],o.pokerResult=[],o.betPosPlayer=[],o.pokerType.push(e.zhuang.type),o.pokerCards.push(e.zhuang.cards),o.pokerCards3.push(e.zhuang.card3);for(var t=0;t<e.xian.length;t++)o.pokerType.push(e.xian[t].type),o.pokerCards.push(e.xian[t].cards),o.pokerCards3.push(e.xian[t].card3);o.pokerResult=e.result,o.betPosPlayer=e.xianChips,sendEvent("niuhun-onCardInfo",e)}),GameNet.getInstance().setCallBack("niuhun-onGameChips",function(e){var t=e.idx,a=e.all,n=(e.total,e.uid);for(var i in o.selfChipsNum)i==t&&n==GameData.player.uid&&(o.selfChipsNum[i]=a);sendEvent("niuhun-onGameChips",e)}),GameNet.getInstance().setCallBack("niuhun-onChipsInfo",function(e){}),GameNet.getInstance().setCallBack("niuhun-onZhuangCoin",function(e){sendEvent("niuhun-onZhuangCoin",e)})},cc._RF.pop()},{niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],hundred_backPanel:[function(e,t,a){"use strict";cc._RF.push(t,"87abfEEw19BabmdmJlYYyIw","hundred_backPanel");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{tipsSp:cc.Sprite},onLoad:function(){},showBackUI:function(e){var t="";"zhuang"==e?t=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/backHome/bg_zaiwanyihui_wenzi2.png")):"xian"==e&&(t=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/backHome/bg_zaiwanyihui_wenzi3.png"))),this.tipsSp.spriteFrame=new cc.SpriteFrame(t)},quitRoom:function(){n.quitRoom(n.room.id)},closePanel:function(){closeView(this.node.name)}}),cc._RF.pop()},{roomHandler:"roomHandler"}],hundred_dealerPanel:[function(e,t,a){"use strict";cc._RF.push(t,"dbb8b38+lZJPpG7qG2qwnQH","hundred_dealerPanel");var n=e("gameDefine"),i=e("roomHandler"),o=(e("hundredNiuHandler"),e("niuniuPokerHandler"));cc.Class({extends:cc.Component,properties:{dealerNode:cc.Node,contentNode:cc.Node,playerInfo:cc.Node,lineUpNum:cc.Label,scrollView:cc.ScrollView,upZhuangCdtion:cc.Label,costPanel:cc.Node},onLoad:function(){},showUI:function(e){this.initUI(),e&&(this.setLineUpNum(e),this.setUpCondition(),this.showHeadInfo(e))},initUI:function(){this.lineUpNum.string="",this.dealerNode.active=!0,this.costPanel.active=!1,this.upZhuangCdtion.string="",this.contentNode.removeAllChildren()},showHeadInfo:function(e){for(var t=0;t<e.length;t++){var a=this.contentNode.getChildByName("player"+t);null==a&&((a=cc.instantiate(this.playerInfo)).y=-51-t*this.playerInfo.height,this.contentNode.height=(t+1)*this.playerInfo.height,a.parent=this.contentNode,a.name="player"+t);var n=cc.find("num",a),i=cc.find("numLb",a),o=cc.find("coin",a),r=cc.find("name",a),s=cc.find("headMask/headIcon",a);null!=e[t].name&&this.setName(r,e[t].name),null!=e[t].headimgurl&&this.setHeadIcon(s,e[t].headimgurl),null!=e[t].coin&&(o.getComponent("cc.Label").string=ConversionCoinValue(e[t].coin,0)),this.showSign(n,i,t)}},setName:function(e,t){e.getComponent("cc.Label").string=getShortStr(t,4)},setHeadIcon:function(a,e){if(null==e||""==e||e.length<=0)a.getComponent("cc.Sprite").spriteFrame=null;else{cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))})}},showSign:function(e,t,a){if(a<=2){var n=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/shangzhuang/jp_"+a+".png"));e.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),e.active=!0,t.active=!1}else t.getComponent("cc.Label").string=a+1,t.active=!0,e.active=!1},setLineUpNum:function(e){this.lineUpNum.string="当前排队"+e.length+"人"},setUpCondition:function(){var e=i.room.opts.scorelv,t=getMatchShangZhuangFinal(n.GameType.Game_Niu_Hundred,e);this.upZhuangCdtion.string="上庄条件："+ConversionCoinValue(t,0)},clickUpZhuang:function(){var n=this;GameNet.getInstance().request("room.niuHundredHandler.upZhuang",{},function(e){switch(e.result){case o.ERRORTYPE.SUCCESSE:n.showUI(e.zhuanglist);var t=n.getSelfPosition(e.zhuanglist),a=n.contentNode.getChildByName("player"+t);n.scrollView.scrollToOffset(cc.p(0,-a.y),.1),cc.log("is upZhuangCdtion");break;case o.ERRORTYPE.Niu100_Zhuang_Coin:n.costPanel.active=!0,n.dealerNode.active=!1;break;case o.ERRORTYPE.Niu100_Zhuang_Already:niuniuCreateMoveMessage("您已在队列中");break;case o.ERRORTYPE.Niu100_Zhuang_UpAlready:niuniuCreateMoveMessage("您已上庄");break;default:cc.log("error")}})},getSelfPosition:function(e){for(var t=e.length;t--;)if(e[t]&&e[t].uid==GameData.player.uid)return t;return 0},clickGoingShop:function(){var t=this;openView("shoppingPanel",void 0,function(e){t.close(),e.getComponent("shoppingPanel").showPanel(2)})},close:function(){closeView(this.node.name)}}),cc._RF.pop()},{gameDefine:"gameDefine",hundredNiuHandler:"hundredNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],hundred_fortunePanel:[function(e,t,a){"use strict";cc._RF.push(t,"82d1d49tBxFI4nVnGT4/RAy","hundred_fortunePanel"),cc.Class({extends:cc.Component,properties:{xingSp:cc.Node,xingAnim:cc.Node},onLoad:function(){this.xingSp.active=!1,this.xingAnim.active=!1},playXingAnimation:function(){this.xingAnim.active=!0,this.xingAnim.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);var e=this;this.scheduleOnce(function(){e.xingAnim.active=!1,e.xingSp.active=!0},1.5)},cliskShowTips:function(){niuniuCreateMoveMessage("神算子已在该区域下注")}}),cc._RF.pop()},{}],hundred_pokerPanel:[function(e,t,a){"use strict";cc._RF.push(t,"c29e7cP8TxBuLyZZu8eoWnH","hundred_pokerPanel"),cc.Class({extends:cc.Component,properties:{chipSp:cc.Sprite},onLoad:function(){},setChipImg:function(e){if(e){var t="resources/hundredNiuNiu/uiResources/table/chips/x_"+e+".png",a=cc.textureCache.addImage(cc.url.raw(t));this.chipSp.spriteFrame=new cc.SpriteFrame(a)}}}),cc._RF.pop()},{}],hundred_rulePanel:[function(e,t,a){"use strict";cc._RF.push(t,"3d73fH39KVODLcO5MPjDJp3","hundred_rulePanel"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){},close:function(){closeView(this.node.name)}}),cc._RF.pop()},{}],hundred_runscorePanel:[function(e,t,a){"use strict";cc._RF.push(t,"3c47fNbiqNNuIIfydDFvIMH","hundred_runscorePanel"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,fonts:[cc.Font]},onLoad:function(){},getScoreColor:function(e){0<(this.scoreLabel.string=e)?(this.scoreLabel.string="+"+e,this.scoreLabel.font=this.fonts[0]):e<0?(this.scoreLabel.string=e,this.scoreLabel.font=this.fonts[1]):0==e&&(this.scoreLabel.string=e,this.scoreLabel.font=this.fonts[2])},setAnchor:function(e){this.scoreLabel.node.anchorX=e}}),cc._RF.pop()},{}],hundred_sankePanel:[function(e,t,a){"use strict";cc._RF.push(t,"8bc9eHlWs5LoaokI3KypRC6","hundred_sankePanel");var p=e("hundredNiuHandler"),g=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{contentNode:cc.Node,playerInfo:cc.Node},onLoad:function(){},showUI:function(e){this.initUI(),e&&this.showList(e)},initUI:function(){this.contentNode.removeAllChildren()},showList:function(e){var t=e.players,a=e.winNums,n=p.guideInfo;if(null!=n.player)for(var i=n.player.uid,o=0;o<t.length;o++){(s=t[o]).uid==i&&(t=g.itemtoArraytop(t,o),a=g.itemtoArraytop(a,o))}for(var r=0;r<t.length;r++){var s=t[r],c=this.contentNode.getChildByName("player"+r);null==c&&((c=cc.instantiate(this.playerInfo)).y=-48-r*this.playerInfo.height,this.contentNode.height=(r+1)*this.playerInfo.height,c.parent=this.contentNode,c.name="player"+r);var d=cc.find("bg/signSp",c),h=cc.find("bg/signLb",c),l=cc.find("headNode/headMask/headIcon",c),u=cc.find("headNode/name",c),m=cc.find("headNode/coin",c);null!=s.name&&this.setName(u,s.name),null!=s.headimgurl&&this.setHeadIcon(l,s.headimgurl),null!=s.coin&&(m.getComponent("cc.Label").string=ConversionCoinValue(s.coin,0)),this.showSignSp(d,r),this.showSignLb(h,r),this.showWinAndChips(c,a[r])}},setName:function(e,t){e.getComponent("cc.Label").string=getShortStr(t,4)},setHeadIcon:function(a,e){if(null==e||""==e||e.length<=0)a.getComponent("cc.Sprite").spriteFrame=null;else{cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))})}},showSignSp:function(e,t){var a="";if(null!=p.guideInfo.player){if(0==t)a=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/xian/shensuanzi.png"));else if(1==t)a=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/xian/dafuhao.png"));else if(1<t)return void(e.active=!1)}else if(0==t)a=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/xian/dafuhao.png"));else if(1<=t)return void(e.active=!1);e.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(a),e.active=!0},showSignLb:function(e,t){null!=p.guideInfo.player&&t<=1||null==p.guideInfo.player&&t<1?e.active=!1:(null!=p.guideInfo.player?e.getComponent("cc.Label").string=t:e.getComponent("cc.Label").string=t+1,e.active=!0)},showWinAndChips:function(e,t){cc.find("winNode/winNum",e).getComponent("cc.Label").string=t},close:function(){closeView(this.node.name)}}),cc._RF.pop()},{hundredNiuHandler:"hundredNiuHandler",niuniuPokerHandler:"niuniuPokerHandler"}],hundred_trendPanel:[function(e,t,a){"use strict";cc._RF.push(t,"417d4IgrOBA9a6GAtsy27RG","hundred_trendPanel"),cc.Class({extends:cc.Component,properties:{contentNode:cc.Node,playerInfo:cc.Node},onLoad:function(){},showUI:function(e){this.initUI(),e&&this.showList(e)},initUI:function(){this.contentNode.removeAllChildren()},showList:function(e){for(var t=e.length-1;0<=t;t--){var a=e.length-(t+1),n=this.contentNode.getChildByName("list"+a);null==n&&((n=cc.instantiate(this.playerInfo)).y=-22-a*this.playerInfo.height,this.contentNode.height=(a+1)*this.playerInfo.height,n.parent=this.contentNode,n.name="list"+a);for(var i=e[t],o=0;o<n.childrenCount;o++){var r=n.children[o],s=i[o];this.setResultIcon(r,s)}}},setResultIcon:function(e,t){var a;a=t?cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/zoushi/bai.png")):cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/panelUI/zoushi/sheng.png")),e.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(a)},close:function(){closeView(this.node.name)}}),cc._RF.pop()},{}],joinControl:[function(e,t,a){"use strict";cc._RF.push(t,"638fezSDt9JXZMp8H88cXbB","joinControl");var n=e("SoundMngr"),i=e("roomHandler");e("matchHandler"),e("gameDefine"),e("configMgr");cc.Class({extends:cc.Component,properties:{layer_join:cc.Node,room_number:cc.String},onLoad:function(){this.resetNumber()},onEnable:function(){},onDestroy:function(){},loadSpriteImg:function(e,t){if(!(null==e||null==t||t.length<=0)){var a=cc.textureCache.addImage(cc.url.raw(t));a&&(e.spriteFrame=new cc.SpriteFrame(a))}},enterNumber:function(e,t){n.instance.playAudioOther("button"),this.room_number.length<6&&(this.room_number+=t,this.showNumber(),6<=this.room_number.length&&i.enterRoom(this.room_number))},deleteNumber:function(e){n.instance.playAudioOther("button"),this.room_number=this.room_number.substring(0,this.room_number.length-1),this.showNumber()},resetNumber:function(e){e&&n.instance.playAudioOther("button"),this.room_number="",this.showNumber()},showNumber:function(){for(var e=1;e<=this.room_number.length;e++){var t=this.room_number.substr(e-1,1),a=cc.find("panel/enter_number/room_number/number"+e,this.layer_join);a.getComponent("cc.Label").string=t,a.active=!0}for(e=6;e>this.room_number.length;e--){cc.find("panel/enter_number/room_number/number"+e,this.layer_join).active=!1}},enterRoom:function(e){n.instance.playAudioOther("button"),""!==this.room_number&&i.enterRoom(this.room_number)},backToHome:function(e){n.instance.playAudioOther("button"),this.layer_join.active=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",matchHandler:"matchHandler",roomHandler:"roomHandler"}],joinclubPanel:[function(e,t,a){"use strict";cc._RF.push(t,"6c780x9SZJCS7Fs4ZvlcELc","joinclubPanel");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{joinClubEditBox:cc.EditBox},onLoad:function(){},onDestroy:function(){},joinClubClick:function(){n.instance.playAudioOther("button");var e=this.joinClubEditBox.getComponent(cc.EditBox).string;ClubHandler.getInstance().reqJoinClub(e)},close:function(){n.instance.playAudioOther("button"),closeView("joinclubIDPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],locationView:[function(e,t,a){"use strict";cc._RF.push(t,"558b3uUt/JCxZ+omzMWAqSA","locationView"),cc._RF.pop()},{}],loginHandler:[function(require,module,exports){"use strict";cc._RF.push(module,"8db04S6iu1P25FUEdEhAa35","loginHandler");var configMgr=require("configMgr"),errorCode=require("errorCode"),configMgr=require("configMgr"),updateHandler=require("updateHandler"),STATUS={DISCONNECT:0,CONNECTING:1,CONNECTED:2},login={status:STATUS.DISCONNECT};module.exports=login,login.loginBtn=function(e){try{if(this.status!=STATUS.DISCONNECT)return;if(openView("Loading"),!cc.sys.isNative)return void this.onWebLogin(e);if(this.loginByLocalData())return;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","wx_login","()V"):cc.sys.OS_IOS==cc.sys.os?jsb.reflection.callStaticMethod("AppController","wx_login"):this.onSimulatorLogin()}catch(e){WriteLog("loginHandler.loginBtn throw error:"+JSON.stringify(e))}},login.loginByLocalData=function(){if(!cc.sys.isNative)return!1;var localData=cc.sys.localStorage.getItem("loginData");if(!localData)return!1;var Data=eval("("+localData+")");return this.connect(Data),!0},login.onWebLogin=function(e){var t=e||"Web-"+(new Date).getTime();cc.sys.localStorage.setItem("testName",t);var a={account:t,nickname:t,sex:Math.floor(2*Math.random()+1),app:{appid:"com.mahjong.tianjin",os:"web"}};this.connect(a)},login.onSimulatorLogin=function(){var e=cc.sys.localStorage.getItem("account")||"Simulator-"+(new Date).getTime(),t={account:e,nickname:e,app:{appid:"com.mahjong.tianjin",os:"simulator"}};this.connect(t)},login.login=function(t){t.version=updateHandler.getVersion(),GameNet.getInstance().request("connector.entryHandler.login",t,function(e){if(e.result==errorCode.Success)cc.sys.localStorage.setItem("loginData",JSON.stringify(t)),GameData.player=e.pinfo,loginYunwa(GameData.player.uid.toString(),GameData.player.name),void 0===GameData.player.roomid||GameData.player.roomid<=0?(cc.director.loadScene("home"),closeView("Loading")):GameNet.getInstance().request("room.roomHandler.enterRoom",{roomid:GameData.player.roomid,posInfo:getPosInfo()},function(e){e.result!=errorCode.Success&&(GameData.player.roomid=void 0,cc.director.loadScene("home"),closeView("Loading"))});else{if(e.result==errorCode.accountHasSeal)return void createMessageBox("帐号已封停,无法登录！",function(){closeView("Loading")});if(e.result==errorCode.codeVersionError)return void createMessageBox("请更新至最新版本,体验更优质的游戏内容.",function(){closeView("Loading")});if(e.result==errorCode.packetVersionError)return void createMessageBox("请下载最新的安装包,更多精彩值得期待.",function(){closeView("Loading")});WriteLog("login error "+JSON.stringify(e)),GameData.restart()}})},login.logout=function(e){cc.sys.localStorage.removeItem("loginData"),cc.game.end()},login.connect=function(e){var t=this;this.status=STATUS.CONNECTING,GameNet.getInstance().connect(configMgr.getIP(),configMgr.getPort(),function(){WriteLog("connect suc..."),t.status=STATUS.CONNECTED,t.login(e)},function(){WriteLog("connect failed..."),t.status=STATUS.DISCONNECT,createMessageBox("网络断开，请重新连接",function(){GameData.autoLogin=!0,WriteLog("点击重连..."),cc.director.loadScene("login")})})},login.OnWXLogin=function(wxinfo){var userinfo=eval("("+wxinfo+")");if(null!=userinfo.unionid){userinfo.nickname=emoji2Str(userinfo.nickname);var self=this;GameData.client.sex=userinfo.sex,GameData.client.nickname=userinfo.nickname,GameData.client.headurl=userinfo.headimgurl;var loginData={account:"wx_"+userinfo.unionid,openid:userinfo.openid,nickname:userinfo.nickname,sex:userinfo.sex,headimgurl:userinfo.headimgurl,app:{appid:"com.mahjong.tianjin",os:cc.sys.os,area:configMgr.getAreaType()}};self.connect(loginData)}},login.OnWXFailed=function(){},cc._RF.pop()},{configMgr:"configMgr",errorCode:"errorCode",updateHandler:"updateHandler"}],login:[function(e,t,a){"use strict";cc._RF.push(t,"57cf4uTldVG94VmXKfa9Rof","login");var n=e("configMgr"),i=e("SoundMngr"),o=(e("ruleHandler"),e("roomHandler")),r=e("matchHandler"),s=e("loginHandler"),c=e("updateHandler"),d=e("TuiDaoHu-Protocol"),h=e("tdkRoomData"),l=e("ZJH-RoomData"),u=e("niuNiuHandler"),m=e("hundredNiuHandler"),p=e("competitionHandler");cc.Class({extends:cc.Component,properties:{manifestUrl:cc.RawAsset,versionfile:cc.RawAsset,toggle_agree:cc.Toggle,label_version:cc.Label,login_panel:cc.Node,update_panel:cc.Node,update_progress:cc.ProgressBar,uidInputBox:cc.EditBox,updateText:cc.Label,gengxinStr:cc.Label,huaNode:cc.Node,loginImage:cc.Node,wenAn:cc.Node},onLoad:function(){n.init(),registEvent("updateStart",this,this.showUpdatePanel),registEvent("updateProgress",this,this.showUpdateProgress),registEvent("updateFinish",this,this.showLoginPanel),registEvent("updateError",this,this.showUpdateError),this.uidInputBox.node.active=!cc.sys.isNative,cc.sys.os==cc.sys.OS_WINDOWS&&(this.uidInputBox.node.active=!0),this.login_panel.active=!1,h.unregistAllMessage(),o.registMessage(),r.registMessage(),h.registMessage(),l.registMessage(),p.registMessage(),u.registMessage(),m.registMessage(),GameData.init(),GameData13.init(),GameDataPDK.init(),GameDataTJDDZ.init(),profileNiuNiu.init(),d.registMessage(),c.checkUpdate(this.manifestUrl),p.getActivityList(),this.label_version.string="版本号:"+c.getVersion(),this.flag_init_x=this.huaNode.x,this.setLoginWenAn(),this.setLoginImage()},onEnable:function(){i.instance.stopAll(),i.instance.playMusic("sound/wait")},onDestroy:function(){unregistEvent("updateStart",this,this.showUpdatePanel),unregistEvent("updateProgress",this,this.showUpdateProgress),unregistEvent("updateFinish",this,this.showLoginPanel),unregistEvent("updateError",this,this.showUpdateError)},showLoginPanel:function(){this.login_panel.active=!0,this.update_panel.active=!1,s.loginByLocalData()},showUpdatePanel:function(){this.login_panel.active=!1,this.update_panel.active=!0,this.showUpdateProgress({detail:0})},showUpdateProgress:function(e){if(null!=e){this.gengxinStr.node.active=!0,this.update_progress.node.active=!0,this.huaNode.active=!0;var t=100*e.detail;100<(t=parseInt(t))||(this.updateText.string="正在更新资源",this.gengxinStr.string=t+"%",this.update_progress.progress=e.detail,this.huaNode.x=this.flag_init_x+this.update_progress.totalLength*this.update_progress.progress)}},showUpdateError:function(e){createMessageBox(e.detail,function(){c.retry()})},loginBtnCliecked:function(e){i.instance.playAudioOther("button");var t=this.uidInputBox.string;s.loginBtn(t)},setLoginImage:function(){var e=n.getLogo(),t=cc.textureCache.addImage(cc.url.raw(e));t&&this.loginImage&&(this.loginImage.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))},setLoginWenAn:function(){var e=cc.find("label1",this.wenAn),t=cc.find("label2",this.wenAn);e.getComponent(cc.Label).string=n.getNotice(),t.getComponent(cc.Label).string=n.getVersionText()},showAgreePanel:function(){i.instance.playAudioOther("button"),openView("AgreePanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr","TuiDaoHu-Protocol":"TuiDaoHu-Protocol","ZJH-RoomData":"ZJH-RoomData",competitionHandler:"competitionHandler",configMgr:"configMgr",hundredNiuHandler:"hundredNiuHandler",loginHandler:"loginHandler",matchHandler:"matchHandler",niuNiuHandler:"niuNiuHandler",roomHandler:"roomHandler",ruleHandler:"ruleHandler",tdkRoomData:"tdkRoomData",updateHandler:"updateHandler"}],mahjong_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"f8c42vxgMtJ/aKotXFHiDzy","mahjong_changchun");var n=e("mahjong"),i=function(){n.call(this)};e("utils").inherits(i,n),(t.exports=i).prototype.canChi=function(e,t){var a=[],n=GameData.getMyHandCards();n.sort();for(var i=[n[0]],o=1;o<n.length;o++)n[o]!==i[i.length-1]&&i.push(n[o]);var r=t-2,s=t-1,c=t-0+1,d=t-0+2;for(o=0;o<i.length;o++)if(r==i[o])for(var h=0;h<i.length;h++)if(s==i[h]){a.push([r,s]);break}for(o=0;o<i.length;o++)if(s==i[o])for(h=0;h<i.length;h++)if(c==i[h]){a.push([s,c]);break}for(o=0;o<i.length;o++)if(c==i[o])for(h=0;h<i.length;h++)if(d==i[h]){a.push([c,d]);break}return a},i.prototype.canDianPao=function(e,t){},i.prototype.isHuier=function(e){return GameData.game.cardHuier1==e},i.prototype.canHu=function(e,t,a){return n.prototype.canHu.call(this,e,t,a)},i.prototype.getGangCardsByType=function(e){},cc._RF.pop()},{mahjong:"mahjong",utils:"utils"}],mahjong_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"b1c2bDdow1Eur+9AHSrUWGw","mahjong_huadian");var n=e("mahjong"),i=e("utils"),l=2,u=3,m=4,p=5,g=6,f=7,y=8,v=9,C=10,D=11,o=12,r=13,_=14,s=function(){n.call(this)};i.inherits(s,n),(t.exports=s).prototype.canChi=function(e,t){var a=[],n=GameData.getMyHandCards();n.sort();for(var i=[n[0]],o=1;o<n.length;o++)n[o]!==i[i.length-1]&&i.push(n[o]);var r=t-2,s=t-1,c=t-0+1,d=t-0+2;for(o=0;o<i.length;o++)if(r==i[o])for(var h=0;h<i.length;h++)if(s==i[h]){a.push([r,s]);break}for(o=0;o<i.length;o++)if(s==i[o])for(h=0;h<i.length;h++)if(c==i[h]){a.push([s,c]);break}for(o=0;o<i.length;o++)if(c==i[o])for(h=0;h<i.length;h++)if(d==i[h]){a.push([c,d]);break}return a},s.prototype.canDianPao=function(e,t){return!1},s.prototype.isHuier=function(e){return GameData.game.cardHuier1==e||GameData.game.cardHuier2==e},s.prototype.canHu=function(e,t,a){return!GameData.player.isXiangGong&&n.prototype.canHu.call(this,e,t,a)},s.prototype.getHuType=function(e,t,a,n){for(var i=0,o=[],r=e.length;i<r;i++){o[i]=[];var s=e[i];n&&(this.isGangkaihua()&&o[i].push(C),this.isTianhu()?o[i].push(y):this.isDihu()&&o[i].push(v)),this.isSuBenLong(s,GameData.game.cardHuier1)?(o[i].push(D),this.isZhuowu(s,a)&&o[i].push(p)):this.isBenLong(s,GameData.game.cardHuier1)?(o[i].push(f),this.isHundiao(s,a)?o[i].push(u):(this.isDHundiao(s,a,!0)&&o[i].push(m),this.isZhuowu(s,a)&&o[i].push(p))):this.isLong(s,GameData.game.cardHuier1)?(o[i].push(g),this.isSupai(s)?o[i].push(l):this.isHundiao(s,a)?o[i].push(u):(this.isDHundiao(s,a,!0)&&o[i].push(m),this.isZhuowu(s,a)&&o[i].push(p))):this.isZhuowu(s,a)?(o[i].push(p),this.isSupai(s)?o[i].push(l):this.isDHundiao(s,a,!1)&&o[i].push(m)):this.isSupai(s)?o[i].push(l):this.isHundiao(s,a)?o[i].push(u):this.isDHundiao(s,a,!1)&&o[i].push(m)}s=[];this.isJinGang(t,s)&&(o[i]=[],o[i].push(_),e[i]=s,this.isGangkaihua()&&o[i].push(C),this.isTianhu()?o[i].push(y):this.isDihu()&&o[i].push(v));var c=-1,d=0;for(i=0;i<o.length;i++)if(GameData.room.opts.hd||1!=o[i].length||o[i][0]!=u&&o[i][0]!=m){var h=this.calcHuScore(o[i]);d<h&&(c=i,d=h)}return[o[c],e[c],a,d]},s.prototype.calcHuScore=function(e){if(e.length<=0)return 0;for(var t=1,a=0,n=0;n<e.length;n++)switch(e[n]){case l:case u:case m:case C:t*=2;break;case p:a+=3;break;case g:a+=4;break;case f:a+=8;break;case y:t*=8;break;case v:t*=4;break;case D:a+=4,t*=4;break;case _:a+=GameData.createRoomOpts.jGangScore}return(t=t||1)*(a=a||1)},s.prototype.getHuTypeString=function(){for(var e="",t=!1,a=GameData.game.winnerType.length,n=0;n<a;n++)switch(GameData.game.winnerType[n]){case y:e+="天胡 *8   ";break;case v:e+="地胡 *4   ";break;case l:e+="没混 *2   ";break;case u:e+="混吊 *2   ";break;case m:e+=1<a?"双混吊 *2   ":"混吊 *2   ";break;case C:e+="杠开花 *2   ";break;case p:e+="捉五 +3   ";break;case g:e+="一条龙 +4   ";break;case f:e+="本混龙 +4 *2 ";break;case o:t=!0;break;case r:e+="拉五龙   ";break;case D:e+="素本龙 +4 *4   ";break;case _:4==GameData.room.opts.jingang?e+="金杠胡 +4   ":8==GameData.room.opts.jingang&&(e+="金杠胡 +8   ")}return t&&(e+=" 铲牌 -1"),e},s.prototype.isSupai=function(e){for(var t=0;t<e.length;t++)if(this.isHuier(e[t]))return!1;return!0},s.prototype.isHundiao=function(e,t){return!!this.isHuier(e[1])&&(!this.isHuier(t)&&t==e[0]||!(!this.isHuier(t)||!this.isHuier(e[0])))},s.prototype.isDHundiao=function(e,t,a){var n=e.concat();if(a)for(var i=0;i<3&&!this.checkLong(n,10*i);i++);for(var o=2;o<n.length;o+=3)if(!(n[o]<=0))if(this.isHuier(t)){if(this.isHuier(n[o])&&this.isHuier(n[o+1])&&this.isHuier(n[o+2]))return!0}else{if(t==n[o]&&this.isHuier(n[o+1])&&this.isHuier(n[o+2]))return!0;if(t==n[o+1]&&this.isHuier(n[o])&&this.isHuier(n[o+2]))return!0;if(t==n[o+2]&&this.isHuier(n[o])&&this.isHuier(n[o+1]))return!0}return!1},s.prototype.isZhuowu=function(e,t){if(this.isHuier(t))for(var a=2;a<e.length;a+=3){if(14==e[a]&&this.isHuier(e[a+1])&&16==e[a+2])return!0;if(14==e[a]&&this.isHuier(e[a+1])&&this.isHuier(e[a+2]))return!0;if(16==e[a]&&this.isHuier(e[a+1])&&this.isHuier(e[a+2]))return!0;if(this.isHuier(e[a])&&this.isHuier(e[a+1])&&this.isHuier(e[a+2]))return!0}else if(15==t)for(a=2;a<e.length;a+=3){if(14==e[a]&&15==e[a+1]&&16==e[a+2])return!0;if(14==e[a]&&15==e[a+1]&&this.isHuier(e[a+2]))return!0;if(15==e[a]&&16==e[a+1]&&this.isHuier(e[a+2]))return!0;if(15==e[a]&&this.isHuier(e[a+1])&&this.isHuier(e[a+2]))return!0}return!1},s.prototype.checkLong=function(e,t){return!!this.matchGroup(e,[t+1,t+2,t+3])&&(!!this.matchGroup(e,[t+4,t+5,t+6])&&!!this.matchGroup(e,[t+7,t+8,t+9]))},s.prototype.isLong=function(e){for(var t=0;t<3;t++){var a=10*t,n=e.concat();if(this.checkLong(n,a))return!0}return!1},s.prototype.isBenLong=function(e,t){var a=parseInt(t/10);if(3<=a)return!1;var n=10*a,i=e.concat();return this.checkLong(i,n)},s.prototype.isSuBenLong=function(e,t){var a=parseInt(t/10);if(3<=a)return!1;for(var n=e.concat(),i=0,o=0,r=0;r<n.length;r++)if(this.isHuier(n[r])){if(2<++i)return!1;if(o==n[r])return!1;o=n[r]}if(2!=i)return!1;var s=10*a;return this.checkLong(n,s)},s.prototype.isGangkaihua=function(){return 1==GameData.game.gangOver},s.prototype.isTianhu=function(){return GameData.game.noActions&&GameData.player.uid==GameData.game.zhuangUid&&0==GameData.game.discard},s.prototype.isDihu=function(){return GameData.game.noActions&&GameData.player.uid!=GameData.game.zhuangUid&&0==GameData.game.discard},s.prototype.isJinGang=function(e,t){var a=e[GameData.game.cardHuier1],n=e[GameData.game.cardHuier2];if(4!=a&&4!=n)return!1;for(var i in e)for(var o=0;o<e[i];o++)t.push(i);return!0},cc._RF.pop()},{mahjong:"mahjong",utils:"utils"}],mahjong_hz:[function(e,t,a){"use strict";cc._RF.push(t,"927b4oQEShCsrXAFWybULtX","mahjong_hz");var n=e("mahjong"),i=e("utils"),c=e("hongzhongData"),o=function(){n.call(this)};i.inherits(o,n),(t.exports=o).prototype.getCardNumber=function(e,t){var a=0;if(null==e||t<=0)return a;for(var n=0;n<e.length;n++)e[n]==t&&a++;return a},o.prototype.isHuier=function(e){var t=c.getGameInfoData();if(t&&t.wildcard)for(var a=0;a<t.wildcard.length;a++)if(e==t.wildcard[a])return!0;return!1},o.prototype.canChi=function(e,t){var a=[],n=c.getHandCards(e);if(null==n||t<=0)return a;var i=t-2,o=t-1,r=t-0+1,s=t-0+2;return!this.isHuier(i)&&!this.isHuier(o)&&0<this.getCardNumber(n,i)&&0<this.getCardNumber(n,o)&&a.push([i,o]),!this.isHuier(o)&&!this.isHuier(r)&&0<this.getCardNumber(n,o)&&0<this.getCardNumber(n,r)&&a.push([o,r]),!this.isHuier(r)&&!this.isHuier(s)&&0<this.getCardNumber(n,r)&&0<this.getCardNumber(n,s)&&a.push([r,s]),cc.log("....chi:"+JSON.stringify(a)),a},o.prototype.canAnGang=function(e){var t=[],a=c.getHandCards(e);if(null==a)return t;for(var n=0;n<a.length;n++){var i=a[n];if(!(null==i||i<=0))if(4<=this.getCardNumber(a,i)){if(0<this.getCardNumber(t,i))continue;t.push(i)}}return cc.log("....anGang:"+JSON.stringify(t)),t},o.prototype.canBuGang=function(e){var t=[],a=c.getHandCards(e),n=c.getPengCards(e);if(null==n||null==a)return t;for(var i=0;i<n.length;i++){var o=n[i];if(!(null==o||Object.keys(o).length<=0)){var r=o.cards;if(!(null==r||r.length<=0)){var s=r[0];1<=this.getCardNumber(a,s)&&t.push(s)}}}return cc.log("....buGang:"+JSON.stringify(t)),t},cc._RF.pop()},{hongzhongData:"hongzhongData",mahjong:"mahjong",utils:"utils"}],mahjong_shishi:[function(e,t,a){"use strict";cc._RF.push(t,"5a6c9ehY5lBvKgLCS2MbK20","mahjong_shishi");var i=e("mahjong"),n=e("utils"),o=0,h=1,l=2,u=3,r=4,s=5,c=6,d=7,m=function(){i.call(this)};n.inherits(m,i),(t.exports=m).prototype.isHuier=function(e){return GameData.game.cardHuier1==e},m.prototype.canChi=function(e,t){for(var a in GameData.cards){if(0<GameData.cards[a].youNum)return!1}return i.prototype.canChi.call(this,e,t)},m.prototype.canPeng=function(e,t){for(var a in GameData.cards){if(0<GameData.cards[a].youNum)return!1}return i.prototype.canPeng.call(this,e,t)},m.prototype.canAnGang=function(e){if(0==GameData.game.cardleft)return 0;if(e!=GameData.player.uid)return 0;for(var t in GameData.cards){var a=GameData.cards[t].youNum;if(3==a||10==a)return!1}return i.prototype.canAnGang.call(this,e)},m.prototype.canMingGang=function(e,t){if(1==this.isHuier(t))return 0;if(0==GameData.game.cardleft)return 0;for(var a in GameData.cards){var n=GameData.cards[a].youNum;if(3==n||10==n)return!1}return i.prototype.canMingGang.call(this,e,t)},m.prototype.canMingGangSelf=function(){if(0==GameData.game.cardleft)return 0;for(var e in GameData.cards){var t=GameData.cards[e].youNum;if(3==t||10==t)return!1}return i.prototype.canMingGangSelf.call(this)},m.prototype.canDianPao=function(e,t){if(0<GameData.cards[GameData.player.uid].youNum)return!1;var a=GameData.getMyHandCards(),n=a[GameData.game.cardHuier1];if(GameData.room.opts.shuangjin&&1<n&&0==GameData.cards[GameData.game.lastdisUid].youNum)return!1;var i=JSON.stringify(a),o=JSON.parse(i);o[t]=0<o[t]?o[t]+1:1,this.getHuDecks(o);var r=this.checkHuType(o,t,!1),s=[];return[r[0],r[1],t,s[0],s[1]]},m.prototype.canZimo=function(e,t){this.getHuDecks(e);var a=this.checkHuType(e,t,!0),n=GameData.cards[GameData.player.uid].youNum,i=[];return this.isMingYou(n)?i=this.getYoujinDeck(n,e):this.isAnYou(n)&&(i=this.getYoujinDeck(n,e)),[a[0],a[1],t,i[0],i[1]]},m.prototype.checkHuType=function(e,t,a){var n=[],i=[],o=this.huCards.length;if(a&&this.isDizhen(e))i.push(u);else if(0<o){var r=GameData.cards[GameData.player.uid].youNum;if(0<(d=this.isYoujinHu(r))[0])n=d[1],i.push(d[0]);else if(a)n=this.huCards[0].slice(),i.push(l);else{o=this.huCards.length;for(var s=0;s<o;s++)if(!(this.isHuier(this.huCards[s][0])&&t==this.huCards[s][1]||this.isHuier(this.huCards[s][1])&&t==this.huCards[s][0])){for(var c=!0,d=2;d<this.huCards[s].length;d+=3)if(t==this.huCards[s][d]&&this.isHuier(this.huCards[s][d+1])&&this.isHuier(this.huCards[s][d+2])||t==this.huCards[s][d+1]&&this.isHuier(this.huCards[s][d])&&this.isHuier(this.huCards[s][d+2])||t==this.huCards[s][d+2]&&this.isHuier(this.huCards[s][d])&&this.isHuier(this.huCards[s][d+1])){c=!1;break}if(c){n=this.huCards[s].slice(),i.push(h);break}}}}return[i,n]},m.prototype.checkYoujin=function(e){var t=[],a=[],n=GameData.getMyHandCards();if(this.formatCards(n,t,a),this.huCards.splice(0,this.huCards.length),this.isHuier(e)){if(1<a.length){var i=[a.pop(),a.pop()];return this.canGroup(t,a,i),0<this.huCards.length}}else if(0<a.length){i=[e,a.pop()];return t[e]--,this.canGroup(t,a,i),0<this.huCards.length}return!1},m.prototype.isYoujinHu=function(e){var t=o,a=[];if(0<e){for(var n=this.huCards.length,i=0;i<n;i++)if(this.isHuier(this.huCards[i][0])||this.isHuier(this.huCards[i][1])){a=this.huCards[i].slice();break}e==YoujinType.Ming?t=r:e==YoujinType.An1?t=s:e==YoujinType.An2?t=c:e==YoujinType.An3&&(t=d)}return[t,a]},m.prototype.isMingYou=function(e){return GameData.room.opts.youJin==YoujinType.Ming&&(cc.log("isMingYou "+GameData.room.opts.youJin+" "+e),!0)},m.prototype.isAnYou=function(e){return cc.log("isAnYou "+GameData.room.opts.youJin+" "+e),!(e>=GameData.room.opts.youJin)},m.prototype.getYoujinDeck=function(e,t){for(var a=!1,n=this.huCards.length,i=t[GameData.game.cardHuier1],o=0;o<n;o++)if(1==e||2==e){if(cc.log("huCards:"+this.huCards[o][0]+" "+this.huCards[o][1]),this.isHuier(this.huCards[o][0])&&this.isHuier(this.huCards[o][1])){GameData.youJinDeck=this.huCards[o].slice(),a=!0,cc.log("getYoujinDeck:"+GameData.youJinDeck);break}}else if(1<i){if(this.isHuier(this.huCards[o][0])&&this.isHuier(this.huCards[o][1])){GameData.youJinDeck=this.huCards[o].slice(),a=!0;break}(this.isHuier(this.huCards[o][0])||this.isHuier(this.huCards[o][1]))&&(GameData.youJinDeck=this.huCards[o].slice(),a=!0)}else if(this.isHuier(this.huCards[o][0])||this.isHuier(this.huCards[o][1])){GameData.youJinDeck=this.huCards[o].slice(),a=!0;break}return[a,GameData.youJinDeck]},m.prototype.isDizhen=function(e){return 3==e[GameData.game.cardHuier1]},m.prototype.calcHuScore=function(e){return 1},m.prototype.calcHuaScore=function(e){var t=GameData.getHuaCard(e);this.huaScore(t)},m.prototype.huaScore=function(e){var t=e.length;if(console.log("..hua = "+JSON.stringify(e)),console.log(t),t<4)return 0;if(4<=t&&t<8){for(var a=0;a<t;a++){for(var n=parseInt(e[a]/10),i=0,o=0;o<t;o++)n==parseInt(e[o]/10)&&i++;if(4==i)return 2}return 1}return 8==t?4:0},m.prototype.getHuType=function(e,t,a,n){return 0<e.length?[[h],e[0],a,0]:[]},m.prototype.getHuTypeString=function(){for(var e="",t=GameData.game.winnerType.length,a=0;a<t;a++)switch(GameData.game.winnerType[a]){case h:e+="速到*1   ";break;case l:e+="自摸*2   ";break;case u:e+="地震*3   ";break;case r:e+="明游*3   ";break;case s:e+="暗游1游*3   ";break;case c:e+="暗游2游*6   ";break;case d:e+="暗游3游*9   "}return e},cc._RF.pop()},{mahjong:"mahjong",utils:"utils"}],mahjong_tianjin:[function(e,t,a){"use strict";cc._RF.push(t,"31711tPAhJCS6GIhX+jwGyK","mahjong_tianjin");var n=e("mahjong"),i=e("utils"),y=2,v=3,C=4,D=5,_=6,G=7,w=8,S=9,T=10,N=11,o=12,r=13,b=14,s=function(){n.call(this)};i.inherits(s,n),(t.exports=s).prototype.canChi=function(e,t){return[]},s.prototype.canDianPao=function(e,t){return!1},s.prototype.isHuier=function(e){return GameData.game.cardHuier1==e||GameData.game.cardHuier2==e},s.prototype.isDeckHuier=function(e,t){return e-100==t},s.prototype.canHu=function(e,t,a){return!GameData.player.isXiangGong&&n.prototype.canHu.call(this,e,t,a)},s.prototype.getHuType=function(e,t,a,n){cc.log("TianjinMj.prototype.getHuType");for(var i=0,o=0,r=[],s=[],c=[],d=function(e,t,a){var n=e.calcHuScore(a);cc.log("score: deck:"+JSON.stringify(t)+" type:"+JSON.stringify(a)+" score:"+n),o<n&&(r=a,s=t,o=n)},h=e.length;i<h;i++){var l=e[i],u=this.isLong(l,c);if(u){var m=[],p=JSON.stringify(c),g=JSON.parse(p);n&&(this.isGangkaihua()&&m.push(T),this.isTianhu()?m.push(w):this.isDihu()&&m.push(S)),this.isSuBenLong(l,c,GameData.game.cardHuier1)?(m.push(N),15==a&&this.isZhuowu(c,a)&&m.push(D)):this.isBenLong(l,c,GameData.game.cardHuier1)?(m.push(G),this.isDHundiao(l,a,!0)?(m.push(C),this.isZhuowu(c,a)&&m.push(D)):this.isHundiao(l,a)?m.push(v):this.isZhuowu(c,a)&&m.push(D)):(m.push(_),this.isSupai(l)?(m.push(y),this.isZhuowu(g,a)&&m.push(D)):this.isDHundiao(l,a,!0)?(m.push(C),this.isZhuowu(g,a)&&m.push(D)):this.isHundiao(l,a)?m.push(v):this.isZhuowu(g,a)&&m.push(D)),d(this,l,m)}var f=this.isZhuowu(l,a);if(f){m=[];n&&(this.isGangkaihua()&&m.push(T),this.isTianhu()?m.push(w):this.isDihu()&&m.push(S)),m.push(D),this.isSupai(l)?m.push(y):this.isDHundiao(l,a,!1)&&m.push(C),d(this,l,m)}if(!u&&!f){m=[];n&&(this.isGangkaihua()&&m.push(T),this.isTianhu()?m.push(w):this.isDihu()&&m.push(S)),this.isSupai(l)?m.push(y):(0<m.length||GameData.room.opts.hd)&&this.isHundiao(l,a)?m.push(v):(0<m.length||GameData.room.opts.hd)&&this.isDHundiao(l,a,!1)&&m.push(C),d(this,l,m)}}l=[];this.isJinGang(t,l)&&((m=[]).push(b),this.isGangkaihua()&&m.push(T),this.isTianhu()?m.push(w):this.isDihu()&&m.push(S),d(this,l,m));return[r,s,a,o]},s.prototype.calcHuScore=function(e){if(e.length<=0)return 0;for(var t=!1,a=1,n=0,i=0;i<e.length;i++)switch(e[i]){case y:case v:case C:case T:a*=2;break;case D:GameData.room.opts.longwufan&&(t=!0),n+=3;break;case _:GameData.room.opts.longwufan&&(t=!0),n+=4;break;case G:GameData.room.opts.longwufan&&(t=!0),n+=8;break;case w:a*=8;break;case S:a*=4;break;case N:GameData.room.opts.longwufan&&(a*=2),n+=4,a*=4;break;case b:n+=GameData.createRoomOpts.jGangScore}return a=a||1,(a=t?2*a:a)*(n=n||1)},s.prototype.getHuTypeString=function(){for(var e="",t=!1,a=!1,n=GameData.game.winnerType.length,i=0;i<n;i++)switch(GameData.game.winnerType[i]){case w:e+="天胡 *4  ";break;case y:e+="没混 *2  ";break;case v:e+="混吊 *2  ";break;case C:e+=1<n?"双混吊 *2  ":"混吊 *2  ";break;case T:e+="杠开花 *2  ";break;case D:e+="捉五 +3  ",a=!0;break;case _:e+="一条龙 +4  ",a=!0;break;case G:e+="本混龙 +4 *2  ",a=!0;break;case o:t=!0;break;case r:e+="拉五龙  ";break;case N:e+="素本龙 +4 *4  ",a=!0;break;case b:4==GameData.room.opts.jingang?e+="金杠胡 +4  ":8==GameData.room.opts.jingang&&(e+="金杠胡 +8  ")}return a&&GameData.room.opts.longwufan&&(e+="龙五翻 *2  "),[e,t]},s.prototype.isSupai=function(e){for(var t=0;t<e.length;t++)if(this.isHuier(e[t]))return!1;return!0},s.prototype.isHundiao=function(e,t){return!!this.isHuier(e[1])&&(!this.isHuier(t)&&t==e[0]||!(!this.isHuier(t)||!this.isHuier(e[0])))},s.prototype.isDHundiao=function(e,t,a){var n=[];if(a)for(var i=0;i<3;i++){var o=10*i;if(n=e.concat(),this.removeGroup(n,[o+1,o+2,o+3])&&this.removeGroup(n,[o+4,o+5,o+6])&&this.removeGroup(n,[o+7,o+8,o+9]))break}else n=e.concat();for(var r=2;r<n.length;r+=3)if(!(n[r]<=0))if(this.isHuier(t)){if(this.isHuier(n[r])&&this.isHuier(n[r+1])&&this.isHuier(n[r+2]))return!0}else{if(t==n[r]&&this.isHuier(n[r+1])&&this.isHuier(n[r+2]))return!0;if(t==n[r+1]&&this.isHuier(n[r])&&this.isHuier(n[r+2]))return!0;if(t==n[r+2]&&this.isHuier(n[r])&&this.isHuier(n[r+1]))return!0}return!1},s.prototype.isZhuowu=function(e,t){if(this.isHuier(t))for(var a=2;a<e.length;a+=3){if(14==e[a]&&(this.isHuier(e[a+1])||this.isDeckHuier(e[a+1],15))&&(16==e[a+2]||this.isHuier(e[a+2])||this.isDeckHuier(e[a+2],16)))return!0;if(16==e[a]&&(this.isHuier(e[a+1])||this.isDeckHuier(e[a+1],14))&&(this.isHuier(e[a+2])||this.isDeckHuier(e[a+2],15)))return!0;if((this.isHuier(e[a])||this.isDeckHuier(e[a],14))&&(this.isHuier(e[a+1])||this.isDeckHuier(e[a+1],15))&&(this.isHuier(e[a+2])||this.isDeckHuier(e[a+2],16)))return!0;if((14==e[a]||this.isDeckHuier(e[a],14))&&this.isDeckHuier(e[a+1],15)&&(16==e[a+2]||this.isDeckHuier(e[a+2],16)))return!0}else if(15==t)for(a=2;a<e.length;a+=3){if(14==e[a]&&15==e[a+1]&&16==e[a+2])return!0;if(14==e[a]&&15==e[a+1]&&this.isHuier(e[a+2]))return!0;if(14==e[a]&&15==e[a+1]&&this.isDeckHuier(e[a+2],16))return!0;if(15==e[a]&&16==e[a+1]&&this.isHuier(e[a+2]))return!0;if(15==e[a]&&16==e[a+1]&&this.isDeckHuier(e[a+2],14))return!0;if(15==e[a]&&(this.isHuier(e[a+1])||this.isDeckHuier(e[a+1],14))&&(this.isHuier(e[a+2])||this.isDeckHuier(e[a+2],16)))return!0;if(14==e[a]&&15==e[a+1]&&this.isDeckHuier(e[a+2],16))return!0;if(this.isDeckHuier(e[a],14)&&15==e[a+1]&&16==e[a+2])return!0;if(this.isDeckHuier(e[a],14)&&15==e[a+1]&&this.isDeckHuier(e[a+2],16))return!0}return!1},s.prototype.checkLong=function(e,t){return!!this.matchGroup(e,[t+1,t+2,t+3])&&(!!this.matchGroup(e,[t+4,t+5,t+6])&&!!this.matchGroup(e,[t+7,t+8,t+9]))},s.prototype.isLong=function(e,t){for(var a=0;a<3;a++){var n=10*a;if(cloneArray(e,t),this.checkLong(t,n))return!0}return!1},s.prototype.isBenLong=function(e,t,a){var n=parseInt(a/10);if(3<=n)return!1;var i=10*n;return cloneArray(e,t),this.checkLong(t,i)},s.prototype.isSuBenLong=function(e,t,a){var n=parseInt(a/10);if(3<=n)return!1;for(var i=0,o=0,r=0;r<e.length;r++)if(this.isHuier(e[r])){if(2<++i)return!1;if(o==e[r])return!1;o=e[r]}if(2!=i)return!1;var s=10*n;return cloneArray(e,t),this.checkLong(t,s)},s.prototype.isGangkaihua=function(){return 1==GameData.game.gangOver},s.prototype.isTianhu=function(){return GameData.game.noActions&&GameData.player.uid==GameData.game.zhuangUid},s.prototype.isDihu=function(){return!1},s.prototype.isJinGang=function(e,t){var a=e[GameData.game.cardHuier1],n=e[GameData.game.cardHuier2];if(4!=a&&4!=n)return!1;for(var i in e)for(var o=0;o<e[i];o++)t.push(i);return!0},s.prototype.getHuTypeArry=function(e){for(var t=0;t<GameData.game.winnerType.length;t++)if(e==GameData.game.winnerType[t])return!0;return!1},cc._RF.pop()},{mahjong:"mahjong",utils:"utils"}],mahjong:[function(e,t,a){"use strict";cc._RF.push(t,"219e5KZKEpD3pUWCeIQHVLZ","mahjong");e("roomHandler");var c={tiao:[1,2,3,4,5,6,7,8,9],wan:[11,12,13,14,15,16,17,18,19],tong:[21,22,23,24,25,26,27,28,29],feng:[31,41,51,61],jian:[71,81,91],hua:[111,112,113,114,121,122,123,124]},n=function(){this.huCards=[]};(t.exports=n).prototype.isHuier=function(e){return e>=c.hua[0]&&e<=c.hua[7]},n.prototype.canDianPao=function(e,t){var a=GameData.cards[e].hand,n=JSON.stringify(a),i=JSON.parse(n);return i[t]=0<i[t]?i[t]+1:1,this.canHu(i,t,!1)},n.prototype.canZimo=function(e,t,a){return this.canHu(e,t,a)},n.prototype.canHu=function(e,t,a){return this.getHuDecks(e),this.getHuType(this.huCards,e,t,a)},n.prototype.getHuDecks=function(e){var t=[],a=[];this.formatCards(e,t,a),this.huCards.splice(0,this.huCards.length);for(var n=t.length,i=a.length,o=0;o<n;o++){if(1<t[o])(r=t.concat())[o]-=2,this.canGroup(r,a,[o,o]);if(1<=t[o]&&0<i){var r=t.concat(),s=[o,(c=a.concat()).pop()];r[o]--,this.canGroup(r,c,s)}}if(1<i){var c;r=t.concat(),s=[(c=a.concat()).pop(),c.pop()];this.canGroup(r,c,s)}},n.prototype.canTing=function(e){var t=[],a=JSON.stringify(e);for(var n in c)if("hua"!=n)for(var i=0;i<c[n].length;i++){var o=c[n][i];if(!this.isHuier(o)){var r=JSON.parse(a);r[o]=0<r[o]?r[o]+1:1;var s=this.canHu(r,o,!1);0!=s&&s[0]&&0<s[0].length&&t.push({obcard:o,type:s[0],score:s[3]})}}return t},n.prototype.discardTip=function(e){var t=[],a=JSON.stringify(e);for(var n in e)if(!(this.isHuier(n)||e[n]<=0)){var i=JSON.parse(a);i[n]--;var o=this.canTing(i);0<o.length&&t.push({discard:n,ting:o})}return t},n.prototype.formatCards=function(e,t,a){t.push(0);for(var n=1;n<=91;n++)if(0<e[n])if(this.isHuier(n)){for(var i=0;i<e[n];i++)a.push(n);t.push(0)}else t.push(e[n]);else t.push(0)},n.prototype.canGroup=function(e,t,a){for(var n=e.length,i=t.length,o=0;o<n;o++)if(!(e[o]<=0)){if(0<e[o+1]&&0<e[o+2]){var r=e.concat(),s=a.concat(o,o+1,o+2);r[o]--,r[o+1]--,r[o+2]--,this.canGroup(r,t,s)}if(0<e[o+1]&&0<i){r=e.concat();var c=t.concat();s=a.concat(o,o+1,c.pop());r[o]--,r[o+1]--,this.canGroup(r,c,s)}if(0<e[o+2]&&0<i&&o%10<9){r=e.concat(),c=t.concat(),s=a.concat(o,c.pop(),o+2);r[o]--,r[o+2]--,this.canGroup(r,c,s)}if(3==e[o]){r=e.concat(),s=a.concat(o,o,o);r[o]-=3,this.canGroup(r,t,s)}if(2==e[o]&&0<i){r=e.concat(),c=t.concat(),s=a.concat(o,o,c.pop());r[o]-=2,this.canGroup(r,c,s)}if(1<i){r=e.concat(),c=t.concat(),s=a.concat(o,c.pop(),c.pop());r[o]--,this.canGroup(r,c,s)}return}if(i%3==0){for(o=0;o<i;o++)a.push(t[o]);this.huCards.push(a)}},n.prototype.matchGroup=function(e,t){for(var a=2;a<e.length;a+=3)if(!(e[a]<=0)){var n=[e[a],e[a+1],e[a+2]];if(this.equal(n,t))return e[a]=n[0],e[a+1]=n[1],e[a+2]=n[2],!0}return!1},n.prototype.removeGroup=function(e,t){for(var a=2;a<e.length;a+=3)if(!(e[a]<=0)){var n=[e[a],e[a+1],e[a+2]];if(this.equal(n,t))return e[a]=e[a+1]=e[a+2]=0,!0}return!1},n.prototype.equal=function(e,t){return e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]||(e[0]==t[0]&&this.isHuier(e[1])&&e[2]==t[2]?(e[1]=t[1]+100,!0):e[0]==t[0]&&e[1]==t[1]&&this.isHuier(e[2])?(e[2]=t[2]+100,!0):e[0]==t[0]&&this.isHuier(e[1])&&this.isHuier(e[2])?(e[1]=t[1]+100,e[2]=t[2]+100,!0):e[0]==t[1]&&e[1]==t[2]&&this.isHuier(e[2])?(e[0]=t[0]+100,e[1]=t[1],e[2]=t[2],!0):e[0]==t[1]&&this.isHuier(e[1])&&this.isHuier(e[2])?(e[0]=t[0]+100,e[1]=t[1],e[2]=t[2]+100,!0):e[0]==t[2]&&this.isHuier(e[1])&&this.isHuier(e[2])?(e[0]=t[0]+100,e[1]=t[1]+100,e[2]=t[2],!0):!!(this.isHuier(e[0])&&this.isHuier(e[1])&&this.isHuier(e[2]))&&(e[0]=t[0]+100,e[1]=t[1]+100,e[2]=t[2]+100,!0))},n.prototype.canChi=function(e,t){if(!GameData.isPrevPlayer(e))return!1;if(this.isHuier(t))return!1;var a=[],n=GameData.getMyHandCards(),i=t-2,o=t-1,r=t-0+1,s=t-0+2;return!this.isHuier(i)&&!this.isHuier(o)&&0<n[i]&&0<n[o]&&a.push([i,o]),!this.isHuier(o)&&!this.isHuier(r)&&0<n[o]&&0<n[r]&&a.push([o,r]),!this.isHuier(r)&&!this.isHuier(s)&&0<n[r]&&0<n[s]&&a.push([r,s]),a},n.prototype.canPeng=function(e,t){return e!=GameData.player.uid&&(1!=this.isHuier(t)&&1<GameData.cards[GameData.player.uid].hand[t])},n.prototype.canAnGang=function(e){if(0==GameData.game.cardleft)return 0;if(e!=GameData.player.uid)return 0;var t=GameData.getMyHandCards();for(var a in t)if(4<=t[a])return a;return 0},n.prototype.canMingGang=function(e,t){if(1==this.isHuier(t))return 0;if(0==GameData.game.cardleft)return 0;if(e!=GameData.player.uid&&3==GameData.getMyHandCards()[t])return t;return 0},n.prototype.canMingGangSelf=function(){var e=[];if(0==GameData.game.cardleft)return e;for(var t=GameData.cards[GameData.player.uid].peng,a=GameData.getMyHandCards(),n=0;n<t.length;n++)0<a[t[n][0]]&&e.push(t[n][0]);return e},n.prototype.getHuType=function(e,t,a,n){return[]},n.prototype.calcHuScore=function(e){return 0},n.prototype.getHuTypeString=function(){return""},cc._RF.pop()},{roomHandler:"roomHandler"}],matchHandler:[function(e,t,a){"use strict";cc._RF.push(t,"447a5nPemhOXKOPWznTZIS/","matchHandler");var n=e("roomHandler"),i=e("errorCode"),o={matchTime:0,onMatch:!1,selectGameType:void 0,selectGameLv:void 0};(t.exports=o).signup=function(){cc.log("..match game type:"+this.selectGameType+"..lv:"+this.selectGameLv);var t=this;GameNet.getInstance().request("game.matchHandler.signup",{gameType:this.selectGameType,level:this.selectGameLv},function(e){if(e.ret==i.Success){t.matchTime=0;openView("UIMatch",void 0,function(e){var t=cc.director.getScene().getChildByName("Canvas").getChildByName("SelectGameLvPanel");t&&e.setLocalZOrder(t.getLocalZOrder()+2)})}else{switch(console.log("match ret:"+e.ret),e.ret){case i.lessCoin:createMoveMessage("",i.LessCoin);break;default:messageBoxWithoutCB("匹配失败")}}closeView("Loading")})},o.cancel=function(t){var a=this;GameNet.getInstance().request("game.matchHandler.cancel",{},function(e){e.ret==i.Success&&(a.matchTime=0,a.onMatch=!1,t())})},o.registMessage=function(){var t=this;GameNet.getInstance().setCallBack("createMatchRoom",function(e){t.onMatch=!1,t.matchTime=0,n.enterRoom(e.roomid)}),GameNet.getInstance().setCallBack("onMatchData",function(e){t.onMatch=!0,t.matchTime=Math.abs(parseInt(((new Date).getTime()-e.time)/1e3)),sendEvent("onMatchData")})},cc._RF.pop()},{errorCode:"errorCode",roomHandler:"roomHandler"}],md5:[function(require,module,exports){(function(process,global){"use strict";cc._RF.push(module,"243c38+gUpFn6lr5r5BEkqH","md5");var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};(function(){var ERROR="input is invalid type",WINDOW="object"===("undefined"==typeof window?"undefined":_typeof(window)),root=WINDOW?window:{};root.JS_MD5_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"===("undefined"==typeof self?"undefined":_typeof(self)),NODE_JS=!root.JS_MD5_NO_NODE_JS&&"object"===(void 0===process?"undefined":_typeof(process))&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_MD5_NO_COMMON_JS&&"object"===(void 0===module?"undefined":_typeof(module))&&module.exports,AMD="function"==typeof define&&define.amd,ARRAY_BUFFER=!root.JS_MD5_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[128,32768,8388608,-2147483648],SHIFT=[0,8,16,24],OUTPUT_TYPES=["hex","array","digest","buffer","arrayBuffer","base64"],BASE64_ENCODE_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),blocks=[],buffer8;if(ARRAY_BUFFER){var buffer=new ArrayBuffer(68);buffer8=new Uint8Array(buffer),blocks=new Uint32Array(buffer)}!root.JS_MD5_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),!ARRAY_BUFFER||!root.JS_MD5_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"===(void 0===e?"undefined":_typeof(e))&&e.buffer&&e.buffer.constructor===ArrayBuffer});var createOutputMethod=function(t){return function(e){return new Md5(!0).update(e)[t]()}},createMethod=function(){var t=createOutputMethod("hex");NODE_JS&&(t=nodeWrap(t)),t.create=function(){return new Md5},t.update=function(e){return t.create().update(e)};for(var e=0;e<OUTPUT_TYPES.length;++e){var a=OUTPUT_TYPES[e];t[a]=createOutputMethod(a)}return t},nodeWrap=function nodeWrap(method){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),nodeMethod=function(e){if("string"==typeof e)return crypto.createHash("md5").update(e,"utf8").digest("hex");if(null==e)throw ERROR;return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash("md5").update(new Buffer(e)).digest("hex"):method(e)};return nodeMethod};function Md5(e){if(e)blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks,this.buffer8=buffer8;else if(ARRAY_BUFFER){var t=new ArrayBuffer(68);this.buffer8=new Uint8Array(t),this.blocks=new Uint32Array(t)}else this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];this.h0=this.h1=this.h2=this.h3=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Md5.prototype.update=function(e){if(!this.finalized){var t,a=void 0===e?"undefined":_typeof(e);if("string"!==a){if("object"!==a)throw ERROR;if(null===e)throw ERROR;if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw ERROR;t=!0}for(var n,i,o=0,r=e.length,s=this.blocks,c=this.buffer8;o<r;){if(this.hashed&&(this.hashed=!1,s[0]=s[16],s[16]=s[1]=s[2]=s[3]=s[4]=s[5]=s[6]=s[7]=s[8]=s[9]=s[10]=s[11]=s[12]=s[13]=s[14]=s[15]=0),t)if(ARRAY_BUFFER)for(i=this.start;o<r&&i<64;++o)c[i++]=e[o];else for(i=this.start;o<r&&i<64;++o)s[i>>2]|=e[o]<<SHIFT[3&i++];else if(ARRAY_BUFFER)for(i=this.start;o<r&&i<64;++o)(n=e.charCodeAt(o))<128?c[i++]=n:(n<2048?c[i++]=192|n>>6:(n<55296||57344<=n?c[i++]=224|n>>12:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++o)),c[i++]=240|n>>18,c[i++]=128|n>>12&63),c[i++]=128|n>>6&63),c[i++]=128|63&n);else for(i=this.start;o<r&&i<64;++o)(n=e.charCodeAt(o))<128?s[i>>2]|=n<<SHIFT[3&i++]:(n<2048?s[i>>2]|=(192|n>>6)<<SHIFT[3&i++]:(n<55296||57344<=n?s[i>>2]|=(224|n>>12)<<SHIFT[3&i++]:(n=65536+((1023&n)<<10|1023&e.charCodeAt(++o)),s[i>>2]|=(240|n>>18)<<SHIFT[3&i++],s[i>>2]|=(128|n>>12&63)<<SHIFT[3&i++]),s[i>>2]|=(128|n>>6&63)<<SHIFT[3&i++]),s[i>>2]|=(128|63&n)<<SHIFT[3&i++]);this.lastByteIndex=i,this.bytes+=i-this.start,64<=i?(this.start=i-64,this.hash(),this.hashed=!0):this.start=i}return 4294967295<this.bytes&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}},Md5.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[t>>2]|=EXTRA[3&t],56<=t&&(this.hashed||this.hash(),e[0]=e[16],e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.bytes<<3,e[15]=this.hBytes<<3|this.bytes>>>29,this.hash()}},Md5.prototype.hash=function(){var e,t,a,n,i,o,r=this.blocks;this.first?t=((t=((e=((e=r[0]-680876937)<<7|e>>>25)-271733879<<0)^(a=((a=(-271733879^(n=((n=(-1732584194^2004318071&e)+r[1]-117830708)<<12|n>>>20)+e<<0)&(-271733879^e))+r[2]-1126478375)<<17|a>>>15)+n<<0)&(n^e))+r[3]-1316259209)<<22|t>>>10)+a<<0:(e=this.h0,t=this.h1,a=this.h2,t=((t+=((e=((e+=((n=this.h3)^t&(a^n))+r[0]-680876936)<<7|e>>>25)+t<<0)^(a=((a+=(t^(n=((n+=(a^e&(t^a))+r[1]-389564586)<<12|n>>>20)+e<<0)&(e^t))+r[2]+606105819)<<17|a>>>15)+n<<0)&(n^e))+r[3]-1044525330)<<22|t>>>10)+a<<0),t=((t+=((e=((e+=(n^t&(a^n))+r[4]-176418897)<<7|e>>>25)+t<<0)^(a=((a+=(t^(n=((n+=(a^e&(t^a))+r[5]+1200080426)<<12|n>>>20)+e<<0)&(e^t))+r[6]-1473231341)<<17|a>>>15)+n<<0)&(n^e))+r[7]-45705983)<<22|t>>>10)+a<<0,t=((t+=((e=((e+=(n^t&(a^n))+r[8]+1770035416)<<7|e>>>25)+t<<0)^(a=((a+=(t^(n=((n+=(a^e&(t^a))+r[9]-1958414417)<<12|n>>>20)+e<<0)&(e^t))+r[10]-42063)<<17|a>>>15)+n<<0)&(n^e))+r[11]-1990404162)<<22|t>>>10)+a<<0,t=((t+=((e=((e+=(n^t&(a^n))+r[12]+1804603682)<<7|e>>>25)+t<<0)^(a=((a+=(t^(n=((n+=(a^e&(t^a))+r[13]-40341101)<<12|n>>>20)+e<<0)&(e^t))+r[14]-1502002290)<<17|a>>>15)+n<<0)&(n^e))+r[15]+1236535329)<<22|t>>>10)+a<<0,t=((t+=((n=((n+=(t^a&((e=((e+=(a^n&(t^a))+r[1]-165796510)<<5|e>>>27)+t<<0)^t))+r[6]-1069501632)<<9|n>>>23)+e<<0)^e&((a=((a+=(e^t&(n^e))+r[11]+643717713)<<14|a>>>18)+n<<0)^n))+r[0]-373897302)<<20|t>>>12)+a<<0,t=((t+=((n=((n+=(t^a&((e=((e+=(a^n&(t^a))+r[5]-701558691)<<5|e>>>27)+t<<0)^t))+r[10]+38016083)<<9|n>>>23)+e<<0)^e&((a=((a+=(e^t&(n^e))+r[15]-660478335)<<14|a>>>18)+n<<0)^n))+r[4]-405537848)<<20|t>>>12)+a<<0,t=((t+=((n=((n+=(t^a&((e=((e+=(a^n&(t^a))+r[9]+568446438)<<5|e>>>27)+t<<0)^t))+r[14]-1019803690)<<9|n>>>23)+e<<0)^e&((a=((a+=(e^t&(n^e))+r[3]-187363961)<<14|a>>>18)+n<<0)^n))+r[8]+1163531501)<<20|t>>>12)+a<<0,t=((t+=((n=((n+=(t^a&((e=((e+=(a^n&(t^a))+r[13]-1444681467)<<5|e>>>27)+t<<0)^t))+r[2]-51403784)<<9|n>>>23)+e<<0)^e&((a=((a+=(e^t&(n^e))+r[7]+1735328473)<<14|a>>>18)+n<<0)^n))+r[12]-1926607734)<<20|t>>>12)+a<<0,t=((t+=((o=(n=((n+=((i=t^a)^(e=((e+=(i^n)+r[5]-378558)<<4|e>>>28)+t<<0))+r[8]-2022574463)<<11|n>>>21)+e<<0)^e)^(a=((a+=(o^t)+r[11]+1839030562)<<16|a>>>16)+n<<0))+r[14]-35309556)<<23|t>>>9)+a<<0,t=((t+=((o=(n=((n+=((i=t^a)^(e=((e+=(i^n)+r[1]-1530992060)<<4|e>>>28)+t<<0))+r[4]+1272893353)<<11|n>>>21)+e<<0)^e)^(a=((a+=(o^t)+r[7]-155497632)<<16|a>>>16)+n<<0))+r[10]-1094730640)<<23|t>>>9)+a<<0,t=((t+=((o=(n=((n+=((i=t^a)^(e=((e+=(i^n)+r[13]+681279174)<<4|e>>>28)+t<<0))+r[0]-358537222)<<11|n>>>21)+e<<0)^e)^(a=((a+=(o^t)+r[3]-722521979)<<16|a>>>16)+n<<0))+r[6]+76029189)<<23|t>>>9)+a<<0,t=((t+=((o=(n=((n+=((i=t^a)^(e=((e+=(i^n)+r[9]-640364487)<<4|e>>>28)+t<<0))+r[12]-421815835)<<11|n>>>21)+e<<0)^e)^(a=((a+=(o^t)+r[15]+530742520)<<16|a>>>16)+n<<0))+r[2]-995338651)<<23|t>>>9)+a<<0,t=((t+=((n=((n+=(t^((e=((e+=(a^(t|~n))+r[0]-198630844)<<6|e>>>26)+t<<0)|~a))+r[7]+1126891415)<<10|n>>>22)+e<<0)^((a=((a+=(e^(n|~t))+r[14]-1416354905)<<15|a>>>17)+n<<0)|~e))+r[5]-57434055)<<21|t>>>11)+a<<0,t=((t+=((n=((n+=(t^((e=((e+=(a^(t|~n))+r[12]+1700485571)<<6|e>>>26)+t<<0)|~a))+r[3]-1894986606)<<10|n>>>22)+e<<0)^((a=((a+=(e^(n|~t))+r[10]-1051523)<<15|a>>>17)+n<<0)|~e))+r[1]-2054922799)<<21|t>>>11)+a<<0,t=((t+=((n=((n+=(t^((e=((e+=(a^(t|~n))+r[8]+1873313359)<<6|e>>>26)+t<<0)|~a))+r[15]-30611744)<<10|n>>>22)+e<<0)^((a=((a+=(e^(n|~t))+r[6]-1560198380)<<15|a>>>17)+n<<0)|~e))+r[13]+1309151649)<<21|t>>>11)+a<<0,t=((t+=((n=((n+=(t^((e=((e+=(a^(t|~n))+r[4]-145523070)<<6|e>>>26)+t<<0)|~a))+r[11]-1120210379)<<10|n>>>22)+e<<0)^((a=((a+=(e^(n|~t))+r[2]+718787259)<<15|a>>>17)+n<<0)|~e))+r[9]-343485551)<<21|t>>>11)+a<<0,this.first?(this.h0=e+1732584193<<0,this.h1=t-271733879<<0,this.h2=a-1732584194<<0,this.h3=n+271733878<<0,this.first=!1):(this.h0=this.h0+e<<0,this.h1=this.h1+t<<0,this.h2=this.h2+a<<0,this.h3=this.h3+n<<0)},Md5.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,a=this.h2,n=this.h3;return HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]},Md5.prototype.toString=Md5.prototype.hex,Md5.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,a=this.h2,n=this.h3;return[255&e,e>>8&255,e>>16&255,e>>24&255,255&t,t>>8&255,t>>16&255,t>>24&255,255&a,a>>8&255,a>>16&255,a>>24&255,255&n,n>>8&255,n>>16&255,n>>24&255]},Md5.prototype.array=Md5.prototype.digest,Md5.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(16),t=new Uint32Array(e);return t[0]=this.h0,t[1]=this.h1,t[2]=this.h2,t[3]=this.h3,e},Md5.prototype.buffer=Md5.prototype.arrayBuffer,Md5.prototype.base64=function(){for(var e,t,a,n="",i=this.array(),o=0;o<15;)e=i[o++],t=i[o++],a=i[o++],n+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[63&(e<<4|t>>>4)]+BASE64_ENCODE_CHAR[63&(t<<2|a>>>6)]+BASE64_ENCODE_CHAR[63&a];return e=i[o],n+=BASE64_ENCODE_CHAR[e>>>2]+BASE64_ENCODE_CHAR[e<<4&63]+"=="};var exports=createMethod();COMMON_JS?module.exports=exports:(root.md5=exports,AMD&&define(function(){return exports}))})(),cc._RF.pop()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],messagebox:[function(e,t,a){"use strict";cc._RF.push(t,"8932erMsF1OE5oe4fGje+2N","messagebox"),cc.Class({extends:cc.Component,properties:{btnOk:cc.Button,btnCancel:cc.Button,content:cc.Label,artWordSp:cc.Node,nameStr:cc.Label,content1:cc.Label,content2:cc.Label,content3:cc.Label},onLoad:function(){this.node.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})},setContent:function(e){cc.log("text:"+e),this.content.node.active=!0,null!=e?this.content.string=e:(cc.log("11111111111111"),this.content.node.active=!1)},setName:function(e){!e||e.length<=0?this.nameStr.node.active=!1:(this.nameStr.node.active=!0,this.nameStr.string=e)},setContent1:function(e){!e||e.length<=0?this.content1.node.active=!1:(this.content1.node.active=!0,this.content1.string=e)},setContent2:function(e){!e||e.length<=0?this.content2.node.active=!1:(this.content2.node.active=!0,this.content2.string=e,this.content2.node.x=30+this.content1.node.getPositionX()+this.content1.node.getContentSize().width+this.nameStr.node.getContentSize().width)},setContent3:function(e){!e||e.length<=0?this.content3.node.active=!1:(this.content3.node.active=!0,this.content3.string=e)},setArtwordSp:function(e){if(cc.log("img:"+e),this.artWordSp.active=!0,null!=e){this.artWordSp.getComponent(cc.Sprite).spriteFrame=null;var t=cc.textureCache.addImage(cc.url.raw(e));this.artWordSp.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}else this.artWordSp.active=!1},setStringVisbile:function(){0==this.nameStr.node.active&&0==this.content2.node.active?(this.content1.node.active=!1,this.content3.node.active=!1):(this.content1.node.active=!0,this.content3.node.active=!0)},setOkFunc:function(t){var a=this;this.btnOk.node.on(cc.Node.EventType.TOUCH_END,function(e){a.node.active=!1,t()})},setCancelFunc:function(t){var a=this;this.btnCancel.node.on(cc.Node.EventType.TOUCH_END,function(e){a.node.active=!1,t()})},updateBtnPos:function(e){e?(this.btnOk.node.x=-140,this.btnOk.node.active=!0,this.btnCancel.node.active=!0):(this.btnOk.node.x=0,this.btnOk.node.active=!0,this.btnCancel.node.active=!1)},update13BtnPos:function(e){e?(this.node.width,this.btnOk.width,this.btnOk.node.active=!0,this.btnCancel.node.active=!0):(this.btnOk.node.x=0,this.btnOk.node.active=!0,this.btnCancel.node.active=!1)}}),cc._RF.pop()},{}],missionHandler:[function(e,t,a){"use strict";cc._RF.push(t,"621ff60HQ9FOLvaenfyxUuP","missionHandler");e("gameDefine");var n=e("errorCode"),i={missionTable:e("mission").missionTable};(t.exports=i).onShareSucess=function(){for(var e in GameData.player.mission)this.missionTable[e]&&"share"==this.missionTable[e].event&&GameData.player.mission[e].count<this.missionTable[e].count&&GameNet.getInstance().request("game.playerHandler.onCompleteShareMission",{id:e},function(e){e.result,n.Success})},i.getReward=function(t){this.missionTable[t]&&GameData.player.mission&&GameData.player.mission[t]&&(GameData.player.mission[t].isGet||GameNet.getInstance().request("game.playerHandler.getMissionReward",{missionId:t},function(e){e.result==n.Success&&sendEvent("taskGetReward",t)}))},i.checkAllComplete=function(e){if(null==e)return!1;for(var t in e){if(null!=(e=e[t])&&0==e.isGet)return!1}return!0},cc._RF.pop()},{errorCode:"errorCode",gameDefine:"gameDefine",mission:"mission"}],mission:[function(e,t,a){"use strict";cc._RF.push(t,"64f8exjJtNAYI4ieXLVyI0d","mission");var n=e("gameDefine"),i={missionTable:[{id:0,desc:"分享游戏到微信",event:"share",gameType:0,timeType:0,count:1,reward:10001,icon:"resources/home/jinbi02.png"}],rewardTable:{10001:{type:n.taskRewardType.coin,count:5e3}},getMissionData:function(e){if(null==e)return null;for(var t=0;t<i.missionTable.length;t++){var a=i.missionTable[t];if(null!=a&&e==a.id)return a}return null},getMissionRewardData:function(e){if(null==e)return null;var t=this.getMissionData(e);if(null==t)return null;for(var a in i.rewardTable)if(a==t.reward)return i.rewardTable[a];return null},getMissionRewardStr:function(e){var t="";if(null==e)return t;var a=i.rewardTable[e];if(null==a)return t;switch(a.type){case n.taskRewardType.coin:t+="金币"}return t+="X"+a.count}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],niuNiuHandler:[function(e,t,a){"use strict";cc._RF.push(t,"01c92fdxPpCZoCIvnPtESFD","niuNiuHandler");e("roomHandler");var n={isStartAnimationPlayed:!1,isSelfClickAdviseBtn:!1,status:0,zhuangUid:0,gameTimes:0,gameStart:!1,readyBtnActive:!1,playerCards:{},playerCard3:{},playerScore:{},playerChips:{},playerZhuang:{},playerSendCard:{},recordType:{}};(t.exports=n).initAllData=function(){this.isStartAnimationPlayed=!1,this.isSelfClickAdviseBtn=!1,this.status=0,this.zhuangUid=0,this.gameTimes=0,this.gameStart=!1,this.readyBtnActive=!1,this.playerCards={},this.playerCard3={},this.playerScore={},this.playerChips={},this.playerZhuang={},this.playerSendCard={},this.recordType={}},n.initRoundData=function(){this.zhuangUid=0,this.playerCards={},this.playerCard3={},this.playerScore={},this.playerChips={},this.playerZhuang={},this.playerSendCard={},this.recordType={},this.readyBtnActive=!1,this.isSelfClickAdviseBtn=!1},n.spectator=function(e){var t=!0;for(var a in this.playerScore)if(a==e){t=!1;break}return t},n.setTexture=function(e,t){var a;if(null==e||0==e.length||null==e){t.getComponent(cc.Sprite)&&(t.getComponent(cc.Sprite).spriteFrame=null)}else{var n=cc.url.raw(e);n&&(a=cc.textureCache.addImage(n)),t.getComponent(cc.Sprite)&&(t.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a))}},n.randomNum=function(e,t){var a=t-e;return Math.random()*a+e},n.getZhuangMax=function(){var e=[];for(var t in this.playerZhuang)e.push(parseInt(this.playerZhuang[t],10));for(var a=0,n=1;n<e.length;n++)e[n]&&e[n]>e[a]&&(a=n);return e[a]},n.getZhuangMaxArray=function(){var e=this.getZhuangMax(),t=[];for(var a in this.playerZhuang)parseInt(this.playerZhuang[a],10)===e&&t.push(a);return t},n.requestZhuang=function(e){var t={num:e};GameNet.getInstance().request("room.niuNiuHandler.setZhuang",t,function(e){})},n.requestStart=function(){GameNet.getInstance().request("room.niuNiuHandler.setStart",{},function(e){if(0==e.result)return 0})},n.requestChips=function(e){var t={num:e};GameNet.getInstance().request("room.niuNiuHandler.setChips",t,function(e){})},n.requestSend=function(){GameNet.getInstance().request("room.niuNiuHandler.setShow",{},function(e){})},n.registMessage=function(){var t=this;GameNet.getInstance().setCallBack("douniu-onGameStart",function(e){t.gameStart=!0,t.isStartAnimationPlayed=!0,sendEvent("douniu-onGameStart",e)}),GameNet.getInstance().setCallBack("douniu-onGameEnd",function(e){t.status=0,t.gameStart=!1,sendEvent("douniu-onGameEnd",e)}),GameNet.getInstance().setCallBack("douniu-onGameInfo",function(e){t.status=e.status,t.zhuangUid=e.zhuangUid,t.playerZhuang=e.zhuangs,t.playerChips=e.chips,t.playerScore=e.score,t.playerSendCard=e.show,t.gameTimes=e.timer,sendEvent("douniu-onGameInfo",e)}),GameNet.getInstance().setCallBack("douniu-onGameCards",function(e){t.playerCards[e.uid]=e.cards,null==e.type||(t.recordType[e.uid]=e.type),e.card3&&(t.playerCard3[e.uid]=e.card3),cc.log("self.playerCards = "+JSON.stringify(t.playerCards)),sendEvent("douniu-onGameCards",e)}),GameNet.getInstance().setCallBack("douniu-onShowCards",function(e){cc.log("douniu-onShowCards = "+JSON.stringify(e)),sendEvent("douniu-onShowCards",e)})},cc._RF.pop()},{roomHandler:"roomHandler"}],niuNiuPlayerInfo:[function(e,t,a){"use strict";cc._RF.push(t,"3dde8K/SCJJJr8T51cP1f+P","niuNiuPlayerInfo");var i=e("roomHandler"),o=e("gameDefine"),r=e("SoundMngr");cc.Class({extends:cc.Component,properties:{uid:0,headBg:cc.Node,headBtn:cc.Button,headIcon:cc.Sprite,zhuangIcon:cc.Sprite,nameLabel:cc.Label,_player:null,zhuangBg:cc.Node},onLoad:function(){},setPlayer:function(e){this._player=e,this._player.uid&&(this.uid=this._player.uid)},setName:function(e){this.nameLabel.string=getShortStr(e,4)},setHeadIcon:function(e){if(null!=e&&""!=e){var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.headIcon.spriteFrame=new cc.SpriteFrame(t))})}else this.headIcon.spriteFrame=null},initHeadIcon:function(e){var t;t=cc.textureCache.addImage(cc.url.raw("resources/hundredNiuNiu/uiResources/playerInfo/kongHead.png")),this.headIcon.spriteFrame=new cc.SpriteFrame(t)},showHeadBg:function(e){this.headBg.active=e},showZhuang:function(e){this.zhuangIcon.node.active=e},enableHeadBtn:function(e){this.headBtn.node.active=e},HeadBtnIsClick:function(e){this.headBtn.interactable=e},onHeadBtnClicked:function(e){r.instance.playAudioOther("button");var t=cc.director.getScene().name;if(cc.log("..sceneName:",t),"home"==t)createPlayerInfoPanel(this._player);else{var a=this,n=i.getRoomData();n&&n.opts&&n.opts.gameType&&(cc.log("..gameType:"+n.opts.gameType),openPlayerInfoView(n.opts.gameType,function(e){if(e){var t=e.getComponent("uiRoomPlayerInfo");t&&t.onShow(a._player)}}))}},setIsOnline:function(e){cc.find("/Disconnect",this.node).active=!e},getLiuGuang:function(e){cc.find("liuguang",this.node).active=e},setCoin:function(e){var t=cc.find("coin",this.node),a="";0<e?(a="+"+e,t.color=new cc.Color(255,204,0)):e<0?(a=e,t.color=new cc.Color(0,255,246)):(a=e,t.color=new cc.Color(0,255,36)),t.getComponent(cc.Label).string=a},setGold:function(e,t){var a;t==o.GameType.Game_niu_niu?a=cc.find("coin",this.node):t==o.GameType.Game_Niu_Hundred&&(a=cc.find("labelNode/coin",this.node));var n="";null!=e&&(n=e);var i=0;i=null!=n?ConversionCoinValue(n,0):null,a.getComponent(cc.Label).string=i,a.color=new cc.Color(255,204,0)},setCoinShow:function(e){var t=this.nameLabel.node,a=cc.find("labelNode/coin",this.node);t.active=e||!e,a.active=e},setLabelNodePos:function(e,t){if(e){var a=cc.find("labelNode",this.node);a.y=t?-25:2}},showZhuangNumNode:function(e){this.zhuangBg.active=e},lianZhuangNum:function(e){cc.find("zhuangLabel",this.zhuangBg).getComponent("cc.Label").string="连庄剩余"+e+"次"}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],niuNiuPoker:[function(e,t,a){"use strict";cc._RF.push(t,"2fa4fCosKVEv7jGsGKPTf1v","niuNiuPoker"),cc.Class({extends:cc.Component,properties:{bgImg:cc.Sprite},onLoad:function(){this.isShow=!0,this.isTurn=!1,this.cardInfo=null},initCardInfo:function(e){this.cardInfo=e,this.updateUI()},updateUI:function(){var e=this.getSpriteNameByCardId()+".png",t=cc.textureCache.addImage(cc.url.raw("resources/niuNiuTable/poker/"+e));this.bgImg.spriteFrame=new cc.SpriteFrame(t)},initUI:function(){var e=cc.textureCache.addImage(cc.url.raw("resources/niuNiuTable/poker/0.png"));this.bgImg.spriteFrame=new cc.SpriteFrame(e)},clearCardsUI:function(){this.bgImg.spriteFrame=null},turnOver:function(e){void 0===e&&(e=!0),this.isTurn=e,this.updateUI()},getSpriteNameByCardId:function(){if(!this.cardInfo)return"0";if(!this.isTurn)return"0";var e=parseInt(this.cardInfo/100),t=16*(e-1);return this.cardInfo-100*e+t+""},showTipAction:function(){this.node.runAction(cc.moveBy(.2,cc.p(0,60)))}}),cc._RF.pop()},{}],niuNiuProcessResult:[function(e,t,a){"use strict";cc._RF.push(t,"10fe3lm22pL3YVVXlXP2zfU","niuNiuProcessResult");var d=e("roomHandler"),n=e("niuNiuHandler"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,resultNode:cc.Node,scoreNode:cc.Node,scoreContent:cc.Node,lastTimeLabel:cc.Label,fonts:{default:[],type:cc.Font}},onLoad:function(){},showUI:function(){var e=d.recordData;if(0!=e.length){this.scoreNode.removeAllChildren();var t=e[d.room.gameNum-1].score,a=0;for(var n in t)if(null!=t[n]){var i=cc.instantiate(this.scoreContent),o=d.getPlayerByUid(n),r=cc.find("headNode/headSp",i);this.showPlayerHead(r,o.headimgurl);var s=cc.find("name",i);s.getComponent("cc.Label").string=o.name.substring(0,4),n==GameData.player.uid?s.color=new cc.Color(172,234,111):s.color=new cc.Color(255,229,178);var c=cc.find("score",i);0<t[n]?(c.getComponent("cc.Label").string="+"+t[n],c.getComponent("cc.Label").font=this.fonts[0]):0==t[n]?(c.getComponent("cc.Label").string=t[n],c.getComponent("cc.Label").font=this.fonts[1]):t[n]<0&&(c.getComponent("cc.Label").string=t[n],c.getComponent("cc.Label").font=this.fonts[2]),i.y=-47*a,this.scoreNode.addChild(i),a++}this.getWinOrLose(t),this.handleCloseTimer(),sendEvent("onPrepareInfo",d.readyData)}},showPlayerHead:function(a,e){if(""!=e&&null!=e){cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=null,a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},getWinOrLose:function(e){var t=cc.find("win",this.resultNode),a=cc.find("ping",this.resultNode),n=cc.find("lose",this.resultNode);if(null!=e[GameData.player.uid]){var i=e[GameData.player.uid];0<i?(t.active=!0,a.active=!1,n.active=!1):0==i?(t.active=!1,a.active=!0,n.active=!1):i<0&&(t.active=!1,a.active=!1,n.active=!0)}},handleCloseTimer:function(){this.lastTimeLabel.string="(3)",this.lastTime=3,this.schedule(this.updateLastTime,1)},updateLastTime:function(){cc.log("this.lastTime = "+this.lastTime),this.lastTime--;var e="("+this.lastTime+")";this.lastTimeLabel.string=e,this.lastTime<=0&&(GameData.roomClose&&this.node.getComponent("niuNiuRoomMain").showSummaryLayer(),this.resultLayer.active=!1,sendEvent("onPrepareInfo",d.readyData),this.unschedule(this.updateLastTime))},readyClick:function(e){i.instance.playAudioOther("button"),GameData.roomClose?this.node.getComponent("niuNiuRoomMain").showSummaryLayer():(this.clearCard(),d.setReady()),this.resultLayer.active=!1,n.readyBtnActive=!0,sendEvent("onPrepareInfo",d.readyData),this.unschedule(this.updateLastTime)},clearCard:function(){cc.find("Canvas/layer_ui/layer_ui_table").getComponent("niuNiuRoomPlay").clearUI()}}),cc._RF.pop()},{SoundMngr:"SoundMngr",niuNiuHandler:"niuNiuHandler",roomHandler:"roomHandler"}],niuNiuResultRender:[function(e,t,a){"use strict";cc._RF.push(t,"608e741QaBD0YAqx6HDv3he","niuNiuResultRender");var c=e("roomHandler"),d=(e("niuNiuHandler"),e("niuniuPokerHandler"));cc.Class({extends:cc.Component,properties:{maxWinner:cc.Node,nameLbl:cc.Label,userIdLbl:cc.Label,niuNiuNumLbl:cc.Label,wuNiuNumLbl:cc.Label,winNumLbl:cc.Label,selfBgFrame:cc.Node,creatorIcon:cc.Node,headIcon:cc.Node,roomScoreLbl:cc.Label,fonts:[cc.Font],_playerInfo:null,infoNode:cc.Node},onLoad:function(){},initUI:function(){var e=this._playerInfo;JSON.stringify("结算玩家数据  "+JSON.stringify(e)),this.nameLbl.string=getShortStr(e.name,10),this.userIdLbl.string="ID "+e.uid,e.uid===GameData.player.uid?(this.nameLbl.node.color=new cc.Color(254,255,215),this.userIdLbl.node.color=new cc.Color(254,255,215)):(this.nameLbl.node.color=new cc.Color(210,172,111),this.userIdLbl.node.color=new cc.Color(210,172,111));var a=this;null!=e.headimgurl&&""!=e.headimgurl&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(a.headIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))});var t=c.scores[e.uid];0<t?(this.roomScoreLbl.string="+"+t,this.roomScoreLbl.node.color=new cc.Color(117,190,92)):t<0?(this.roomScoreLbl.string=t,this.roomScoreLbl.node.color=new cc.Color(255,92,92)):0==t&&(this.roomScoreLbl.string=t,this.roomScoreLbl.node.color=new cc.Color(235,224,129));(function(){var e=[];for(var t in c.scores)e.push(c.scores[t]);for(var a=0,n=1;n<e.length;n++)e[n]&&e[n]>e[a]&&(a=n);return e[a]})()==t&&(this.maxWinner.active=!0),this.creatorIcon.active=e.uid==c.room.creator},getActiveNode:function(){return this.infoNode},showTypeNum:function(e){var t=c.getRecordData(),a=0,n=0,i=0;if(t.length<=0);else for(var o=d.getPokerType(),r=0;r<t.length;r++){var s=t[r];0<s.score[e]&&i++,s.result[e]==o.NIU_NIU?a++:s.result[e]==o.NIU_NONE&&n++}this.niuNiuNumLbl.string=a,this.winNumLbl.string=i,this.wuNiuNumLbl.string=n},initData:function(e){this._playerInfo=e,this._playerInfo&&this.initUI()}}),cc._RF.pop()},{niuNiuHandler:"niuNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],niuNiuRoomDissolve:[function(e,t,a){"use strict";cc._RF.push(t,"7442760LSVGgqTqZJQ3C8Q/","niuNiuRoomDissolve");var r=e("roomHandler"),n=e("SoundMngr");e("niuNiuHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&(cc.log("GameData.game.onRoomDissolve = "+JSON.stringify(GameData.game.onRoomDissolve)),sendEvent("onRoomDissolve",GameData.game.onRoomDissolve)),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showHeaderConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showHeaderConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.opts.joinermax-1;e++){var t=e+1,a=cc.instantiate(this.headerNode);a.parent=this.headerNode.parent,a.name="header_"+(e+2),a.x=this.headerNode.x+t%6*170,a.y=this.headerNode.y-115*parseInt(t/6)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1;if(GameData.joiners[e]){var a=GameData.joiners[e];if(null!=a){var n=a.uid,i=a.headimgurl;this.showHeaderIcon(t,i),this.showHeaderName(t,a.name);var o=r.isPlayerOnline(n);cc.find("header_"+t+"/lost",this.headerNode.parent).active=!o}}else{cc.find("header_"+t,this.headerNode.parent).active=!1}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(e,t){var a=cc.find("header_"+e+"/headimg",this.headerNode.parent);null==t||""==t||t.length<=0?a.getComponent(cc.Sprite).spriteFrame=null:cc.loader.load({url:t,type:"png"},function(e,t){!e&&t&&(a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return NiuNiuMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n]){return"拒绝解散房间",0,cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showDissolveLayer(1,0),void this.handleSomebodyDisagree(n)}"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showDissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){r.deleteRoom(GameData.room.id,"apply"),cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){n.instance.playAudioOther("button"),r.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.instance.playAudioOther("button"),r.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(r.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}},showHeaderConnect:function(){for(var e=0;e<GameData.joiners.length;e++){var t=GameData.joiners[e].uid,a=r.isPlayerOnline(t),n=e+1;cc.find("header_"+n+"/lost",this.headerNode.parent).active=!a}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",niuNiuHandler:"niuNiuHandler",roomHandler:"roomHandler"}],niuNiuRoomMain:[function(e,t,a){"use strict";cc._RF.push(t,"bbc4d0azUhDcbfZWXIskv9w","niuNiuRoomMain");var n=e("SoundMngr"),i=e("gameDefine"),o=e("roomHandler"),r=e("ruleHandler"),s=e("niuNiuHandler"),c=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{dissolveLayer:cc.Node,dissolvePrefab:cc.Prefab,summaryLayer:cc.Node,summaryPrefab:cc.Prefab,debugLayer:cc.Node,debugPrefab:cc.Prefab,resultLayer:cc.Node,waitLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,quitRoomBtn:cc.Node},onLoad:function(){n.instance.playMusic("shisanshui/sound/sss_table_bg1"),this.initUIData(),this.initUIShow(),this.addUIDissolve(),this.addUISummary(),this.addUIDebug(),this.handlerMsg(),this.talkClick(),GameData.game.onRoomDissolve&&0<Object.keys(GameData.game.onRoomDissolve).length&&this.showDissolveLayer(1,1)},initUIData:function(){cc.log("...room main init data."),r.instance.setGameType(GameData.client.gameType),this.setCurGameData()},initUIShow:function(){this.resultLayer.active=!1,this.summaryLayer.active=!1,this.dissolveLayer.active=!1,this.showLayer()},addUIDissolve:function(){var e=this.dissolveLayer.getChildByName("uiDissolve");null==e&&((e=cc.instantiate(this.dissolvePrefab)).parent=this.dissolveLayer,e.name="uiDissolve",e.active=!0)},addUISummary:function(){var e=this.summaryLayer.getChildByName("uiSummary");null==e&&((e=cc.instantiate(this.summaryPrefab)).parent=this.summaryLayer,e.name="uiSummary")},addUIDebug:function(){var e=this.debugLayer.getChildByName("uiDebug");null==e&&((e=cc.instantiate(this.debugPrefab)).parent=this.debugLayer,e.name="uiDebug",e.active=!1)},RoomInfoHandler:function(e){null!=e&&(this.setCurGameData(),this.showLayer(),this.addUISummary())},setCurGameData:function(){o.getRoomData()},showLayer:function(){GameData.room.status>i.RoomState.WAIT||0<o.readyCountDown?this.showWaitLayer(!1):this.showWaitLayer(!0),o.room.opts.currencyType==i.currencyType.Currency_Coin?this.showCoinQuitRoomBtn():this.showCardsQuitRoomBtn()},showCardsQuitRoomBtn:function(){var e=o.playGame;null!=e[GameData.player.uid]&&(0==e[GameData.player.uid]?o.readyData[GameData.player.uid]&&0<o.readyCountDown?this.quitRoomBtn.active=!1:this.quitRoomBtn.active=!0:this.quitRoomBtn.active=!1)},showCoinQuitRoomBtn:function(){if(o.room.opts.currencyType==i.currencyType.Currency_Coin){null==o.readyData[GameData.player.uid]&&0<o.readyCountDown&&(s.readyBtnActive?this.quitRoomBtn.active=!1:this.quitRoomBtn.active=!0);var e=s.status,t=c.getGameStatus();e==t.WAIT||e==t.SETTLE?s.readyBtnActive||s.gameStart?this.quitRoomBtn.active=!1:this.quitRoomBtn.active=!0:s.spectator(GameData.player.uid)?this.quitRoomBtn.active=!0:this.quitRoomBtn.active=!1}},showWaitLayer:function(e){this.waitLayer.active=e},showSettingLayer:function(e,t){n.instance.playAudioOther("button"),openView("niuniu_settingPrefab",i.GameType.Game_niu_niu)},showResultLayer:function(){s.spectator(GameData.player.uid)},showResultDirectly:function(){this.resultLayer.active=!0,this.waitLayer.active=!1,this.node.getComponent("niuNiuProcessResult").showUI()},registShowDisLayer:function(){this.showDissolveLayer(1,1)},showDissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.getChildByName("uiSummary").getComponent("niuNiuRoomResult").initUI(),this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})},showDebugLayer:function(){var e=this.debugLayer.getChildByName("uiDebug");e&&(e.active=!0)},showChat:function(){inCD(2e3)||(n.instance.playAudioOther("button"),openView("NiuNiuChatPanel",i.GameType.Game_niu_niu))},talkClick:function(){var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),n.instance.playAudioOther("button"),inCD(2e3)||(yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>2*this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()})},handlerMsg:function(){registEvent("onRoomInfo",this,this.RoomInfoHandler),registEvent("onPrepareInfo",this,this.showLayer),registEvent("douniu-onGameStart",this,this.showLayer),registEvent("douniu-onGameEnd",this,this.showResultLayer),registEvent("douniu-onGameInfo",this,this.showQuitRoomBtn),registEvent("onRoomDissolve",this,this.registShowDisLayer)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.RoomInfoHandler),unregistEvent("onPrepareInfo",this,this.showLayer),unregistEvent("douniu-onGameStart",this,this.showLayer),unregistEvent("douniu-onGameEnd",this,this.showResultLayer),unregistEvent("douniu-onGameInfo",this,this.showQuitRoomBtn),unregistEvent("onRoomDissolve",this,this.registShowDisLayer),this.unscheduleAllCallbacks(),s.initAllData(),GameData.initGameData()}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",niuNiuHandler:"niuNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],niuNiuRoomPlay:[function(e,t,a){"use strict";cc._RF.push(t,"d98c8dMnY1Pz7eK60Bqj6qv","niuNiuRoomPlay");var m=e("SoundMngr"),p=e("roomHandler"),g=e("niuNiuHandler"),l=e("gameDefine"),n=e("configMgr"),d=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{tableNode:{default:null,type:cc.Node},coinNode:{default:null,type:cc.Node},qiangzhuangNode:cc.Node,multipleNode:cc.Node,otherHandCardNode:cc.Node,selfHandCardNode:cc.Node,adviseBtn:cc.Node,sendBtn:cc.Node,actionNode:cc.Node,selfPokerTypePrefab:cc.Prefab,otherPokerTypePrefab:cc.Prefab,betSp:cc.Sprite,pinNiuSp:cc.Sprite,qiangzhuangSp:cc.Sprite,playerHeads:[cc.Node],scoreNode:cc.Prefab,scoreParent:cc.Node,lastTimeLabel:cc.Label,debugBtn:cc.Node,spectatorNode:cc.Node,randomNode:cc.Node,dingzhuangNode:cc.Node,winPlayerNode:cc.Node},onLoad:function(){this.debugBtn.active=n.getSetCardsOpen(),this.handlerMsg(),this.coinFlyData(),this.initNodeActive(),this.getCardsPosition(),this._selfHandCards=[],this._selfHandCardInitialPos=[];for(var e=cc.find("/handCard",this.selfHandCardNode),t=0;t<e.childrenCount;t++)this._selfHandCardInitialPos.push(e.children[t].getPosition());this.initUI()},initNodeActive:function(){this.qiangzhuangSp.node.active=!1,this.pinNiuSp.node.active=!1,this.betSp.node.active=!1,this.qiangzhuangNode.active=!1,this.otherHandCardNode.active=!1,this.selfHandCardNode.active=!1,this.multipleNode.active=!1,this.adviseBtn.active=!1,this.sendBtn.active=!1,this.niuniuStayType=d.getGameStatus(),this.niuniuPokerType=d.getPokerType()},getCardsPosition:function(){this.handCardsInitialPos=[];for(var e=0;e<this.otherHandCardNode.children.length;e++)this.handCardsInitialPos.splice(e+1,0,this.otherHandCardNode.children[e].getPosition());var t=this.selfHandCardNode.getChildByName("handCardDis");this.handCardsInitialPos.splice(0,0,t.getPosition())},coinFlyData:function(){this._coinIndex=0,this._coinList=[],this._coinCount=8,this._winnerIndex=0,this._isLoserClear=!0,this._isWinnerClear=!0,this._winnerToLoser={winner:[],loser:[]}},initUI:function(){this.playAudio=!1;var e=GameData.room;if(e&&""!=e.id){var t=e.status;if(this.qiangzhuangNode.active=!1,this.otherHandCardNode.active=!1,this.selfHandCardNode.active=!1,1==g.isStartAnimationPlayed){if(t<l.RoomState.GAMEING&&g.status!=this.niuniuStayType.SETTLE)return void this.handleGameStart();g.isStartAnimationPlayed=!1}this.showHandCards(),g.status<this.niuniuStayType.CHIPS&&this.showGetZhuangUI(),this.getGameInfo()}},initPokerType:function(){for(var e=GameData.joiners,t=0;t<p.room.opts.joinermax;t++){for(var a=cc.find("/act"+t,this.actionNode),n=0;n<e.length;n++)if(null==e[n]){p.getLocalPosition(n)==t&&a&&a.removeAllChildren()}else{var i=e[n].uid;p.getLocalPosition(n)===t&&g.spectator(i)&&a&&a.removeAllChildren()}t>=e.length&&a&&a.removeAllChildren()}},clearUI:function(){if(this.zhuangId=0,this.playAudio=!1,this.isclick=void 0,this.showpokers=void 0,this.initNodeActive(),0<this._coinList.length)for(var e=0;e<this._coinList.length;e++)this._coinList[e].active=!1,this.tableNode.removeChild(this._coinList[e]);this.coinFlyData();for(e=0;e<p.room.opts.joinermax;e++){var t=cc.find("/act"+e,this.actionNode);t&&t.removeAllChildren()}var a=GameData.joiners;for(e=0;e<a.length;e++)if(null!=a[e]){a[e].uid;var n=p.getLocalPosition(e);if(0!=n)for(i=this.otherHandCardNode.getChildByName("handCard"+n),o=0;o<i.children.length;o++){i.children[o].getComponent("niuNiuPoker").initUI()}else for(var i=this.selfHandCardNode.getChildByName("handCardDis"),o=0;o<i.children.length;o++){i.children[o].getComponent("niuNiuPoker").initUI()}}g.initRoundData(),this.unschedule(this.loserCoinAnimation),this.unschedule(this.winnerAllIsPlayer)},getGameInfo:function(){this.handleGameStart();var e=g.status,t=[];e>this.niuniuStayType.WAIT&&e<=this.niuniuStayType.SETTLE&&(e>this.niuniuStayType.ZHUANG&&(t=g.getZhuangMaxArray(),this.zhuangId!=g.zhuangUid&&e==this.niuniuStayType.CHIPS?2<=t.length?this.randomZhuangUI(t):(this.dingzhuangAnimation(),this.showBetUI(),this.zhuangId=g.zhuangUid):this.showBetUI(),e>=this.niuniuStayType.COMPARE&&this.showDisCardUI(),this.showGetZhuangUI()),this.showHandCards()),this.statusSign=g.status,this.showHintImg()},handleGameStart:function(){if(this.statusSign!=g.status&&g.status==this.niuniuStayType.ZHUANG){m.instance.playNiuNiuAudio(-1),this.actionNode.active=!0;var e=cc.find("/actGameStart",this.actionNode);e.active=!0,e.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);for(var t=cc.find("/handCard",this.selfHandCardNode),a=0;a<t.childrenCount;a++)t.children[a].position=this._selfHandCardInitialPos[a];var n=this;this.scheduleOnce(function(){e.active=!1,n.initUI()},1.5)}},randomZhuangUI:function(e){this.zhuangId=g.zhuangUid,this.zhuangPos=[];for(var t=0;t<e.length;t++){var a=e[t],n=p.getPlayerPosByUid(a),i=p.getLocalPosition(n),o=this.playerHeads[i];null!=o&&this.zhuangPos.splice(i,0,{uid:a,pos:o.getPosition()})}for(var r=0;r<this.zhuangPos.length;r++)null!=this.zhuangPos[r]&&null!=this.zhuangPos[r]||(this.zhuangPos.splice(r,1),r--);this.makeSureZhuangTimer()},makeSureZhuangTimer:function(){this.surplus=1,this.zhuangSign=0,this.updateRandomZhuangPos(),this.schedule(this.updateRandomZhuangPos,.09)},updateRandomZhuangPos:function(){this.surplus-=.09,this.randomNode.active=!0,m.instance.playNiuNiuAudio(-6);var e=this.zhuangPos[this.zhuangSign].uid,t=p.getPlayerPosByUid(e),a=p.getLocalPosition(t),n=this.zhuangPos[this.zhuangSign].pos;this.randomNode.x=n.x,this.randomNode.y=n.y,0==a?(this.randomNode.scaleX=1,this.randomNode.scaleY=1):(this.randomNode.scaleX=.62,this.randomNode.scaleY=.62),this.zhuangSign++,this.zhuangSign>=this.zhuangPos.length&&(this.zhuangSign=0),this.surplus<=0&&(this.randomNode.x=n.x,this.randomNode.y=n.y,this.randomNode.active=!1,this.zhuangSign=0,this.dingzhuangAnimation(),this.showBetUI(),this.unschedule(this.updateRandomZhuangPos))},dingzhuangAnimation:function(){var e=p.getPlayerPosByUid(g.zhuangUid),t=p.getLocalPosition(e);m.instance.playNiuNiuAudio(-7);var a=this.playerHeads[t];this.dingzhuangNode.position=a.getPosition(),this.dingzhuangNode.scale=0==t?1:.62;var n=cc.find("zhuangAc",this.dingzhuangNode);this.dingzhuangNode.active=!0,this.dingzhuangNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",0),n.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);var i=this;this.scheduleOnce(function(){i.dingzhuangNode.active=!1,i.showZhuangUI()},1.5)},showZhuangUI:function(){this.clearZhuangUI();for(var e=GameData.joiners,t=0;t<e.length;t++){var a=e[t];if(null!=a){var n=p.getLocalPosition(t),i=this.playerHeads[n].getChildByName("TableNiuNiuPlayerTemplate").getComponent("niuNiuPlayerInfo"),o=a.uid==g.zhuangUid;i.showZhuang(o),i.getLiuGuang(o);var r=this.playerHeads[n].getChildByName("numQiang");if(g.status>this.niuniuStayType.ZHUANG&&g.zhuangUid!=a.uid)for(var s=0;s<r.childrenCount;s++)r.children[s].active=!1}}},clearZhuangUI:function(){for(var e=0;e<this.playerHeads.length;e++){var t=this.playerHeads[e].getChildByName("TableNiuNiuPlayerTemplate").getComponent("niuNiuPlayerInfo");t.showZhuang(!1),t.getLiuGuang(!1)}},showGetZhuangUI:function(){for(var e=0;e<this.qiangzhuangNode.childrenCount;e++){(n=this.qiangzhuangNode.children[e].getComponent("cc.Button")).interactable=!0}if(p.room.opts.currencyType==l.currencyType.Currency_Coin)for(var t=p.getPlayerByUid(GameData.player.uid).coin,a=0;a<this.qiangzhuangNode.childrenCount;a++)if(0!=a){var n=this.qiangzhuangNode.children[a].getComponent("cc.Button"),i=p.room.opts.scorelv,o=getMatchCostTableFinal(l.GameType.Game_niu_niu,i)*(GameData.joiners.length-1)*2*3*a;n.interactable=o<=t}-1==g.playerZhuang[GameData.player.uid]?this.qiangzhuangNode.active=!0:this.qiangzhuangNode.active=!1},showBetUI:function(){if(-1===g.playerChips[GameData.player.uid]&&g.zhuangUid!=GameData.player.uid){var e=p.room.opts.multipleType;this.multipleNode.getChildByName("multipleType"+e).active=!0,this.multipleNode.active=!0}else this.multipleNode.active=!1},showDisCardUI:function(){if(!g.spectator(GameData.player.uid)){var e=!1,t=g.playerSendCard;cc.find("act0",this.actionNode);0<Object.keys(t).length&&(g.status===this.niuniuStayType.COMPARE?t[GameData.player.uid]||this.showpokers||(e=!0):e=!1),1==e&&1==this.isclick?this.adviseBtn.active=!1:this.adviseBtn.active=e,this.sendBtn.active=e}},showHandCards:function(){if(l.currencyType.Currency_Coin==p.room.opts.currencyType||!(g.status<this.niuniuStayType.ZHUANG||g.status>this.niuniuStayType.COMPARE)||!p.readyData[GameData.player.uid]){var e=GameData.joiners;if(e&&0!=e.length&&null!=e){this.otherHandCardNode.active=!0;for(var t=0;t<this.otherHandCardNode.children.length;t++)this.otherHandCardNode.children[t].active=!1;var a=g.zhuangUid,n=g.playerCards;for(t=0;t<e.length;t++)if(null!=e[t]){var i=e[t].uid,o=p.getLocalPosition(t);if(i==GameData.player.uid)this.showSelfHandCards(n[GameData.player.uid],0);else{g.status>this.niuniuStayType.WAIT&&g.status<this.niuniuStayType.COMPARE&&delete n[i];if(!n[i]||n[i]&&0==n[i].length)this.showOthersHandCards(i,o,null,!0);else if(n[i]&&0<n[i].length){var r=this.showPokerForm(i,n[i],!0);i==a?this.showZhuangCards(o,r.newHandCards,r.cardPos):this.showOthersHandCards(i,o,r.newHandCards,r.cardPos);cc.find("act"+o,this.actionNode);5==n[i].length&&i!=a&&this.playCardType(i,o)}}}g.readyBtnActive||this.initScore(),this.initPokerType()}}},showSelfHandCards:function(e,t){this._selfHandCards=[];for(var a=0;a<this.selfHandCardNode.childrenCount;a++)this.selfHandCardNode.children[a].active=!1;this.selfHandCardNode.active=!1;var n,i=g.status,o=g.playerSendCard[GameData.player.uid];if(0==t?n=o||i==this.niuniuStayType.SETTLE||0==i?"handCardDis":"handCard":1==t&&(n="handCardDis"),GameData.player.uid==g.zhuangUid&&this.showpokers&&(n="handCardDis"),g.spectator(GameData.player.uid))this.selfHandCardNode.active=!1;else{this.selfHandCardNode.active=!0;var r=this.selfHandCardNode.getChildByName(n);if(r)if(r.active=!0,"handCardDis"==n){var s=this.showPokerForm(GameData.player.uid,e,!0);s.cardPos?r.x=this.handCardsInitialPos[0].x+20:r.x=this.handCardsInitialPos[0].x,this.showEveryCards(r,s.newHandCards)}else this.showEveryCards(r,e);0==cc.find("act0",this.actionNode).childrenCount&&"handCardDis"==n&&(this.playCardType(GameData.player.uid,0),GameData.player.uid==g.zhuangUid&&!this.showpokers&&i>this.niuniuStayType.WAIT&&this.playCardAudio(GameData.player.uid))}},showOthersHandCards:function(e,t,a,n){var i=this.otherHandCardNode.getChildByName("handCard"+t);i.x=n?this.handCardsInitialPos[t].x+12:this.handCardsInitialPos[t].x,g.spectator(e)?i.active=!1:i.active=!0,this.showEveryCards(i,a)},showZhuangCards:function(e,t,a){var n=this.otherHandCardNode.getChildByName("handCard"+e);n.active=!0;var i=this;setTimeout(function(){(g.status<i.niuniuStayType.ZHUANG||g.status>i.niuniuStayType.COMPARE)&&Object.keys(g.playerCards)<=0||(n.x=a?i.handCardsInitialPos[e].x+12:i.handCardsInitialPos[e].x,i.showEveryCards(n,t),i.playCardType(g.zhuangUid,e),i.playAudio||(i.playAudio=!0,i.playCardAudio(g.zhuangUid)))},1e3)},showEveryCards:function(e,t){for(var a=0;a<e.children.length;a++){var n=e.children[a].getComponent("niuNiuPoker");null==t||null==t[a]?5==a?n.clearCardsUI():n.initCardInfo(null):0==t[a]?n.clearCardsUI():(n.turnOver(),n.initCardInfo(t[a]),"handCard"==e.name&&5==t.length&&this._selfHandCards.push(n))}},showPokerForm:function(e,t,a){var n=[];g.playerCard3[e]&&(n=g.playerCard3[e]);var i=n.concat(t),o=d.unequally(i),r=g.recordType[e];return r>this.niuniuPokerType.NIU_NONE&&r<this.niuniuPokerType.NIU_NIU?(o.splice(3,0,0),a=!1):(o.splice(5,0,0),a=!0),{newHandCards:o,cardPos:a}},onReadyBtnClick:function(){m.instance.playAudioOther("button"),this.clearUI(),this.spectatorNode.active=!1;var e=this.qiangzhuangSp.node.parent;(cc.find("actionAnimations/readyBtn",e).active=!1,GameData.roomClose)?cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showSummaryLayer():p.setReady()},onAdviseBtnClick:function(e,t){var a=d.getPokerStar();m.instance.playAudioOther("button");var n=0,i=[];g.isSelfClickAdviseBtn=!0,g.recordType[GameData.player.uid]&&(n=g.recordType[GameData.player.uid]),g.playerCard3[GameData.player.uid]&&(i=g.playerCard3[GameData.player.uid]),this.actionNode.active=!0;this.actionNode.getChildByName("act0");for(var o in this.niuniuPokerType)this.niuniuPokerType[o]==n&&niuniuCreateMoveMessage(a[o]);if(0<i.length&&n<=this.niuniuPokerType.NIU_Nine)for(var r=0;r<this._selfHandCards.length;r++)for(var s=this._selfHandCards[r],c=0;c<i.length;c++)s.cardInfo&&s.cardInfo==i[c]&&s.showTipAction();this.isclick=!0,e.target.active=!1},onBetBtnClick:function(e,t){m.instance.playAudioOther("button");0==g.requestChips(t)&&this.showBetUI()},onSendBtnClick:function(){m.instance.playAudioOther("button");var t=this;if(this.showpokers=!0,GameData.player.uid==g.zhuangUid){var e=g.playerCards[GameData.player.uid];this.showSelfHandCards(e,1),this.playCardType(GameData.player.uid,0),this.playCardAudio(GameData.player.uid),this.adviseBtn.active=!1,this.sendBtn.active=!1}else GameNet.getInstance().request("room.niuNiuHandler.setShow",{},function(e){0==e.result&&(t.adviseBtn.active=!1,t.sendBtn.active=!1)})},clickGetZhuang:function(e,t){m.instance.playAudioOther("button");var a=t;this.qiangzhuangNode.active=!1,g.requestZhuang(a)},getShowActiveAudio:function(e){if(e){var t=e.detail.uid,a=p.getPlayerPosByUid(t),n=p.getLocalPosition(a);g.playerCards[t];t!=g.zhuangUid&&(this.playCardType(t,n),this.playCardAudio(t))}},playCardType:function(e,t){p.getPlayerByUid(e);var a=null;if(g.recordType&&(a=g.recordType[e]),null!=a){var n=cc.find("act"+t,this.actionNode);n.removeAllChildren();var i=0==t?this.selfPokerTypePrefab:this.otherPokerTypePrefab;i=cc.instantiate(i),n.addChild(i),i.getComponent("pokerTypeAnimation").initFanInfo(a,0)}},playCardAudio:function(e){var t=p.getPlayerByUid(e),a=null;g.recordType&&(a=g.recordType[e]),g.status>this.niuniuStayType.WAIT&&g.status<this.niuniuStayType.COMPARE||null!=a&&(cc.log("record = "+a),m.instance.playNiuNiuAudio(a,t.sex))},handleCloseTimer:function(){0!=g.gameTimes&&(this.unschedule(this.updateCountDown),cc.log("niuNiuHandler.status = "+g.status),cc.log("niuNiuHandler.gameTimes = "+g.gameTimes),g.status<this.niuniuStayType.ZHUANG||g.status>this.niuniuStayType.COMPARE?g.gameTimes=0:(cc.log("start game count: countTime = "+g.gameTimes),this.updateCountDown(),this.schedule(this.updateCountDown,1)))},updateCountDown:function(){return g.gameTimes--,cc.log("run game count: countTime = "+g.gameTimes),g.status<this.niuniuStayType.ZHUANG||g.status>this.niuniuStayType.COMPARE?(g.gameTimes=0,void this.unschedule(this.updateCountDown)):(g.status==this.niuniuStayType.ZHUANG&&g.isStartAnimationPlayed?this.lastTimeLabel.node.active=!1:this.lastTimeLabel.node.active=!0,this.lastTimeLabel.string=g.gameTimes,g.gameTimes<=0?(g.gameTimes=0,this.lastTimeLabel.node.active=!1,void this.unschedule(this.updateCountDown)):void 0)},showHintImg:function(){g.playerZhuang,g.playerChips;if(g.status==this.niuniuStayType.ZHUANG&&0==g.isStartAnimationPlayed){var e="resources/niuNiuTable/artword/qingqiangzhuang.png",t=cc.textureCache.addImage(cc.url.raw(e));this.qiangzhuangSp.spriteFrame=new cc.SpriteFrame(t),this.qiangzhuangSp.node.active=!0,this.betSp.node.active=!1,this.pinNiuSp.node.active=!1}else if(g.status==this.niuniuStayType.CHIPS){e="";e=g.zhuangUid==GameData.player.uid?"resources/niuNiuTable/artword/dengdaixiazhuzi.png":"resources/niuNiuTable/artword/xianjiaxiazhu.png";t=cc.textureCache.addImage(cc.url.raw(e));this.betSp.spriteFrame=new cc.SpriteFrame(t),this.betSp.node.active=!0,this.qiangzhuangSp.node.active=!1,this.pinNiuSp.node.active=!1}else g.status==this.niuniuStayType.COMPARE?(this.pinNiuSp.node.active=!0,this.betSp.node.active=!1,this.qiangzhuangSp.node.active=!1):g.status==this.niuniuStayType.SETTLE&&(this.pinNiuSp.node.active=!1,this.betSp.node.active=!1,this.qiangzhuangSp.node.active=!1);this.showReadyImg(),this.handleCloseTimer()},showReadyImg:function(){var e=this.pinNiuSp.node.parent,t=cc.find("waitstart",e),a=cc.find("pleaseReady",e),n=p.readyData;p.room.status==l.RoomState.WAIT||p.room.status==l.RoomState.READY?0<p.readyCountDown?(g.readyBtnActive?t.active=!1:t.active=!0,this.clearZhuangUI(),a.active=!1):p.room.status!=l.RoomState.READY||n[GameData.player.uid]||(a.active=!0):(a.active=!1,t.active=!1),g.status>=this.niuniuStayType.ZHUANG&&g.status<this.niuniuStayType.SETTLE&&(t.active=!1,a.active=!1),g.status>this.niuniuStayType.WAIT&&g.status<=this.niuniuStayType.SETTLE&&g.spectator(GameData.player.uid)?n[GameData.player.uid]?this.spectatorNode.active=!1:this.spectatorNode.active=!0:this.spectatorNode.active=!1,this.surplus<=0&&this.showZhuangUI()},handleRunEnd:function(){g.readyBtnActive=!0;var e=this.qiangzhuangSp.node.parent;cc.find("actionAnimations/readyBtn",e).active=!1,cc.find("pleaseReady",e).active=!1;var t=this;this.scheduleOnce(function(){t.showClearAnimation()},1.5)},moveScoreActive:function(){this.moveAboutScore();var e=this;this.scheduleOnce(function(){if(e.initScore(),g.readyBtnActive=!1,GameData.roomClose)cc.find("Canvas/layer_ui").parent.getComponent("niuNiuRoomMain").showSummaryLayer();else if(sendEvent("onPrepareInfo",p.readyData),g.zhuangUid=0,l.currencyType.Currency_Coin==p.room.opts.currencyType&&checkOpenUISuccour(p.room.opts.gameType,p.room.opts.scorelv))return},1)},moveAboutScore:function(){for(var t=this,e=GameData.joiners,a=0;a<e.length;a++)if(null!=e[a]){var n=e[a],i=p.getLocalPosition(a),o=g.playerScore[n.uid],r=t.scoreParent.getChildByName("score"+i),s=r.getChildByName("resultScore");if(null==s){if(s=cc.instantiate(t.scoreNode),l.currencyType.Currency_Coin==p.room.opts.currencyType){var c=p.room.opts.scorelv,d=getMatchCostTableFinal(l.GameType.Game_niu_niu,c);s.getComponent("resultRunScore").getScoreColor(o*d)}else s.getComponent("resultRunScore").getScoreColor(o);s.active=!0,r.addChild(s),0<o&&this.winnerAnimation(i)}var h=cc.moveBy(1,cc.p(0,60));s.runAction(h)}this.scheduleOnce(function(){for(var e=0;e<t.scoreParent.children.length;e++)t.scoreParent.children[e].removeAllChildren()},1)},initScore:function(){for(var e=GameData.joiners,t=0;t<e.length;t++){var a=e[t];if(null!=a){var n=p.getLocalPosition(t),i=this.playerHeads[n].getChildByName("TableNiuNiuPlayerTemplate").getComponent("niuNiuPlayerInfo"),o=p.scores[a.uid];l.currencyType.Currency_Coin==p.room.opts.currencyType?i.setGold(a.coin,l.GameType.Game_niu_niu):i.setCoin(o)}}this.surplus<=0&&this.showZhuangUI()},winnerAnimation:function(e){var t=cc.find("action"+e,this.winPlayerNode);t.active=!0,t.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);this.scheduleOnce(function(){t.active=!1},1.5)},showClearAnimation:function(){WriteLog("showClearAnimation"),this.confirmWinnerOrLoser(),0<this._winnerToLoser.loser.length?this.loserJetton():0<this._winnerToLoser.winner.length&&this.flyToPlayer()},confirmWinnerOrLoser:function(){d.clearArray(this._winnerToLoser.winner),d.clearArray(this._winnerToLoser.loser);var e=g.playerScore;for(var t in e)t!=g.zhuangUid&&(0<e[t]?this._winnerToLoser.winner.push({uid:t,score:e[t]}):this._winnerToLoser.loser.push({uid:t,score:e[t]}))},winnerCoinCount:function(){var e=this._coinCount*this._winnerToLoser.winner.length;return Math.floor(e/this._winnerToLoser.winner.length)},createCoinNode:function(e){var t;this.tableNode.getChildByName("coinNode"+e)?t=this.tableNode.getChildByName("coinNode"+e):((t=cc.instantiate(this.coinNode)).name="coinNode"+e,this.tableNode.addChild(t)),t.active=!0,this._coinList.push(t);return g.setTexture("resources/niuNiuTable/result/jinbiniuniu.png",t),t},flyToPlayer:function(){this._coinIndex=0,this.schedule(this.winnerAllIsPlayer,.05)},loserJetton:function(){this._coinIndex=0,this.schedule(this.loserCoinAnimation,.05)},loserCoinAnimation:function(){var t=this,e=p.getPlayerPosByUid(g.zhuangUid),a=p.getLocalPosition(e);m.instance.playNiuNiuAudio(-5);for(var n=0;n<this._winnerToLoser.loser.length;n++){var i,o=this._coinIndex+1;i=this.createCoinNode(o);var r=p.getPlayerPosByUid(this._winnerToLoser.loser[n].uid),s=p.getLocalPosition(r),c=this.playerHeads[s];i.setPosition(c.getPosition());var d=this.playerHeads[a].x+g.randomNum(-50,50),h=this.playerHeads[a].y+g.randomNum(-20,50),l=cc.moveTo(.25,cc.p(d,h));i.runAction(l).easing(cc.easeCubicActionOut()),this._coinIndex++}this._coinIndex>=this._coinCount*this._winnerToLoser.loser.length&&(this.unschedule(this.loserCoinAnimation),this.scheduleOnce(function(){for(var e=0;e<t._coinList.length;e++)t._coinList[e].active=!1,t.tableNode.removeChild(t._coinList[e])},.5),0<this._winnerToLoser.winner.length?this.winnerAction():this.scheduleOnce(function(){t.moveScoreActive()},.5))},winnerAction:function(){var e=cc.delayTime(1),t=this,a=cc.callFunc(function(){t.winnerCoin()},this),n=cc.sequence(e,a);this.node.runAction(n)},winnerCoin:function(){this._coinIndex=0,this.schedule(this.winnerAllIsPlayer,.05)},winnerAllIsPlayer:function(){var r,s=this,e=this._winnerToLoser.winner.length-1,t=p.getPlayerPosByUid(g.zhuangUid),a=p.getLocalPosition(t),n=this.playerHeads[a];m.instance.playNiuNiuAudio(-5);for(var i=0;i<this._winnerToLoser.winner.length;i++){var c,o=this._coinIndex+1,d=this.createCoinNode(o);d.setPosition(n.getPosition());var h=function(e){var t=p.getPlayerPosByUid(s._winnerToLoser.winner[s._winnerIndex].uid),a=p.getLocalPosition(t),n=s.playerHeads[a],i=n.getPosition().x+g.randomNum(-50,50),o=n.getPosition().y+g.randomNum(-20,50);c=cc.moveTo(.25,cc.p(i,o)),r=cc.callFunc(function(){s._coinList[e-1].active=!1,s.tableNode.removeChild(s._coinList[e-1])},this)};o<=this.winnerCoinCount()*(this._winnerIndex+1)&&this._winnerIndex<e?h(o):o>this.winnerCoinCount()*(this._winnerIndex+1)&&this._winnerIndex<e?(this._winnerIndex++,h(o)):this._winnerIndex==e&&h(o);var l=cc.fadeOut(.4),u=cc.sequence(c,l,r);d.runAction(u).easing(cc.easeCubicActionOut()),this._coinIndex++}this._coinIndex>=this._coinCount*this._winnerToLoser.winner.length&&(this.unschedule(this.winnerAllIsPlayer),this.scheduleOnce(function(){s.moveScoreActive()},.5))},handlerMsg:function(){registEvent("onRoomInfo",this,this.showHandCards),registEvent("onJoinerConnect",this,this.initScore),registEvent("onPrepareInfo",this,this.showReadyImg),registEvent("douniu-onGameEnd",this,this.handleRunEnd),registEvent("douniu-onGameInfo",this,this.getGameInfo),registEvent("douniu-onGameCards",this,this.showHandCards),registEvent("douniu-onGameStart",this,this.clearUI),registEvent("douniu-onShowCards",this,this.getShowActiveAudio)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showHandCards),unregistEvent("onJoinerConnect",this,this.initScore),unregistEvent("onPrepareInfo",this,this.showReadyImg),unregistEvent("douniu-onGameEnd",this,this.handleRunEnd),unregistEvent("douniu-onGameInfo",this,this.getGameInfo),unregistEvent("douniu-onGameCards",this,this.showHandCards),unregistEvent("douniu-onGameStart",this,this.clearUI),unregistEvent("douniu-onShowCards",this,this.getShowActiveAudio)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",niuNiuHandler:"niuNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],niuNiuRoomResult:[function(e,t,a){"use strict";cc._RF.push(t,"35caaumai5K4o60hj7YoXgb","niuNiuRoomResult");e("niuNiuHandler");var i=e("roomHandler"),n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{playerRender:cc.Prefab,content:cc.Node,panel:cc.Node,dengguang:cc.Node},onLoad:function(){this.handlerMsg(),this.dengguang.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",0),GameData.game.close&&(cc.log("initUI"),this.initUI())},initUI:function(){this._roomInfo=i.room,this.showTime(this._roomInfo.createtime,this._roomInfo.id),this.content.removeAllChildren();for(var e=GameData.joiners,t=0;t<e.length;t++){(n=cc.instantiate(this.playerRender)).x=t%3*440-560,n.y=165.25-111*parseInt(t/3),this.content.addChild(n)}var a=this.content.children;for(t=0;t<a.length;t++){var n;(n=a[t]).getComponent("niuNiuResultRender").initData(e[t]),n.getComponent("niuNiuResultRender").getActiveNode().active=!0}},showTime:function(e,t){var a=cc.find("roomID",this.panel),n=cc.find("date",this.panel),i=cc.find("time",this.panel),o=new Date(e),r=o.getFullYear(),s=o.getMonth()+1,c=o.getDate(),d=o.getHours();d<10?d="0"+d+":":d+=":";var h=o.getMinutes();h<10?h="0"+h+":":h+=":";var l=o.getSeconds();l=l<10?"0"+l:l,a.getComponent("cc.Label").string="房号 : "+t,n.getComponent("cc.Label").string=r+"-"+s+"-"+c,i.getComponent("cc.Label").string=d+h+l},btnBackOnClicked:function(e){n.instance.playAudioOther("button"),GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){n.instance.playAudioOther("button"),inCD(3e3)||screenShoot(wxShareTexture)},handlerMsg:function(){registEvent("onRoomClose",this,this.initUI)},onDestroy:function(){unregistEvent("onRoomClose",this,this.initUI)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",niuNiuHandler:"niuNiuHandler",roomHandler:"roomHandler"}],niuNiuRoomWait:[function(e,t,a){"use strict";cc._RF.push(t,"44420jvMHxDdKpe2EwjiVZQ","niuNiuRoomWait");var v=e("SoundMngr"),d=e("gameDefine"),n=e("configMgr"),C=e("roomHandler"),h=e("niuNiuHandler"),i=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{roomId:cc.Label,roomTitle:cc.Node,bossType:cc.Label,roundInfo:cc.Label,scoreBase:cc.Label,playerHeads:[cc.Node],readyNode:cc.Node,wifiNode:cc.Node,playerTemplate:cc.Prefab,btnReady:cc.Node,btnStart:cc.Node,quitRoomBtn:cc.Node,unStartLayer:cc.Node,playintrNode:cc.Node,lastTimeLabel:cc.Label,resultLayer:cc.Node,costTips:cc.Node,dragonBonesNode:cc.Prefab},onLoad:function(){this.headers=new Array,this.handlerMsg(),this.initUi(),this.addDynAnimation()},handlerMsg:function(){registEvent("dynChat",this,this.dynChatHandler),registEvent("onRoomInfo",this,this.initPlayers),registEvent("douniu-onGameStart",this,this.initUi),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("onPrepareInfo",this,this.initReadyInfo),registEvent("onJoinerConnect",this,this.initPlayers),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("onJoinerLost",this,this.handleJoinerLost),registEvent("alertLottery",this,this.openLotteryPanel),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("douniu-onGameInfo",this,this.showPlayerRoundInfo)},onDestroy:function(){unregistEvent("dynChat",this,this.dynChatHandler),unregistEvent("onRoomInfo",this,this.initPlayers),unregistEvent("douniu-onGameStart",this,this.initUi),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("onPrepareInfo",this,this.initReadyInfo),unregistEvent("onJoinerConnect",this,this.initPlayers),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("onJoinerLost",this,this.handleJoinerLost),unregistEvent("alertLottery",this,this.openLotteryPanel),unregistEvent("yunwaUploaded",this,this.onYunwaUploaded),unregistEvent("douniu-onGameInfo",this,this.showPlayerRoundInfo),this.unschedule(this.updateLastTime)},initUi:function(){this.readyNode.active=!1,this.btnStart.active=!1,this.costTips.active=!1,this.TipsFlag=!0,this.gamestatus=h.status,this.niuniuGameStatus=i.getGameStatus();var e=C.room;this.initPlayers(),this.unStartLayer.active=e.status==d.RoomState.WAIT},showRuleUI:function(){var e=C.room,t=0;if(C.room.opts.currencyType==d.currencyType.Currency_Coin){t=81,this.bossType.string="",this.roundInfo.string="";var a=e.gameNum+1;1==a.toString().length?a="000"+a:2==a.toString().length?a="00"+a:3==a.toString().length?a="0"+a:4==a.toString().length&&(a=a),this.roomId.string=a+e.id,this.roomId.node.x=-118;var n=C.room.opts.scorelv,i=getMatchCostTableFinal(d.GameType.Game_niu_niu,n);this.scoreBase.string="底分: "+i,this.scoreBase.node.parent.y=this.bossType.node.parent.y,this.roomTitle.active=!1}else t=255,this.roomId.string=e.id,this.roundInfo.string="局数: "+e.roundNum+" / "+e.opts.roundMax,this.bossType.string="人数: "+e.opts.joinermax,this.scoreBase.string="底分: "+e.opts.scoreBase,this.roomTitle.active=!0;this.roomId.node.opacity=t,this.scoreBase.node.opacity=t},initPlayers:function(){this.headers=[],this.initPlayerHeads();for(var e=GameData.joiners,t=0;t<e.length;t++){var a=e[t];if(null!=a){var n=C.getLocalPosition(t),i=this.playerHeads[n].getChildByName("TableNiuNiuPlayerTemplate");i.parent.active=!0;var o=i.getComponent("niuNiuPlayerInfo"),r=C.isPlayerOnline(a.uid);o.showHeadBg(!0),o.setPlayer(a),o.HeadBtnIsClick(!0),o.setName(a.name),o.setHeadIcon(a.headimgurl),o.setIsOnline(r),this.headers.push(i)}}this.showPlayerRoundInfo()},initPlayerHeads:function(){for(var e=0;e<this.playerHeads.length;e++){var t=this.playerHeads[e].getChildByName("TableNiuNiuPlayerTemplate").getComponent("niuNiuPlayerInfo");t.setPlayer({}),t.showHeadBg(!1),t.setName(""),t.HeadBtnIsClick(!1),t.initHeadIcon(),h.readyBtnActive||t.setCoin(""),t.setIsOnline(!0);for(var a=this.playerHeads[e].getChildByName("betNum"),n=0;n<a.childrenCount;n++)a.children[n].active=!1;for(var i=this.playerHeads[e].getChildByName("numQiang"),o=0;o<i.childrenCount;o++)i.children[o].active=!1;this.playerHeads[e].active=!0}},showPlayerRoundInfo:function(){for(var e=GameData.joiners,t=0;t<e.length;t++){var a=e[t];if(null!=a){for(var n=C.getLocalPosition(t),i=h.playerChips[a.uid],o=this.playerHeads[n].getChildByName("betNum"),r=0;r<o.childrenCount;r++)o.children[r].active=!1;0<i&&o.getChildByName(i+"jiao")&&(o.getChildByName(i+"jiao").active=!0);var s=h.playerZhuang[a.uid];h.playerZhuang[a.uid]<=0&&a.uid===h.zhuangUid&&(s=1);var c=this.playerHeads[n].getChildByName("numQiang");for(r=0;r<c.childrenCount;r++)c.children[r].active=!1;if(h.status>=this.niuniuGameStatus.ZHUANG&&c.getChildByName(s+"qiang")&&(c.getChildByName(s+"qiang").active=!0),h.status>=this.niuniuGameStatus.COMPARE&&h.zhuangUid!=a.uid)for(r=0;r<c.childrenCount;r++)c.children[r].active=!1}}this.showRuleUI(),this.initReadyInfo(),C.room.opts.currencyType==d.currencyType.Currency_Coin&&this.beginCountDown()},initReadyInfo:function(){if(C.room.opts.currencyType!=d.currencyType.Currency_Coin){if(C.room.status==d.RoomState.WAIT||C.room.status==d.RoomState.READY){for(var e in this.readyNode.children)this.readyNode.children[e].active=!1;for(var t=GameData.joiners,a=0;a<t.length;a++){var n=t[a];if(null!=n){var i=C.getLocalPosition(a),o=C.readyData[n.uid];0==i&&n.uid==GameData.player.uid&&(0==o&&(h.readyBtnActive||this.gamestatus!=h.status&&h.status==this.niuniuGameStatus.SETTLE||this.gamestatus==h.status&&h.status==this.niuniuGameStatus.COMPARE)?this.btnReady.active=o:this.btnReady.active=!o),o&&(h.readyBtnActive||this.gamestatus!=h.status&&h.status==this.niuniuGameStatus.SETTLE||this.gamestatus==h.status&&h.status==this.niuniuGameStatus.COMPARE)?this.readyNode.getChildByName("ready_hand_"+i).active=!o:this.readyNode.getChildByName("ready_hand_"+i).active=o}}this.readyNode.active=!0,this.beginCountDown()}else this.readyNode.active=!1,this.btnReady.active=!1;this.gamestatus=h.status}},onSartBtnClick:function(){v.instance.playAudioOther("button");var e=C.players;if(e.length<2)createMoveMessage("房间内至少有两名玩家");else{for(var t=0;t<e.length;t++){var a=e[t];if(null!=a&&!C.readyData[a.uid])return void createMoveMessage("房间内的玩家必须都要准备")}h.requestStart()}},onCopyRoomInfo:function(){v.instance.playAudioOther("button");var e=C.room.id;if(0<e){var t="";C.room.opts.gameType==d.GameType.Game_Niu_Niu_10?t="拼十(10人),":C.room.opts.gameType==d.GameType.Game_niu_niu&&(t="拼十(6人),");var a=t+"房间号:"+e+",",n=C.room.opts,i=getRuleStrNiuNiu(n)+",邀请您快速进入";wxShareCommond(a+i)}},onQuitRoomBtnClick:function(){v.instance.playAudioOther("button"),this.quitRoomBtn.active=!1,C.room.creator==GameData.player.uid?cc.director.loadScene("home"):C.quitRoom(C.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,C.room.creator!=GameData.player.uid?NiuNiuMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},ruleClick:function(){v.instance.playAudioOther("button"),1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.onShowPlayIntrClick(),this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){v.instance.playAudioOther("button"),this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(C.room.opts){var t="";t+=C.room.opts.roundMax+"局,",t+="2-6人,",1==C.room.opts.costType?t+="房主付费,":2==C.room.opts.costType?t+="AA,":3==C.room.opts.costType&&(t+="赢家付,"),t+="底分:"+C.room.opts.scoreBase+"分,",0==C.room.opts.multipleType?t+="下注1/2/3/5,":1==C.room.opts.multipleType&&(t+="下注1/2,"),t+="明牌抢庄",cc.find(e+"/content",this.playintrNode).getComponent(cc.Label).string=t}},wxInviteBtnClicked:function(){v.instance.playAudioOther("button");var e="";C.room.opts.gameType==d.GameType.Game_Niu_Niu_10?e="拼十(10人),":C.room.opts.gameType==d.GameType.Game_niu_niu&&(e="拼十(6人),");var t=e+"房间号:"+C.room.id,a=this.getInviteStr();wxShareWeb(t,a)},handleJoinerLost:function(){this.initPlayers()},getInviteStr:function(){var e="玩法: "+this.bossType.string+","+C.room.opts.roundMax+"局,"+this.scoreBase.string+",2-"+C.room.opts.joinermax+"人,";return 1==C.room.opts.costType?e+="房主付费":2==C.room.opts.costType?e+="AA":3==C.room.opts.costType&&(e+="赢家付"),e+=", 请您快速加入",cc.log("........str = "+e),e},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){v.instance.playAudioOther("button");var t=e.detail.uid,a=e.detail.msg.type;cc.log("uid = "+t+",type = "+a);var n=C.getPlayerByUid(t);if(null!=n)for(var i=n.sex,o=0;o<this.headers.length;o++){var r=this.headers[o];if(cc.log(" this.uid:"+r.getComponent("niuNiuPlayerInfo").uid,t),r.getComponent("niuNiuPlayerInfo").uid==t){var s=cc.find("chat",r);if(null!=s){var c=cc.find("word",s),d=cc.find("emo",s),h=cc.find("yuyinNode",s);if("word"==a){var l=e.detail.msg.data,u=cc.find("word/bg",s),m=cc.find("word/Label",s).getComponent(cc.Label),p=l;u.width=20+24*p.length,c.getComponent("HideComponent").show(3),m.string=p}else if("fast"==a){var g=e.detail.msg.data.sound;l=e.detail.msg.data.content,u=cc.find("word/bg",s),m=cc.find("word/Label",s).getComponent(cc.Label),p=getShortStr(l,10);u.width=30*p.length,c.getComponent("HideComponent").show(3),m.string=p,cc.log("soundKey:"+g,i),v.instance.playAudioChat(g,i)}else if("emo"==a){var f=e.detail.msg.data;d.getComponent(cc.Animation).play(f),d.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var y=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",y):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(y)),cc.find("yuyinAnimNode/yuyinAnim",h).getComponent(cc.Animation).play("yuyinduihua"),h.getComponent("HideComponent").show(3)}}}}},clearSignUI:function(){for(var e=GameData.joiners,t=0;t<e.length;t++){var a=e[t];if(null!=a){for(var n=C.getLocalPosition(t),i=(this.playerHeads[n].getChildByName("TableNiuNiuPlayerTemplate").getComponent("niuNiuPlayerInfo"),h.playerChips[a.uid],this.playerHeads[n].getChildByName("betNum")),o=0;o<i.childrenCount;o++)i.children[o].active=!1;var r=this.playerHeads[n].getChildByName("numQiang");for(o=0;o<r.childrenCount;o++)r.children[o].active=!1}}},beginCountDown:function(){0<C.readyCountDown&&(C.room.status==d.RoomState.WAIT||C.room.status==d.RoomState.READY)?(this.lastTimeLabel.string="",this.lastTimeLabel.node.active=!0,this.clearSignUI(),this.handleCloseTimer()):(this.lastTimeLabel.node.active=!1,this.unschedule(this.updateLastTime))},handleCloseTimer:function(){cc.log("ready start count: roomHandler.readyCountDown = "+C.readyCountDown),this.updateLastTime(),this.TipsFlag=!0,this.schedule(this.updateLastTime,1)},updateLastTime:function(){if(C.readyCountDown--,cc.log("ready run time: roomHandler.readyCountDown = "+C.readyCountDown),h.status>=this.niuniuGameStatus.ZHUANG&&h.status<this.niuniuGameStatus.SETTLE)return this.lastTimeLabel.node.active=!1,void this.unschedule(this.updateLastTime);if(h.readyBtnActive||C.readyCountDown<=0)this.lastTimeLabel.node.active=!1;else{var e=this.isFirstPlayGame();this.TipsFlag&&e&&C.room.opts.currencyType==d.currencyType.Currency_Coin&&(this.showCostTips(),this.TipsFlag=!1),this.lastTimeLabel.node.active=!0}this.lastTimeLabel.string=C.readyCountDown,C.readyCountDown<=0&&(this.readyLen=0,this.costTips.active=!1,this.unStartLayer.active=!1,this.lastTimeLabel.node.active=!1,this.unschedule(this.updateLastTime))},showCostTips:function(){var e=n.getServerConfig(),t=C.room.opts.scorelv,a=e.matchCoin[GameData.client.gameType].cost[t];this.costTips.active=!0,this.costTips.getComponent(cc.Label).string="每局消耗"+a+"金币"},isFirstPlayGame:function(){var e=C.getScoreData();for(var t in e)if(t==GameData.player.uid)return 0==e[t]},openLotteryPanel:function(){var e=C.room;e.roundNum==e.opts.roundMax?setTimeout(function(){openView("GetLottery")},7e3):openView("GetLottery")},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("niuNiuPlayerInfo");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",niuNiuHandler:"niuNiuHandler",niuniuPokerHandler:"niuniuPokerHandler",roomHandler:"roomHandler"}],niuNiuSetting:[function(e,t,a){"use strict";cc._RF.push(t,"a8086CibLdKm5baHZbgL3fR","niuNiuSetting");var n=e("SoundMngr"),i=e("loginHandler"),o=e("roomHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,_musicOpen:!0,_soundOpen:!0,byeRoomBtn:cc.Node,quitRoomBtn:cc.Node},onLoad:function(){this.musicBtn.getChildByName("guan").active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen,"home"==cc.director.getScene().name?(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!0):(o.room.opts.currencyType==r.currencyType.Currency_Coin?this.byeRoomBtn.active=!1:this.byeRoomBtn.active=!0,this.quitRoomBtn.active=!1),this.refreshUI()},logout:function(e){n.instance.playAudioOther("button"),i.logout()},requestDissolve:function(){if(n.instance.playAudioOther("button"),Object.keys(o.room).length<=0)this.node.active=!1;else{if(cc.log("GameData.player.uid == roomHandler.room.creator:"+GameData.player.uid,o.room.creator),GameData.room.status===r.RoomState.WAIT&&GameData.player.uid!=o.room.creator)return createMoveMessage("游戏开始才允许解散房间"),void(this.node.active=!1);if(""!=o.room.id){o.deleteRoom(GameData.room.id,"apply");var e=cc.find("Canvas/layer_ui");e.parent.getComponent("niuNiuRoomMain").showDissolveLayer(1,1);var t=cc.find("layer_dissolve/uiDissolve",e);t.getComponent("niuNiuRoomDissolve").showPlayers(),t.getComponent("niuNiuRoomDissolve").alreadyAgree(),this.node.active=!1,cc.log("this.node.active = "+this.node.active)}}},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen},onBtnClose:function(){n.instance.playAudioOther("button"),this.node.active=!1},musicClick:function(e){this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;n.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,n.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;n.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],niuniuGmCard:[function(e,t,a){"use strict";cc._RF.push(t,"c7898cy70JKv4qVBehE60aG","niuniuGmCard");e("configMgr");var i=e("roomHandler");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox},onLoad:function(){},onOkBtnClick:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:i.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){createMoveMessage("调牌成功"),console.log("--- 调牌结果 "+JSON.stringify(e))})}}),cc._RF.pop()},{configMgr:"configMgr",roomHandler:"roomHandler"}],niuniuMoveMessage:[function(e,t,a){"use strict";cc._RF.push(t,"17b220UBbpN/7AmmSiEDgY7","niuniuMoveMessage"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var e=cc.moveBy(2,cc.p(0,40));this.node.runAction(e);this.scheduleOnce(function(e){this.node.destroy()},2)}}),cc._RF.pop()},{}],niuniuPokerHandler:[function(e,t,a){"use strict";cc._RF.push(t,"53f64cN3JFOR7HNqseoAzKz","niuniuPokerHandler");var n={GAMESTATUS:{WAIT:0,ZHUANG:1,CHIPS:2,COMPARE:3,SETTLE:4},HUNDREDNIUSTATUS:{CHIPS:1,SETTLE:2,END:3},XIAZHU:[[50,100,1e3,1e4,2e4],[50,100,1e3,1e4,2e4],[50,100,1e3,1e4,2e4]],ERRORTYPE:{SUCCESSE:0,Niu100_Zhuang_Coin:601,Niu100_Chips_State:602,Niu100_Chips_Zhuang:603,Niu100_Chips_ZhuangMax:604,Niu100_Chips_PlayerMax:605,Niu100_Chips_Continue:606,Niu100_Zhuang_Already:607,Niu100_Zhuang_UpAlready:608},POKER_TYPE:{NIU_NONE:0,NIU_ONE:1,NIU_Two:2,NIU_Three:3,NIU_Four:4,NIU_Five:5,NIU_Six:6,NIU_Seven:7,NIU_Eight:8,NIU_Nine:9,NIU_NIU:10,NIU_HuaFour:11,NIU_HuaFive:12,NIU_Bomb:13,NIU_Little:14},POKER_STR:{NIU_NONE:"没牛",NIU_ONE:"牛一",NIU_Two:"牛二",NIU_Three:"牛三",NIU_Four:"牛四",NIU_Five:"牛五",NIU_Six:"牛六",NIU_Seven:"牛七",NIU_Eight:"牛八",NIU_Nine:"牛九",NIU_NIU:"牛牛",NIU_HuaFour:"四花",NIU_HuaFive:"五花",NIU_Bomb:"炸弹",NIU_Little:"小牛牛"},AllCards:{joker:[501,502],club:[201,202,203,204,205,206,207,208,209,210,211,212,213],heart:[301,302,303,304,305,306,307,308,309,310,311,312,313],spade:[401,402,403,404,405,406,407,408,409,410,411,412,413],dianmond:[101,102,103,104,105,106,107,108,109,110,111,112,113]}};(t.exports=n).getGameStatus=function(){return n.GAMESTATUS},n.getPokerType=function(){return n.POKER_TYPE},n.getPokerStar=function(){return n.POKER_STR},n.unequally=function(e){for(var t=[],a={},n=0;n<e.length;n++)a[e[n]]||(a[e[n]]=1,t.push(e[n]));return t},n.clearArray=function(e){0<e.length&&e.splice(0,e.length)},n.itemtoArraytop=function(e,t){var a=e[t];if(0==t)return e;for(var n=0;n<e.length;n++)if(e[n]===e[t]){e.splice(n,1);break}return e.unshift(a),e},cc._RF.pop()},{}],playerInfoTemplate:[function(e,t,a){"use strict";cc._RF.push(t,"687d8ZdDPtPI6zf1NLyHqwq","playerInfoTemplate");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{headNode:cc.Node,nameLabel:cc.Label,idLabel:cc.Label,ipLabel:cc.Label,winningLabel:cc.Label,roundLabel:cc.Label,winperLabel:cc.Label,playerTemplate:cc.Prefab},onLoad:function(){},onShow:function(e){var t=cc.instantiate(this.playerTemplate);t.getComponent("playerTemplate").setName(""),t.getComponent("playerTemplate").showZhuang(!1),t.getComponent("playerTemplate").enableHeadBtn(!1),t.getComponent("playerTemplate").setHeadIcon(e.headimgurl),this.headNode.addChild(t),isChinese(e.name)?this.nameLabel.string=getShortStr(e.name,8):this.nameLabel.string=getShortStr(e.name,16),this.idLabel.string=e.uid,this.ipLabel.string=e.remoteAddr||"",this.winningLabel.string=e.winning||0,this.roundLabel.string=e.round||0,this.winperLabel.string=e.winper||0,this.node.active=!0},onClose:function(){n.instance.playAudioOther("button"),this.node.active=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],playerInformationLayer:[function(e,t,a){"use strict";cc._RF.push(t,"0dfb3loy2BLObOao8f1bOAZ","playerInformationLayer");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{EditBox:cc.EditBox},onLoad:function(){},sendClick:function(){n.instance.playAudioOther("button"),createMessageBox("功能暂未开放！",function(){})}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],playerRoundDetail:[function(e,t,a){"use strict";cc._RF.push(t,"3d65djh6AVDwo1RhKNrE7Tx","playerRoundDetail"),cc.Class({extends:cc.Component,properties:{playerName:cc.Label,playerId:cc.Label,scoreNode:cc.Node,specialSpriteNode:cc.Node,cardRow_1:cc.Node,cardRow_2:cc.Node,cardRow_3:cc.Node,fonts:{default:[],type:cc.Font},id:0},onLoad:function(){},onDestroy:function(){},showPlayerRoundDetail:function(){this.showPlayer(),this.showCard()},showPlayer:function(){if(null!=GameData13.gemaEndResult.history){var e=0;GameData13.isEmptyObject(GameData13.gemaEndResult)?cc.log("GameData13.gemaEndResult is empty."):0<GameData13.gemaEndResult.history.length&&(e=GameData13.gemaEndResult.history[this.roundNum][this.playerUidById(this.id)].score),this.showScore(e),isChinese(GameData13.joiners[this.id].name)?this.playerName.string=getShortStr(GameData13.joiners[this.id].name,6):isChinese(GameData13.joiners[this.id].name)||(this.playerName.string=getShortStr(GameData13.joiners[this.id].name,8)),this.playerId.string=GameData13.joiners[this.id].uid}else cc.log("GameData13.gameEndResult.history is undefined")},showCard:function(){this.specialSpriteNode.active=!1;var e={},t=0;if(GameData13.isEmptyObject(GameData13.gemaEndResult)?cc.log("GameData13.gemaEndResult is empty."):0<GameData13.gemaEndResult.history.length&&(GameData13.gemaEndResult.history[this.roundNum][this.playerUidById(this.id)].special&&(t=GameData13.gemaEndResult.history[this.roundNum][this.playerUidById(this.id)].special),e=GameData13.gemaEndResult.history[this.roundNum][this.playerUidById(this.id)].cards),t){if(t){for(a=0;a<e.length;a++)if(0<=a&&a<3){n=cc.find("card"+a,this.cardRow_1);this.showCardTextrue(n,e[a])}else if(3<=a&&a<8){n=cc.find("card"+(a-3),this.cardRow_2);this.showCardTextrue(n,e[a])}else if(8<=a&&a<13){n=cc.find("card"+(a-8),this.cardRow_3);this.showCardTextrue(n,e[a])}60!=t&&(this.specialSpriteNode.active=!0,this.updateSpecialSprite(t))}}else{for(var a=0;a<e.up.length;a++){var n=cc.find("card"+a,this.cardRow_1);this.showCardTextrue(n,e.up[a])}for(var a=0;a<e.mid.length;a++){var i=cc.find("card"+a,this.cardRow_2),o=cc.find("card"+a,this.cardRow_3);this.showCardTextrue(i,e.mid[a]),this.showCardTextrue(o,e.down[a])}}},showScore:function(e){0<e?(this.scoreNode.getComponent(cc.Label).string="+"+e,this.scoreNode.getComponent(cc.Label).font=this.fonts[0]):e<0?(this.scoreNode.getComponent(cc.Label).string=e,this.scoreNode.getComponent(cc.Label).font=this.fonts[1]):(this.scoreNode.getComponent(cc.Label).string=e,this.scoreNode.getComponent(cc.Label).font=this.fonts[2])},showCardTextrue:function(e,t){var a="resources/shisanshui/cardUI/"+(t.value+1)+"_"+(t.type+1)+".png",n=cc.textureCache.addImage(cc.url.raw(a));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)},updateSpecialSprite:function(e){var t="resources/shisanshui/cardTypeUI/specialName/special_"+e+".png",a=cc.textureCache.addImage(cc.url.raw(t));this.specialSpriteNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)},setRoundNum:function(e){this.roundNum=e},playerUidById:function(e){return GameData13.joiners[e].uid}}),cc._RF.pop()},{}],playerTemplate:[function(e,t,a){"use strict";cc._RF.push(t,"1f9f9UhQY1CNaBwdQbVPzV1","playerTemplate");var i=e("SoundMngr"),o=e("roomHandler");cc.Class({extends:cc.Component,properties:{uid:0,headBtn:cc.Button,headIcon:cc.Sprite,zhuangIcon:cc.Sprite,creatorIcon:cc.Sprite,zhuangNumIcon:cc.Sprite,nameLabel:cc.Label,_player:null,chaShuiIcon:cc.Sprite,sssWinNode:cc.Node,sssMainNode:cc.Node,piaoIcon:cc.Sprite},onLoad:function(){},setPlayer:function(e){this._player=e,this._player.uid&&(this.uid=this._player.uid)},setName:function(e){this.nameLabel.string=getShortStr(e,4)},setHeadIcon:function(e){if(null!=e&&""!=e){var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.headIcon.spriteFrame=new cc.SpriteFrame(t))})}else this.headIcon.spriteFrame=null},initHeadIcon:function(){var e=cc.textureCache.addImage(cc.url.raw("resources/niuNiuTable/playerHead/touxiangkong.png"));this.headIcon.spriteFrame=new cc.SpriteFrame(e)},showZhuang:function(e){this.zhuangIcon.node.active=e},showCreator:function(e){this.creatorIcon.node.active=e},showZhuangNum:function(e,t){if(e){if(1==t){var a=cc.textureCache.addImage(cc.url.raw("resources/newui/zuo1.png"));this.zhuangNumIcon.spriteFrame=new cc.SpriteFrame(a),this.zhuangNumIcon.node.active=!0}else if(2==t){a=cc.textureCache.addImage(cc.url.raw("resources/newui/zuo2.png"));this.zhuangNumIcon.spriteFrame=new cc.SpriteFrame(a),this.zhuangNumIcon.node.active=!0}}else{if(1==t){a=cc.textureCache.addImage(cc.url.raw("resources/newui/la1.png"));this.zhuangNumIcon.spriteFrame=new cc.SpriteFrame(a),this.zhuangNumIcon.node.active=!0}if(2==t){a=cc.textureCache.addImage(cc.url.raw("resources/newui/la2.png"));this.zhuangNumIcon.spriteFrame=new cc.SpriteFrame(a),this.zhuangNumIcon.node.active=!0}}},enableHeadBtn:function(e){this.headBtn.node.active=e},HeadBtnIsClick:function(e){this.headBtn.interactable=e},onHeadBtnClicked:function(e){i.instance.playAudioOther("button");var t=cc.director.getScene().name;if(cc.log("..sceneName:",t),"home"==t)createPlayerInfoPanel(this._player);else{var a=this,n=o.getRoomData();n&&n.opts&&n.opts.gameType&&(cc.log("..gameType:"+n.opts.gameType),openPlayerInfoView(n.opts.gameType,function(e){if(e){var t=e.getComponent("uiRoomPlayerInfo");t&&t.onShow(a._player)}}))}},setIsOnline:function(e){cc.find("/Disconnect",this.node).active=!e},getLiuGuang:function(e){cc.find("liuguang",this.node).active=e},setCoin:function(e,t){var a,n=cc.find("coin",this.node),i="";1==t?a=GameData.room.opts.scoreBase:2==t&&(a=ReplayRoomData.opts.scoreBase),0<a?(i=e,n.color=new cc.Color(255,204,0)):0<e?(i="+"+e,n.color=new cc.Color(255,204,0)):e<0?(i=e,n.color=new cc.Color(0,255,246)):(i=e,n.color=new cc.Color(0,255,36)),n.getComponent(cc.Label).string=i},setGold:function(e){var t="";null!=e&&(t=e),cc.find("coin",this.node).getComponent(cc.Label).string=t},setChaShuiIconShow:function(e){var t=!1,a=GameData.getPlayerByPos(e);if(a&&0<GameDataShiShi.setWater[a.uid]&&(t=!0),this.setChaShuiShow(t),1==t)switch(e){case"down":case"right":case"left":this.chaShuiIcon.node.y=70;break;case"up":this.chaShuiIcon.node.y=-90}},setChaShuiShow:function(e){this.chaShuiIcon.node.active=e},setSSSWinNodeActive:function(e){this.sssWinNode.active=e},setSSSMainNodeActive:function(e){this.sssMainNode.active=e},setPiaoIconShow:function(e){this.piaoIcon.node.active=!1;var t=GameData.getPlayerByPos(e);t&&0<profileHuaDian.getPiaoStateByUid(t.uid)&&(this.piaoIcon.node.active=!0)},setCoinBgShow:function(e){var t=cc.find("coinBg",this.node);t&&(t.active=e)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",roomHandler:"roomHandler"}],poker13:[function(e,t,a){"use strict";cc._RF.push(t,"ee201TC661BHoh+wPZAEpb0","poker13");var n={WuLong:1,DuiZi:2,LiangDui:3,SanTiao:4,ShunZi:5,TongHua:6,HuLu:7,TieZhi:8,TongHuaShun:9,WuTong:10},i={WuLong:5,DuiZi:2,LiangDui:4,SanTiao:3,ShunZi:5,TongHua:5,HuLu:5,TieZhi:4,TongHuaShun:5,WuTong:5};function o(e){this._pokerTypeList={DuiZi:[],LiangDui:[],SanTiao:[],ShunZi:[],TongHua:[],HuLu:[],TieZhi:[],TongHuaShun:[],WuTong:[]},this._cardHandList=[],this.initCardHandList(e)}var r=o.prototype;r.initCardHandList=function(e){this.clearArray(this._cardHandList);for(var t=e,a=0;a<t.length;a++)this._cardHandList.push({card:t[a],status:0})},r.sortHandCard=function(e){for(var t=[],a=0;a<e.length;a++)0!=e[a]&&(t[t.length]=e[a]);for(a=0;a<t.length;a++)t[a].value=50*t[a].value,t[a].type=t[a].type+t[a].value;t.sort(function(e,t){return t.type-e.type});for(a=0;a<t.length;a++)t[a].type=t[a].type-t[a].value,t[a].value=t[a].value/50;this.clearArray(e);for(var n=0;n<GameData13.handSize;n++)n<t.length?e[n]=t[n]:e[n]=0;return t.length},r.compare=function(e,t){return t<e},r.sortArray=function(e,t,a){for(var n=e;n<t;++n)this.compare(a[n+1].status,a[n].status)&&(a[n+1].status=0,n=-(a[n].status=1))},r.permResult=function(e,t){for(var a=[],n=0;n<e;n++)1==t[n].status&&a.push(t[n].card);return a},r.permPoker=function(e,t,a,n){if(a<=t)for(var i=0;i<t;i++)e[i].status=i<a?1:0;this.pokerType(this.permResult(t,e),n);for(i=0;i<t;++i){var o=i+1;if(o<t&&1==e[i].status&&0==e[o].status){e[i].status=0,e[o].status=1,this.sortArray(0,i,e);var r=this.permResult(t,e);this.pokerType(r,n),i=-1}}},r.searchPokerType=function(e,t){if(this._cardHandList.length<=0)cc.log("function:searchPokerType.. _cardHandList is empty.");else{for(var a=[],n=0;n<this._cardHandList.length;n++)a.push(this._cardHandList[n]);this.permPoker(a,e,i[t],t)}},r.isSameValueOfCard=function(e,t,a){if(e.length<=0)return!1;for(var n=0,i=[],o=0;o<e.length;o++)i.push({card:e[o],status:0});for(var r=0;r<i.length;r++){var s=0;for(o=0;o<i.length;o++)if(0==i[o].status){if(i[r].card.value!=i[o].card.value)continue;i[o].status=1,s++}s!=t||n++}return n==a},r.isDuiZi=function(e){return!(e.length<=0||e.length!=i.DuiZi)&&!!this.isSameValueOfCard(e,2,1)},r.isLiangDui=function(e){return!(e.length<=0||e.length!=i.LiangDui)&&!!this.isSameValueOfCard(e,2,2)},r.isSanTiao=function(e){return!(e.length<=0||e.length!=i.SanTiao)&&!!this.isSameValueOfCard(e,3,1)},r.isShunZi=function(e){var t=0;if(e.length<=0||e.length!=i.ShunZi)return!1;e.sort(function(e,t){return e.value-t.value});for(var a=0;a<e.length;a++){var n=e[0].value;e[a].value-a==n&&t++}return 5==t},r.isTongHua=function(e){var t=0;if(e.length<=0||e.length!=i.TongHua)return!1;for(var a=0;a<e.length;a++){var n=e[0].type;e[a].type==n&&t++}return 5==t},r.isHuLu=function(e){return!(e.length<=0||e.length!=i.HuLu)&&!(!this.isSameValueOfCard(e,3,1)||!this.isSameValueOfCard(e,2,1))},r.isTieZhi=function(e){return!(e.length<=0||e.length!=i.TieZhi)&&!!this.isSameValueOfCard(e,4,1)},r.isTongHuaShun=function(e){var t=!1;return!(e.length<=0||e.length!=i.TongHuaShun)&&(this.isTongHua(e)&&(t=!0),!(!t||!this.isShunZi(e)))},r.isWuTong=function(e){if(!(e.length<=0||e.length!=i.WuTong))return!!this.isSameValueOfCard(e,5,1)},r.pokerType=function(e,t){return n[t]==n.DuiZi?this.isDuiZi(e)&&this._pokerTypeList.DuiZi.push(e):n[t]==n.LiangDui?this.isLiangDui(e)&&this._pokerTypeList.LiangDui.push(e):n[t]==n.SanTiao?this.isSanTiao(e)&&this._pokerTypeList.SanTiao.push(e):n[t]==n.ShunZi?this.isShunZi(e)&&this._pokerTypeList.ShunZi.push(e):n[t]==n.TongHua?this.isTongHua(e)&&this._pokerTypeList.TongHua.push(e):n[t]==n.HuLu?this.isHuLu(e)&&this._pokerTypeList.HuLu.push(e):n[t]==n.TieZhi?this.isTieZhi(e)&&this._pokerTypeList.TieZhi.push(e):n[t]==n.TongHuaShun?this.isTongHuaShun(e)&&this._pokerTypeList.TongHuaShun.push(e):n[t]==n.WuTong&&this.isWuTong(e)&&this._pokerTypeList.WuTong.push(e),[]},r.getPokerTypeCards=function(e,t){return this.searchPokerType(e,t),this._pokerTypeList},r.clearArray=function(e){0<e.length&&e.splice(0,e.length)},r.clearPokerTypeList=function(){this.clearArray(this._pokerTypeList)},t.exports=o,cc._RF.pop()},{}],pokerAnimationBase:[function(e,t,a){"use strict";cc._RF.push(t,"91976faCA1EQpUlFmdov++u","pokerAnimationBase");var n=cc.Class({extends:cc.Component,properties:{},dealAction:function(e,t,a,n,i){if(e){for(var o=[],r=n,s=0;s<e.length;s++)o.push(e[s].scale),e[s].setScale(r),e[s].setPosition(t);for(var c=0;c<e.length;c++)e[c].active||(e[c].active=!0),e[c].parent&&!e[c].parent.active&&(e[c].parent.active=!0),e[c].parent.parent&&!e[c].parent.parent.active&&(e[c].parent.parent.active=!0),e[c].runAction(cc.sequence(cc.delayTime(.1*(c+1)),cc.spawn(cc.rotateBy(.1,360),cc.moveTo(.1,a[c]),cc.scaleTo(.1,o[c]))));var d;d=.1*e.length,i&&i(d)}},flyToMidAction:function(e,t,a,n){if(e){var i=e.getPosition().x,o=i+a;e.x=o,e.runAction(cc.moveTo(t,cc.v2(i,e.y))),n&&n(t)}},playFlopAnimation:function(e,t){if(e){var a=e.scale,n=cc.scaleTo(.25,0,a),i=cc.scaleTo(.25,a,a);e.runAction(cc.sequence(n,i))}},playDragAnimation:function(i,e,o,r){cc.loader.loadResDir(e,function(e,t){if(e)cc.log(e);else if(t.length<=0)cc.log("assets length: ",t.length);else{var a;for(var n in i.getComponent(dragonBones.ArmatureDisplay)?(cc.log("dragonBones get"),a=i.getComponent(dragonBones.ArmatureDisplay)):(cc.log("dragonBones add"),a=i.addComponent(dragonBones.ArmatureDisplay)),t)t[n]instanceof dragonBones.DragonBonesAsset&&a.dragonAsset!=t[n]&&(a.dragonAsset=t[n]),t[n]instanceof dragonBones.DragonBonesAtlasAsset&&a.dragonAtlasAsset!=t[n]&&(a.dragonAtlasAsset=t[n]);a.armatureName="armature",a.playAnimation(o,1),r&&a.addEventListener(dragonBones.EventObject.COMPLETE,r,this)}})},playScaleAnim:function(e,t){e.active||(e.active=!0),e.scale=t+1;var a=cc.scaleTo(.2,t);e.runAction(a)},playDragonBonesAnimation:function(e,t,a,n,i,o){if(null==e||null==t||t.length<=0)cc.log("..node or animation name is undefined");else{var r=e.getComponent(dragonBones.ArmatureDisplay);if(null!=r)if(r.playAnimation(t,a),n&&i){e.position=n;var s=cc.moveTo(.6,i);e.runAction(cc.sequence(s.easing(cc.easeIn(1.5)),cc.callFunc(function(){o&&o(e)})))}else o&&r.addEventListener(dragonBones.EventObject.COMPLETE,function(){o(e)},this);else cc.log("..animation dragonBones node is undefined")}}});t.exports=n,cc._RF.pop()},{}],pokerRoomBaseView:[function(e,t,a){"use strict";cc._RF.push(t,"64d4dxTJ8dMKJiXq6npEo/A","pokerRoomBaseView");var n=e("roomUtil"),o=e("roomHandler"),r=e("gameDefine"),i=e("SoundMngr");cc.Class({extends:cc.Component,properties:{talkBtn:cc.Button,wifiNode:cc.Node,roomNum:cc.Label,roomRound:cc.Label,powerNode:cc.Node,yuyinNode:cc.Node,roomRule:cc.Label,timeLabel:cc.Label,playintrNode:cc.Node,yuyinShortNode:cc.Node,roomDesNodeCard:cc.Node,roomDesNodeCoin:cc.Node,playersNode:[cc.Node],playerPrefab:cc.Prefab,container:cc.Node},onLoad:function(){registEvent("onRoomInfo",this,this.showPlayers),registEvent("nativePower",this,this.showPower),registEvent("yunwaUploaded",this,this.handleVoice)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("nativePower",this,this.showPower),unregistEvent("yunwaUploaded",this,this.handleVoice)},onEnable:function(){this.setVoiceBtn(),this.showTime(),this.showWifi(),this.showPlayers(),this.showRoomDes(),this.schedule(this.showTime,1),this.schedule(this.showWifi,5),this.schedule(n.getPower,60)},showRoomDes:function(){o.room.opts.currencyType==r.currencyType.Currency_Coin?this.showRoomDesCoin():this.showRoomDesCard()},showRoomDesCoin:function(){this.roomDesNodeCard.active=!1,this.roomDesNodeCoin.active=!0,this.showRoomDesCoinNum(),this.showRoomDesRule()},showRoomDesCard:function(){this.roomDesNodeCard.active=!0,this.roomDesNodeCoin.active=!1,this.showRoomDesCardNum(),this.showRoomDesRule()},showPlayers:function(){var e=o.getRoomData(),t=e.roundNum>e.opts.roundMax?e.opts.roundMax:e.roundNum;this.roomRound.string="局数: "+t+"/"+e.opts.roundMax,o.room.opts.currencyType==r.currencyType.Currency_Coin&&this.showRoomDesCoinNum()},showPlayer:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=t.getChildByName("headNode");null==n&&((n=cc.instantiate(this.playerPrefab)).getComponent("pokerRoomPlayer").setPlayer(a),n.getComponent("pokerRoomPlayer").setName(a.name),n.getComponent("pokerRoomPlayer").setHeadIcon(a.headimgurl),n.name="headNode",t.addChild(n));o.getScoreData();n.getComponent("pokerRoomPlayer").setIsOnline(a.uid),t.active=!0}else t.active=!1},showWifi:function(){var e=0,t=GameNet.getInstance().getPingPong();t<300?e=3:t<600?e=2:t<1e3&&(e=1);for(var a=0;a<4;a++){cc.find("WiFi-"+(a+1),this.wifiNode).active=a==e}},showPower:function(e){powerNode.scaleX=e.detail/100},showTime:function(){this.timeLabel.string=n.getTimeString()},showRoomDesCardNum:function(){this.roomNum.string=n.getRoomString(GameData.room.id)},showRoomDesCoinNum:function(){var e=cc.find("des",this.roomDesNodeCoin),t=o.room.gameNum+1;1==t.toString().length?t="000"+t:2==t.toString().length?t="00"+t:3==t.toString().length?t="0"+t:4==t.toString().length&&(t=t),e&&(e.getComponent(cc.Label).string=t+n.getRoomString(GameData.room.id))},showRoomDesRule:function(){var e=o.getRoomData();switch(GameData.client.gameType){case r.GameType.Game_Poker_ZJH:if(o.room.opts.currencyType==r.currencyType.Currency_Coin){var t=cc.find("roomRule",this.roomDesNodeCoin);t&&(t.getComponent(cc.Label).string=this.getRuleStrZJH(e.opts))}else this.roomRule.string=this.getRuleStrZJH(e.opts)}},setVoiceBtn:function(){var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){inCD(1e3)||(yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),o.room.opts.currencyType==r.currencyType.Currency_Coin?this.talkBtn.node.active=!1:this.talkBtn.node.active=!0},handleVoice:function(e){var t=e.detail;WriteLog("soundurl 语音"+t),ChatHandler.getInstance().sendRecord(t)},onSettingClicked:function(e){i.instance.playAudioOther("button"),openView("poker_settingPrefab",r.GameType.Game_Poker_ZJH)},onRuleClicked:function(e){var t=this.playintrNode;if(!t.active){var a=cc.find("small/content",t);a&&(a.getComponent(cc.Label).string=this.roomRule.string,t.active=!0,t.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(function(){t.active=!1}))))}},onChatClicked:function(e){inCD(2e3)||(i.instance.playAudioOther("button"),openView("NiuNiuChatPanel",r.GameType.Game_niu_niu))},addGameNode:function(){var e;switch(this.container.removeAllChildren(!0),GameData.room.opts.gameType){case r.GameType.Game_Poker_ZJH:e=cc.instantiate(this.ZJHRoomMainPrefab)}e.setPosition(this.container.getPosition()),this.container.addChild(e)},getRuleStrZJH:function(e){if(!e||0==Object.keys(e).length)return"";var t="";switch(0==e.chipsType?t+="底分1,\n":1==e.chipsType&&(t+="底分5,\n"),e.canNotLookTurnNum){case 0:t+="无必闷,\n";break;case 1:t+="闷一轮,\n";break;case 2:t+="闷两轮,\n";break;case 3:t+="闷三轮,\n"}switch(e.maxTunNum){case 5:t+="封顶轮数5,\n";break;case 10:t+="封顶轮数10,\n";break;case 15:t+="封顶轮数15,\n";break;case 20:t+="封顶轮数20,\n"}switch(e.compareSuit&&(t+="比花色,\n"),e.twoThreeFiveBiger&&(t+="235吃豹子,\n"),e.a23Type){case 1:t+="A23地龙\n";break;case 0:t+="A23最大\n";break;case 2:t+="A23最小\n"}return o.room.opts.currencyType==r.currencyType.Currency_Coin&&(t="闷1轮\n封顶10轮\n235吃豹子\n"),t}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler",roomUtil:"roomUtil"}],pokerRoomPlayer:[function(e,t,a){"use strict";cc._RF.push(t,"333aa+wiZxONonlETWIZ53W","pokerRoomPlayer");var i=e("roomHandler"),o=e("SoundMngr"),n=e("gameDefine"),r=e("ZJH-RoomData");cc.Class({extends:cc.Component,properties:{uid:0,headBtn:cc.Button,headIcon:cc.Sprite,zhuangIcon:cc.Sprite,nameLabel:cc.Label,score:cc.Node,_player:null,countDownNode:cc.Node,chatsNode:[cc.Node],fonts:{default:[],type:cc.Font},countDownTotalLen:15},onLoad:function(){},setPlayer:function(e){this._player=e,this.uid=this._player.uid},setName:function(e){this.nameLabel.string=getShortStr(e,4);var t=cc.find("coin",this.node);GameData.room.opts.gameType==n.GameType.Game_Poker_ZJH&&GameData.player.uid==this.uid&&(this.nameLabel.node.y=-8,t.y=-30)},setHeadIcon:function(e){if(null==e||""==e||e.length<=0)this.headIcon.spriteFrame=null;else{var a=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.headIcon.spriteFrame=new cc.SpriteFrame(t))})}},showPlayerIdentity:function(e,t){if(this.setIsPlayerIcon(e),1==t){var a=cc.textureCache.addImage(cc.url.raw("resources/ddz/UI/common/icon/dizhu_icon.png"));this.zhuangIcon.spriteFrame=new cc.SpriteFrame(a)}else if(2==t){a=cc.textureCache.addImage(cc.url.raw("resources/ddz/UI/common/icon/nongmin_icon.png"));this.zhuangIcon.spriteFrame=new cc.SpriteFrame(a)}},setNamePositionByDir:function(e){"right"==e&&(this.nameLabel.node.x=-57,this.score.x=-53,this.zhuangIcon.node.x=33,this.nameLabel.horizontalAlign=3,this.nameLabel.node.anchorX=1,this.score.horizontalAlign=3,this.score.anchorX=1)},showZhuang:function(e){this.zhuangIcon.node.active=e},enableHeadBtn:function(e){this.headBtn.node.active=e},showCountDownEffect:function(e,t){e?this.playCountAnimtion(t):(this.countDownNode.active=e,this.unschedule(this.countDownBgChange))},playCountAnimtion:function(e){cc.find("animation",this.countDownNode);var t=cc.find("bg",this.countDownNode);t.getComponent(cc.Sprite).fillStart=.44,this.startPos=1-e/this.countDownTotalLen,t.getComponent(cc.ProgressBar).progress=this.startPos,this.schedule(this.countDownBgChange,.5)},countDownBgChange:function(){r.isRunAnimation?this.countDownNode.active=!1:this.countDownNode.active=!0,this.startPos-=1/(2*this.countDownTotalLen),cc.find("bg",this.countDownNode).getComponent(cc.ProgressBar).progress=this.startPos,this.startPos<=0&&this.unschedule(this.countDownBgChange)},onHeadBtnClicked:function(e){o.instance.playAudioOther("button");var t=cc.director.getScene().name;if(cc.log("..sceneName:",t),"home"==t)createPlayerInfoPanel(this._player);else{var a=this,n=i.getRoomData();n&&n.opts&&n.opts.gameType&&(cc.log("..gameType:"+n.opts.gameType),openPlayerInfoView(n.opts.gameType,function(e){if(e){var t=e.getComponent("uiRoomPlayerInfo");t&&t.onShow(a._player)}}))}},setCoin:function(e){var t=cc.find("coin",this.node),a="";i.room.opts.currencyType==n.currencyType.Currency_Coin&&(a=e=ConversionCoinValue(e,2)),cc.log("coin:"+e),0<e?a="+"+e:e<0?a=e:0==e&&(a=e),t.getComponent(cc.Label).string=a},getLiuGuang:function(e){cc.find("liuguang",this.node).active=e},setIsOnline:function(e){var t=cc.find("Disconnect",this.node),a=i.isPlayerOnline(e);t.active=!a}}),cc._RF.pop()},{SoundMngr:"SoundMngr","ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",roomHandler:"roomHandler"}],pokerTypeAnimation:[function(e,t,a){"use strict";cc._RF.push(t,"6cb173UDRhOebS7vvSob2gV","pokerTypeAnimation");e("niuNiuHandler");var n=e("niuniuPokerHandler");cc.Class({extends:cc.Component,properties:{maskBg:cc.Sprite,actNode:cc.Node,skeNode:cc.Node,effectAc:cc.Node},onLoad:function(){this.actNode.active=!1,this.skeNode.active=!1,this.effectAc.active=!1,this._fanInfo=null,this.niuniuPokerType=n.getPokerType()},initFanInfo:function(e,t){if(cc.log("data = "+e),null!=e)if(this._fanInfo=e,this._fanInfo==this.niuniuPokerType.NIU_Little&&0==t){this.skeNode.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",-1),this.skeNode.parent.active=!0,this.skeNode.active=!0}else{var a,n=this;0==t?a=cc.url.raw("resources/niuNiuTable/pokerType/"+this._fanInfo+".png"):1==t&&(a=cc.url.raw("resources/hundredNiuNiu/uiResources/table/pokerType/"+this._fanInfo+".png")),cc.loader.load(a,function(e,t){!e&&t&&(n.actNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),n.actNode.getComponent(cc.Animation).play("niuNiuPokerTypeAnimation"))}),n.actNode.active=!0}},pokerTypeAnim:function(){this.actNode.scaleX=.5,this.actNode.scaleY=.5;var e=cc.scaleTo(.17,1.1,1.1),t=cc.scaleTo(.1,1,1);this.actNode.runAction(cc.sequence(e,t))},pokerAnimation:function(){this.effectAc.parent.active=!0,this.effectAc.active=!0,this.effectAc.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1);this.scheduleOnce(function(){this.effectAc.active=!1},1.5)},changeMaskBg:function(e){var t="";if(null!=e){t=e>this.niuniuPokerType.NIU_NONE&&e<=this.niuniuPokerType.NIU_NIU?cc.url.raw("resources/hundredNiuNiu/uiResources/table/pokerType/mengban.png"):cc.url.raw("resources/hundredNiuNiu/uiResources/table/pokerType/mengban2.png");var a=cc.textureCache.addImage(t);this.maskBg.spriteFrame=new cc.SpriteFrame(a)}}}),cc._RF.pop()},{niuNiuHandler:"niuNiuHandler",niuniuPokerHandler:"niuniuPokerHandler"}],poker_Mask:[function(e,t,a){"use strict";cc._RF.push(t,"238e2csNahDSbkxqkjk41Rj","poker_Mask"),cc.Class({extends:cc.Component,properties:{maskNode:cc.Sprite},onLoad:function(){},setMask:function(e){this.maskNode.node.scale=e}}),cc._RF.pop()},{}],poker_ZJH_resultItemPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"de096txAeJNJb5hBgZQ3gOW","poker_ZJH_resultItemPrefab");var r=e("ZJH-RoomData");e("gameDefine"),e("roomHandler");cc.Class({extends:cc.Component,properties:{maxWinner:cc.Node,nameLbl:cc.Label,userIdLbl:cc.Label,winNumLbl:cc.Label,loseNumLbl:cc.Label,creatorIcon:cc.Node,headIcon:cc.Node,roomScoreLbl:cc.Label,fonts:[cc.Font],_playerInfo:null,infoNode:cc.Node},onLoad:function(){},initUI:function(){var e=this._playerInfo;JSON.stringify("结算玩家数据  "+JSON.stringify(e)),this.nameLbl.string=getShortStr(e.name,10),this.userIdLbl.string="ID: "+e.uid;var a=this;(this.headIcon.getComponent(cc.Sprite).spriteFrame=null)!=e.headimgurl&&""!=e.headimgurl&&0<e.headimgurl.length&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(a.headIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))}),this.winNumLbl.string=0,this.loseNumLbl.string=0;var i,t=r.gameResultData;for(var n in r.gameResultData.extraInfo)e.uid==n&&(this.winNumLbl.string=r.gameResultData.extraInfo[n].winNum,this.loseNumLbl.string=r.gameResultData.extraInfo[n].loseNum);var o=0;if(r.gameResultData.socres&&r.gameResultData.socres[e.uid]&&(o=(i=t.socres)[e.uid]),o){0<o?(this.roomScoreLbl.string="+"+o,this.roomScoreLbl.font=this.fonts[0]):o<0?(this.roomScoreLbl.string=o,this.roomScoreLbl.font=this.fonts[1]):0==o&&(this.roomScoreLbl.string=o,this.roomScoreLbl.font=this.fonts[2]);(function(){var e=[];for(var t in i)e.push(i[t]);for(var a=0,n=1;n<e.length;n++)e[n]&&e[n]>e[a]&&(a=n);return e[a]})()==i[e.uid]&&(this.maxWinner.active=!0),this.creatorIcon.active=e.uid==GameData.room.creator}},getActiveNode:function(){return this.infoNode},initData:function(e){e&&(this._playerInfo=e,0<Object.keys(r.gameResultData).length&&this.initUI())}}),cc._RF.pop()},{"ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",roomHandler:"roomHandler"}],poker_chipPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"c930c78jCNCtpAI/zD6HIMK","poker_chipPrefab"),cc.Class({extends:cc.Component,properties:{chipSp:cc.Sprite},onLoad:function(){},setChipImg:function(e){if(e){var t="resources/zjh/UI/img/chip/chip_x_"+e+".png",a=cc.textureCache.addImage(cc.url.raw(t));this.chipSp.spriteFrame=new cc.SpriteFrame(a)}}}),cc._RF.pop()},{}],poker_debugPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"316d6w+AotEdbEfVLqRA4vU","poker_debugPrefab");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,debugBtn:cc.Node},onLoad:function(){var e=n.getSetCardsOpen(),t=cc.find("debugBtn",this.node.parent);t&&(t.active=e)},onOkBtnClick:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){})},close:function(){this.node.active=!1}}),cc._RF.pop()},{configMgr:"configMgr"}],poker_playerStateImgPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"15ab9wyo21DI5cT1MTDL4kb","poker_playerStateImgPrefab"),cc.Class({extends:cc.Component,properties:{stateImg:cc.Sprite},onLoad:function(){},setImg:function(e,t,a){if(e){var n="resources/zjh/UI/artword/artword_"+e+".png",i=cc.textureCache.addImage(cc.url.raw(n));this.stateImg.spriteFrame=new cc.SpriteFrame(i)}t&&(this.stateImg.node.scale=t),a&&(this.stateImg.node.y=a)}}),cc._RF.pop()},{}],poker_settingPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"7fa1e7wtSlIw4Gl/McJ7T8g","poker_settingPrefab");var n=e("SoundMngr"),i=e("roomHandler"),o=e("loginHandler"),r=e("gameDefine");e("ZJH-RoomData");cc.Class({extends:cc.Component,properties:{musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,_musicOpen:!0,_soundOpen:!0,_LanguageTypeOpen:!0,byeRoomBtn:cc.Node,quitRoomBtn:cc.Node,toggle_tianjin:cc.Toggle,toggle_putong:cc.Toggle,fangyanLb:cc.Label},onLoad:function(){this._LanguageTypeOpen=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_local,this.musicBtn.getChildByName("guan").active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this.toggle_tianjin.node.on("toggle",this.selectLanguageTypeClick,this),this.toggle_putong.node.on("toggle",this.selectLanguageTypeClick,this);cc.director.getScene().name;"home"==cc.director.getScene().name?(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!0):(this.byeRoomBtn.active=!0,this.quitRoomBtn.active=!1),i.room.opts.currencyType==r.currencyType.Currency_Coin&&(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!1),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen,this.selectLanguageTypeOpen(),this.refreshUI()},onEnable:function(){},musicClick:function(e){this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;n.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},selectLanguageTypeClick:function(e){var t=GameData.language_local;this.toggle_tianjin.isChecked&&(t=GameData.language_local),this.toggle_putong.isChecked&&(t=GameData.language_putong),cc.sys.localStorage.setItem("languageType"+GameData.player.uid,t)},selectLanguageTypeOpen:function(){this._LanguageTypeOpen==GameData.language_local?(this.toggle_tianjin.isChecked=!0,this.toggle_putong.isChecked=!1):(this.toggle_tianjin.isChecked=!1,this.toggle_putong.isChecked=!0)},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen,this.musicBtn.getChildByName("base").active=this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen,this.soundBtn.getChildByName("base").active=this._soundOpen},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,n.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;n.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},onClose:function(){closeView(this.node.name)},requestDissolve:function(){if(GameData.room.opts){if(GameData.player.uid!=GameData.joiners[0].uid&&GameData.room.status===r.RoomState.WAIT)return createMoveMessage("牌局开始后才允许解散房间"),void closeView(this.node.name);if(GameData.room.status>r.RoomState.WAIT&&!i.isPlayGameByUid(GameData.player.uid))return createMoveMessage("观战玩家不允许解散房间"),void closeView(this.node.name);if(i.deleteRoom(GameData.room.id,"apply"),closeView(this.node.name),GameData.gameType==r.GameType.Game_Poker_ZJH){var e=this.node.parent.getChildByName("pokerRoomBaseView").getChildByName("gamecontent").getChildByName("poker_ZJH_main");e.getComponent("ZJH_roomMain").showdissolveLayer(1,1);var t=cc.find("layer_dissove/uiDissolve",e);return t.getComponent("ZJH-roomDissolve").showPlayers(),void t.getComponent("ZJH-roomDissolve").alreadyAgree()}}},logout:function(e){o.logout()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("base").active=GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("base").active=GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume}}),cc._RF.pop()},{SoundMngr:"SoundMngr","ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],poker_summaryPrefab:[function(e,t,a){"use strict";cc._RF.push(t,"7bc01SrfTpJxZamGrwJe7Sl","poker_summaryPrefab");var o=e("roomHandler"),r=(e("ZJH-RoomData"),e("gameDefine"));cc.Class({extends:cc.Component,properties:{playerRender:cc.Prefab,content:cc.Node,panel:cc.Node},onLoad:function(){this._roomInfo=o,this.handlerMsg(),registEvent("onZhaJinHuaRoomEnd",this,this.onShow),GameData.game.close&&this.initUI()},onEnable:function(){},onShow:function(){var e=this;GameData.room.status==r.RoomState.READY&&this.initUI(),ZJH_RoomData.isCompare?this.scheduleOnce(function(){e.initUI()},5):GameData.room.roundNum==GameData.room.opts.roundMax?this.scheduleOnce(function(){e.initUI()},3):this.initUI()},initUI:function(){this.showTime(this._roomInfo.room.createtime,this._roomInfo.room.id),this.content.removeAllChildren();for(var e=0;e<6;e++){(n=cc.instantiate(this.playerRender)).x=6+212*e,this.content.addChild(n)}var t=this.content.children;for(e=0;e<t.length;e++){var a=o.getPlayGamePlayerArr().length;if(GameData.room.status==r.RoomState.WAIT&&(a=GameData.joiners.length),e<a){var n=t[e],i=GameData.getPlayerByUid(o.getPlayGamePlayerArr()[e]);GameData.room.status==r.RoomState.WAIT&&(i=GameData.joiners[e]),n.getComponent("poker_ZJH_resultItemPrefab").initData(i),n.getComponent("poker_ZJH_resultItemPrefab").getActiveNode().active=!0}else{(n=t[e]).getComponent("poker_ZJH_resultItemPrefab").getActiveNode().active=!1}}},showTime:function(e,t){var a=cc.find("roomID",this.panel),n=cc.find("date",this.panel),i=cc.find("time",this.panel),o=new Date(e),r=o.getFullYear(),s=o.getMonth()+1,c=o.getDate(),d=o.getHours();d<10?d="0"+d+":":d+=":";var h=o.getMinutes();h<10?h="0"+h+":":h+=":";var l=o.getSeconds();l=l<10?"0"+l:l,a.getComponent("cc.Label").string="房间号 : "+t,n.getComponent("cc.Label").string=r+"-"+s+"-"+c,i.getComponent("cc.Label").string=d+h+l},btnBackOnClicked:function(e){cc.log("summary to home"),GameData.player.roomid=void 0,GameData.joiners=[],GameData.game.onRoomDissolve=null,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)},handlerMsg:function(){},onDestroy:function(){unregistEvent("onZhaJinHuaRoomEnd",this,this.initUI)}}),cc._RF.pop()},{"ZJH-RoomData":"ZJH-RoomData",gameDefine:"gameDefine",roomHandler:"roomHandler"}],powerView:[function(e,t,a){"use strict";cc._RF.push(t,"599aaHrzDFP67jcclmMfE/y","powerView");var n=e("roomUtil");cc.Class({extends:cc.Component,properties:{powerNode:cc.Node},onLoad:function(){registEvent("nativePower",this,this.showPower)},onDestroy:function(){unregistEvent("nativePower",this,this.showPower)},onEnable:function(){this.schedule(n.getPower,60)},showPower:function(e){this.powerNode.scaleX=e.detail/100}}),cc._RF.pop()},{roomUtil:"roomUtil"}],prepareView:[function(e,t,a){"use strict";cc._RF.push(t,"b4ee8UYg+JAQ7FCiD4Yc0vz","prepareView");e("gameDefine");var s=e("roomHandler");cc.Class({extends:cc.Component,properties:{handNode:cc.Node,readyNode:cc.Node},onLoad:function(){registEvent("onRoomInfo",this,this.updatePlayerReady),registEvent("onPrepareInfo",this,this.updatePlayerReady)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.updatePlayerReady),unregistEvent("onPrepareInfo",this,this.updatePlayerReady)},onEnable:function(){this.updatePlayerReady()},updatePlayerReady:function(){for(var e=["left","right","up","down"],t=0;t<e.length;t++)this.showReadyIcon(e[t],!1,!1);var a=s.getRoomReadyData();for(var n in a){var i=!a[n],o=a[n],r=GameData.getPlayerPosByUid(n);this.showReadyIcon(r,o,i)}},showReadyIcon:function(e,t,a){var n=cc.find(e,this.handNode);n&&(n.active=t);var i=cc.find(e,this.readyNode);i&&(i.active=a)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],replayData:[function(e,t,a){"use strict";cc._RF.push(t,"48982FhB6RPMatSAmCo6da7","replayData");cc._RF.pop()},{}],replayHandler:[function(e,t,a){"use strict";cc._RF.push(t,"1466aLmkixKcr4ud7X66Dxt","replayHandler"),cc._RF.pop()},{}],"replayMain-tdk":[function(e,t,a){"use strict";cc._RF.push(t,"16dc4r9e6hODJjFbdxAeDH/","replayMain-tdk"),cc.Class({extends:cc.Component,properties:{stopBtn:cc.Button,playBtn:cc.Button,exitBtn:cc.Button,quick_btn:cc.Button,overBtn:cc.Button,playerNodes:{default:[],type:cc.Node},continueBtn:cc.Node,playCardsNode:cc.Node,escapeNode:cc.Node,winnerNode:cc.Node,borrowPokerPre:cc.Prefab,languo:cc.Node,scoreNode:cc.Prefab,scoreParent:cc.Node,chips:[cc.Node],chipsNode:cc.Node,_actionIndex:-1,runSum:cc.Label,roomNode:cc.Node},onLoad:function(){this.stopBtn.node.active=!1,this.playBtn.node.active=!0,registEvent("onGameStart",this,this.showTableLayer),registEvent("ddz-onGameStart",this,this.showTableLayer),registEvent("tjddz-onGameStart",this,this.showTableLayer)},onEnable:function(){cc.director.getScheduler().setTimeScale(1),this.initPlayers(),this.initStopPanel(),this.schedule(this.runAction,1),this.showRoomRule()},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("ddz-onGameStart",this,this.showTableLayer),unregistEvent("tjddz-onGameStart",this,this.showTableLayer)},showTableLayer:function(){GameData.client.gameType==gameDefine.GameType.Game_Mj_Tianjin?cc.director.loadScene("table"):GameData.client.gameType==gameDefine.GameType.Game_Poker_DDZ?cc.director.loadScene("table-DDZ"):GameData.client.gameType==gameDefine.GameType.Game_Poker_TianjinDDZ&&cc.director.loadScene("table-TJDDZ")},initStopPanel:function(){var t=this;this.stopBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(1),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.playBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(0),t.stopBtn.node.active=!0,t.playBtn.node.active=!1}),this.exitBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){ReplayDataCenter.openRoundPanel=!0,cc.director.getScheduler().setTimeScale(1),cc.director.loadScene("home")}),this.quick_btn.node.on(cc.Node.EventType.TOUCH_START,function(e){cc.director.getScheduler().setTimeScale(2),t.stopBtn.node.active=!1,t.playBtn.node.active=!0}),this.overBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){t.overBtnClick()})},overBtnClick:function(){this.unschedule(this.runAction),ReplayDataCenter.openRoundPanel=!0,cc.director.loadScene("home")},initPlayers:function(){this.headers=[],this.continueBtn.active=!1;for(var e=0;e<this.playerNodes.length;e++)this.playerNodes[e].active=!1;for(var t=0;t<ReplayData.players.length;t++)if(null!=ReplayData.players[t]){var a=ReplayData.players[t].uid,n=this.getPlayerInfoByUid(a),i=this.getLocalPosition(t),o=this.playerNodes[i].getChildByName("TableTDKPlayerTemplate");o.parent.active=!0;var r=o.getComponent("TDK-playerTemplate");r.setPlayer(n),r.setHeadIcon(n.headimgurl),r.setName(n.name),this.headers.push(o)}this.initPokerNode()},initPokerNode:function(){for(var e in this.playCardsNode.children)this.hideNodeChild(this.playCardsNode.children[e]);for(var e in this.escapeNode.children)this.escapeNode.children[e].active=!1;for(var e in this.escapeNode.children)this.winnerNode.children[e].active=!1;for(var t=0;t<ReplayData.players.length;t++){var a=this.getLocalPosition(t),n=this.playerNodes[a].getChildByName("pokerBg"),i=this.playerNodes[a].getChildByName("nowChipsNum");i.getChildByName("Num").getComponent(cc.Label).string="0",i.active=!1,n.active=!1}},hideNodeChild:function(e){for(var t in e.children)e.children[t].active=!1},showRoomRule:function(){cc.find("roomNum",this.roomNode).getComponent(cc.Label).string=ReplayData.room;var e=ReplayData.opts;cc.find("roundBg/txt",this.roomNode).getComponent(cc.Label).string="局数:"+e.roundMax,cc.find("quanya/txt",this.roomNode).getComponent(cc.Label).string="全压:"+e.allin},runAction:function(){this.runNextAction()},runNextAction:function(){if(this._actionIndex++,this._actionIndex<ReplayData.game.length){var e=this._actionIndex+1;this.runSum.getComponent(cc.Label).string="进度: "+e+"/"+ReplayData.game.length;var t=ReplayData.game[this._actionIndex];if(t.type)switch(t.type){case"sendCards":this.showPokers(t.data),this.showPokerScore();break;case"initIncScore":this.basicScore(t.data);break;case"result":cc.log("game over"),this.getResultScore(t.data),this.gameResult(t.data);break;default:cc.log("data error")}else if(t.action){var a=t.uid,n=t.action,i=t.score;this.turnerActionEffect(n,i,a),this.getEveryOneScore(a,i)}}},showPokers:function(e){this.pokerScore={},this.darkPoker={};for(var t=0;t<ReplayData.players.length;t++){var a=ReplayData.players[t].uid;for(var n in e)if(e[a]){var i=e[a],o=TDKPokerCard.calcScore(i);this.pokerScore[a]||(this.pokerScore[a]=o);var r=this.getLocalPosition(t);this.showHandPokers(i,this.playCardsNode.children[r],a),this.playerNodes[r].getChildByName("nowChipsNum").active=!0}}},showHandPokers:function(e,t,a){for(var n=[],i=0;i<e.length;i++)i<2&&n.push(e[i]),t.children[i].active=!0,this.showPokerContent(t.children[i],e[i]);var o=TDKPokerCard.calcScore(n);this.darkPoker[a]||(this.darkPoker[a]=o)},showPokerContent:function(e,t){var a;a=1e3<t?t-1e3:t,e.getComponent(cc.Sprite).spriteFrame=null;var n="resources/TDK/UI/poker/poker_"+a+".png",i=cc.textureCache.addImage(cc.url.raw(n));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),this.showBorrowPoker(e,t)},showBorrowPoker:function(e,t){var a=!1;1e3<t&&(a=!0);var n=e.getChildByName(e.name+"_borrow");null==n?1==a&&(n=cc.instantiate(this.borrowPokerPre),cc.find("borrow",n).active=!0,e.addChild(n),n.name=e.name+"_borrow"):n.active=a},getEveryOneScore:function(e,t){for(var a=0;a<ReplayData.players.length;a++)if(null!=ReplayData.players[a]&&ReplayData.players[a].uid===e){var n=this.getLocalPosition(a),i=this.playerNodes[n].getChildByName("nowChipsNum"),o=i.getChildByName("Num").getComponent(cc.Label).string,r=parseInt(o)+t;cc.log("scoreToNum = "+r),i.getChildByName("Num").getComponent(cc.Label).string=r}},showPokerScore:function(){for(var e=0;e<ReplayData.players.length;e++)if(null!=ReplayData.players[e]){var t,a=ReplayData.players[e].uid,n=this.getLocalPosition(e),i=this.playerNodes[n].getChildByName("pokerBg"),o=i.getChildByName("pokerScore");i.active=!0,this.pokerScore[a]&&this.darkPoker[a]&&(t=this.darkPoker[a],o.getComponent(cc.Label).string=this.pokerScore[a]+"("+t+")")}},basicScore:function(e){for(var t=0;t<e.length;t++){var a=e[t].score;this.clipClick(a,e[t].uid),this.getEveryOneScore(e[t].uid,a)}},turnerActionEffect:function(e,t,a){this.showActionType(a,e),2===e?this.escapePoker(a):6===e?cc.log("buti"):this.clipClick(t,a)},showActionType:function(e,t){for(var a=0;a<ReplayData.players.length;a++)if(null!=ReplayData.players[a]&&ReplayData.players[a].uid===e){for(var n=this.getLocalPosition(a),i=this.playerNodes[n].getChildByName("actionType"),o=0;o<i.children.length;o++){var r=o+2;i.getChildByName("action"+r).active=r===t}this.scheduleOnce(function(){for(var e=0;e<i.children.length;e++){var t=e+2;i.getChildByName("action"+t).active=!1}},1)}},escapePoker:function(e){for(var t=0;t<ReplayData.players.length;t++){ReplayData.players[t].uid;var a=this.getLocalPosition(t);if(ReplayData.players[t].uid===e)return void(this.escapeNode.children[a].active=!0)}},gameResult:function(e){if(!(null===e||Object.keys(e).length<=0)){var n,i,o=e.winner;if(0===o)return this.languo.active=!0,this.languo.getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1),void(this.continueBtn.active=!0);var r=this;return this.scheduleOnce(function(){for(var e=0;e<ReplayData.players.length;e++)if(null!=ReplayData.players[e]&&ReplayData.players[e].uid===o){var t=this.getLocalPosition(e),a=r.playerNodes[t].position;n=a.x,i=a.y,r.winnerNode.children[t].active=!0,r.winnerNode.children[t].getComponent(dragonBones.ArmatureDisplay).playAnimation("newAnimation",1)}},1),void this.scheduleOnce(function(){for(var e=0;e<r.chipsNode.children.length;e++){var t=r.chipsNode.children[e],a={};cc.log("posX = "+n+",posY = "+i),a.x=n+(this.randomNum(0,180)-90),a.y=i+(this.randomNum(0,90)-45),r.resultChipsAnimation(t,a)}r.moveAboutScore(o),r.continueBtn.active=!0},3)}},resultChipsAnimation:function(e,t){var a=cc.moveTo(.4,t),n=cc.callFunc(function(){e.active=!1,e.destroy()},e);e.runAction(cc.sequence(a,n))},moveAboutScore:function(c){cc.log("this.preScore = "+JSON.stringify(this.preScore));var d=this;this.scheduleOnce(function(){for(var e=0;e<ReplayData.players.length;e++){var t=ReplayData.players[e].uid,a=d.getLocalPosition(e),n=d.scoreParent.getChildByName("score"+a),i=n.getChildByName("resultScore");if(null==i){if(i=cc.instantiate(d.scoreNode),c===t){var o=0;for(var r in d.preScore)r!=c&&(o+=d.preScore[r]);i.getComponent("tdk-resultFlyScore").getScoreColor(o)}else i.getComponent("tdk-resultFlyScore").getScoreColor(0-d.preScore[t]);i.active=!0,n.addChild(i)}var s=cc.moveBy(.75,cc.p(0,60));i.runAction(s)}},.5),this.scheduleOnce(function(){for(var e=0;e<d.scoreParent.children.length;e++)d.scoreParent.children[e].removeAllChildren();d.changeSumScore()},1.5)},changeSumScore:function(){for(var e=0;e<ReplayData.players.length;e++)if(null!=ReplayData.players[e]){var t=ReplayData.players[e].uid,a=(this.getPlayerInfoByUid(t),this.getLocalPosition(e));this.playerNodes[a].getChildByName("TableTDKPlayerTemplate").getComponent("TDK-playerTemplate").setCoin(ReplayData.scores[t])}},getResultScore:function(e){var t=e.result;for(var a in this.preScore={},t){var n=arraySum(t[a]);this.preScore[a],this.preScore[a]=n}},clipClick:function(e,t){for(var a=e,n=[0,0,0,0],i=0;i<n.length;i++)n[i]=this.spliceScore(a)[i];for(i=0;i<n.length;i++)for(var o=0;o<n[i];o++){for(var r=0;r<ReplayData.players.length;r++){var s=this.getLocalPosition(r);if(ReplayData.players[r].uid===t){var c=this.playCardsNode.children[s];this.chips[i].x=c.x,this.chips[i].y=c.y}}var d=cc.instantiate(this.chips[i]);d.parent=this.chipsNode,d.x=this.chips[i].x,d.y=this.chips[i].y,d.active=!0,this.clipFlyToTableAnimation(d)}cc.log("筹码数量："+this.chipsNode.childrenCount)},clipFlyToTableAnimation:function(e){var t=this.randomNum(0,400)-200,a=this.randomNum(0,100)-100,n=cc.moveTo(.3,cc.p(t,a)),i=cc.callFunc(function(){e.removeFromParent(!0)},e),o=cc.fadeOut(.1);80<this.chipsNode.childrenCount?e.runAction(cc.sequence(n,o,i)).easing(cc.easeCubicActionOut()):e.runAction(n).easing(cc.easeCubicActionOut())},spliceScore:function(e){for(var t=[],a=[10,5,2,1],n=0;n<a.length;n++){var i=Math.floor(e/a[n]);t.push(i),e-=Math.floor(e/a[n])*a[n]}return t},randomNum:function(e,t){var a=t-e,n=Math.random()*a+e;return parseInt(n,10)},continueClick:function(){ReplayDataCenter.openReplayPanel=!0,cc.director.loadScene("home")},getPlayerInfoByUid:function(e){for(var t=0;t<ReplayData.players.length;t++)if(ReplayData.players[t].uid==e)return ReplayData.players[t];return null},getPlayerPosByUid:function(e){for(var t=0;t<ReplayData.players.length;t++)if(ReplayData.players[t].uid==e)return t;return null},getLocalPosition:function(e){for(var t=[],a=0;a<ReplayData.players.length;a++)t.push(a);var n=this.getPlayerPosByUid(GameData.player.uid),i=t.slice(t.indexOf(n));return(i=i.concat(t.slice(0,t.indexOf(n)))).indexOf(e)}}),cc._RF.pop()},{}],resultRunScore:[function(e,t,a){"use strict";cc._RF.push(t,"f1b49LAxbVOrYq6YBrFJg7C","resultRunScore"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,fonts:[cc.Font]},onLoad:function(){},getScoreColor:function(e){0<(this.scoreLabel.getComponent(cc.Label).string=e)?(this.scoreLabel.getComponent(cc.Label).string="+"+e,this.scoreLabel.getComponent(cc.Label).font=this.fonts[0]):e<0?(this.scoreLabel.getComponent(cc.Label).string=e,this.scoreLabel.getComponent(cc.Label).font=this.fonts[1]):0==e&&(this.scoreLabel.getComponent(cc.Label).string=e,this.scoreLabel.getComponent(cc.Label).font=this.fonts[2])}}),cc._RF.pop()},{}],resultView:[function(e,t,a){"use strict";cc._RF.push(t,"4e294U7rsNGH6Tc07lEgKtM","resultView");var v=e("gameConfig"),D=e("roomHandler");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,playerItem:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,createTime:cc.Label,roomID:cc.Label,roundNumber:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,shareBtn:cc.Button,readyBtn:cc.Button,font:{default:[],type:[cc.Font]},_curGameData:void 0},onEnable:function(){this.isMark=0,this.onShow()},initResultData:function(){cc.log("initResultData"),this.isHuType=!1,this._curGameData=v.getGameData()},onShow:function(){var e=D.getRoomData();if(null!=e&&(this.initResultData(),e.opts.joinermax)){this.showResultIcon();for(var t=0;t<e.opts.joinermax;t++)this.showPlayer(t),this.showCards(t),this.showScore(t),this.showDetail(t),this.showWinIcon(t);this.showRoundInfo()}},showPlayer:function(e){var t=D.getRoomData();if(null!=t){var a=this._curGameData;if(null!=a){var n=a.getGameInfoData();if(null!=n){var i=cc.find("player"+(e+1),this.resultLayer);null==i&&((i=cc.instantiate(this.playerItem)).parent=this.resultLayer,i.name="player"+(e+1),i.x=this.playerItem.x,i.y=this.playerItem.y-e*this.playerItem.height);var o=cc.find("/head/id",i),r=cc.find("/head/name",i),s=cc.find("/head/headpic",i),c=cc.find("/head/zhuang",i),d=cc.find("/head/creator",i),h=GameData.joiners[e],l=h.name.substring(0,6)+"...";r.getComponent(cc.Label).string=l,o.getComponent(cc.Label).string=h.uid,c.active=h.uid==n.zhuangUid,d.active=h.uid==t.creator;var u=s.getComponent(cc.Sprite);this.setIcon(u,h.headimgurl)}}}},showCards:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameInfoData();if(null!=a){var n=GameData.joiners[e],i=n.uid==a.winnerUid;i&&(this.isMark=0);var o=cc.find("player"+(e+1),this.resultLayer);if(null!=o){for(var r=cc.find("cards",o),s=cc.find("cardHand",r),c=0;c<s.getChildrenCount();c++){var d=s.getChildren()[c];d&&(d.active=!1)}var h=t.getHandCards(n.uid);if(null!=h){for(var l,u=h.length,m=1,p=1,g=u;0<=g;g--){var f=h[g];if(!(null==f||f<=0)){v.getGameRule().isWildCard(f)?(l=!0,p=u,u--):(l=!1,p=m,m++);var y=cc.find("cardHand"+p,s);y&&(y.active=!0,this.showCardContent(y,"mj_face_xia_shou",f),this.setMyHuierVisible(y,f,"down",l),this.setMyHuimageVisible(y,f,i))}}this.showPengCards(n,r,"mj_face_xia_chu")}}}}}},showScore:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameScoreData();if(null!=a){var n=cc.find("player"+(e+1),this.resultLayer);if(null!=n){var i=GameData.joiners[e].uid,o=cc.find("score",n);0<a[i]?(o.getComponent("cc.Label").font=this.font[0],o.getComponent("cc.Label").string="+"+a[i]):a[i]<0?(o.getComponent("cc.Label").font=this.font[1],o.getComponent("cc.Label").string=a[i]):0==a[i]&&(o.getComponent("cc.Label").font=this.font[2],o.getComponent("cc.Label").string=a[i])}}}}},showDetail:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t)if(null!=t.getGameInfoData()){var a=cc.find("player"+(e+1),this.resultLayer);if(null!=a)GameData.joiners[e],cc.find("term",a).getComponent(cc.Label)}}},setIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},setMyHuierVisible:function(e,t,a,n){var i=e.getChildByName(e.name+"_huier");null==i?1==n&&((i=cc.instantiate(this.cardHuier)).y=i.y-18,e.addChild(i),i.name=e.name+"_huier",cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0):i.active=n},setMyHuimageVisible:function(e,t,a){var n=!1;0==a?n=!1:0==this.isMark&&(n=!0);var i=e.getChildByName(e.name+"_hu");null==i?1==n&&((i=cc.instantiate(this.cardHuimage)).y=i.y-20,e.addChild(i),i.name=e.name+"_hu"):i.active=n,1==n&&(this.isMark=1)},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a){if(null!=D.getRoomData()){var n=this._curGameData;if(null!=n&&!(null==t||null==e||Object.keys(e).length<=0)){for(var i=cc.find("cardPeng",t),o=0;o<i.getChildrenCount();o++){var r=i.getChildren()[o];r&&(r.active=!1)}var s=n.getChiCards(e.uid),c=n.getPengCards(e.uid),d=n.getGangCards(e.uid);if(null!=s&&null!=d&&null!=c){var h,l,u,m,p,g,f,y,v=c.concat(s),C=parseInt(GameData.client.handsize/3);for(h=0;h<v.length&&!(C<=h);h++)if(l=cc.find("cardPeng"+(h+1),i)){for(u=0;u<4&&(m=l.getChildByName("card_face"+(u+1)).getComponent(cc.Sprite),null!=(g=v[h]))&&!(null==(f=g.cards)||f.length<=0);u++)1<=f.length&&f.sort(function(e,t){return e-t}),u<f.length?(m.node.active=!0,3==u&&((p=l.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1),y=f[u],this.showCardContent(m.node,a,y)):m.node.active=!1;l.active=!0}for(;h<d.length&&!(C<=h);h++)if(l=cc.find("cardPeng"+(h+1),i)){for(u=0;u<4&&(m=l.getChildByName("card_face"+(u+1)).getComponent(cc.Sprite),null!=(g=d[h]))&&!(null==(f=g.cards)||f.length<=0);u++)u<f.length?(m.node.active=!0,3==u&&(p=l.getChildByName("card_back4").getComponent(cc.Sprite),g.type==GangType.Gang_An?(m.node.active=!1,p.node.active=!0):p.node.active=!1),y=f[u],this.showCardContent(m.node,a,y)):m.node.active=!1;l.active=!0}}}}},showWinIcon:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameInfoData();if(null!=a){var n=cc.find("player"+(e+1),this.resultLayer);if(null!=n){var i=GameData.joiners[e].uid;cc.find("huIcon",n).active=i==a.winnerUid}}}}},showResultIcon:function(){var e=this._curGameData;if(null!=e){var t=e.getGameScoreData();if(!(null==t||Object.keys(t).length<=0)){var a=t[GameData.player.uid];0<a?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):a<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)}}},showRoundInfo:function(){var e=D.getRoomData();if(null!=e){var t=this._curGameData;if(null!=t)if(null!=t.getGameInfoData()){this.roomID.string="房号："+e.id;var a=getTimeStr(e.createtime);this.createTime.string=a[0]+"/"+a[1]+"/"+a[2]+"  "+a[3]+":"+a[4]+":"+a[5];var n=e.gameNum;this.roundNumber.string="第"+n+"局"}}},setReady:function(){GameData.roomClose?sendEvent("onShowView","summaryView"):(D.setReady(),sendEvent("onCloseView","resultView"),sendEvent("onRoomInfo",{force:!0}))},shareRet:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameConfig:"gameConfig",roomHandler:"roomHandler"}],"roomChaShui-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"f2f265yO+JDe7wTuAFQKnqs","roomChaShui-shishi"),cc.Class({extends:cc.Component,properties:{layer_up:cc.Node,layer_down:cc.Node,layer_left:cc.Node,layer_right:cc.Node,ok_btn:cc.Button,no_btn:cc.Button,headNodes:{default:[],type:cc.Node},action_up:!1,action_down:!1,action_left:!1,action_right:!1},onLoad:function(){cc.log("..chashui.onLoad"),registEvent("startWater",this,this.UIControl),1!=GameDataShiShi.setWater&&this.showChaShuiState();var t=this;this.ok_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendChaShuiMes(2),t.ok_btn.node.active=!1,t.no_btn.node.active=!1}),this.no_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendChaShuiMes(0),t.ok_btn.node.active=!1,t.no_btn.node.active=!1})},onDestroy:function(){unregistEvent("startWater",this,this.UIControl)},sendChaShuiMes:function(e){MjHandler.getInstance().requestSetWater(e,function(e){})},ShowUI:function(){this.setUI(!0),this.action_up=!1,this.action_down=!1,this.action_left=!1,this.action_right=!1,this.setWaterFlag(this.headNodes[0],"down"),this.setWaterFlag(this.headNodes[1],"right"),this.setWaterFlag(this.headNodes[2],"up"),this.setWaterFlag(this.headNodes[3],"left")},CloseUI:function(){1==this.action_up&&1==this.action_down&&1==this.action_left&&1==this.action_right&&this.setUI(!1)},setUI:function(e){this.node.active=e},UIControl:function(){0==this.node.active&&this.ShowUI(),this.showChaShuiState()},showChaShuiState:function(){cc.log("...data...:"+JSON.stringify(GameDataShiShi.setWater));var e=GameDataShiShi.setWater;if(this.ok_btn.node.active=!1,this.ok_btn.node.active=!1,null!=GameDataShiShi.setWater){var t=GameData.getPlayerByPos("down");t&&null==e[t.uid]&&(this.ok_btn.node.active=!0,this.no_btn.node.active=!0),t?(this.layer_down.active=!0,cc.find("down/choice",this.node).active=!1,cc.find("down/no",this.node).active=!1,cc.find("down/yes",this.node).active=!1,0<=e[t.uid]&&(0==this.action_down?this.runMoveActionFlag("down",e[t.uid]):this.layer_down.active=!1)):(this.layer_down.active=!1,this.action_down=!0),(t=GameData.getPlayerByPos("right"))?(this.layer_right.active=!0,cc.find("right/choice",this.node).active=!0,cc.find("right/no",this.node).active=!1,cc.find("right/yes",this.node).active=!1,0<=e[t.uid]&&(0==this.action_right?this.runMoveActionFlag("right",e[t.uid]):this.layer_right.active=!1)):(this.layer_right.active=!1,this.action_right=!0),(t=GameData.getPlayerByPos("up"))?(this.layer_up.active=!0,cc.find("up/choice",this.node).active=!0,cc.find("up/no",this.node).active=!1,cc.find("up/yes",this.node).active=!1,0<=e[t.uid]&&(0==this.action_up?this.runMoveActionFlag("up",e[t.uid]):this.layer_up.active=!1)):(this.layer_up.active=!1,this.action_up=!0),(t=GameData.getPlayerByPos("left"))?(this.layer_left.active=!0,cc.find("left/choice",this.node).active=!0,cc.find("left/no",this.node).active=!1,cc.find("left/yes",this.node).active=!1,0<=e[t.uid]&&(0==this.action_left?this.runMoveActionFlag("left",e[t.uid]):this.layer_left.active=!1)):(this.layer_left.active=!1,this.action_left=!0)}},runMoveActionFlag:function(e,t){if(null!=t){var a,n;switch(e){case"down":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[0],this.action_down=!0;break;case"right":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[1],this.action_right=!0;break;case"up":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[2],this.action_up=!0;break;case"left":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[3],this.action_left=!0}this.setWaterFlag(n,e);var i=cc.scaleTo(.25,1.4),o=cc.delayTime(.5),r=cc.scaleTo(1,.6),s=cc.fadeOut(1),c=this;a.stopAllActions(),a.runAction(cc.sequence(i,o,cc.spawn(r,s),cc.callFunc(function(){a.active=!1,a.scale=1,a.opacity=255,c.CloseUI()},this)))}},setWaterFlag:function(e,t){var a=GameData.getPlayerByPos(t);if(a){var n=e.getChildByTag(a.uid);n&&n.getComponent("playerTemplate").setChaShuiIconShow(t)}}}),cc._RF.pop()},{}],"roomDissolve-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"18df19/FuFLabawULNokLcL","roomDissolve-shishi");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),null!=GameData.game.onRoomDissolve&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.lastTimeLabel.string="",this.openDisAgree=!1},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=2;e<=GameData.room.joinermax;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+e,t.x=this.headerNode.x+200*(e-1)}},showPlayers:function(){if(GameData.room.joinermax)for(var e=0;e<GameData.room.joinermax;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){a.uid;var n=a.headimgurl;if(this.showHeaderIcon(t,n),this.showHeaderName(t,a.name),2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("roomMain-shishi").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("roomMain-shishi").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("roomMain-shishi").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("roomMain-shishi").showSettingLayer(1,0)},requestDissolveAgree:function(){n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],roomDissolve_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"2fe0cFaciJAELrkMqU9+iCM","roomDissolve_changchun");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),null!=GameData.game.onRoomDissolve&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.lastTimeLabel.string="",this.openDisAgree=!1},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=2;e<=GameData.room.opts.joinermax;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+e,t.x=this.headerNode.x+200*(e-1)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1,a=GameData.joiners[e],n=cc.find("header_"+t,this.headerNode.parent);if(null!=a){a.uid;var i=a.headimgurl;if(this.showHeaderIcon(t,i),this.showHeaderName(t,a.name),n.active=!0,2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}else n.active=!1}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("roomMain_changchun").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("roomMain_changchun").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("roomMain_changchun").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("roomMain_changchun").showSettingLayer(1,0)},requestDissolveAgree:function(){n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],roomDissolve_heb:[function(e,t,a){"use strict";cc._RF.push(t,"399a5/zgqlKM5BL2MAub3Ry","roomDissolve_heb");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),null!=GameData.game.onRoomDissolve&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.lastTimeLabel.string="",this.openDisAgree=!1},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=2;e<=GameData.room.opts.joinermax;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+e,t.x=this.headerNode.x+200*(e-1)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1,a=GameData.joiners[e],n=cc.find("header_"+t,this.headerNode.parent);if(null!=a){a.uid;var i=a.headimgurl;if(this.showHeaderIcon(t,i),this.showHeaderName(t,a.name),n.active=!0,2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}else n.active=!1}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("roomMain_heb").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("roomMain_heb").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("roomMain_heb").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("roomMain_heb").showSettingLayer(1,0)},requestDissolveAgree:function(){n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],roomDissolve_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"383edR5a8ZAIJSuq9N82qch","roomDissolve_huadian");var n=e("roomHandler");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),null!=GameData.game.onRoomDissolve&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.lastTimeLabel.string="",this.openDisAgree=!1},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=2;e<=GameData.room.opts.joinermax;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+e,t.x=this.headerNode.x+200*(e-1)}},showPlayers:function(){if(GameData.room.opts.joinermax)for(var e=0;e<GameData.room.opts.joinermax;e++){var t=e+1,a=GameData.joiners[e],n=cc.find("header_"+t,this.headerNode.parent);if(null!=a){a.uid;var i=a.headimgurl;if(this.showHeaderIcon(t,i),this.showHeaderName(t,a.name),n.active=!0,2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}else n.active=!1}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.opts.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("roomMain_huadian").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("roomMain_huadian").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){0==e&&(this.node.getComponent("roomMain_huadian").showSummaryLayer(),this.unschedule(this.updateLastTime))},requestDissolve:function(){n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("roomMain_huadian").showSettingLayer(1,0)},requestDissolveAgree:function(){n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{roomHandler:"roomHandler"}],roomDissolve:[function(e,t,a){"use strict";cc._RF.push(t,"e167bDTLXFN/qZymDWP84Vf","roomDissolve");var n=e("roomHandler"),i=e("gameDefine"),o=e("SoundMngr");cc.Class({extends:cc.Component,properties:{headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){this.initHeaderUI(),registEvent("onRoomDissolve",this,this.showDissolveText),this.lastTimeLabel.string="",null!=GameData.game.onRoomDissolve&&GameData.client.gameType==i.GameType.Game_Mj_Tianjin&&sendEvent("onRoomDissolve",GameData.game.onRoomDissolve),this.openDisAgree=!1,registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect)},onDestroy:function(){unregistEvent("onRoomDissolve",this,this.showDissolveText),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.joinermax-1;e++){var t=cc.instantiate(this.headerNode);t.parent=this.headerNode.parent,t.name="header_"+(e+2),t.x=this.headerNode.x+200*(e+1)}},showPlayers:function(){if(GameData.room.joinermax)for(var e=0;e<GameData.room.joinermax;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){a.uid;var n=a.headimgurl;if(this.showHeaderIcon(t,n),this.showHeaderName(t,a.name),2==a.status)console.log("joiner.status =="+a.status),cc.find("header_"+t+"/lost",this.headerNode.parent).active=!0}}},showHeaderName:function(e,t){cc.find("header_"+e+"/nameLabel",this.headerNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},showAgreeIcon:function(e,t){cc.find("header_"+e+"/duigou",this.headerNode.parent).active=t},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/headimg",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree)for(var t=this,a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a];if(n&&n.uid==e){var i=n.name;return createMessageBox("因［"+i+"］拒绝解散房间，游戏需继续进行",function(){t.openDisAgree=!1}),void(this.openDisAgree=!0)}}},resetUI:function(){this.agreeWaitNode.active=!1;for(var e=0;e<GameData.room.joinermax;e++)this.showAgreeIcon(e+1,!1)},showDissolveText:function(e){GameData.showResult=!1;var t=e.detail;this.alreadyAgree(!0),this.resetUI();var a=t.isStart;for(var n in this.showPlayers(),t.select){for(var i=0,o=0;o<GameData.joiners.length;o++){if((r=GameData.joiners[o])&&r.uid==n){i=o+1;break}}if("apply"==t.select[n]){"申请解散房间";for(o=0;o<GameData.joiners.length;o++){var r;(r=GameData.joiners[o])&&r.uid==n&&(this.dissolvePerson.string="["+r.name+"]发起投票解散对局")}this.showAgreeIcon(i,!0)}else if("agree"==t.select[n])"同意解散房间",this.showAgreeIcon(i,!0);else if("disagree"==t.select[n])return"拒绝解散房间",0,this.node.getComponent("roomMain").showdissolveLayer(1,0),void this.handleSomebodyDisagree(n);"agree"!=t.select[n]&&"apply"!=t.select[n]||n!=GameData.player.uid||this.alreadyAgree(!1)}null==t||Object.keys(t).length<=0||(this.node.getComponent("roomMain").showdissolveLayer(1,1),this.handleVoteResult(a),this.handleRoomDisbandTimer(t))},handleVoteResult:function(e){if(0==e){var t=this;this.node.getComponent("roomMain").showdissolveLayer(1,0);var a=cc.sequence(cc.delayTime(.1),cc.callFunc(function(){t.node.getComponent("roomMain").shutDissolveLayer()}));this.node.runAction(a),this.unschedule(this.updateLastTime)}},requestDissolve:function(){o.instance.playAudioOther("button"),n.deleteRoom(GameData.room.id,"apply"),this.node.getComponent("roomMain").showSettingLayer(1,0)},requestDissolveAgree:function(){o.instance.playAudioOther("button"),n.deleteRoom(GameData.room.id,"agree")},requestDissolveDisagree:function(){o.instance.playAudioOther("button"),n.deleteRoom(GameData.room.id,"disagree")},handleRoomDisbandTimer:function(e){this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1)},updateLastTime:function(){this.lastTime--;var e="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1);this.lastTimeLabel.string=e,this.lastTime<=0&&(n.deleteRoom(GameData.room.id,"close"),this.unschedule(this.updateLastTime))},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(n&&n.uid==e)return void(cc.find("header_"+i+"/lost",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomEndClear:[function(e,t,a){"use strict";cc._RF.push(t,"152dfFQiY5G0L+H93VlPRrZ","roomEndClear");var n=cc.Class({extends:cc.Component,properties:{roomEndClear:{default:null,type:cc.Node},gainsLayer:{default:null,type:cc.Node},detailLayer:{default:null,type:cc.Node},gainsBtn:{default:null,type:cc.Node},detailBtn:{default:null,type:cc.Node},gainsSprite:cc.Node,detailSprite:cc.Node,roomInfoNode:cc.Node,bottomNode:cc.Node,UIPlayerRoundDetail:cc.Node,content:{default:null,type:cc.Node},roomID:{default:null,type:cc.Label},roundNum:{default:null,type:cc.Label},houseOwner:{default:null,type:cc.Label},time:{default:null,type:cc.Label},fonts:{default:[],type:cc.Font},playerRound:cc.Prefab,roundDetailPanel:cc.Prefab,playerRoundDetail:cc.Prefab},onLoad:function(){this.cumulativeScore=0,this.playerAllScoreList=[],this.playerRoundScoreList=[],this.roundCumulativeScoreList=[],this.gainsLayer.active=!0,this.detailLayer.active=!1,this.gainsBtn.active=!1,this.detailBtn.active=!0,this.gainsSprite.active=!0,this.detailSprite.active=!1,this.roomInfoNode.active=!0,this.bottomNode.active=!0,this.curPageIndex=0,this.initGainsLayer(),this.initPlayerRoundScore(),this.initDetailLayer(),this.showRoomInfo(),this.playAnimation(),this.play()},onDestroy:function(){},play:function(){this.schedule(this.playAnimation,1)},playAnimation:function(){var e=cc.find("topNode",this.roomEndClear);cc.find("animate",e).getComponent(cc.Animation).play("paomadengdonghua")},initGainsLayer:function(){if(this.initPlayerAllScoreList(),this.playerRound)for(var e=0;e<GameData13.room.joinermax;e++){var t=cc.instantiate(this.playerRound);t.parent=this.content,this.setPlayerRound(t,e+1,this.playerAllScoreList[e].score,GameData13.game.roundNum,this.playerAllScoreList[e].uid)}},initDetailLayer:function(){var e=0;if(!GameData13.isEmptyObject(GameData13.gemaEndResult)){if(GameData13.gemaEndResult.history.length<=0)return void cc.log("GameData13.gemaEndResult.history is empty.");e=GameData13.gemaEndResult.history.length}for(var t=cc.find("layer",this.detailLayer),a=14*this.curPageIndex,n=0;n<t.getChildrenCount();n++){var i=t.getChildren()[n];i&&(i.active=!1)}for(var o=0;o<14&&!(e<=a+o);o++){var r=t.getChildren()[o];if(null==r){(r=cc.instantiate(this.roundDetailPanel)).parent=t;var s=.05*r.width,c=t.height-1.1*r.height,d=s+parseInt(o%2)*(1.02*r.width),h=c-parseInt(o/2)*(1.1*r.height);r.position=cc.p(d,h)}r.tag=a+o,r.active=!0,r.on(cc.Node.EventType.TOUCH_END,this.showUIPlayerRoundDetail,this),this.setRoundDetail(r,a+o,this.playerRoundScoreList[a+o],this.roundCumulativeScoreList[a+o])}var l=cc.find("lastButton",this.detailLayer),u=cc.find("nextButton",this.detailLayer);l.on(cc.Node.EventType.TOUCH_END,this.lastPageBtnClick,this),u.on(cc.Node.EventType.TOUCH_END,this.nextPageBtnClick,this)},showUIPlayerRoundDetail:function(e){cc.log("UIPlayerRoundDetail");var t=parseInt(e.target.tag);this.UIPlayerRoundDetail.active=!0,this.initPlayerRoundDetailLayer(t)},closeUIPlayerRoundDetail:function(){this.UIPlayerRoundDetail.active=!1},initPlayerRoundDetailLayer:function(e){var t=GameData13.gemaEndResult.history[e];if(!(null==t||Object.keys(t).length<=0)){cc.find("soundLabel",this.UIPlayerRoundDetail).getComponent(cc.Label).string=e+1;for(var a=cc.find("layer",this.UIPlayerRoundDetail),n=0;n<a.getChildrenCount();n++){var i=a.getChildren()[n];i&&(i.active=!1)}for(var o=0;o<GameData13.joiners.length;o++){if(null!=GameData13.joiners[o]){var r=a.getChildren()[o];if(null==r){var s=((r=cc.instantiate(this.playerRoundDetail)).parent=a).height-r.height,c=5+parseInt(o%2)*(r.width+5),d=s-parseInt(o/2)*r.height;r.position=cc.p(c,d)}r.active=!0;var h=r.getComponent("playerRoundDetail");h.id=o,h.setRoundNum(e),h.showPlayerRoundDetail()}}}},initPlayerAllScoreList:function(){var e=0;if(GameData13.isEmptyObject(GameData13.gemaEndResult))cc.log("GameData13.gameEndResult is empty.");else{if(GameData13.gemaEndResult.score.length<=0)return void cc.log("GameData13.gameEndResult.score is empty.");for(var t=0;t<GameData13.room.joinermax;t++)e=GameData13.gemaEndResult.score[GameData13.joiners[t].uid],this.playerAllScoreList.push({score:Number(e),uid:GameData13.joiners[t].uid})}this.sortScoreArray(this.playerAllScoreList),cc.log("playerAllScoreList: ",JSON.stringify(this.playerAllScoreList))},initPlayerRoundScore:function(){if(null!=GameData13.gemaEndResult.history){cc.log("..history:"+JSON.stringify(GameData13.gemaEndResult.history));var e=0;if(GameData13.isEmptyObject(GameData13.gemaEndResult))cc.log("GameData13.gameEndResult is empty.");else{if(GameData13.gemaEndResult.history.length<=0)return void cc.log("GameData13.gameEndResult.history is empty.");for(var t=0;t<GameData13.gemaEndResult.history.length;t++)e=GameData13.gemaEndResult.history[t][GameData.player.uid].score,this.playerRoundScoreList.push(e),this.roundCumulativeScoreList.push(this.roundCumulativeScore(e))}}else cc.log("GameData13.gameEndResult.history is undefined")},sortScoreArray:function(e){e.sort(function(e,t){return t.score-e.score})},showPlayerHead:function(e,n,i,o){var r=cc.find("player/headNode",e);cc.loader.loadRes("shisanshui/prefab/poker13PlayerTemplate",function(e,t){if(!e){var a=cc.instantiate(t);r.addChild(a),a.getComponent("playerTemplate").setHeadIcon(GameData13.getJoinerByUid(n).headimgurl),a.getComponent("playerTemplate").setSSSWinNodeActive(i),a.getComponent("playerTemplate").setSSSMainNodeActive(o)}})},showRoomInfo:function(){isChinese(GameData13.getJoinerByUid(GameData13.owner).name)?this.houseOwner.string="房主:"+getShortStr(GameData13.getJoinerByUid(GameData13.owner).name,5):isChinese(GameData13.getJoinerByUid(GameData13.owner).name)||(this.houseOwner.string="房主:"+getShortStr(GameData13.getJoinerByUid(GameData13.owner).name,8)),this.roomID.string="房间:"+GameData13.getJoinerByUid(GameData13.owner).roomid;var e=GameData13.game.roundNum>GameData13.room.roundmax?GameData13.room.roundmax:GameData13.game.roundNum;this.roundNum.string="局数:"+e;var t=new Date(GameData13.createtime),a=(t.getFullYear(),t.getMonth()+1),n=t.getDate(),i=t.getHours();i<10?i="0"+i+":":i+=":";var o=t.getMinutes();o=o<10?"0"+o:o,this.time.string="开局时间:"+a+"-"+n+"  "+i+o;var r=cc.find("roomID",this.UIPlayerRoundDetail),s=cc.find("time",this.UIPlayerRoundDetail);r.getComponent(cc.Label).string="房间:"+GameData13.getJoinerByUid(GameData13.owner).roomid,s.getComponent(cc.Label).string="开局时间:"+a+"-"+n+"  "+i+o},roundCumulativeScore:function(e){return this.cumulativeScore+=e,this.cumulativeScore},setPlayerRound:function(e,t,a,n,i){var o=cc.find("roundNum",e),r=cc.find("scoreLabel",e),s=cc.find("player/name",e),c=cc.find("player/id",e),d=cc.find("player/rank",e);isChinese(GameData13.getJoinerByUid(i).name)?s.getComponent(cc.Label).string=getShortStr(GameData13.getJoinerByUid(i).name,5):isChinese(GameData13.getJoinerByUid(i).name)||(s.getComponent(cc.Label).string=getShortStr(GameData13.getJoinerByUid(i).name,8)),c.getComponent(cc.Label).string=i,d.getComponent(cc.Label).string=t,o.getComponent(cc.Label).string=n,0<a?(r.getComponent(cc.Label).font=this.fonts[0],r.getComponent(cc.Label).string="+"+a):a<0?(r.getComponent(cc.Label).font=this.fonts[1],r.getComponent(cc.Label).string=a):0==a&&(r.getComponent(cc.Label).font=this.fonts[2],r.getComponent(cc.Label).string=a);var h=!1,l=!1;1==t&&(h=!0),i==GameData13.owner&&(l=!0),this.showPlayerHead(e,i,h,l)},setRoundDetail:function(e,t,a,n){var i=e.getComponent("roundDetail");i.id=t,i.setRoundNumString(t+1),i.setScoreNodeString(a),i.setAllScoreNodeString(n)},lastPageBtnClick:function(){cc.log("..last"),this.curPageIndex<=0?createSSSMoveMessage("已是第一页"):(this.curPageIndex--,this.initDetailLayer())},nextPageBtnClick:function(){cc.log("..next");var e=GameData13.gemaEndResult.history.length,t=parseInt(e/14);1<=t&&0<e%14&&t++,this.curPageIndex>=t-1?createSSSMoveMessage("已是最后页"):(this.curPageIndex++,this.initDetailLayer())},onGainsBtnCliked:function(e){this.detailLayer.active=!1,this.gainsLayer.active=!0,this.gainsBtn.active=!1,this.detailBtn.active=!0,this.gainsSprite.active=!0,this.detailSprite.active=!1,this.roomInfoNode.active=!0,this.bottomNode.active=!0},onDetailBtnClied:function(e){this.gainsLayer.active=!1,this.detailLayer.active=!0,this.gainsBtn.active=!0,this.detailBtn.active=!1,this.gainsSprite.active=!1,this.detailSprite.active=!0,this.roomInfoNode.active=!1,this.bottomNode.active=!1},onBackBtnClied:function(e){GameData13.clearAllGameData(),GameData.player.roomid=void 0,GameData.SetLayerData.soundOpen=!0,cc.director.loadScene("home")}});t.exports=n,cc._RF.pop()},{}],roomHandler:[function(e,t,a){"use strict";cc._RF.push(t,"196d6LNNThDMaMnHbMhkkya","roomHandler");var i=e("tdkRoomData"),n=e("hongzhongData"),o=e("ZJH-RoomData"),r=e("hhdz_data"),s=e("gameDefine"),c=e("errorCode"),d={room:{},coinData:{},scores:{},players:[],onlines:[],readyData:{},readyCountDown:0,dissolveData:{},playGame:{},recordData:[]};(t.exports=d).createRoom=function(e){var a=this;openView("Loading"),GameNet.getInstance().request("room.roomHandler.createRoom",e,function(e){if(!e||null==e.result)return messageBoxWithoutCB("_createRoomCallBack error"),void closeView("Loading");if(e.result!=c.Success){var t="";switch(e.result){case c.LessCard:t="房卡不足.";break;case c.NoJoinThisClub:t="抱歉!您不在该俱乐部.";break;case c.AgentMoneyNotEnough:t="代理钻石不足,请通知代理及时充值.";break;case c.AgentRoomMax:t="同时只能代开20个房间.";break;case c.LessPoint:t="积分不足.";break;case c.LessCoin:t="金币不足.";break;default:t="创建房间失败 "+e.result}return messageBoxWithoutCB(t),void closeView("Loading")}return e.isAgentRoom?(createMoveMessage("代开房间成功."),openView("agentPanel"),closeView("Loading"),a.reqAgentRoom(),void a.reqAgentResultRoom()):e.roomid?(GameData.saveCreateRoomOpts(),void a.enterRoom(e.roomid)):(messageBoxWithoutCB("createRoom cb error roomid"),void closeView("Loading"))})},d.enterRoom=function(e){var t=Number(e);if(t<1e5||999999<t)return messageBoxWithoutCB("房间号无效"),void closeView("Loading");var a={roomid:t,posInfo:getPosInfo()};openView("Loading"),GameNet.getInstance().request("room.roomHandler.enterRoom",a,function(e){if(textClipboard("1"),!e||null==e.result)return closeView("Loading"),void messageBoxWithoutCB("enterRoom without ret");if(e.result!=c.Success){var t="";switch(e.result){case c.roomNotFound:t="房间不存在.";break;case c.roomFull:t="房间已满.";break;case c.LessCard:t="房卡不足.";break;case c.LessPoint:t="积分不足.";break;case c.NoJoinThisClub:t="抱歉!您不在该俱乐部.";break;case c.LessCoin:t="金币不足.";break;default:t="进入房间失败"}closeView("Loading"),createMoveMessage(t)}GameData.initGameData()})},d.quitRoom=function(e){GameNet.getInstance().request("room.roomHandler.quitRoom",{roomid:e},function(e){e.result==c.Success&&(GameData.player.roomid=void 0,cc.director.loadScene("home"))})},d.deleteRoom=function(e,t){GameNet.getInstance().request("room.roomHandler.disbandRoom",{roomid:e,action:t},function(e){})},d.setReady=function(){GameNet.getInstance().request("room.roomHandler.ready",{},function(e){})},d.reqAgentRoom=function(){GameNet.getInstance().request("game.playerHandler.reqAgentRoom",{},function(e){GameData.AgentRoomsData=e,sendEvent("refreshAgentRoomUINew")})},d.reqAgentResultRoom=function(){GameNet.getInstance().request("game.playerHandler.AgentResultRoom",{},function(e){GameData.AgentResultRoom=e,sendEvent("refreshAgentRoomUIResult")})},d.getRoomData=function(){return this.room},d.getPlayersData=function(){return this.players},d.getPlayersCoin=function(){var e={};for(var t in this.players)this.players[t]&&(e[this.players[t].uid]=this.players[t].coin);return e},d.getPlayerByUid=function(e){for(var t=0;t<GameData.joiners.length;t++){var a=GameData.joiners[t];if(a&&a.uid==e)return a}return null},d.getPlayerPosByUid=function(e){for(var t=0;t<GameData.joiners.length;t++)if(GameData.joiners[t]&&GameData.joiners[t].uid&&GameData.joiners[t].uid==e)return t;return null},d.getLocalPosition=function(e){for(var t=[],a=0;a<GameData.joiners.length;a++)t.push(a);var n=this.getPlayerPosByUid(GameData.player.uid),i=t.slice(t.indexOf(n));return(i=i.concat(t.slice(0,t.indexOf(n)))).indexOf(e)},d.getScoreData=function(){return this.scores},d.getOnLinesData=function(){return this.onlines},d.getRoomReadyData=function(){return this.readyData},d.getRoomDissolveData=function(){return this.dissolveData},d.getRecordData=function(){return this.recordData},d.getCoinData=function(){return this.coinData},d.getPlayGame=function(){return this.playGame},d.getPlayGamePlayerArr=function(){for(var e=[],t=0;t<GameData.joiners.length;t++)for(var a in this.playGame)GameData.joiners[t]&&GameData.joiners[t].uid==a&&0<this.playGame[a]&&e.push(parseInt(a));return e},d.isPlayerOnline=function(e){return-1!=this.onlines.indexOf(e)},d.isPlayGameByUid=function(e){for(var t in this.playGame)if(t==e)return 0<this.playGame[t]},d.onRoomInfoSetData=function(e){if(null!=e){this.room=e.room,this.scores=e.scores,this.players=e.players,this.onlines=e.onlines,this.playGame=e.playerGames,null==e.record||(this.recordData=e.record),GameData.room=e.room,GameData.players=e.players,GameData.setGameType(e.room.opts.gameType),GameData.player.roomid=e.room.id,GameData.client.gameType=e.room.opts.gameType,GameData.joiners=[];for(var t=0;t<e.players.length;t++){var a=e.players[t];GameData.joiners[t]=a}GameData.room.status==s.RoomState.GAMEING&&GameData.room.opts.gameType==s.GameType.Game_MJ_HuaDian&&(GameData.game.gameStart=!0),e.room.opts.gameType==s.GameType.Game_Poker_TianjinDDZ?GameDataTJDDZ.setPosition():e.room.opts.gameType==s.GameType.Game_Poker_DDZ?GameDataDDZ.setPosition():e.room.opts.gameType==s.GameType.Game_Poker_paodekuai?GameDataPDK.setPosition():e.room.opts.gameType==s.GameType.Game_Poker_ZJH?o.setPosition():GameData.setPosition(),GameData.room.status<=s.RoomState.READY&&profileHuaDian.initGameData()}},d.onPrepareInfoSetData=function(e){null!=e&&(this.readyData=e)},d.onRoomDissolveSetData=function(e){null!=e&&(this.dissolveData=e)},d.getCurGameDataOnType=function(){if(this.room&&this.room.opts)switch(this.room.opts.gameType){case s.GameType.Game_Mj_HZ:return n;default:return}},d.registMessage=function(){cc.log("....roomHandler registMessage.");var n=this;GameNet.getInstance().setCallBack("onRoomMsg",function(e){for(var t in n.room=e.room,n.scores=e.scores,WriteLog("onRoomMsg:"+JSON.stringify(e)),GameData.room=e.room,GameData.players=e.players,GameData.setGameType(e.room.opts.gameType),GameData.player.roomid=e.room.id,GameData.joiners.splice(0,GameData.joiners.length),e.players){var a=e.players[t];GameData.joiners[a.seat]=a}GameData.setPosition(),GameData.allScores=e.scores,GameData.showResult=!0,sendEvent("onRoomMsg",e)}),GameNet.getInstance().setCallBack("onRoomInfo",function(e){n.onRoomInfoSetData(e),sendEvent("onRoomInfo",e)}),GameNet.getInstance().setCallBack("onRoomEnter",function(e){var t;switch(n.room.opts.gameType){case s.GameType.Game_Mj_Tianjin:t="table";break;case s.GameType.Game_Mj_Shishi:t="table-shishi";break;case s.GameType.Game_MJ_HuaDian:profileHuaDian.registAllMessage(),t="table-huadian1";break;case s.GameType.Game_Mj_CC:profileChangChun.registAllMessage(),t="table-changchun";break;case s.GameType.Game_Mj_Heb:profileHeb.registAllMessage(),t="table-heb";break;case s.GameType.Game_Mj_HZ:t="mahjong";break;case s.GameType.Game_niu_niu:t="table-niuNiu";break;case s.GameType.Game_Niu_Niu_10:t="table-tenNiuNiu";break;case s.GameType.Game_Niu_Hundred:t="hundredNiuNiu";break;case s.GameType.Game_Poker_DDZ:t="table-DDZ";break;case s.GameType.Game_Poker_TianjinDDZ:t="table-TJDDZ";break;case s.GameType.Game_TDK:t="table-TDK";break;case s.GameType.Game_Poker_13shui:t="teble-shisanshui";break;case s.GameType.Game_Poker_paodekuai:t="table-PDK";break;case s.GameType.Game_Poker_ZJH:t="table-ZJH";break;case s.GameType.Game_Poker_HHDZ:r.registMessage_hhdz(),t="table-hhdz";break;default:return}null!=t&&(GameData.roomClose=!1,t!=cc.director.getScene().name?cc.director.loadScene(t):(closeView("UIMatch"),closeView("Loading")))}),GameNet.getInstance().setCallBack("onRoomReadyInfo",function(e){GameData.game.onRoomReadyInfo.data=e,n.onPrepareInfoSetData(e),sendEvent("onRoomReadyInfo",e)}),GameNet.getInstance().setCallBack("onRoomQuit",function(e){sendEvent("onRoomQuit",e),e.uid==GameData.player.uid&&cc.director.loadScene("home")}),GameNet.getInstance().setCallBack("onRoomClose",function(e){GameData.roomClose=!0,sendEvent("onRoomClose",e)}),GameNet.getInstance().setCallBack("onRoomDissolve",function(e){n.onRoomDissolveSetData(e),GameData.game.onRoomDissolve=e,sendEvent("onRoomDissolve",e)}),GameNet.getInstance().setCallBack("onCreatorQuit",function(e){sendEvent("onCreatorQuit",e)}),GameNet.getInstance().setCallBack("onJoinerLost",function(e){sendEvent("onJoinerLost",e)}),GameNet.getInstance().setCallBack("onJoinerConnect",function(e){GameData.joinContact=e,sendEvent("onJoinerConnect",e)}),GameNet.getInstance().setCallBack("onPrepareInfo",function(e){n.readyCountDown=e.countdown,n.onPrepareInfoSetData(e.readyInfo),GameDataTJDDZ.game.onRoomReadyInfo=e.readyInfo,GameDataDDZ.game.onRoomReadyInfo=e.readyInfo,i.onRoomReadyInfo=e.readyInfo,i.close=!1,o.onRoomReadyInfo=e.readyInfo,0<n.readyCountDown&&sendEvent("onReadyCountDown"),sendEvent("onPrepareInfo",e.readyInfo)}),GameNet.getInstance().setCallBack("onGameCoin",function(e){n.coinData=e,GameData.scores=e,GameData.game.gameStart=!1,GameData.player.isXiangGong=!1;var t=e;switch(t.zhuangUid=GameData.game.zhuangUid,GameData.JushuScore.push(t),GameData.room.opts.gameType){case s.GameType.Game_Mj_Tianjin:sendEvent("onGameScore",e);break;case s.GameType.Game_Poker_DDZ:sendEvent("coinEndEvent",e);break;case s.GameType.Game_Poker_TianjinDDZ:e.coins[GameData.player.uid]?sendEvent("coinEndEvent",e):sendEvent("onShowSummary");break;case s.GameType.Game_Niu_Hundred:sendEvent("niuhun-onGameCoin",e);break;default:return}}),GameNet.getInstance().setCallBack("alertLottery",function(e){e&&(cc.log("data = "+JSON.stringify(e.detail)),e&&(GameData.room.opts.gameType==s.GameType.Game_niu_niu||GameData.room.opts.gameType==s.GameType.Game_Niu_Niu_10?sendEvent("alertLottery"):openView("GetLottery")))}),GameNet.getInstance().setCallBack("dynChat",function(e){sendEvent("dynChat",e)})},cc._RF.pop()},{"ZJH-RoomData":"ZJH-RoomData",errorCode:"errorCode",gameDefine:"gameDefine",hhdz_data:"hhdz_data",hongzhongData:"hongzhongData",tdkRoomData:"tdkRoomData"}],"roomMain-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"21fbeHgeUZFUbrB+J447ro/","roomMain-shishi");var n=e("SoundMngr"),o=e("ruleHandler");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node,layer_chaShui:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.showTableLayer),registEvent("onGameScore",this,this.showResultLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("startWater",this,this.openUIChaShui),registEvent("initCards",this,this.closeUIChaShui),o.instance.setGameType(GameData.client.gameType),GameData.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,1==GameData.openScore&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(3e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>2*this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),0<GameData.game.zhuangUid?this.showTableUI(!0):this.showTableUI(!1);var e="";GameData.room.opts&&(e=getRuleStrShiShi(GameData.room.opts));var t=cc.find("layer_table/term",this.node);t&&(t.getComponent("cc.Label").string=e)},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("onGameScore",this,this.showResultLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("startWater",this,this.openUIChaShui),unregistEvent("initCards",this,this.closeUIChaShui),GameData.initRoomData()},openUIChaShui:function(){this.showTableUI(!1)},closeUIChaShui:function(){this.showTableUI(!0)},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/wait")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/wait")},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&(GameData.joinContact.uid,GameData.player.uid),GameData.contact=!1,this.node.getComponent("roomResult-shishi").onShow()},showSettingLayer:function(e,t){1==t?openView("SettingsPanel-shishi"):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",ruleHandler:"ruleHandler"}],roomMain_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"57b9f8CkpRIUJwarZ7UKXMt","roomMain_changchun");var n=e("SoundMngr"),o=e("ruleHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){cc.log("onEnter 长春 table"),registEvent("onGameStart",this,this.showTableLayer),registEvent("onGameReady",this,this.showTableLayer),registEvent("onMahjongRunEnd",this,this.showResultLayer),registEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onStarPiao",this,this.openUIPiao),registEvent("initCards",this,this.closeUIPiao),o.instance.setGameType(GameData.client.gameType),GameData.room.status>=r.RoomState.READY?this.showTableLayer():this.showWaitLayer(),GameData.room.status>r.RoomState.READY?this.showTableUI(!0):this.showTableUI(!1),this.lostMessage=!1,1==GameData.openScore&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(2e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>4*this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),0<GameData.game.zhuangUid?this.showTableUI(!0):this.showTableUI(!1);var e="";GameData.room.opts&&(e=getRuleStrCC(GameData.room.opts));var t=cc.find("layer_table/term",this.node);t&&(t.getComponent("cc.Label").string=e)},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onStarPiao",this,this.openUIPiao),unregistEvent("initCards",this,this.closeUIPiao),cc.log("roomMain-destroy"),GameData.initRoomData(),profileHuaDian.initRoomData()},showLayer:function(){GameData.room.status>r.RoomState.READY?this.showTableUI(!0):this.showTableUI(!1)},openUIPiao:function(){this.uiWaitLayer.active=!1,this.resultLayer.active=!1,this.showTableUI(!1)},closeUIPiao:function(){this.showTableUI(!0)},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableLayer:function(){cc.log("~~~~~~~~~~~~~~show table layer and hide wait layer~~~~~~~~~~~~~~~~~");this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue"),GameData.room.status==r.RoomState.READY&&(this.showTableUI(!1),MjHandler.getInstance().requestReady(function(e){}))},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&(GameData.joinContact.uid,GameData.player.uid),GameData.contact=!1,this.node.getComponent("roomResult_changchun").onShow()},showSettingLayer:function(e,t){1==t?openView("SettingsPanel_CC",r.GameType.Game_Mj_CC):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showJoinerConnect:function(){this.showLayer()},showChat:function(){inCD(2e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomMain_heb:[function(e,t,a){"use strict";cc._RF.push(t,"22361P/X6JE340TrO5oc6/b","roomMain_heb");var n=e("SoundMngr"),o=e("ruleHandler"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){cc.log("onEnter 哈尔滨 table"),registEvent("onGameStart",this,this.showTableLayer),registEvent("onGameReady",this,this.showTableLayer),registEvent("onMahjongRunEnd",this,this.showResultLayer),registEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onStarPiao",this,this.openUIPiao),registEvent("initCards",this,this.closeUIPiao),o.instance.setGameType(GameData.client.gameType),GameData.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,1==GameData.openScore&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(2e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>2*this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),0<GameData.game.zhuangUid?this.showTableUI(!0):this.showTableUI(!1);var e="";GameData.room.opts&&(e=getRuleStrCC(GameData.room.opts));var t=cc.find("layer_table/term",this.node);t&&(t.getComponent("cc.Label").string=e)},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onStarPiao",this,this.openUIPiao),unregistEvent("initCards",this,this.closeUIPiao),cc.log("roomMain-destroy"),GameData.initRoomData(),profileHuaDian.initRoomData()},openUIPiao:function(){this.uiWaitLayer.active=!1,this.resultLayer.active=!1,this.showTableUI(!1)},closeUIPiao:function(){this.showTableUI(!0)},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableLayer:function(){cc.log("~~~~~~~~~~~~~~show table layer and hide wait layer~~~~~~~~~~~~~~~~~");this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue"),GameData.room.status==i.RoomState.READY&&(this.showTableUI(!1),MjHandler.getInstance().requestReady(function(e){}))},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&(GameData.joinContact.uid,GameData.player.uid),GameData.contact=!1,this.node.getComponent("roomResult_heb").onShow()},showSettingLayer:function(e,t){1==t?openView("SettingsPanel_CC",i.GameType.Game_Mj_CC):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(2e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomMain_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"9cf6dR5iVFDaqN3nM/N5yL6","roomMain_huadian");var n=e("SoundMngr"),o=e("ruleHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,settingLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.showTableLayer),registEvent("onGameReady",this,this.showTableLayer),registEvent("onMahjongRunEnd",this,this.showResultLayer),registEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onStarPiao",this,this.openUIPiao),registEvent("initCards",this,this.closeUIPiao),o.instance.setGameType(GameData.client.gameType),cc.log("gameStart:"+GameData.game.gameStart),WriteLog("gameStart:"+GameData.game.gameStart),GameData.room.status>r.RoomState.WAIT?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,1==GameData.openScore&&this.showResultDirectly(),0<Object.keys(profileHuaDian.PiaoInfo).length&&this.openUIPiao();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(2e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>2*this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),0<GameData.game.zhuangUid?this.showTableUI(!0):this.showTableUI(!1);var e="";GameData.room.opts&&(e=getRuleStrHd(GameData.room.opts));var t=cc.find("layer_table/term",this.node);t&&(t.getComponent("cc.Label").string=e)},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onHuaDianMahjongReconnecet",this,this.showTableLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onStarPiao",this,this.openUIPiao),unregistEvent("initCards",this,this.closeUIPiao),WriteLog("roomMain-destroy"),GameData.initRoomData(),profileHuaDian.initRoomData()},openUIPiao:function(){this.uiWaitLayer.active=!1,this.resultLayer.active=!1,profileHuaDian.PiaoInfo.runState>HuaDian.RunStateEmnum.PIAO?this.showTableUI(!0):this.showTableUI(!1)},closeUIPiao:function(){this.showTableUI(!0)},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableLayer:function(){cc.log("~~~~~~~~~~~~~~show table layer and hide wait layer~~~~~~~~~~~~~~~~~");this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue"),GameData.room.status==r.RoomState.READY&&(this.showTableUI(!1),MjHandler.getInstance().requestReady(function(e){}))},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&(GameData.joinContact.uid,GameData.player.uid),GameData.contact=!1,this.node.getComponent("roomResult_huadian").onShow()},showSettingLayer:function(e,t){1==t?openView("SettingsPanel_HD",r.GameType.Game_MJ_HuaDian):this.settingLayer.active=!1},showdissolveLayer:function(e,t){1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.dissolveLayer.active=!1,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(2e3)||openView("ChatPanel")},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomMain:[function(e,t,a){"use strict";cc._RF.push(t,"b661c/afldBWL5J0J1ppnYQ","roomMain");var n=e("SoundMngr"),o=e("ruleHandler");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,tableUI:{default:[],type:cc.Node},resultLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,debugLayer:cc.Node,talkBtn:cc.Button,yuyinNode:cc.Node,yuyinShortNode:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.showTableLayer),registEvent("onGameScore",this,this.showResultLayer),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("shortRecord",this,this.YVShortRecordCallback),registEvent("onServerNotice",this,handlerServerNotice),scheduleLamp(this),o.instance.setGameType(GameData.client.gameType),GameData.game.gameStart?this.showTableLayer():this.showWaitLayer(),this.lostMessage=!1,(1==GameData.openScore||0<GameData.game.winnerUid)&&this.showResultDirectly();var i=this;this.talkBtn.node.on(cc.Node.EventType.TOUCH_START,function(e){console.log("TOUCH_START"),WriteLog("TOUCH_START : "),inCD(1e3)||(console.log("TOUCH_START and"),yunwaStartTalk(),i.yuyinNode.active=!0,GameData.isPlayVioce=!0,i.yuyinNode.getComponent(cc.Animation).play("yuyin"),cc.audioEngine.pauseAll())}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_MOVE,function(e){console.log("TOUCH_MOVE");var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>this.width&&(i.yuyinNode.getComponent(cc.Animation).play("CancelSend"),GameData.isPlayVioce=!1)}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_END,function(){console.log("TOUCH_END"),WriteLog("TOUCH_END : "),yunwaStopTalk(),i.yuyinNode.active=!1,cc.audioEngine.resumeAll()}),this.talkBtn.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){console.log("TOUCH_CANCEL"),yunwaStopTalk(),GameData.isPlayVioce=!1,i.yuyinNode.active=!1,cc.audioEngine.resumeAll()})},onDestroy:function(){unregistEvent("onGameStart",this,this.showTableLayer),unregistEvent("onGameScore",this,this.showResultLayer),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("shortRecord",this,this.YVShortRecordCallback),unregistEvent("onServerNotice",this,handlerServerNotice),GameData.initRoomData()},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showResultLayer:function(){var e=this;this.scheduleOnce(function(){GameData.game.gameStart||e.showResultDirectly()},2)},showTableUI:function(e){for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1),1==GameData.contact&&(GameData.joinContact.uid,GameData.player.uid),GameData.contact=!1,this.node.getComponent("roomResult").onShow()},showSettingLayer:function(e,t){n.instance.playAudioOther("button"),sendEvent("runlamp"),1==t?openView("SettingsPanel-tianjin"):this.settingLayer.active=!1},showdissolveLayer:function(e,t){n.instance.playAudioOther("button"),1==t?(this.dissolveLayer.active=!0,this.dissolveLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()})):this.dissolveLayer.active=!1},showSummaryLayer:function(){this.summaryLayer.active=!0,this.summaryLayer.on(cc.Node.EventType.TOUCH_START,function(e){e.stopPropagation()}),sendEvent("onShowSummary"),GameData.player.uid==GameData.room.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1)},shutDissolveLayer:function(){1==GameData.showResult||this.showSummaryLayer()},showDebugLayer:function(){this.debugLayer.active=!this.debugLayer.active},showJoinerLost:function(e){},showChat:function(){inCD(3e3)||(n.instance.playAudioOther("button"),openView("ChatPanel"))},YVShortRecordCallback:function(){WriteLog("YVShortRecordCallback : "),this.yuyinShortNode.getComponent(cc.Animation).play("ShortRecoed"),this.yuyinShortNode.getComponent("HideComponent").show(1)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",ruleHandler:"ruleHandler"}],roomNumView:[function(e,t,a){"use strict";cc._RF.push(t,"2bce4wdZUFJ7bV1pHDJ8cJE","roomNumView");var n=e("roomUtil"),i=e("roomHandler");cc.Class({extends:cc.Component,properties:{roomNum:cc.Label},onLoad:function(){},onDestroy:function(){},onEnable:function(){this.showRoomNum()},showRoomNum:function(){var e=i.getRoomData();null!=e&&(this.roomNum.string=n.getRoomString(e.id))}}),cc._RF.pop()},{roomHandler:"roomHandler",roomUtil:"roomUtil"}],roomPiao_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"8ed0cUeXZhAz6Xm8Z66xZnz","roomPiao_changchun"),cc.Class({extends:cc.Component,properties:{layer_up:cc.Node,layer_down:cc.Node,layer_left:cc.Node,layer_right:cc.Node,ok_btn:cc.Button,no_btn:cc.Button,all_btn:cc.Button,headNodes:{default:[],type:cc.Node},action_up:!1,action_down:!1,action_left:!1,action_right:!1},onLoad:function(){registEvent("onStarPiao",this,this.UIControl),registEvent("onMahjongRunEnd",this,this.ShowUI),0<Object.keys(profileHuaDian.PiaoInfo).length&&profileHuaDian.PiaoInfo.runState==HuaDian.RunStateEmnum.PIAO&&this.showPiaoState();var t=this;this.ok_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(1),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1}),this.no_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(0),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1}),this.all_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(2),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1})},onDestroy:function(){unregistEvent("onStarPiao",this,this.UIControl)},sendPiaoMes:function(e){MjHandler.getInstance().requestPiao(e,function(e){})},ShowUI:function(){this.setUI(!0),this.action_up=!1,this.action_down=!1,this.action_left=!1,this.action_right=!1,this.setPiaoFlag(this.headNodes[0],"down"),this.setPiaoFlag(this.headNodes[1],"right"),this.setPiaoFlag(this.headNodes[2],"up"),this.setPiaoFlag(this.headNodes[3],"left")},CloseUI:function(){1==this.action_up&&1==this.action_down&&1==this.action_left&&1==this.action_right&&this.setUI(!1)},setUI:function(e){this.node.active=e},UIControl:function(){this.showPiaoState()},showPiaoState:function(){cc.log("...data...:"+JSON.stringify(profileHuaDian.PiaoInfo));profileHuaDian.PiaoInfo;if(this.ok_btn.node.active=!1,this.no_btn.node.active=!1,this.all_btn.node.active=!1,null!=profileHuaDian.PiaoInfo){var e=GameData.getPlayerByPos("down"),t=profileHuaDian.getPiaoStateByUid(e.uid);e&&-1==t&&(this.ok_btn.node.active=!0,this.no_btn.node.active=!0,this.all_btn.node.active=!0),e?(this.layer_down.active=!0,cc.find("down/choice",this.node).active=!1,cc.find("down/no",this.node).active=!1,cc.find("down/yes",this.node).active=!1,0<=t&&(0==this.action_down?this.runMoveActionFlag("down",t):this.layer_down.active=!1)):(this.layer_down.active=!1,this.action_down=!0),(e=GameData.getPlayerByPos("right"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_right.active=!0,cc.find("right/choice",this.node).active=!0,cc.find("right/no",this.node).active=!1,cc.find("right/yes",this.node).active=!1,0<=t&&(0==this.action_right?this.runMoveActionFlag("right",t):this.layer_right.active=!1)):(this.layer_right.active=!1,this.action_right=!0),(e=GameData.getPlayerByPos("up"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_up.active=!0,cc.find("up/choice",this.node).active=!0,cc.find("up/no",this.node).active=!1,cc.find("up/yes",this.node).active=!1,0<=t&&(0==this.action_up?this.runMoveActionFlag("up",t):this.layer_up.active=!1)):(this.layer_up.active=!1,this.action_up=!0),(e=GameData.getPlayerByPos("left"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_left.active=!0,cc.find("left/choice",this.node).active=!0,cc.find("left/no",this.node).active=!1,cc.find("left/yes",this.node).active=!1,0<=t&&(0==this.action_left?this.runMoveActionFlag("left",t):this.layer_left.active=!1)):(this.layer_left.active=!1,this.action_left=!0)}},runMoveActionFlag:function(e,t){if(null!=t){var a,n;switch(e){case"down":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[0],this.action_down=!0;break;case"right":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[1],this.action_right=!0;break;case"up":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[2],this.action_up=!0;break;case"left":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[3],this.action_left=!0}this.setPiaoFlag(n,e);var i=cc.scaleTo(.25,1.4),o=cc.delayTime(.5),r=cc.scaleTo(1,.6),s=cc.fadeOut(1),c=this;a.stopAllActions(),a.runAction(cc.sequence(i,o,cc.spawn(r,s),cc.callFunc(function(){a.active=!1,a.scale=1,a.opacity=255,c.CloseUI()},this)))}},setPiaoFlag:function(e,t){var a=GameData.getPlayerByPos(t);if(a){var n=e.getChildByTag(a.uid);n&&n.getComponent("playerTemplate").setPiaoIconShow(t)}}}),cc._RF.pop()},{}],roomPiao_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"ab6707iCb9LQryJHn/v4p7T","roomPiao_huadian"),cc.Class({extends:cc.Component,properties:{layer_up:cc.Node,layer_down:cc.Node,layer_left:cc.Node,layer_right:cc.Node,ok_btn:cc.Button,no_btn:cc.Button,all_btn:cc.Button,headNodes:{default:[],type:cc.Node},action_up:!1,action_down:!1,action_left:!1,action_right:!1},onLoad:function(){registEvent("onStarPiao",this,this.UIControl),registEvent("onMahjongRunEnd",this,this.ShowUI),0<Object.keys(profileHuaDian.PiaoInfo).length&&profileHuaDian.PiaoInfo.runState>=HuaDian.RunStateEmnum.PIAO&&this.showPiaoState();var t=this;this.ok_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(1),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1}),this.no_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(0),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1}),this.all_btn.node.on(cc.Node.EventType.TOUCH_END,function(e){console.log("TOUCH_END"),t.sendPiaoMes(2),t.ok_btn.node.active=!1,t.no_btn.node.active=!1,t.all_btn.node.active=!1})},onDestroy:function(){unregistEvent("onStarPiao",this,this.UIControl),unregistEvent("onMahjongRunEnd",this,this.ShowUI)},sendPiaoMes:function(e){MjHandler.getInstance().requestPiao(e,function(e){})},ShowUI:function(){this.setUI(!0),this.action_up=!1,this.action_down=!1,this.action_left=!1,this.action_right=!1,this.setPiaoFlag(this.headNodes[0],"down"),this.setPiaoFlag(this.headNodes[1],"right"),this.setPiaoFlag(this.headNodes[2],"up"),this.setPiaoFlag(this.headNodes[3],"left")},CloseUI:function(){1==this.action_up&&1==this.action_down&&1==this.action_left&&1==this.action_right&&this.setUI(!1)},setUI:function(e){this.node.active=e},UIControl:function(){this.showPiaoState()},showPiaoState:function(){cc.log("...data...:"+JSON.stringify(profileHuaDian.PiaoInfo));profileHuaDian.PiaoInfo;if(this.ok_btn.node.active=!1,this.no_btn.node.active=!1,this.all_btn.node.active=!1,null!=profileHuaDian.PiaoInfo){var e=GameData.getPlayerByPos("down"),t=profileHuaDian.getPiaoStateByUid(e.uid);e&&-1==t&&(this.ok_btn.node.active=!0,this.no_btn.node.active=!0,this.all_btn.node.active=!0),e?(this.layer_down.active=!0,cc.find("down/choice",this.node).active=!1,cc.find("down/no",this.node).active=!1,cc.find("down/yes",this.node).active=!1,0<=t&&(0==this.action_down?this.runMoveActionFlag("down",t):this.layer_down.active=!1)):(this.layer_down.active=!1,this.action_down=!0),(e=GameData.getPlayerByPos("right"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_right.active=!0,cc.find("right/choice",this.node).active=!0,cc.find("right/no",this.node).active=!1,cc.find("right/yes",this.node).active=!1,0<=t&&(0==this.action_right?this.runMoveActionFlag("right",t):this.layer_right.active=!1)):(this.layer_right.active=!1,this.action_right=!0),(e=GameData.getPlayerByPos("up"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_up.active=!0,cc.find("up/choice",this.node).active=!0,cc.find("up/no",this.node).active=!1,cc.find("up/yes",this.node).active=!1,0<=t&&(0==this.action_up?this.runMoveActionFlag("up",t):this.layer_up.active=!1)):(this.layer_up.active=!1,this.action_up=!0),(e=GameData.getPlayerByPos("left"))?(t=profileHuaDian.getPiaoStateByUid(e.uid),this.layer_left.active=!0,cc.find("left/choice",this.node).active=!0,cc.find("left/no",this.node).active=!1,cc.find("left/yes",this.node).active=!1,0<=t&&(0==this.action_left?this.runMoveActionFlag("left",t):this.layer_left.active=!1)):(this.layer_left.active=!1,this.action_left=!0)}},runMoveActionFlag:function(e,t){if(null!=t){var a,n;switch(e){case"down":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[0],this.action_down=!0;break;case"right":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[1],this.action_right=!0;break;case"up":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[2],this.action_up=!0;break;case"left":cc.find(e+"/choice",this.node).active=!1,cc.find(e+"/no",this.node).active=!1,cc.find(e+"/yes",this.node).active=!1,(a=0<t?cc.find(e+"/yes",this.node):cc.find(e+"/no",this.node)).active=!0,a.scale=1,a.opacity=255,n=this.headNodes[3],this.action_left=!0}this.setPiaoFlag(n,e);var i=cc.scaleTo(.25,1.4),o=cc.delayTime(.5),r=cc.scaleTo(1,.6),s=cc.fadeOut(1),c=this;a.stopAllActions(),a.runAction(cc.sequence(i,o,cc.spawn(r,s),cc.callFunc(function(){a.active=!1,a.scale=1,a.opacity=255,c.CloseUI()},this)))}},setPiaoFlag:function(e,t){var a=GameData.getPlayerByPos(t);if(a){var n=e.getChildByTag(a.uid);n&&n.getComponent("playerTemplate").setPiaoIconShow(t)}}}),cc._RF.pop()},{}],"roomResult-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"aeff4+Ni0lH+5ip38OhU3ve","roomResult-shishi");var g=e("ruleHandler"),f=e("gameDefine");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,isMark:0,roomid:cc.Label,createTime:cc.Label,roundNum:cc.Label,jinNum:0,fonts:{default:[],type:cc.Font}},onLoad:function(){},onDestroy:function(){},onShow:function(){if(GameData.room.joinermax){for(var e=0;e<GameData.room.joinermax;e++)this.jinNum=0,this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.hideDianpaoIcon(e),this.showWinIcon(e);for(e=GameData.room.joinermax;e<4;e++){cc.find("player"+(e+1),this.resultLayer).active=!1}this.showResultIcon(),this.showRoomDetail()}},showPlayer:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/head/id",this.resultLayer),n=cc.find("player"+(e+1)+"/head/name",this.resultLayer),i=cc.find("player"+(e+1)+"/head/headpic",this.resultLayer),o=cc.find("player"+(e+1)+"/head/zhuang",this.resultLayer),r=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=r,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==GameData.game.zhuangUid,null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},setMyHuierVisible:function(e,t){var a=!1,n=e.getChildByName(e.name+"_huier");if(g.instance.isHuier(t)&&(a=!0),1==a&&this.jinNum++,null==n){if(a){(n=cc.instantiate(this.cardHuier)).y=n.y-8,e.addChild(n),n.name=e.name+"_huier";var i=cc.textureCache.addImage(cc.url.raw("resources/shishi/image/youjinbiao.png"));cc.find("huier_icon",n).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)}}else n.active=a},setMyHuimageVisible:function(e,t,a){var n=GameData.game.winnerObtain,i=!1;0==a?i=!1:n==t&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuimage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/term",this.resultLayer).getComponent("cc.Label");a.string="";GameData.scores[GameData.player.uid];if(0<GameDataShiShi.setWater[t.uid]&&(a.string+="2水 "),GameData.client.gameType==f.GameType.Game_Mj_Shishi){GameData.game.winnerUid==t.uid?a.string+=g.instance.getHuTypeString():a.string+="";for(var n=GameData.getGangCards(t.uid),i=0;i<n.length;i++){g.instance.isHuier(n[i][0])&&(a.string+="金杠+"+GameData.room.opts.jingang+"  ");e=0;var o=0;for(i=0;i<n.length;i++)4==n[i].length?e++:5==n[i].length&&o++;0==e||(a.string+="明杠 +1*"+e+"  "),0==o||(a.string+="暗杠 +2*"+o+"  ")}if(GameData.game.zhuangUid==t.uid&&0<GameData.game.zhuangNum[t.uid]){var r=2*(s=GameData.game.zhuangNum[t.uid]);a.string+="坐"+s+"庄 *"+r+"  "}else if(GameData.game.zhuangUid!=t.uid&&0<GameData.game.zhuangNum[t.uid]){var s;r=2*(s=GameData.game.zhuangNum[t.uid]);a.string+="拉"+s+"庄 *"+r+"  "}if(GameData.client.gameType==f.GameType.Game_Mj_Shishi){var c=g.instance.calcHuaScore(t.uid);cc.log("..hua:"+c),c&&0!=c&&(a.string+="花杠 +"+c+" ")}if(0==this.jinNum)return;a.string+="金 +"+this.jinNum+"  "}},showCardContent:function(e,t,a){if(null!=e&&null!=e){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a,n){if(e){var i=GameData.getGangCards(e.uid),o=GameData.getPengCards(e.uid),r=i.concat(o);if(GameData.client.gameType==f.GameType.Game_Mj_Shishi){var s=GameData.getChiCards(e.uid);console.log("chi == "+JSON.stringify(s));for(var c=0;c<s.length;c++)2<s[c].length&&s[c].sort(function(e,t){return e-t});r=i.concat(o,s)}var d=parseInt(GameData.client.handsize/3);for(c=0;c<d;c++){var h=cc.find("cardPeng/cardPeng"+(c+1),t);if(c<r.length){for(var l=0;l<4;l++){var u=h.getChildByName("card_face"+(l+1)).getComponent("cc.Sprite");if(l<r[c].length){u.node.active=!0;var m=r[c][l];this.showCardContent(u.node,a,m),3==l&&1==g.instance.isHuier(m)&&this.addHuierIcon(u.node,n)}else u.node.active=!1}if(5==r[c].length){u=h.getChildByName("card_face4").getComponent("cc.Sprite");var p=h.getChildByName("card_back4").getComponent("cc.Sprite");u.node.active=!1,p.node.active=!0}else{(p=h.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1}h.active=!0}else h.active=!1}}},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n="";GameData.client.gameType==f.GameType.Game_Mj_Shishi&&(n=cc.url.raw("resources/shishi/image/youjinbiao.png"));var i=cc.textureCache.addImage(n);a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCards:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1),this.resultLayer),n=cc.find("cards",a),i=t.uid==GameData.game.winnerUid,o=GameData.client.handsize+1,r=GameData.getHandCards(t.uid),s=GameData.getHandCardNum(t.uid),c=s=s%3==1?s+1:s;for(var d in i&&(this.isMark=0),r)for(var h=0;h<r[d];h++){var l=cc.find("cardHand/cardHand"+s,n);cc.log("result showCards:"+s+" "+d),this.showCardContent(l,"mj_face_xia_shou",d),this.setMyHuierVisible(l,d),this.setMyHuimageVisible(l,d,i),l.active=!0,s--}for(h=s;1<=h;h--){(l=cc.find("cardHand/cardHand"+h,n)).active=!1}for(h=c+1;h<=o;h++){(l=cc.find("cardHand/cardHand"+h,n)).active=!1}this.showPengCards(t,n,"mj_face_xia_chu","down"),GameData.client.gameType==f.GameType.Game_Mj_Shishi&&this.showHua(t,n),a.active=!0},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1)+"/score",this.resultLayer);0<GameData.scores[t]?(a.getComponent("cc.Label").font=this.fonts[0],a.getComponent("cc.Label").string="+"+GameData.scores[t]):(0==GameData.scores[t]?a.getComponent("cc.Label").font=this.fonts[2]:a.getComponent("cc.Label").font=this.fonts[1],a.getComponent("cc.Label").string=GameData.scores[t])},hideDianpaoIcon:function(e){GameData.joiners[e].uid;var t=cc.find("player"+(e+1),this.resultLayer);cc.find("paoIcon",t).active=!1},showWinIcon:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1),this.resultLayer),n=cc.find("huIcon",a);n.active=t==GameData.game.winnerUid;var i=cc.find("paoIcon",a);i.active=!1,GameData.recordInfo[GameData.game.roundNum-1]&&(1==GameData.recordInfo[GameData.game.roundNum-1].type&&t==GameData.recordInfo[GameData.game.roundNum-1].dianpao?(n.active=!1,i.active=!0):i.active=!1)},showResultIcon:function(){this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1;var e=GameData.scores[GameData.player.uid];0<e?this.winSprite.node.active=!0:e<0?this.loseSprite.node.active=!0:this.pingSprite.node.active=!0},showRoomDetail:function(){this.roomid.string="房间号:"+GameData.room.id,this.createTime.string=getDate(GameData.room.createtime);var e=GameData.game.roundNum;this.roundNum.string="第 "+e+" 局"},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("roomMain-shishi").showSummaryLayer()):(MjHandler.getInstance().requestReady(function(e){}),sendEvent("onGameStart"))},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)},showHua:function(e,t){for(var a=e.uid,n=GameData.cards[a].hua.sort(),i=cc.find("cardhua",t).children,o=0;o<i.length;o++)i[o].active=!1;for(o=0;o<n.length;o++){var r=o+1,s=cc.find("cardhua/"+r,t);s.getComponent(cc.Sprite).spriteFrame=null;var c=this.showHuaTexture(n[o]),d=cc.textureCache.addImage(cc.url.raw(c));s.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d),s.active=!0}},showHuaTexture:function(e){var t="resources/shishi/image/",a="";return 111==e?a="chun":112==e?a="xia":113==e?a="qiu":114==e?a="dong":121==e?a="mei":122==e?a="lan":123==e?a="zhu":124==e&&(a="ju"),t=t+a+".png"}}),cc._RF.pop()},{gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomResult_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"93e38dG6DBMdLXks+dyX+Se","roomResult_changchun");var o=e("ruleHandler"),r=e("gameDefine"),s=e("roomHandler"),m={HUTYPE_ZHUANG:21,HUTYPE_DIAN_PAO:31,HUTYPE_ZIMO:4,HUTYPE_MENQING:20,HUTYPE_QINGYISE:18,HUTYPE_MOBAO:5,HUTYPE_BAOZHONGBAO:13};cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,createtime:cc.Label,roomID:cc.Label,roundData:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,cardBugangPre:cc.Prefab,isMark:0,baoCardNode:cc.Node},onLoad:function(){},onDestroy:function(){},onShow:function(){for(var e=0;e<GameData.room.opts.joinermax;e++)this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e);for(e=GameData.room.opts.joinermax;e<4;e++){cc.find("player"+(e+1),this.resultLayer).active=!1}this.showBaoNode(),this.showRoundInfo(),this.showResultIcon()},showPlayer:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/head/id",this.resultLayer),n=cc.find("player"+(e+1)+"/head/name",this.resultLayer),i=cc.find("player"+(e+1)+"/head/headpic",this.resultLayer),o=cc.find("player"+(e+1)+"/head/zhuang",this.resultLayer),r=cc.find("player"+(e+1)+"/head/creator",this.resultLayer),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==GameData.game.zhuangUid,r.active=t.uid==GameData.room.creator,null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showBaoNode:function(){var e=cc.find("baoCard",this.baoCardNode);if(1e3!=GameData.game.cardHuier1&&-1!=GameData.game.cardHuier1&&0!=GameData.game.cardHuier1){this.baoCardNode.active=!0,e.getComponents(cc.Sprite).spriteFrame=null;var t="resources/mjcard2d/mj_face_xia_shou_"+GameData.game.cardHuier1+".png",a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}else this.baoCardNode.active=!1},setMyBaoVisible:function(e,t,a){var n=!1;o.instance.isHuier(t.card)&&(n=!0),0==a&&(n=!1),0==t.type&&(n=!1);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&(i=cc.instantiate(this.cardHuier),e.addChild(i),i.name=e.name+"_huier"):i.active=n},setMyHuimageVisible:function(e,t,a){var n=GameData.game.winnerObtain;cc.log("orCard:"+n);var i=!1;0==a?i=!1:n==t.card&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuimage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/term",this.resultLayer).getComponent("cc.Label");a.node.active=!1;var n=profileChangChun.getResultScoreInfoByUid(t.uid);a.string="";for(var i=1==GameData.ResultData[t.uid].isWin||3==GameData.ResultData[t.uid].isWin,o=(GameData.ResultData[t.uid].isWin,HuaDian.WINTYPE.LIUJU,GameData.ResultData[t.uid].isWin==HuaDian.WINTYPE.DIANPAOLOSE),r=t.uid==GameData.game.zhuangUid,s=0;s<n.huTypes.length;s++)if(i){for(var c in m)if(n.huTypes[s].code==m[c]){!0;break}a.string+=n.huTypes[s].des+"*"+n.huTypes[s].fan+" "}o&&(a.string+="点炮*2 "),r&&i?a.string+="庄家*2 ":r&&2==GameData.ResultData[t.uid].isWin?a.string+="庄家*2 ":r&&3==profileChangChun.getHuType()&&(a.string+="庄家*2 ");var d,h=GameData.ResultData[t.uid].gangCards,l=0;for(var c in h)l+=profileChangChun.getGangSorce(h[c].cards)*(GameData.joiners.length-1);if(0!=l&&(a.string+=" 蛋:+"+l+"分 "),0!=(d=l-n.scoreList[1])&&(a.string+=" 蛋:-"+d+"分 "),!i){var u=GameData.cards[t.uid].hasCheckedBao?"看宝":"未看宝";a.string+=u}a.node.active=!0},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showHandCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a.card),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a.card+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showRoundInfo:function(){this.roomID.string="房号："+GameData.room.id;var e=1e3*profileChangChun.resultData.timeStamp,t=(e=new Date(e)).getFullYear()+"/",a=e.getMonth()+1+"/",n=e.getDate()+"   ",i=e.getHours()+"",o=e.getMinutes()+"",r=e.getSeconds()+"";i=1==i.length?"0"+i:i,o=1==o.length?"0"+o:o,r=1==r.length?"0"+r:r,this.createtime.string=t+a+n+i+":"+o+":"+r;var s=GameData.room.gameNum;this.roundData.string="第"+s+"局"},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a,n){if(e){var i=GameData.getChiCards(e.uid);i.sort(function(e,t){return e-t});for(var o=GameData.getGangCards(e.uid),r=0;r<o.length;r++)o[r].cardType=-1;for(var s=GameData.getPengCards(e.uid),c=o.concat(s,i),d=parseInt(GameData.client.handsize/3),h=0;h<d;h++){var l=cc.find("cardPeng/cardPeng"+(h+1),t),u=cc.find("card_face7",l);if(u.active=!1,h<c.length){for(var m=0;m<7;m++){var p=l.getChildByName("card_face"+(m+1)).getComponent("cc.Sprite"),g=p.node.getChildByName(p.node.name+"_bugangIcon");g&&(g.active=!1);var f=!1;c[h].cards.length<4&&profileChangChun.isAllEqual(c[h].cards)&&!c[h].cardType&&(f=!0);var y=!1;4==c[h].cards.length&&profileChangChun.isAllEqual(c[h].cards)&&(y=!0);var v=!1;if(5==c[h].cards.length&&profileChangChun.isAllEqual(c[h].cards)&&(v=!0),m<c[h].cards.length){p.node.active=!0;var C=c[h].cards[m];if(f)this.showCardContent(p.node,a,C);else if(y)m<4?3==m?(this.showCardContent(u,a,C),p.node.active=!1):this.showCardContent(p.node,a,C):p.node.active=!1,u.active=!0,this.addGangIcon(u,n,1);else if(v)m<4?3==m?(this.showCardContent(u,a,C),p.node.active=!1):this.showCardContent(p.node,a,C):p.node.active=!1,u.active=!0,this.addGangIcon(u,n,2);else if(c[h].cardType&&c.type!=HuaDian.OPERATION.OPERATION_ANGANG&&c.type!=HuaDian.OPERATION.OPERATION_MINGGANG&&c.type!=HuaDian.OPERATION.OPERATION_GONGGANG){var D=[].concat(c[h].cards);D.splice(3,D.length);var _=[].concat(c[h].cards),G=profileChangChun.guolv(D,_),w=[].concat(D,G),S=w.length>m,T=1,N=3;for(3<=m&&(N=c[h].cards.indexOf(w[m])+1);N<c[h].cards.length;N++)if(w[m]==c[h].cards[N]){if(0!=m&&c[h].cards.indexOf(w[m])==N)continue;if(1==m&&(c[h].cards[0]==c[h].cards[1]||c[h].cards[1]==c[h].cards[2]))continue;T++}S?(2<=T&&this.addBuGangIcon(p.node,n,T),this.showCardContent(p.node,a,w[m]),p.node.active=!0):p.node.active=!1}else this.showCardContent(p.node,a,C)}else 6!=m&&(p.node.active=!1)}l.active=!0}else l.active=!1}}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},addBuGangIcon:function(e,t,a){var n,i=e.getChildByName(e.name+"_bugangIcon");null==i&&((i=cc.instantiate(this.cardBugangPre)).name=e.name+"_bugangIcon",i.setScale(1.2),i.setPosition(i.x-5,i.y-10),e.addChild(i)),i.active=!0;var o="";"right"==t?o="1":"down"==t?o="0":"left"==t?o="3":"up"==t&&(o="2");for(var r=0;r<i.childrenCount;r++)if("down"==i.children[r].name){i.children[r].active=!0,n=cc.url.raw("resources/changchun/UI/icon/bugang_"+o+"_"+a+".png");var s=cc.textureCache.addImage(n);i.children[r].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)}else i.children[r].active=!1},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n="";GameData.client.gameType==r.GameType.Game_Mj_Tianjin?n=cc.url.raw("resources/table/huier_icon.png"):GameData.client.gameType==r.GameType.Game_MJ_HuaDian&&(n=cc.url.raw("resources/table/huier_icon.png"));var i=cc.textureCache.addImage(n);a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCards:function(e){var t,a=GameData.joiners[e],n=cc.find("player"+(e+1),this.resultLayer),i=cc.find("cards",n),o=0;GameData.ResultData[a.uid]&&(t=1==GameData.ResultData[a.uid].isWin||3==GameData.ResultData[a.uid].isWin);var r=GameData.client.handsize+1,s=GameData.cards[a.uid].Resulthand;s.sort(function(e,t){return e.card-t.card});var c=GameData.getHandCardNum(a.uid);c=c%3==1?c+1:c,t&&(this.isMark=0);for(var d=cc.find("cardHand",i),h=0;h<d.childrenCount;h++)d.children[h].active=!1;for(var l=cc.find("cardPeng",i),u=0;u<l.childrenCount;u++)l.children[u].active=!1;for(var m=0;m<s.length;m++)1==s[m].type&&o++;for(var p=profileChangChun.resultData.isLouBao,g=3*GameData.getPengCards(a.uid).length+3*GameData.getGangCards(a.uid).length+3*GameData.getChiCards(a.uid).length,f=0;f<s.length;f++){if(!t&&p){cc.log("nodeIdx:"+c);var y=cc.find("cardHand/cardHand"+c,i);if(this.showHandCardContent(y,"mj_face_xia_shou",s[f]),c==r-s.length-g)cc.log("nodeIdxnodeIdxnodeIdxnodeIdx:"+c),(y=cc.find("cardHand/cardHand"+c,i)).active=!1;if(1==c)(y=cc.find("cardHand/cardHand"+c,i)).active=!1}else{y=cc.find("cardHand/cardHand"+c,i);this.showHandCardContent(y,"mj_face_xia_shou",s[f])}c--}if(this.removeCardIcon(i),o!=s.length)for(var v=0;v<s.length;v++){var C=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(C-v),i);1==s[v].type&&(this.setMyBaoVisible(y,s[v]),this.setMyHuimageVisible(y,s[v],t))}else for(var D=0;D<s.length;D++){var _=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(_-D),i);this.setMyHuimageVisible(y,s[D],t)}this.showPengCards(a,i,"mj_face_xia_chu","down"),n.active=!0},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1)+"/score",this.resultLayer),n=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=s.getCoinData();i&&i.coin&&i.coin[t]&&(n=i.coin[t])}else n=GameData.scores[t];null==n&&(n=0),0<n?(a.getComponent("cc.Label").string="+"+n,a.color=new cc.Color(255,255,0)):(a.getComponent("cc.Label").string=n,a.color=new cc.Color(255,46,53))},removeCardIcon:function(e){var t=cc.find("cardHand",e);for(var a in t.children){var n=t.children[a].getChildByName(t.children[a].name+"_huier"),i=t.children[a].getChildByName(t.children[a].name+"_hu");n&&n.removeFromParent(!0),i&&i.removeFromParent(!0)}},showWinIcon:function(e,t){var a=GameData.joiners[e].uid,n=(t=cc.find("player"+(e+1),this.resultLayer),cc.find("huIcon",t)),i=!1;1!=GameData.ResultData[a].isWin&&3!=GameData.ResultData[a].isWin||(i=!0),n.active=i;var o=cc.find("paoIcon",t);o.active=!1,2==GameData.ResultData[a].isWin?(n.active=!1,o.active=!0):o.active=!1},showResultIcon:function(){var e=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=s.getCoinData();t&&t.coin&&t.coin[GameData.player.uid]&&(e=t.coin[GameData.player.uid])}else e=GameData.scores[GameData.player.uid];null==e&&(e=0),0<e?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):e<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("roomMain_changchun").showSummaryLayer()):(MjHandler.getInstance().requestReady(function(e){}),GameData.game.zhuangUid=0,sendEvent("onGameReady"))},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],roomResult_heb:[function(e,t,a){"use strict";cc._RF.push(t,"8b4eeb74sFFe5E7CN7/+PHY","roomResult_heb");var o=e("ruleHandler"),r=e("gameDefine"),s=e("roomHandler"),p={HUTYPE_ZHUANG:21,HUTYPE_DIAN_PAO:31,HUTYPE_ZIMO:4,HUTYPE_MENQING:20,HUTYPE_QINGYISE:18,HUTYPE_MOBAO:5,HUTYPE_BAOZHONGBAO:13};cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,createtime:cc.Label,roomID:cc.Label,roundData:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,cardBugangPre:cc.Prefab,isMark:0,baoCardNode:cc.Node},onLoad:function(){},onDestroy:function(){},onShow:function(){for(var e=0;e<GameData.room.opts.joinermax;e++)this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e);for(e=GameData.room.opts.joinermax;e<4;e++){cc.find("player"+(e+1),this.resultLayer).active=!1}this.showBaoNode(),this.showRoundInfo(),this.showResultIcon()},showPlayer:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/head/id",this.resultLayer),n=cc.find("player"+(e+1)+"/head/name",this.resultLayer),i=cc.find("player"+(e+1)+"/head/headpic",this.resultLayer),o=cc.find("player"+(e+1)+"/head/zhuang",this.resultLayer),r=cc.find("player"+(e+1)+"/head/creator",this.resultLayer),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==GameData.game.zhuangUid,r.active=t.uid==GameData.room.creator,null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showBaoNode:function(){var e=cc.find("baoCard",this.baoCardNode);if(1e3!=GameData.game.cardHuier1&&-1!=GameData.game.cardHuier1&&0!=GameData.game.cardHuier1){this.baoCardNode.active=!0,e.getComponents(cc.Sprite).spriteFrame=null;var t="resources/mjcard2d/mj_face_xia_shou_"+GameData.game.cardHuier1+".png",a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}else this.baoCardNode.active=!1},setMyBaoVisible:function(e,t,a){var n=!1;o.instance.isHuier(t.card)&&(n=!0),0==a&&(n=!1),0==t.type&&(n=!1);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&(i=cc.instantiate(this.cardHuier),e.addChild(i),i.name=e.name+"_huier"):i.active=n},setMyHuimageVisible:function(e,t,a){var n=GameData.game.winnerObtain;cc.log("orCard:"+n);var i=!1;0==a?i=!1:n==t.card&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuimage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/term",this.resultLayer).getComponent("cc.Label");a.node.active=!1;var n=profileHeb.getResultScoreInfoByUid(t.uid);a.string="";for(var i=1==GameData.ResultData[t.uid].isWin||3==GameData.ResultData[t.uid].isWin,o=(GameData.ResultData[t.uid].isWin,HuaDian.WINTYPE.LIUJU,GameData.ResultData[t.uid].isWin==HuaDian.WINTYPE.DIANPAOLOSE),r=t.uid==GameData.game.zhuangUid,s=0;s<n.huTypes.length;s++)if(i){var c=!1;for(var d in p)if(n.huTypes[s].code==p[d]){c=!0;break}a.string+=c?n.huTypes[s].des+"*"+n.huTypes[s].fan+" ":n.huTypes[s].des+"+"+n.huTypes[s].fan+" "}o&&(a.string+="点炮*2 "),r&&i?a.string+="庄家*2 ":r&&2==GameData.ResultData[t.uid].isWin?a.string+="庄家*2 ":r&&3==profileHeb.getHuType()&&(a.string+="庄家*2 ");var h,l=GameData.ResultData[t.uid].gangCards,u=0;for(var d in l)u+=profileHeb.getGangSorce(l[d].cards)*(GameData.joiners.length-1);0!=u&&(a.string+=" 杠:+"+u+"分 "),0!=(h=u-n.scoreList[1])&&(a.string+=" 杠:-"+h+"分 ");var m=GameData.cards[t.uid].tingState;m&&!i&&(1==m?a.string+="报搂 ":2==m&&(a.string+="报听 ")),a.node.active=!0},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showHandCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a.card),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a.card+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showRoundInfo:function(){this.roomID.string="房号："+GameData.room.id;var e=1e3*profileHeb.resultData.timeStamp,t=(e=new Date(e)).getFullYear()+"/",a=e.getMonth()+1+"/",n=e.getDate()+"   ",i=e.getHours()+"",o=e.getMinutes()+"",r=e.getSeconds()+"";i=1==i.length?"0"+i:i,o=1==o.length?"0"+o:o,r=1==r.length?"0"+r:r,this.createtime.string=t+a+n+i+":"+o+":"+r;var s=GameData.room.gameNum;this.roundData.string="第"+s+"局"},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a,n){if(e){var i=GameData.getChiCards(e.uid);i.sort(function(e,t){return e-t});for(var o=GameData.getGangCards(e.uid),r=0;r<o.length;r++)o[r].cardType=-1;for(var s=GameData.getPengCards(e.uid),c=o.concat(s,i),d=parseInt(GameData.client.handsize/3),h=0;h<d;h++){var l=cc.find("cardPeng/cardPeng"+(h+1),t),u=cc.find("card_face7",l);if(u.active=!1,h<c.length){for(var m=0;m<7;m++){var p=l.getChildByName("card_face"+(m+1)).getComponent("cc.Sprite"),g=p.node.getChildByName(p.node.name+"_bugangIcon");g&&(g.active=!1);var f=!1;c[h].cards.length<4&&profileHeb.isAllEqual(c[h].cards)&&!c[h].cardType&&(f=!0);var y=!1;4==c[h].cards.length&&profileHeb.isAllEqual(c[h].cards)&&(y=!0);var v=!1;if(5==c[h].cards.length&&profileHeb.isAllEqual(c[h].cards)&&(v=!0),m<c[h].cards.length){p.node.active=!0;var C=c[h].cards[m];if(f)this.showCardContent(p.node,a,C);else if(y)m<4?3==m?(this.showCardContent(u,a,C),p.node.active=!1):this.showCardContent(p.node,a,C):p.node.active=!1,u.active=!0,this.addGangIcon(u,n,1);else if(v)m<4?3==m?(this.showCardContent(u,a,C),p.node.active=!1):this.showCardContent(p.node,a,C):p.node.active=!1,u.active=!0,this.addGangIcon(u,n,2);else if(c[h].cardType&&c.type!=HuaDian.OPERATION.OPERATION_ANGANG&&c.type!=HuaDian.OPERATION.OPERATION_MINGGANG&&c.type!=HuaDian.OPERATION.OPERATION_GONGGANG){var D=[].concat(c[h].cards);D.splice(3,D.length);var _=[].concat(c[h].cards),G=profileHeb.guolv(D,_),w=[].concat(D,G),S=w.length>m,T=1,N=3;for(3<=m&&(N=c[h].cards.indexOf(w[m])+1);N<c[h].cards.length;N++)if(w[m]==c[h].cards[N]){if(0!=m&&c[h].cards.indexOf(w[m])==N)continue;T++}S?(2<=T&&this.addBuGangIcon(p.node,n,T),this.showCardContent(p.node,a,w[m]),p.node.active=!0):p.node.active=!1}else this.showCardContent(p.node,a,C)}else 6!=m&&(p.node.active=!1)}l.active=!0}else l.active=!1}}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},addBuGangIcon:function(e,t,a){var n,i=e.getChildByName(e.name+"_bugangIcon");null==i&&((i=cc.instantiate(this.cardBugangPre)).name=e.name+"_bugangIcon",i.setScale(1.2),i.setPosition(i.x-5,i.y-10),e.addChild(i)),i.active=!0;var o="";"right"==t?o="1":"down"==t?o="0":"left"==t?o="3":"up"==t&&(o="2");for(var r=0;r<i.childrenCount;r++)if("down"==i.children[r].name){i.children[r].active=!0,n=cc.url.raw("resources/changchun/UI/icon/bugang_"+o+"_"+a+".png");var s=cc.textureCache.addImage(n);i.children[r].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)}else i.children[r].active=!1},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n="";GameData.client.gameType==r.GameType.Game_Mj_Tianjin?n=cc.url.raw("resources/table/huier_icon.png"):GameData.client.gameType==r.GameType.Game_MJ_HuaDian&&(n=cc.url.raw("resources/table/huier_icon.png"));var i=cc.textureCache.addImage(n);a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCards:function(e){var t,a=GameData.joiners[e],n=cc.find("player"+(e+1),this.resultLayer),i=cc.find("cards",n),o=0;GameData.ResultData[a.uid]&&(t=1==GameData.ResultData[a.uid].isWin||3==GameData.ResultData[a.uid].isWin);var r=GameData.client.handsize+1,s=GameData.cards[a.uid].Resulthand;s.sort(function(e,t){return e.card-t.card});var c=GameData.getHandCardNum(a.uid);c=c%3==1?c+1:c,t&&(this.isMark=0);for(var d=cc.find("cardHand",i),h=0;h<d.childrenCount;h++)d.children[h].active=!1;for(var l=cc.find("cardPeng",i),u=0;u<l.childrenCount;u++)l.children[u].active=!1;for(var m=0;m<s.length;m++)1==s[m].type&&o++;for(var p=profileHeb.resultData.isLouBao,g=3*GameData.getPengCards(a.uid).length+3*GameData.getGangCards(a.uid).length+3*GameData.getChiCards(a.uid).length,f=0;f<s.length;f++){if(!t&&p){cc.log("nodeIdx:"+c);var y=cc.find("cardHand/cardHand"+c,i);if(this.showHandCardContent(y,"mj_face_xia_shou",s[f]),c==r-s.length-g)cc.log("nodeIdxnodeIdxnodeIdxnodeIdx:"+c),(y=cc.find("cardHand/cardHand"+c,i)).active=!1;if(1==c)(y=cc.find("cardHand/cardHand"+c,i)).active=!1}else{y=cc.find("cardHand/cardHand"+c,i);this.showHandCardContent(y,"mj_face_xia_shou",s[f])}c--}if(this.removeCardIcon(i),o!=s.length)for(var v=0;v<s.length;v++){var C=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(C-v),i);1==s[v].type&&(this.setMyBaoVisible(y,s[v]),this.setMyHuimageVisible(y,s[v],t))}else for(var D=0;D<s.length;D++){var _=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(_-D),i);this.setMyHuimageVisible(y,s[D],t)}this.showPengCards(a,i,"mj_face_xia_chu","down"),n.active=!0},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1)+"/score",this.resultLayer),n=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=s.getCoinData();i&&i.coin&&i.coin[t]&&(n=i.coin[t])}else n=GameData.scores[t];null==n&&(n=0),0<n?(a.getComponent("cc.Label").string="+"+n,a.color=new cc.Color(255,255,0)):(a.getComponent("cc.Label").string=n,a.color=new cc.Color(255,46,53))},removeCardIcon:function(e){var t=cc.find("cardHand",e);for(var a in t.children){var n=t.children[a].getChildByName(t.children[a].name+"_huier"),i=t.children[a].getChildByName(t.children[a].name+"_hu");n&&n.removeFromParent(!0),i&&i.removeFromParent(!0)}},showWinIcon:function(e,t){var a=GameData.joiners[e].uid,n=(t=cc.find("player"+(e+1),this.resultLayer),cc.find("huIcon",t)),i=!1;1!=GameData.ResultData[a].isWin&&3!=GameData.ResultData[a].isWin||(i=!0),n.active=i;var o=cc.find("paoIcon",t);o.active=!1,2==GameData.ResultData[a].isWin?(n.active=!1,o.active=!0):o.active=!1},showResultIcon:function(){var e=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=s.getCoinData();t&&t.coin&&t.coin[GameData.player.uid]&&(e=t.coin[GameData.player.uid])}else e=GameData.scores[GameData.player.uid];null==e&&(e=0),0<e?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):e<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("roomMain_heb").showSummaryLayer()):(MjHandler.getInstance().requestReady(function(e){}),GameData.game.zhuangUid=0,sendEvent("onGameReady"))},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],roomResult_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"1d014NOwohHLaO8U874PAKK","roomResult_huadian");var o=e("ruleHandler"),r=e("gameDefine");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,createtime:cc.Label,roomID:cc.Label,roundData:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,isMark:0,baoCardNode:cc.Node},onLoad:function(){},onDestroy:function(){},onShow:function(){for(var e=0;e<GameData.room.opts.joinermax;e++)this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e);for(e=GameData.room.opts.joinermax;e<4;e++){cc.find("player"+(e+1),this.resultLayer).active=!1}this.showBaoNode(),this.showRoundInfo(),this.showResultIcon()},showPlayer:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/head/id",this.resultLayer),n=cc.find("player"+(e+1)+"/head/name",this.resultLayer),i=cc.find("player"+(e+1)+"/head/headpic",this.resultLayer),o=cc.find("player"+(e+1)+"/head/zhuang",this.resultLayer),r=cc.find("player"+(e+1)+"/head/creator",this.resultLayer),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==GameData.game.zhuangUid,r.active=t.uid==GameData.room.creator,null==t.headimgurl||""==t.headimgurl||t.headimgurl.length<=0||cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},showBaoNode:function(){var e=cc.find("baoCard",this.baoCardNode);if(1e3!=GameData.game.cardHuier1&&-1!=GameData.game.cardHuier1&&0!=GameData.game.cardHuier1){this.baoCardNode.active=!0,e.getComponents(cc.Sprite).spriteFrame=null;var t="resources/mjcard2d/mj_face_xia_shou_"+GameData.game.cardHuier1+".png",a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}else this.baoCardNode.active=!1},setMyBaoVisible:function(e,t,a){var n=!1;o.instance.isHuier(t.card)&&(n=!0),0==a&&(n=!1),0==t.type&&(n=!1);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&(i=cc.instantiate(this.cardHuier),e.addChild(i),i.name=e.name+"_huier"):i.active=n},setMyHuimageVisible:function(e,t,a){var n=GameData.game.winnerObtain;cc.log("orCard:"+n);var i=!1;0==a?i=!1:n==t.card&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuimage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/term",this.resultLayer).getComponent("cc.Label");a.node.active=!1;var n=profileHuaDian.getResultScoreInfoByUid(t.uid);a.string="";for(var i=1==GameData.ResultData[t.uid].isWin||3==GameData.ResultData[t.uid].isWin,o=(GameData.ResultData[t.uid].isWin,HuaDian.WINTYPE.LIUJU,0);o<n.huTypes.length;o++)0==GameData.room.opts.isBigFan||1==GameData.room.opts.isBigFan&&i&&(2==n.huTypes[o].code||3==n.huTypes[o].code||9==n.huTypes[o].code?a.string+=n.huTypes[o].des+"+"+n.huTypes[o].fan+" ":a.string+=n.huTypes[o].des+"*"+n.huTypes[o].fan+" ");var r,s=GameData.ResultData[t.uid].gangCards,c=0;for(var d in s)4==s[d].cards.length?c+=1:5==s[d].cards.length&&(c+=GameData.joiners.length-1);0!=c&&(a.string+=" 杠:+"+c+"分 "),0!=(r=c-n.scoreList[1])&&(a.string+=" 杠:-"+r+"分 "),1!=GameData.ResultData[t.uid].hasPiao&&2!=GameData.ResultData[t.uid].hasPiao||(a.string+="飘 ");var h=GameData.cards[t.uid].tingState;h&&!i&&(1==h?a.string+="报搂 ":2==h&&(a.string+="报听 ")),a.node.active=!0},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showHandCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a.card),e.active=!0,e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a.card+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)},showRoundInfo:function(){this.roomID.string="房号："+GameData.room.id;var e=1e3*profileHuaDian.resultData.timeStamp,t=(e=new Date(e)).getFullYear()+"/",a=e.getMonth()+1+"/",n=e.getDate()+"   ",i=e.getHours()+"",o=e.getMinutes()+"",r=e.getSeconds()+"";i=1==i.length?"0"+i:i,o=1==o.length?"0"+o:o,r=1==r.length?"0"+r:r,this.createtime.string=t+a+n+i+":"+o+":"+r;var s=GameData.room.gameNum;this.roundData.string="第"+s+"局"},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a,n){if(e){var i=GameData.getGangCards(e.uid),o=GameData.getPengCards(e.uid),r=GameData.getChiCards(e.uid),s=[];for(var c in i)s.push(i[c]);for(var c in o)s.push(o[c]);for(var c in r)s.push(r[c]);cc.log("resultCards:"+JSON.stringify(s));for(var d=parseInt(GameData.client.handsize/3),h=0;h<d;h++){var l=cc.find("cardPeng/cardPeng"+(h+1),t),u=cc.find("card_face4",l);if(h<s.length){for(var m=0;m<4;m++){var p=l.getChildByName("card_face"+(m+1)).getComponent("cc.Sprite");if(m<s[h].cards.length){p.node.active=!0;var g=s[h].cards[m];4==s[h].cards.length&&this.addGangIcon(u,n,1),5==s[h].cards.length&&this.addGangIcon(u,n,2),this.showCardContent(p.node,a,g)}else p.node.active=!1}l.active=!0}else l.active=!1}}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n="";GameData.client.gameType==r.GameType.Game_Mj_Tianjin?n=cc.url.raw("resources/table/huier_icon.png"):GameData.client.gameType==r.GameType.Game_MJ_HuaDian&&(n=cc.url.raw("resources/table/huier_icon.png"));var i=cc.textureCache.addImage(n);a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCards:function(e){var t,a=GameData.joiners[e],n=cc.find("player"+(e+1),this.resultLayer),i=cc.find("cards",n),o=0;t=1==GameData.ResultData[a.uid].isWin||3==GameData.ResultData[a.uid].isWin;var r=GameData.client.handsize+1,s=GameData.cards[a.uid].Resulthand;s.sort(function(e,t){return e.card-t.card});var c=GameData.getHandCardNum(a.uid);c=c%3==1?c+1:c,t&&(this.isMark=0);for(var d=cc.find("cardHand",i),h=0;h<d.childrenCount;h++)d.children[h].active=!1;for(var l=cc.find("cardPeng",i),u=0;u<l.childrenCount;u++)l.children[u].active=!1;for(var m=0;m<s.length;m++)1==s[m].type&&o++;for(var p=profileHuaDian.resultData.isLouBao,g=3*GameData.getPengCards(a.uid).length+3*GameData.getGangCards(a.uid).length+3*GameData.getChiCards(a.uid).length,f=0;f<s.length;f++){if(!t&&p){cc.log("nodeIdx:"+c);var y=cc.find("cardHand/cardHand"+c,i);if(this.showHandCardContent(y,"mj_face_xia_shou",s[f]),c==r-s.length-g)cc.log("nodeIdxnodeIdxnodeIdxnodeIdx:"+c),(y=cc.find("cardHand/cardHand"+c,i)).active=!1;if(1==c)(y=cc.find("cardHand/cardHand"+c,i)).active=!1}else{y=cc.find("cardHand/cardHand"+c,i);this.showHandCardContent(y,"mj_face_xia_shou",s[f])}c--}if(this.removeCardIcon(i),o!=s.length)for(var v=0;v<s.length;v++){var C=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(C-v),i);1==s[v].type&&(this.setMyBaoVisible(y,s[v]),this.setMyHuimageVisible(y,s[v],t))}else for(var D=0;D<s.length;D++){var _=GameData.getHandCardNum(a.uid);y=cc.find("cardHand/cardHand"+(_-D),i);this.setMyHuimageVisible(y,s[D],t)}this.showPengCards(a,i,"mj_face_xia_chu","down"),n.active=!0},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1)+"/score",this.resultLayer),n=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=RoomHandler.getCoinData();i&&i.coin&&i.coin[t]&&(n=i.coin[t])}else n=GameData.scores[t];null==n&&(n=0),0<n?(a.getComponent("cc.Label").string="+"+n,a.color=new cc.Color(255,255,0)):(a.getComponent("cc.Label").string=n,a.color=new cc.Color(255,46,53))},removeCardIcon:function(e){var t=cc.find("cardHand",e);for(var a in t.children){var n=t.children[a].getChildByName(t.children[a].name+"_huier"),i=t.children[a].getChildByName(t.children[a].name+"_hu");n&&n.removeFromParent(!0),i&&i.removeFromParent(!0)}},showWinIcon:function(e,t){var a=GameData.joiners[e].uid,n=(t=cc.find("player"+(e+1),this.resultLayer),cc.find("huIcon",t)),i=!1;1!=GameData.ResultData[a].isWin&&3!=GameData.ResultData[a].isWin||(i=!0),n.active=i;var o=cc.find("paoIcon",t);o.active=!1,2==GameData.ResultData[a].isWin?(n.active=!1,o.active=!0):o.active=!1},showResultIcon:function(){var e=0;if(r.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=RoomHandler.getCoinData();t&&t.coin&&t.coin[GameData.player.uid]&&(e=t.coin[GameData.player.uid])}else e=GameData.scores[GameData.player.uid];null==e&&(e=0),0<e?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):e<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("roomMain_huadian").showSummaryLayer()):(MjHandler.getInstance().requestReady(function(e){}),GameData.game.zhuangUid=0,sendEvent("onGameReady"))},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomResult:[function(e,t,a){"use strict";cc._RF.push(t,"eee815muQpPk4gtMBEwDD2Y","roomResult");var p=e("ruleHandler"),o=e("gameDefine"),r=e("roomHandler");e("SoundMngr");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,resultTitle:cc.Node,createtime:cc.Label,roomID:cc.Label,roundData:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,isMark:0,maskbg:cc.Node,shareBtn:cc.Button,readyBtn:cc.Button,font:{default:[],type:[cc.Font]}},onLoad:function(){},initResultData:function(){cc.log("initResultData"),this.isHuType=!1,this.moveToPosY=-190;var e=cc.find("player1",this.resultLayer),t=cc.find("player2",this.resultLayer),a=cc.find("player3",this.resultLayer),n=cc.find("player4",this.resultLayer);e.y=215,t.y=80,a.y=-55,n.y=-190,e.setScale(1),t.setScale(1),a.setScale(1),n.setScale(1),this.shareBtn.node.x=-213,this.shareBtn.node.y=-310,this.readyBtn.node.x=227,this.readyBtn.node.y=-310,this.maskbg.active=!1,this.resultTitle.active=!0,this.juShuStr=cc.find("roomInfo/roundNum",this.resultLayer),this.resultTime=cc.find("roomInfo/resultTime",this.resultLayer),this.roomIdStr=cc.find("roomInfo/roomID",this.resultLayer),this.juShuStr.color=new cc.Color(0,0,0),this.resultTime.color=new cc.Color(0,0,0),this.roomIdStr.color=new cc.Color(0,0,0)},onDestroy:function(){},onShow:function(){if(this.initResultData(),GameData.room.joinermax){this.showResultIcon();for(var e=0;e<GameData.room.joinermax;e++)this.showCards(e),this.showPlayer(e),this.showScore(e),this.showDetail(e),this.showWinIcon(e);for(var t=0;t<GameData.room.joinermax;t++);for(var a=GameData.room.joinermax;a<4;a++){cc.find("player"+(a+1),this.resultLayer).active=!1}this.showRoundInfo()}},showPlayer:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/head/id",this.resultLayer),n=cc.find("player"+(e+1)+"/head/name",this.resultLayer),i=cc.find("player"+(e+1)+"/head/headpic",this.resultLayer),o=cc.find("player"+(e+1)+"/head/zhuang",this.resultLayer),r=cc.find("player"+(e+1)+"/head/creator",this.resultLayer),s=t.name.substring(0,4)+"...";n.getComponent(cc.Label).string=s,a.getComponent(cc.Label).string=t.uid,o.active=t.uid==GameData.game.zhuangUid,r.active=t.uid==GameData.room.creator,null!=t.headimgurl&&""!=t.headimgurl&&cc.loader.load({url:t.headimgurl,type:"png"},function(e,t){!e&&t&&(i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})},setMyHuierVisible:function(e,t,a){var n=!1;p.instance.isHuier(t)&&(n=!0);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&((i=cc.instantiate(this.cardHuier)).y=i.y-18,e.addChild(i),i.name=e.name+"_huier",cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0):i.active=n},setMyHuimageVisible:function(e,t,a){var n=GameData.game.winnerObtain,i=!1;0==a?i=!1:n==t&&0==this.isMark&&(i=!0);var o=e.getChildByName(e.name+"_hu");null==o?1==i&&((o=cc.instantiate(this.cardHuimage)).y=o.y-20,e.addChild(o),o.name=e.name+"_hu"):o.active=i,1==i&&(this.isMark=1)},showDetail:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1)+"/term",this.resultLayer),n=a.getComponent("cc.Label");GameData.scores[GameData.player.uid],GameData.getHandCards(t.uid);a.parent.active=!0;var i=p.instance.getHuTypeString();console.log("resultItems = "+JSON.stringify(i)),GameData.game.winnerUid==t.uid?n.string=i[0]:n.string="",GameData.game.zhuangUid==t.uid?1==i[1]&&(n.string+="铲牌 -2  "):n.string+="",GameData.room.opts.times&&(1==GameData.room.opts.times?n.string+="底分 *1  ":2==GameData.room.opts.times?n.string+="底分 *2  ":5==GameData.room.opts.times&&(n.string+="底分 *5  "));for(var o=GameData.getGangCards(t.uid),r=0,s=0,c=0;c<o.length;c++)p.instance.isHuier(o[c][0])?n.string+="金杠 +"+GameData.room.opts.jingang+"  ":4==o[c].length?r++:5==o[c].length&&s++;if(0==r||(n.string+="明杠 +1*"+r+"  "),0==s||(n.string+="暗杠 +2*"+s+"  "),(0<r||0<s)&&1==GameData.room.opts.doubleGang&&0<GameData.game.zhuangNum[GameData.game.zhuangUid]&&(n.string+="杠翻番  "),GameData.game.zhuangUid==t.uid&&0<GameData.game.zhuangNum[t.uid]){var d=2*(h=GameData.game.zhuangNum[t.uid]);n.string+="坐"+h+"庄 *"+d}else if(GameData.game.zhuangUid!=t.uid&&0<GameData.game.zhuangNum[t.uid]){var h;d=2*(h=GameData.game.zhuangNum[t.uid]);n.string+="拉"+h+"庄 *"+d}GameData.game.winnerUid==GameData.player.uid&&(p.instance.getHuTypeArry(5)&&p.instance.getHuTypeArry(7)||p.instance.getHuTypeArry(5)&&p.instance.getHuTypeArry(6)&&p.instance.getHuTypeArry(10)||p.instance.getHuTypeArry(5)&&p.instance.getHuTypeArry(10))&&(this.isHuType=!0)},showShare:function(e){if(this.isHuType&&4==GameData.room.opts.joinermax){this.maskbg.active=!0;for(var t=0;t<GameData.room.joinermax;t++){var a=GameData.joiners[t],n=cc.find("player"+(t+1)+"/term",this.resultLayer);GameData.player.uid==a.uid?n.parent.active=!0:n.parent.active=!1,n.parent.y=-215,n.parent.x=41,n.parent.setScale(.8)}cc.log("winSpritebg "),this.shareBtn.node.x=-408,this.shareBtn.node.y=-324,this.readyBtn.node.x=425,this.readyBtn.node.y=-324,this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1,this.resultTitle.active=!1,this.isHuType=!1,this.juShuStr.color=new cc.Color(125,133,133),this.resultTime.color=new cc.Color(125,133,133),this.roomIdStr.color=new cc.Color(125,133,133)}},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)},showRoundInfo:function(){this.roomID.string="房号："+GameData.room.id;var e=getTimeStr(GameData.room.createtime);this.createtime.string=e[0]+"/"+e[1]+"/"+e[2]+"  "+e[3]+":"+e[4]+":"+e[5];var t=GameData.game.roundCount;this.roundData.string="第"+t+"局"},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a,n){if(e)for(var i=GameData.getGangCards(e.uid),o=GameData.getPengCards(e.uid),r=i.concat(o),s=parseInt(GameData.client.handsize/3),c=0;c<s;c++){var d=cc.find("cardPeng/cardPeng"+(c+1),t);if(c<r.length){for(var h=0;h<4;h++){var l=d.getChildByName("card_face"+(h+1)).getComponent("cc.Sprite");if(h<r[c].length){l.node.active=!0;var u=r[c][h];this.showCardContent(l.node,a,u),3==h&&1==p.instance.isHuier(u)&&this.addHuierIcon(l.node,n)}else l.node.active=!1}if(5==r[c].length){l=d.getChildByName("card_face4").getComponent("cc.Sprite");var m=d.getChildByName("card_back4").getComponent("cc.Sprite");l.node.active=!1,m.node.active=!0}else{(m=d.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1}d.active=!0}else d.active=!1}},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n="";GameData.client.gameType==o.GameType.Game_Mj_Tianjin&&(n=cc.url.raw("resources/table/huier_icon.png"));var i=cc.textureCache.addImage(n);a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCards:function(e){var t=GameData.joiners[e],a=cc.find("player"+(e+1),this.resultLayer),n=cc.find("cards",a),i=t.uid==GameData.game.winnerUid,o=GameData.client.handsize+1,r=GameData.getHandCards(t.uid),s=GameData.getHandCardNum(t.uid),c=s=s%3==1?s+1:s;for(var d in i&&(this.isMark=0),r)for(var h=0;h<r[d];h++){var l=cc.find("cardHand/cardHand"+s,n);cc.log("result showCards:"+s+" "+d),this.showCardContent(l,"mj_face_xia_shou",d),this.setMyHuierVisible(l,d,"down"),this.setMyHuimageVisible(l,d,i),l.active=!0,s--}for(h=s;1<=h;h--){(l=cc.find("cardHand/cardHand"+h,n)).active=!1}for(h=c+1;h<=o;h++){(l=cc.find("cardHand/cardHand"+h,n)).active=!1}this.showPengCards(t,n,"mj_face_xia_chu","down"),a.active=!0},showScore:function(e){var t=GameData.joiners[e].uid,a=cc.find("player"+(e+1)+"/score",this.resultLayer),n=0;if(o.currencyType.Currency_Coin==GameData.room.opts.currencyType){var i=r.getCoinData();i&&i.coin&&i.coin[t]&&(n=i.coin[t])}else n=GameData.scores[t];null==n&&(n=0),0<n?(a.getComponent("cc.Label").font=this.font[0],a.getComponent("cc.Label").string="+"+n):n<0?(a.getComponent("cc.Label").font=this.font[1],a.getComponent("cc.Label").string=n):0==n&&(a.getComponent("cc.Label").font=this.font[2],a.getComponent("cc.Label").string=n)},showWinIcon:function(e,t){var a=GameData.joiners[e].uid;t=cc.find("player"+(e+1),this.resultLayer);cc.find("huIcon",t).active=a==GameData.game.winnerUid},showResultIcon:function(){var e=0;if(o.currencyType.Currency_Coin==GameData.room.opts.currencyType){var t=r.getCoinData();t&&t.coin&&t.coin[GameData.player.uid]&&(e=t.coin[GameData.player.uid])}else e=GameData.scores[GameData.player.uid];null==e&&(e=0),0<e?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):e<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,this.node.getComponent("roomMain").showSummaryLayer()):(MjHandler.getInstance().requestReady(function(e){}),sendEvent("onGameStart"))},shareRet:function(){0==inCD(3e3)&&screenShoot(wxShareTexture)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],"roomScore-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"3ae54iSasJBa4tGQtK9JVeY","roomScore-shishi"),cc.Class({extends:cc.Component,properties:{scoreScollView:cc.ScrollView,scoreLayer:cc.Node,playerHeadNode:cc.Node,playerScoreItem:cc.Node,playerSumScore:cc.Node,ScoreList:[]},onLoad:function(){cc.log("GameData.room.joinermax1 "+JSON.stringify(GameData.room)),GameData.room&&(this.playerNum=GameData.room.joinermax),registEvent("onRoomMsg",this,this.ShowsPlayerTitle)},onEnable:function(){GameData.joiners&&this.ShowsPlayerTitle(),this.ScoreList=[]},onDestroy:function(){},initPlayerHeadNode:function(){for(var e=0;e<this.playerNum-1;e++){var t=this.playerHeadNode.parent.getChildByName("Player_"+(e+2));t||(t=cc.instantiate(this.playerHeadNode),this.playerHeadNode.parent.addChild(t),t.name="Player_"+(e+2),t.x=this.playerHeadNode.x+200*(e+1))}},ShowsPlayerTitle:function(){null!=this.playerNum&&(this.playerNum=GameData.room.joinermax),cc.log("this.playerNum2"+this.playerNum),this.initPlayerHeadNode();for(var e=0;e<this.playerNum;e++){var t=e+1,a=GameData.joiners[e];if(a){var n=a.headimgurl;this.ShowPlayerNameOnItme(t,a.name),this.ShowsPlayerImageOnItme(t,n),this.ShowPlayerOwner(t,a)}}},ShowPlayerNameOnItme:function(e,t){cc.find("Player_"+e+"/nick_name",this.playerHeadNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},ShowsPlayerImageOnItme:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("Player_"+a+"/head",n.playerHeadNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},ShowPlayerOwner:function(e,t){GameData.room.creator==t.uid&&(cc.find("Player_"+e+"/owner",this.playerHeadNode.parent).active=!0)},ShowPlayerScoreItem:function(){var e;e=GameData.game.roundNum;for(var t=0;t<e;t++){var a=t+1,n=this.playerScoreItem.parent.getChildByName(""+t);null==n&&(n=cc.instantiate(this.playerScoreItem),this.playerScoreItem.parent.addChild(n),this.ScoreList.push(n),n.active=!0,n.name=""+t,n.y=this.playerScoreItem.y-t*this.playerScoreItem.height),this.scoreScollView.content.height<this.ScoreList.length*this.playerScoreItem.height&&(this.scoreScollView.content.height=this.scoreScollView.content.height+this.playerScoreItem.height),cc.find(t+"/roundNum",this.playerScoreItem.parent).getComponent(cc.Label).string="第"+a+"局：";for(var i=0;i<4;i++){a=i+1;var o=cc.find("scoreNum_"+a,n);i>=this.playerNum&&(o.active=!1)}for(var r=0;r<this.playerNum;r++){var s=r+1,c=GameData.joiners[r].uid;o=cc.find("scoreNum_"+s,n);if(0<GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="+"+GameData.JushuScore[t][c]+"分",o.color=new cc.Color(254,48,0)):0==GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="0 分",o.color=new cc.Color(0,164,54)):(o.getComponent("cc.Label").string=GameData.JushuScore[t][c]+"分",o.color=new cc.Color(24,51,55)),c==GameData.JushuScore[t].zhuangUid){var d=r+1;cc.find("zhuang_"+d,n).active=!0}}}cc.log("GameData.room.joinermax2 "+GameData.room.joinermax),null!=this.playerNum&&(this.playerNum=GameData.room.joinermax,this.AddSumScore())},AddSumScore:function(){for(var e=this.playerSumScore.children,t=0;t<e.length;t++)console.log("this.playerNum = "+this.playerNum+",i = "+t),t>=this.playerNum&&(e[t].active=!1);for(t=0;t<this.playerNum;t++){var a=t+1,n=cc.find("scoreNum_"+a,this.playerSumScore),i=GameData.joiners[t].uid;0<GameData.allScores[i]?(0!=GameData.room.opts.scoreBase?n.getComponent("cc.Label").string=GameData.allScores[i]+"分":n.getComponent("cc.Label").string="+"+GameData.allScores[i]+"分",n.color=new cc.Color(254,48,0)):0==GameData.allScores[i]?(n.getComponent("cc.Label").string="0 分",n.color=new cc.Color(0,164,54)):(n.getComponent("cc.Label").string=GameData.allScores[i]+"分",n.color=new cc.Color(24,51,55))}},close:function(){this.scoreLayer.active=!1}}),cc._RF.pop()},{}],roomScore_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"9a6c0DskQ1DDr/7Stu3iRa1","roomScore_changchun"),cc.Class({extends:cc.Component,properties:{scoreScollView:cc.ScrollView,scoreLayer:cc.Node,playerHeadNode:cc.Node,playerScoreItem:cc.Node,playerSumScore:cc.Node,ScoreList:[]},onLoad:function(){GameData.room&&(this.playerNum=GameData.room.opts.joinermax),registEvent("onRoomInfo",this,this.ShowsPlayerTitle)},onEnable:function(){GameData.joiners&&this.ShowsPlayerTitle(),this.ScoreList=[]},onDestroy:function(){},initPlayerHeadNode:function(){for(var e=0;e<this.playerNum-1;e++){var t=this.playerHeadNode.parent.getChildByName("Player_"+(e+2));t||(t=cc.instantiate(this.playerHeadNode),this.playerHeadNode.parent.addChild(t),t.name="Player_"+(e+2),t.x=this.playerHeadNode.x+200*(e+1))}},ShowsPlayerTitle:function(){null!=this.playerNum&&(this.playerNum=GameData.room.opts.joinermax),cc.log("this.playerNum2"+this.playerNum),this.initPlayerHeadNode();for(var e=0;e<this.playerNum;e++){var t=e+1,a=GameData.joiners[e];if(a){var n=a.headimgurl;this.ShowPlayerNameOnItme(t,a.name),this.ShowsPlayerImageOnItme(t,n),this.ShowPlayerOwner(t,a)}}},ShowPlayerNameOnItme:function(e,t){cc.find("Player_"+e+"/nick_name",this.playerHeadNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},ShowsPlayerImageOnItme:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("Player_"+a+"/head",n.playerHeadNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},ShowPlayerOwner:function(e,t){GameData.room.creator==t.uid&&(cc.find("Player_"+e+"/owner",this.playerHeadNode.parent).active=!0)},ShowPlayerScoreItem:function(){var e;e=GameData.game.roundNum;for(var t=0;t<e;t++){var a=t+1,n=this.playerScoreItem.parent.getChildByName(""+t);null==n&&(n=cc.instantiate(this.playerScoreItem),this.playerScoreItem.parent.addChild(n),this.ScoreList.push(n),n.active=!0,n.name=""+t,n.y=this.playerScoreItem.y-t*this.playerScoreItem.height),this.scoreScollView.content.height<this.ScoreList.length*this.playerScoreItem.height&&(this.scoreScollView.content.height=this.scoreScollView.content.height+this.playerScoreItem.height),cc.find(t+"/roundNum",this.playerScoreItem.parent).getComponent(cc.Label).string="第"+a+"局：";for(var i=0;i<4;i++){a=i+1;var o=cc.find("scoreNum_"+a,n);i>=this.playerNum&&(o.active=!1)}for(var r=0;r<this.playerNum;r++){var s=r+1,c=GameData.joiners[r].uid;o=cc.find("scoreNum_"+s,n);if(0<GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="+"+GameData.JushuScore[t][c]+"分",o.color=new cc.Color(254,48,0)):0==GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="0 分",o.color=new cc.Color(0,164,54)):(o.getComponent("cc.Label").string=GameData.JushuScore[t][c]+"分",o.color=new cc.Color(24,51,55)),c==GameData.JushuScore[t].zhuangUid){var d=r+1;cc.find("zhuang_"+d,n).active=!0}}}null!=this.playerNum&&(this.playerNum=GameData.room.opts.joinermax,this.AddSumScore())},AddSumScore:function(){for(var e=this.playerSumScore.children,t=0;t<e.length;t++)console.log("this.playerNum = "+this.playerNum+",i = "+t),t>=this.playerNum&&(e[t].active=!1);for(t=0;t<this.playerNum;t++){var a=t+1,n=cc.find("scoreNum_"+a,this.playerSumScore),i=GameData.joiners[t].uid;0<GameData.allScores[i]?(0!=GameData.room.opts.scoreBase?n.getComponent("cc.Label").string=GameData.allScores[i]+"分":n.getComponent("cc.Label").string="+"+GameData.allScores[i]+"分",n.color=new cc.Color(254,48,0)):0==GameData.allScores[i]?(n.getComponent("cc.Label").string="0 分",n.color=new cc.Color(0,164,54)):(n.getComponent("cc.Label").string=GameData.allScores[i]+"分",n.color=new cc.Color(24,51,55))}},close:function(){this.scoreLayer.active=!1}}),cc._RF.pop()},{}],roomScore_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"9d2ceMKIKdA5KAtT6KF/IFU","roomScore_huadian"),cc.Class({extends:cc.Component,properties:{scoreScollView:cc.ScrollView,scoreLayer:cc.Node,playerHeadNode:cc.Node,playerScoreItem:cc.Node,playerSumScore:cc.Node,ScoreList:[]},onLoad:function(){GameData.room&&(this.playerNum=GameData.room.opts.joinermax),registEvent("onRoomInfo",this,this.ShowsPlayerTitle)},onEnable:function(){GameData.joiners&&this.ShowsPlayerTitle(),this.ScoreList=[]},onDestroy:function(){},initPlayerHeadNode:function(){for(var e=0;e<this.playerNum-1;e++){var t=this.playerHeadNode.parent.getChildByName("Player_"+(e+2));t||(t=cc.instantiate(this.playerHeadNode),this.playerHeadNode.parent.addChild(t),t.name="Player_"+(e+2),t.x=this.playerHeadNode.x+200*(e+1))}},ShowsPlayerTitle:function(){null!=this.playerNum&&(this.playerNum=GameData.room.opts.joinermax),cc.log("this.playerNum2"+this.playerNum),this.initPlayerHeadNode();for(var e=0;e<this.playerNum;e++){var t=e+1,a=GameData.joiners[e];if(a){var n=a.headimgurl;this.ShowPlayerNameOnItme(t,a.name),this.ShowsPlayerImageOnItme(t,n),this.ShowPlayerOwner(t,a)}}},ShowPlayerNameOnItme:function(e,t){cc.find("Player_"+e+"/nick_name",this.playerHeadNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},ShowsPlayerImageOnItme:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("Player_"+a+"/head",n.playerHeadNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},ShowPlayerOwner:function(e,t){GameData.room.creator==t.uid&&(cc.find("Player_"+e+"/owner",this.playerHeadNode.parent).active=!0)},ShowPlayerScoreItem:function(){var e;e=GameData.game.roundNum;for(var t=0;t<e;t++){var a=t+1,n=this.playerScoreItem.parent.getChildByName(""+t);null==n&&(n=cc.instantiate(this.playerScoreItem),this.playerScoreItem.parent.addChild(n),this.ScoreList.push(n),n.active=!0,n.name=""+t,n.y=this.playerScoreItem.y-t*this.playerScoreItem.height),this.scoreScollView.content.height<this.ScoreList.length*this.playerScoreItem.height&&(this.scoreScollView.content.height=this.scoreScollView.content.height+this.playerScoreItem.height),cc.find(t+"/roundNum",this.playerScoreItem.parent).getComponent(cc.Label).string="第"+a+"局：";for(var i=0;i<4;i++){a=i+1;var o=cc.find("scoreNum_"+a,n);i>=this.playerNum&&(o.active=!1)}for(var r=0;r<this.playerNum;r++){var s=r+1,c=GameData.joiners[r].uid;o=cc.find("scoreNum_"+s,n);if(0<GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="+"+GameData.JushuScore[t][c]+"分",o.color=new cc.Color(254,48,0)):0==GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="0 分",o.color=new cc.Color(0,164,54)):(o.getComponent("cc.Label").string=GameData.JushuScore[t][c]+"分",o.color=new cc.Color(24,51,55)),c==GameData.JushuScore[t].zhuangUid){var d=r+1;cc.find("zhuang_"+d,n).active=!0}}}null!=this.playerNum&&(this.playerNum=GameData.room.opts.joinermax,this.AddSumScore())},AddSumScore:function(){for(var e=this.playerSumScore.children,t=0;t<e.length;t++)console.log("this.playerNum = "+this.playerNum+",i = "+t),t>=this.playerNum&&(e[t].active=!1);for(t=0;t<this.playerNum;t++){var a=t+1,n=cc.find("scoreNum_"+a,this.playerSumScore),i=GameData.joiners[t].uid;0<GameData.allScores[i]?(0!=GameData.room.opts.scoreBase?n.getComponent("cc.Label").string=GameData.allScores[i]+"分":n.getComponent("cc.Label").string="+"+GameData.allScores[i]+"分",n.color=new cc.Color(254,48,0)):0==GameData.allScores[i]?(n.getComponent("cc.Label").string="0 分",n.color=new cc.Color(0,164,54)):(n.getComponent("cc.Label").string=GameData.allScores[i]+"分",n.color=new cc.Color(24,51,55))}},close:function(){this.scoreLayer.active=!1}}),cc._RF.pop()},{}],roomScore:[function(e,t,a){"use strict";cc._RF.push(t,"7328dbldeRCTLDt0AvpXpeT","roomScore");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{scoreScollView:cc.ScrollView,scoreLayer:cc.Node,playerHeadNode:cc.Node,playerScoreItem:cc.Node,playerSumScore:cc.Node,ScoreList:[]},onLoad:function(){GameData.room&&(this.playerMax=GameData.room.joinermax),registEvent("onRoomMsg",this,this.ShowsPlayerTitle)},onEnable:function(){GameData.joiners&&this.ShowsPlayerTitle(),this.ScoreList=[]},onDestroy:function(){unregistEvent("onRoomMsg",this,this.ShowsPlayerTitle)},initPlayerHeadNode:function(){for(var e=0;e<this.playerMax-1;e++){var t=this.playerHeadNode.parent.getChildByName("Player_"+(e+2));t||(t=cc.instantiate(this.playerHeadNode),this.playerHeadNode.parent.addChild(t),t.name="Player_"+(e+2),t.x=this.playerHeadNode.x+200*(e+1))}},ShowsPlayerTitle:function(){this.initPlayerHeadNode();for(var e=0;e<this.playerMax;e++){var t=e+1,a=GameData.joiners[e];if(a){var n=a.headimgurl;this.ShowPlayerNameOnItme(t,a.name),this.ShowsPlayerImageOnItme(t,n),this.ShowPlayerOwner(t,a)}}},ShowPlayerNameOnItme:function(e,t){cc.log("roomscroe"),cc.find("Player_"+e+"/nick_name",this.playerHeadNode.parent).getComponent(cc.Label).string=getShortStr(t,4)},ShowPlayerOwner:function(e,t){GameData.room.creator==t.uid&&(cc.find("Player_"+e+"/owner",this.playerHeadNode.parent).active=!0)},ShowsPlayerImageOnItme:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("Player_"+a+"/head",n.playerHeadNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},ShowPlayerScoreItem:function(){var e;e=GameData.game.roundCount;for(var t=0;t<e;t++){var a=t+1,n=this.playerScoreItem.parent.getChildByName(""+t);null==n&&(n=cc.instantiate(this.playerScoreItem),this.playerScoreItem.parent.addChild(n),this.ScoreList.push(n),n.active=!0,n.name=""+t,n.y=this.playerScoreItem.y-t*this.playerScoreItem.height),this.scoreScollView.content.height<this.ScoreList.length*this.playerScoreItem.height&&(this.scoreScollView.content.height=this.scoreScollView.content.height+this.playerScoreItem.height),cc.find(t+"/roundNum",this.playerScoreItem.parent).getComponent(cc.Label).string="第"+a+"局：";for(var i=0;i<4;i++){a=i+1;var o=cc.find("scoreNum_"+a,n);i>=this.playerMax&&(o.active=!1)}for(var r=0;r<this.playerMax;r++){var s=r+1,c=GameData.joiners[r].uid;o=cc.find("scoreNum_"+s,n);if(0<GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="+"+GameData.JushuScore[t][c]+"分",o.color=new cc.Color(254,48,0)):0==GameData.JushuScore[t][c]?(o.getComponent("cc.Label").string="0 分",o.color=new cc.Color(0,164,54)):(o.getComponent("cc.Label").string=GameData.JushuScore[t][c]+"分",o.color=new cc.Color(0,0,0)),c==GameData.JushuScore[t].zhuangUid){var d=r+1;cc.find("zhuang_"+d,n).active=!0}}}this.AddSumScore()},AddSumScore:function(){for(var e=this.playerSumScore.children,t=0;t<e.length;t++)console.log("this.playerMax = "+this.playerMax+",i = "+t),t>=this.playerMax&&(e[t].active=!1);for(t=0;t<this.playerMax;t++){var a=t+1,n=cc.find("scoreNum_"+a,this.playerSumScore),i=GameData.joiners[t].uid;0<GameData.allScores[i]?(n.getComponent("cc.Label").string="+"+GameData.allScores[i]+"分",n.color=new cc.Color(254,48,0)):0==GameData.allScores[i]?(n.getComponent("cc.Label").string="0 分",n.color=new cc.Color(0,164,54)):(n.getComponent("cc.Label").string=GameData.allScores[i]+"分",n.color=new cc.Color(0,0,0))}},close:function(){n.instance.playAudioOther("button"),this.scoreLayer.active=!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],"roomSummary-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"71fd7vr38RD05Dr/I7IKe1E","roomSummary-shishi"),cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font}},onLoad:function(){registEvent("onShowSummary",this,this.onShow),registEvent("recordInfo",this.recordInfoShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow),unregistEvent("recordInfo",this.recordInfoShow)},onShow:function(){this.showTime(),cc.find("player_1",this.panel).y=0,cc.find("player_2",this.panel).y=0,cc.find("player_3",this.panel).y=0;for(var e=cc.find("player_4",this.panel).y=0;e<GameData.joiners.length;e++){this.showPlayer(GameData.joiners[e],e+1),(t=cc.find("player_"+(e+1),this.panel)).active=!0,3==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&3==e&&(t.y=25)}for(e=GameData.joiners.length;e<4;e++){var t;(t=cc.find("player_"+(e+1),this.panel)).active=!1}},recordInfoShow:function(e,t){for(var a=0,n=0,i=0,o=0,r=0,s=cc.find("player_"+t+"/zimo/zimolabel",this.panel),c=cc.find("player_"+t+"/sudao/sudaolabel",this.panel),d=cc.find("player_"+t+"/youjin/youjinlabel",this.panel),h=cc.find("player_"+t+"/dizhen/dizhenlabel",this.panel),l=cc.find("player_"+t+"/dianpao/dianpaolabel",this.panel),u=0;u<GameData.recordInfo.length;u++)GameData.recordInfo[u].winner==e?1==GameData.recordInfo[u].type?n++:2==GameData.recordInfo[u].type?a++:3==GameData.recordInfo[u].type?o++:4!=GameData.recordInfo[u].type&&5!=GameData.recordInfo[u].type&&6!=GameData.recordInfo[u].type&&7!=GameData.recordInfo[u].type||i++:GameData.recordInfo[u].dianpao==e&&1==GameData.recordInfo[u].type&&r++;s.getComponent("cc.Label").string=a,c.getComponent("cc.Label").string=n,d.getComponent("cc.Label").string=i,h.getComponent("cc.Label").string=o,l.getComponent("cc.Label").string=r},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(e,t){if(e){this.recordInfoShow(e.uid,t);var a=GameData.room.opts.joinermax,n=cc.find("player_"+t+"/name",this.panel),i=cc.find("player_"+t+"/field_num1",this.panel),o=cc.find("player_"+t+"/head",this.panel),r=cc.find("player_"+t+"/playerID",this.panel),s=cc.find("player_"+t,this.panel),c=cc.find("bg",this.panel).getContentSize().width,d=cc.find("player_"+t+"/biankuang",this.panel).getContentSize().width;if(a<4){var h=(c-d*a)/2-50*(a-1);s.x=h+50*(t-1)}n.getComponent("cc.Label").string=cutstr(e.name,10),r.getComponent("cc.Label").string="ID:"+e.uid;var l=GameData.allScores[e.uid]-GameData.room.opts.scoreBase;if(0<l?(i.getComponent("cc.Label").string="+"+l,i.getComponent("cc.Label").font=this.fonts[1]):l<0?(i.getComponent("cc.Label").string=l,cc.log("..score:"+l),i.getComponent("cc.Label").font=this.fonts[0]):(i.getComponent("cc.Label").string=l,i.getComponent("cc.Label").font=this.fonts[2]),null!=e.headimgurl&&""!=e.headimgurl&&0<e.headimgurl.length&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(o.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),GameData.player.uid==e.uid){var u=cc.find("player_"+t+"/biankuang",this.panel),m=cc.find("player_"+t+"/selfbiankuang",this.panel);u.active=!1,m.active=!0}if(GameData.room.creator==e.uid)cc.find("player_"+t+"/owner",this.panel).active=!0;var p=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&GameData.allScores[GameData.joiners[t].uid]>GameData.allScores[e]&&(e=GameData.joiners[t].uid);return e};if(GameData.allScores[p()]==GameData.allScores[e.uid])cc.find("player_"+t+"/win",this.panel).active=0<GameData.allScores[p()]-GameData.room.opts.scoreBase}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{}],roomSummary_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"aca0b6LCtxI8oJxZonniauf","roomSummary_changchun");var _=e("roomHandler"),G=e("gameDefine");cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),cc.find("player_1",this.panel).y=0,cc.find("player_2",this.panel).y=0,cc.find("player_3",this.panel).y=0;for(var e=cc.find("player_4",this.panel).y=0;e<GameData.joiners.length;e++){this.showPlayer(GameData.joiners[e],e+1),(t=cc.find("player_"+(e+1),this.panel)).active=!0,3==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&3==e&&(t.y=25)}for(e=GameData.joiners.length;e<4;e++){var t;(t=cc.find("player_"+(e+1),this.panel)).active=!1}},recordInfoShow:function(e,t){var a,n,i,o,r=cc.find("player_"+t+"/zimo/zimolabel",this.panel),s=cc.find("player_"+t+"/sudao/sudaolabel",this.panel),c=cc.find("player_"+t+"/youjin/youjinlabel",this.panel),d=cc.find("player_"+t+"/dianpao/dianpaolabel",this.panel),h=profileChangChun.summaryDataByUid(e);h&&(a=h.huCount,n=h.moBaoNum,i=h.serialZhuangNum,o=h.dianPaoCount,r.getComponent("cc.Label").string=a,s.getComponent("cc.Label").string=n,c.getComponent("cc.Label").string=i,d.getComponent("cc.Label").string=o)},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(e,t){if(e){this.recordInfoShow(e.uid,t);var a,n=GameData.room.opts.joinermax,i=cc.find("player_"+t+"/name",this.panel),o=cc.find("player_"+t+"/field_num1",this.panel),r=cc.find("player_"+t+"/head",this.panel),s=cc.find("player_"+t+"/playerID",this.panel),c=cc.find("player_"+t,this.panel),d=cc.find("bg",this.panel).getContentSize().width,h=cc.find("player_"+t+"/biankuang",this.panel).getContentSize().width;if(n<4){var l=(d-h*n)/2-50*(n-1);c.x=l+50*(t-1)}if(i.getComponent("cc.Label").string=cutstr(e.name,10),s.getComponent("cc.Label").string="ID:"+e.uid,G.currencyType.Currency_Coin==GameData.room.opts.currencyType){var u=_.getCoinData();u&&u.coins&&u.coins[e.uid]&&(a=u.coins[e.uid])}else{var m=profileHuaDian.summaryDataByUid(e.uid);if(!m)return;a=m.roomScore}if(null==a&&(a=0),0<a?(o.getComponent("cc.Label").string="+"+a,o.getComponent("cc.Label").font=this.fonts[1]):a<0?(o.getComponent("cc.Label").string=a,cc.log("..score:"+a),o.getComponent("cc.Label").font=this.fonts[0]):(o.getComponent("cc.Label").string=a,o.getComponent("cc.Label").font=this.fonts[2]),null!=e.headimgurl&&""!=e.headimgurl&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(r.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),GameData.player.uid==e.uid){var p=cc.find("player_"+t+"/biankuang",this.panel),g=cc.find("player_"+t+"/selfbiankuang",this.panel);p.active=!1,g.active=!0}if(GameData.room.creator==e.uid)cc.find("player_"+t+"/owner",this.panel).active=!0;var f=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&_.scores[GameData.joiners[t].uid]>_.scores[e]&&(e=GameData.joiners[t].uid);return e};if(_.scores[f()]==_.scores[e.uid]&&0<_.scores[f()]){var y=cc.find("player_"+t+"/win",this.panel);y.active=!0,y.scale=2;var v=cc.rotateBy(.4,720),C=cc.scaleTo(.4,1),D=cc.spawn(v,C);y.runAction(D)}}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomSummary_heb:[function(e,t,a){"use strict";cc._RF.push(t,"3b954qgs91Kgr0YSTG4UurB","roomSummary_heb");var _=e("roomHandler"),G=e("gameDefine");cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),cc.find("player_1",this.panel).y=0,cc.find("player_2",this.panel).y=0,cc.find("player_3",this.panel).y=0;for(var e=cc.find("player_4",this.panel).y=0;e<GameData.joiners.length;e++){this.showPlayer(GameData.joiners[e],e+1),(t=cc.find("player_"+(e+1),this.panel)).active=!0,3==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&3==e&&(t.y=25)}for(e=GameData.joiners.length;e<4;e++){var t;(t=cc.find("player_"+(e+1),this.panel)).active=!1}},recordInfoShow:function(e,t){var a,n,i,o,r=cc.find("player_"+t+"/zimo/zimolabel",this.panel),s=cc.find("player_"+t+"/sudao/sudaolabel",this.panel),c=cc.find("player_"+t+"/youjin/youjinlabel",this.panel),d=cc.find("player_"+t+"/dianpao/dianpaolabel",this.panel),h=profileChangChun.summaryDataByUid(e);h&&(a=h.huCount,n=h.moBaoNum,i=h.serialZhuangNum,o=h.dianPaoCount,r.getComponent("cc.Label").string=a,s.getComponent("cc.Label").string=n,c.getComponent("cc.Label").string=i,d.getComponent("cc.Label").string=o)},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(e,t){if(e){this.recordInfoShow(e.uid,t);var a,n=GameData.room.opts.joinermax,i=cc.find("player_"+t+"/name",this.panel),o=cc.find("player_"+t+"/field_num1",this.panel),r=cc.find("player_"+t+"/head",this.panel),s=cc.find("player_"+t+"/playerID",this.panel),c=cc.find("player_"+t,this.panel),d=cc.find("bg",this.panel).getContentSize().width,h=cc.find("player_"+t+"/biankuang",this.panel).getContentSize().width;if(n<4){var l=(d-h*n)/2-50*(n-1);c.x=l+50*(t-1)}if(i.getComponent("cc.Label").string=cutstr(e.name,10),s.getComponent("cc.Label").string="ID:"+e.uid,G.currencyType.Currency_Coin==GameData.room.opts.currencyType){var u=_.getCoinData();u&&u.coins&&u.coins[e.uid]&&(a=u.coins[e.uid])}else{var m=profileHuaDian.summaryDataByUid(e.uid);if(!m)return;a=m.roomScore}if(null==a&&(a=0),0<a?(o.getComponent("cc.Label").string="+"+a,o.getComponent("cc.Label").font=this.fonts[1]):a<0?(o.getComponent("cc.Label").string=a,cc.log("..score:"+a),o.getComponent("cc.Label").font=this.fonts[0]):(o.getComponent("cc.Label").string=a,o.getComponent("cc.Label").font=this.fonts[2]),null!=e.headimgurl&&""!=e.headimgurl&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(r.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),GameData.player.uid==e.uid){var p=cc.find("player_"+t+"/biankuang",this.panel),g=cc.find("player_"+t+"/selfbiankuang",this.panel);p.active=!1,g.active=!0}if(GameData.room.creator==e.uid)cc.find("player_"+t+"/owner",this.panel).active=!0;var f=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&_.scores[GameData.joiners[t].uid]>_.scores[e]&&(e=GameData.joiners[t].uid);return e};if(_.scores[f()]==_.scores[e.uid]&&0<_.scores[f()]){var y=cc.find("player_"+t+"/win",this.panel);y.active=!0,y.scale=2;var v=cc.rotateBy(.4,720),C=cc.scaleTo(.4,1),D=cc.spawn(v,C);y.runAction(D)}}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomSummary_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"9d03185lT9HxZ/qo7kmJ/+1","roomSummary_huadian");var y=e("roomHandler"),v=e("gameDefine");cc.Class({extends:cc.Component,properties:{panel:cc.Node,fonts:{default:[],type:cc.Font}},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){this.showTime(),cc.find("player_1",this.panel).y=0,cc.find("player_2",this.panel).y=0,cc.find("player_3",this.panel).y=0;for(var e=cc.find("player_4",this.panel).y=0;e<GameData.joiners.length;e++){this.showPlayer(GameData.joiners[e],e+1),(t=cc.find("player_"+(e+1),this.panel)).active=!0,3==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&1==e?t.y=25:4==GameData.joiners.length&&3==e&&(t.y=25)}for(e=GameData.joiners.length;e<4;e++){var t;(t=cc.find("player_"+(e+1),this.panel)).active=!1}},recordInfoShow:function(e,t){var a,n,i,o,r=cc.find("player_"+t+"/zimo/zimolabel",this.panel),s=cc.find("player_"+t+"/sudao/sudaolabel",this.panel),c=cc.find("player_"+t+"/youjin/youjinlabel",this.panel),d=cc.find("player_"+t+"/dianpao/dianpaolabel",this.panel),h=profileHuaDian.summaryDataByUid(e);h&&(a=h.huCount,n=h.moBaoNum,i=h.serialZhuangNum,o=h.dianPaoCount,r.getComponent("cc.Label").string=a,s.getComponent("cc.Label").string=n,c.getComponent("cc.Label").string=i,d.getComponent("cc.Label").string=o)},showTime:function(){var e=cc.find("roomID",this.panel),t=cc.find("date",this.panel),a=cc.find("time",this.panel),n=new Date(GameData.room.createtime),i=n.getFullYear(),o=n.getMonth()+1,r=n.getDate(),s=n.getHours();s<10?s="0"+s+":":s+=":";var c=n.getMinutes();c<10?c="0"+c+":":c+=":";var d=n.getSeconds();d=d<10?"0"+d:d,e.getComponent("cc.Label").string="房号 : "+GameData.room.id,t.getComponent("cc.Label").string=i+"-"+o+"-"+r,a.getComponent("cc.Label").string=s+c+d},showPlayer:function(e,t){if(e){this.recordInfoShow(e.uid,t);var a,n=GameData.room.opts.joinermax,i=cc.find("player_"+t+"/name",this.panel),o=cc.find("player_"+t+"/field_num1",this.panel),r=cc.find("player_"+t+"/head",this.panel),s=cc.find("player_"+t+"/playerID",this.panel),c=cc.find("player_"+t,this.panel),d=cc.find("bg",this.panel).getContentSize().width,h=cc.find("player_"+t+"/biankuang",this.panel).getContentSize().width;if(n<4){var l=(d-h*n)/2-50*(n-1);c.x=l+50*(t-1)}if(i.getComponent("cc.Label").string=cutstr(e.name,10),s.getComponent("cc.Label").string="ID:"+e.uid,v.currencyType.Currency_Coin==GameData.room.opts.currencyType){var u=y.getCoinData();u&&u.coins&&u.coins[e.uid]&&(a=u.coins[e.uid])}else{var m=profileHuaDian.summaryDataByUid(e.uid);if(!m)return;a=m.roomScore}if(null==a&&(a=0),0<a?(o.getComponent("cc.Label").string="+"+a,o.getComponent("cc.Label").font=this.fonts[1]):a<0?(o.getComponent("cc.Label").string=a,cc.log("..score:"+a),o.getComponent("cc.Label").font=this.fonts[0]):(o.getComponent("cc.Label").string=a,o.getComponent("cc.Label").font=this.fonts[2]),null!=e.headimgurl&&""!=e.headimgurl&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(r.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),GameData.player.uid==e.uid){var p=cc.find("player_"+t+"/biankuang",this.panel),g=cc.find("player_"+t+"/selfbiankuang",this.panel);p.active=!1,g.active=!0}if(GameData.room.creator==e.uid)cc.find("player_"+t+"/owner",this.panel).active=!0;var f=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&y.scores[GameData.joiners[t].uid]>y.scores[e]&&(e=GameData.joiners[t].uid);return e};if(y.scores[f()]==y.scores[e.uid]&&0<y.scores[f()])cc.find("player_"+t+"/win",this.panel).active=!0}},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomSummary:[function(e,t,a){"use strict";cc._RF.push(t,"65272mq3KFIfoWddRkFZrLp","roomSummary");e("configMgr");var m=e("gameDefine"),p=e("roomHandler"),n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{panel:cc.Node,font:{default:[],type:[cc.Font]}},onLoad:function(){registEvent("onShowSummary",this,this.onShow),registEvent("recordInfo",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow),unregistEvent("recordInfo",this,this.onShow)},onShow:function(){cc.log("..showSummaryLayer");for(var e=0,t=0;t<GameData.joiners.length;t++){this.showPlayer(GameData.joiners[t],++e),cc.find("player_"+(t+1),this.panel).active=!0}for(t=GameData.joiners.length;t<4;t++){cc.find("player_"+(t+1),this.panel).active=!1}for(t=0;t<GameData.joiners.length;t++){if(2==GameData.joiners.length)cc.find("player_"+(t+1),this.panel).x=310*t-155;else if(3==GameData.joiners.length){cc.find("player_"+(t+1),this.panel).x=310*t-310}}var a=cc.find("strNode/roomid",this.panel),n=cc.find("strNode/time",this.panel);a.getComponent("cc.Label").string="房间号:"+GameData.player.roomid;var i=getTimeStr(GameData.room.createtime);n.getComponent("cc.Label").string=i[0]+"/"+i[1]+"/"+i[2]+"  "+i[3]+":"+i[4]+":"+i[5]},showPlayer:function(e,t){cc.log("player idx:"+t+" name:"+e.name+" score:"+GameData.allScores[e.uid]);var a=cc.find("player_"+t+"/head_bg/name",this.panel),n=cc.find("player_"+t+"/head_bg/id",this.panel),i=cc.find("player_"+t+"/fieldBg",this.panel),o=cc.find("player_"+t+"/field_num1",this.panel),r=cc.find("player_"+t+"/head_bg/head",this.panel);n.getComponent("cc.Label").string="ID:"+e.uid,isChinese(e.name)?a.getComponent("cc.Label").string=getShortStr(e.name,5):a.getComponent("cc.Label").string=getShortStr(e.name,9);var s=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&GameData.allScores[GameData.joiners[t].uid]>GameData.allScores[e]&&(e=GameData.joiners[t].uid);return e},c=cc.find("player_"+t+"/win",this.panel),d=0;if(m.currencyType.Currency_Coin==GameData.room.opts.currencyType){i.active=!1;var h=p.getCoinData();h&&h.coins&&h.coins[e.uid]&&(d=h.coins[e.uid]),c.active=0<d}else d=GameData.allScores[e.uid]-GameData.room.initScore,s()==e.uid?c.active=0<GameData.allScores[s()]-GameData.room.initScore:c.active=!1;null==d&&(d=0),0<d?(o.getComponent("cc.Label").font=this.font[0],o.getComponent("cc.Label").string="+"+d):(o.getComponent("cc.Label").font=d<0?this.font[1]:this.font[2],o.getComponent("cc.Label").string=d),(null!=e.headimgurl&&""!=e.headimgurl||0<e.headimgurl.length)&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(r.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(t))}),cc.find("player_"+t+"/head_bg/Owner",this.panel).active=GameData.room.creator==e.uid;var l=cc.find("player_"+t+"/selfBg",this.panel),u=cc.find("player_"+t+"/playerBg",this.panel);e.uid==GameData.player.uid?(l.active=!0,u.active=!1):(l.active=!1,u.active=!0),this.recordInfoShow(e.uid,t)},btnBackOnClicked:function(e){n.instance.playAudioOther("button"),GameData.player.roomid=void 0,cc.director.loadScene("home")},recordInfoShow:function(e,t){for(var a=0,n=0,i=0,o=0,r=cc.find("player_"+t+"/tongji/hu",this.panel),s=cc.find("player_"+t+"/tongji/chan",this.panel),c=cc.find("player_"+t+"/tongji/ming",this.panel),d=cc.find("player_"+t+"/tongji/an",this.panel),h=0;h<GameData.recordInfo.length;h++){GameData.recordInfo[h].winner==e&&a++;var l=GameData.recordInfo[h].gangs;if(l[e])for(var u=0;u<l[e].length;u++){var m=l[e][u];4==m.length?i++:5==m.length&&o++}if(GameData.recordInfo[h].zhuang==e)for(var p=GameData.recordInfo[h].type,g=0;g<p.length;g++)12==p[g]&&n++}r.getComponent("cc.Label").string="胡牌次数:  "+a,s.getComponent("cc.Label").string="被铲次数:  "+n,c.getComponent("cc.Label").string="明杠次数:  "+i,d.getComponent("cc.Label").string="暗杠次数:  "+o},btnShareOnClicked:function(){inCD(3e3)||(n.instance.playAudioOther("button"),screenShoot(wxShareTexture))}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomTable_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"9bba75iXSlKAKtFVlpGKK8o","roomTable_changchun");var n=e("SoundMngr"),h=e("ruleHandler"),i=e("gameDefine"),s=e("errorCode"),o=cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,baoCardNode:cc.Node,huiercard1:cc.Sprite,leftCardNumLabel:cc.Label,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,cardsNode:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,cardTemplate:cc.Prefab,playerTemplate:cc.Prefab,cardBugangPre:cc.Prefab,selectedCard:-1,HuType:null,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,disCardArrow:cc.Prefab,_cardArrow:cc.Node,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,lastRoundLabel:cc.RichText,scoreLayer:cc.Node,baoAnimationNode:cc.Node,tingStateNode:cc.Node,passBtn:cc.Button,PiaoLayer:cc.Node},onLoad:function(){cc.log("11111111111111111111111"),registEvent("onGameStart",this,this.handleGameStart),registEvent("onGameReady",this,this.handleGameReady),registEvent("onGameTurn",this,this.handleTurn),registEvent("playerConnect",this,this.showUI),registEvent("onMahjongStartRun",this,this.onShow),registEvent("onRegularCircle",this,this.onShow),registEvent("onHuaDianMahjongReconnecet",this,this.onShow),registEvent("onMahjongRunEnd",this,this.onGameScore),registEvent("onCardHu",this,this.handleHuCard),registEvent("onCardChi",this,this.handleChiCard),registEvent("onCardDis",this,this.handleDisCard),registEvent("onCardPeng",this,this.handlePengCard),registEvent("onCardGang",this,this.handleGangCard),registEvent("onCardTing",this,this.handleTingCard),registEvent("onCardBao",this,this.handleBao),registEvent("dianPao",this,this.handleDianPao),registEvent("onPushErrorMsg",this,this.showErrorMsg),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),this.actions=new Array,this._handCardArry=new Array,this._disCardArry=new Array,this.gangOperations=[],this.cardsNode.active=!1,this.tingData=[],this.tingTip=this.node.getComponent("TingTip"),this.playerSex=1,this.isZiMoHuOnly=0,this.isPass=!0,this.isTing=!0,GameData.room&&(4==GameData.room.opts.joinermax&&(this.discardMax=24),3==GameData.room.opts.joinermax&&(this.discardMax=36),2==GameData.room.opts.joinermax&&(this.discardMax=60)),this._cardArrow=cc.instantiate(this.disCardArrow),this.cardsNode.addChild(this._cardArrow),this._cardArrow.active=!1,this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),GameData.game.gameStart&&0<GameData.game.zhuangUid&&(this.handleGameStart(),this.onShow(),this.handleTurn())},onDestroy:function(){unregistEvent("onGameStart",this,this.handleGameStart),unregistEvent("onGameTurn",this,this.handleTurn),unregistEvent("playerConnect",this,this.showUI),unregistEvent("onMahjongStartRun",this,this.onShow),unregistEvent("onRegularCircle",this,this.onShow),unregistEvent("onHuaDianMahjongReconnecet",this,this.onShow),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onCardHu",this,this.handleHuCard),unregistEvent("onCardChi",this,this.handleChiCard),unregistEvent("onCardDis",this,this.handleDisCard),unregistEvent("onCardPeng",this,this.handlePengCard),unregistEvent("onCardGang",this,this.handleGangCard),unregistEvent("onCardBao",this,this.handleBao),unregistEvent("dianPao",this,this.handleDianPao),unregistEvent("onPushErrorMsg",this,this.showErrorMsg),unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel)},showUI:function(){GameData.room.status==i.RoomState.READY&&this.handleGameStart()},handleGameStart:function(){this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.showBaoCardNode(!1)},handleGameReady:function(){for(var e in this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.tingStateNode.children)this.tingStateNode.children[e].active=!1;GameData.game.cardHuier1=0,this.showBaoCardNode(!1),this.huiercard1.spriteFrame=null,this.huiercard1.node.active=!1},onShow:function(){this.cardsNode.active=!0,this.saveMyHandCard(),this.showCards(),this.showOperations(),GameData.room.status>=i.RoomState.GAMEING&&this.showTingState(),GameData.game.dataInfo.bao&&(profileHuaDian.checkIsTingPlayer()?this.showBaoCardNode(!0):this.showBaoCardNode(!1)),GameData.player[GameData.player.uid].hasCheckedBao&&this.showBaoCardImg(),cc.log("~~~~~~~~~~~~~~~this.cardsNode.active~~~~~~~~~~~~~~~"+this.cardsNode.active);var e=GameData.room.roundNum>GameData.room.opts.roundMax?GameData.room.opts.roundMax:GameData.room.roundNum;this.lastRoundLabel.string=e+"/"+GameData.room.opts.roundMax},handleTurn:function(e){this.showTurn(),this.startCoundDown(e)},handleDisCard:function(e){console.log("this.playerSex =  GameData.player.sex",e.detail.player,GameData.player.sex),this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),null!=e.detail.card&&(n.instance.playAudioCC("dis",e.detail.card,this.playerSex),n.instance.playAudioOther("out"))},handlePengCard:function(e){if(this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("cha",null,this.playerSex),e.detail.userId==GameData.player.uid){var t=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(t,"cha")}else this.playActionAnimation(e.detail.userId,"cha")},handleChiCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("chi",null,this.playerSex),e.detail.userId==GameData.player.uid?this.showEffect("chi"):this.playActionAnimation(e.detail.userId,"chi")},handleGangCard:function(e){if(this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),e.detail.operation==HuaDian.OPERATION.OPERATION_ANGANG?n.instance.playAudioCC("andan",null,this.playerSex):e.detail.operation==HuaDian.OPERATION.OPERATION_MINGGANG||e.detail.operation==HuaDian.OPERATION.OPERATION_GONGGANG?n.instance.playAudioCC("mingdan",null,this.playerSex):n.instance.playAudioCC("dan",null,this.playerSex),e.detail.userId==GameData.player.uid){var t=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(t,"dan")}else this.playActionAnimation(e.detail.userId,"dan")},handleTingCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("ting",null,this.playerSex)},handleHuCard:function(e){cc.log("=...........................",e.detail),this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("hu",e.detail,this.playerSex),e.detail.userId==GameData.player.uid?this.showEffect("hu"):this.playActionAnimation(e.detail.userId,"hu"),this.actionLayer.active=!1},handleBao:function(e){GameData.tablePos[e.detail.uid];var t=cc.find("up",this.baoAnimationNode),a=e.detail.type;1==a?this.playBaoAnimation(t,"huanbao"):2==a&&this.playBaoAnimation(t,"dabao"),this.showBaoCardNode(!0)},handleDianPao:function(e){e.detail==GameData.player.uid&&this.playActionAnimation(e.detail,"dianpao")},showErrorMsg:function(e){301==e.detail.errorCode&&createMoveMessage("定宝牌库没牌了!")},playActionAnimation:function(e,t){if(null!=GameData.joiners){var a=GameData.tablePos[e],n=cc.find("layer_ui/layer_ui_table/actionAnimations/"+a,this.node);cc.log("---\x3e animationNode : "+n),null!=n&&(cc.log("---\x3e playActionAnimation : "+t),n.getComponent(cc.Animation).play(t))}},handlePass:function(e){if(GameData.game.dataInfo.onGoingUserId){var t=GameData.game.dataInfo.onGoingUserId,a=GameData.game.dataInfo.showCard[0];this.showPassActions(t,a)||MjHandler_CC.getInstance().requestPass_CC(function(e){}),GameData.game.dataInfo={}}},hideOperationBtn:function(){for(var e=0;e<4;e++)cc.find("btnAct"+(e+1),this.actionLayer).active=!1},createActionBtn:function(e,t){cc.log("show btn:"+t);var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/btn/"+t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){cc.log("onBtnActionClicked, index : "+t);for(var a=0;a<this.actions.length;a++)cc.log(this.actions[a].act+","+this.actions[a].card);var n=this.actions[t];if(cc.log("ActionData:"+JSON.stringify(n)),"hu"==n.act)cc.log("------------------\x3e click hu, should open hu ui,"),MjHandler_CC.getInstance().requestOperation_CC(n.type,null,null,function(e){});else if("cha"==n.act)cc.log("------------------\x3e click cha, should open cha ui,"),MjHandler_CC.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_PENG,n.card,null,function(e){e.code,s.Success});else if("ting"==n.act)cc.log("------------------\x3e click ting, should open ting ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=0;else if("lou"==n.act){cc.log("------------------\x3e click lou, should open lou ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=1;for(a=0;a<this.actions.length;a++){if("lou"==this.actions[a].act)this.actions.splice(a,1),cc.find("btnAct"+a,this.actionLayer).active=!1}}else if("chi"==n.act)if(cc.log("------------------\x3e click chi, should open chi ui,"),n.card.length<=1){var i=[];for(a=0;a<n.card[0].length;a++)i.push(n.card[0][a]);MjHandler_CC.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_CHI,i,null,function(e){e.code,s.Success})}else this.refreshChiActionType(n);else if("dan"==n.act){var o=n.type;o instanceof Array&&(o=n.type[0]),n.card.length<=1?n.card[0][0]instanceof Array&&1<n.card[0].length?this.refreshGangActionBar(n):n.card[0][0]instanceof Array&&1==n.card[0].length?MjHandler_CC.getInstance().requestOperation_CC(o,n.card[0][0],null,function(e){}):MjHandler_CC.getInstance().requestOperation_CC(o,n.card[0],null,function(e){}):this.refreshGangActionBar(n)}this.moveBackMyCards(),this.actionLayer.active=!1},refreshChiActionType:function(e){this.chiActionList=[],this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0;for(var n=0;n<e.card.length;n++){var i=e.card[n];this.chiActionList.push(i);var o=GameData.game.lastdisCard,r=cc.instantiate(a);contains(i,o)||i.push(o),i=i.sort(),r.name=n+"";for(var s=0;s<i.length;s++){var c=cc.find("card_"+s,r);c.getComponent(cc.Sprite).spriteFrame=null;var d="resources/mjcard2d/mj_face_xia_shou_"+i[s]+".png",h=cc.textureCache.addImage(cc.url.raw(d));if(c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h),i[s]==o){var l=c.getChildByName(c.name+"_biao");null==l&&((l=cc.instantiate(this.cardTingPrefab)).y=l.y-10,c.addChild(l),l.name=c.name+"_biao")}c.active=!0}r.getComponent(cc.Sprite).spriteFrame=null,r.on(cc.Node.EventType.TOUCH_START,this.onClickChiActionBtn,this),t.addChild(r),r.width=252}a.active=!1},onClickChiActionBtn:function(e){for(var t=e.target.name,a=this.chiActionList[t],n=GameData.game.lastdisCard,i=0;i<a.length;i++)a[i]==n&&a.splice(i,1);null!=a&&MjHandler_CC.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_CHI,a,null,function(e){e.code,s.Success}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},refreshGangActionBar:function(e){this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer),n=cc.find("bucard",this.actionSecondaryLayer);n.active=!0,a.active=!0,this.gangActionList=new Array;for(var i=0;i<e.card.length;i++){var o=e.card[i],r={card:e.card[i],type:e.type[i]};this.gangActionList.push(r);var s=cc.instantiate(a);if(s.name=i+"_",s.getComponent(cc.Sprite).spriteFrame=null,e.type[i]==HuaDian.OPERATION.OPERATION_GONGGANG||e.type[i]==HuaDian.OPERATION.OPERATION_ANGANG||e.type[i]==HuaDian.OPERATION.OPERATION_MINGGANG){if((m=cc.find("card_2",s))&&o[0]){m.active=!0;var c="resources/mjcard2d/mj_face_xia_shou_"+o[0]+".png",d=cc.textureCache.addImage(cc.url.raw(c));m.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d)}s.width=252,s.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(s)}else if(3!=o.length||o[0]instanceof Array)for(var h=0;h<o.length;h++){var l=cc.instantiate(n);l.name=i+"_"+o[h][0],l.getComponent(cc.Sprite).spriteFrame=null;c="resources/mjcard2d/mj_face_xia_shou_"+o[h][0]+".png",d=cc.textureCache.addImage(cc.url.raw(c));l.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d),l.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(l)}else{for(var u=0;u<s.childrenCount;u++){var m;if((m=cc.find("card_"+u,s))&&o[u]){m.active=!0;var c="resources/mjcard2d/mj_face_xia_shou_"+o[u]+".png",d=cc.textureCache.addImage(cc.url.raw(c));m.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d)}}s.width=252,s.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(s)}}a.active=!1,n.active=!1},showTingMask:function(e,t){this.removeCardMask();var a=cc.find("cardHand",this.play_layer_down);for(var n in a.children){for(var i=a.children[n].getComponent("Card").id,o=0,r=0;r<e.length;r++)i!=e[r]&&o++;o==e.length&&this.setHandCardDisable(a.children[n],!0)}},removeCardMask:function(){var e=cc.find("cardHand",this.play_layer_down);for(var t in e.children)e.children[t].getChildByName("mask")&&e.children[t].getChildByName("mask").removeFromParent(!0)},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){var t,a=[],n=(t=e.target.name.split("_"))[0],i=this.gangActionList[n];i.type==HuaDian.OPERATION.OPERATION_BU_JIU_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_XI_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_YAO_GANG?a.push(parseInt(t[1])):a=i.card,null!=i&&MjHandler_CC.getInstance().requestOperation_CC(i.type,a,null,function(e){}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},onBtnPassClicked:function(e){MjHandler_CC.getInstance().requestPass_CC(HuaDian.OPERATION.OPERATION_PASS,[],function(e){}),this.isPass=!1;for(var t=GameData.getMyHandCards(),a=0;a<t.length;a++){var n=cc.find("cardHand/cardHand"+a,this.play_layer_down);n.active=!0,this.setMyHandButton(n,t[a],a)}this.removeCardMask(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},showCards:function(){cc.log("~~~~~~~~~~~~~~~function_showcards~~~~~~~~~~~~~~~~~~~~~~");var e=GameData.getPlayerByPos("down");e&&GameData.cards[e.uid]?(this.showMyHandCards(e,this.play_layer_down),this.showDisCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showPengCards(e,this.play_layer_down,"mj_face_xia_chu","down")):this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_right),this.showDisCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showPengCards(e,this.play_layer_right,"mj_face_you_chu","right")):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("up"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_up),this.showDisCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showPengCards(e,this.play_layer_up,"mj_face_shang_shou","up")):this.play_layer_up.active=!1,(e=GameData.getPlayerByPos("left"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_left),this.showDisCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showPengCards(e,this.play_layer_left,"mj_face_zuo_chu","left")):this.play_layer_left.active=!1,this.showCardNum()},showHandCards:function(e,t){if(e)for(var a=e.uid,n=GameData.getHandCardNum(a)+3*(GameData.getChiCards(a).length+GameData.getPengCards(a).length+GameData.getGangCards(a).length)>GameData.client.handsize?0:1,i=1,o=0;o<=GameData.client.handsize;o++){var r=cc.find("cardHand/cardHand"+o,t);o==n&&i<=GameData.getHandCardNum(a)?(r.active=!0,n++,i++):r.active=!1}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=43,t<=++a))return}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},showMyHandCards:function(e,t){var a,n=this._handCardArry;n.reverse(),this.moveBackMyCards();var i=cc.find("cardHand",t);for(var o in i.children)i.children[o].getComponent(cc.Sprite).spriteFrame=null,i.children[o].active=!1;var r=3*GameData.getPengCards(GameData.player.uid).length+3*GameData.getGangCards(GameData.player.uid).length+3*GameData.getChiCards(GameData.player.uid).length;if(14==n.length)for(var s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned)for(s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&!GameData.player[GameData.player.uid].cardLastAssigned&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.player[GameData.player.uid].fenZhangCard&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++){var c;if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else for(s=1;s<n.length+1;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s-1],s),this.showCardContent(a,"mj_face_xia_shou",n[s-1]);var d=profileChangChun.getTingStateByUid(GameData.player.uid);if(this.removeCardMask(),d){var h=GameData.getTingData(GameData.player.uid).outCards;this.showTingMask(h,1);var l=profileChangChun.canGang();profileChangChun.canHu()||GameData.game.turn!=GameData.player.uid||l||this.autoDisCard(GameData.game.obtain)}else this.removeCardMask()},showDisCards:function(e,t,a,n){var i=cc.find("cardDis_4",t);i&&(i.active=!1);var o=cc.find("cardDis_3",t);o&&(o.active=!1);var r=cc.find("cardDis_2",t);r&&(r.active=!1);var s=cc.find("cardDis_"+GameData.room.opts.joinermax,t);s.active=!0;var c=GameData.getDisCards(e.uid);e.uid==GameData.player.uid&&(c=this._disCardArry);for(var d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,s);if(d<=c.length){var l=c[d-1];h.active=!0,this.showCardContent(h,a,l),e.uid==GameData.game.lastdisUid&&l==GameData.game.lastdisCard&&null!=h&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==n,cc.find("down",this._cardArrow).active="down"==n,cc.find("right",this._cardArrow).active="right"==n,cc.find("up",this._cardArrow).active="up"==n)}else h.active=!1}},showPengCards:function(e,t,a,n){if(e){for(var i=GameData.getChiCards(e.uid),o=0;o<i.length;o++){var r=i[o].otherPlayerCard;if(1!=(P=i[o].cards.indexOf(r))){var s=[i[o].cards[P],i[o].cards[1]];i[o].cards[1]=s[0],i[o].cards[P]=s[1]}}for(var c=GameData.getGangCards(e.uid),d=0;d<c.length;d++)c[d].cardType=-1;var h=GameData.getPengCards(e.uid),l=c.concat(h,i),u=parseInt(GameData.client.handsize/3);for(o=0;o<u;o++){var m=cc.find("cardPeng/cardPeng"+(o+1),t),p=cc.find("card_face7",m);if(p.active=!1,o<l.length){for(var g=0;g<7;g++){var f=m.getChildByName("card_face"+(g+1)).getComponent("cc.Sprite"),y=f.node.getChildByName(f.node.name+"_bugangIcon");y&&(y.active=!1);var v=!1;l[o].cards.length<4&&profileChangChun.isAllEqual(l[o].cards)&&!l[o].cardType&&(v=!0);var C=!1;4==l[o].cards.length&&profileChangChun.isAllEqual(l[o].cards)&&(C=!0);var D=!1;if(5==l[o].cards.length&&profileChangChun.isAllEqual(l[o].cards)&&(D=!0),g<l[o].cards.length){f.node.active=!0;var _=l[o].cards[g];if(v)this.showCardContent(f.node,a,_);else if(C)g<4?3==g?(this.showCardContent(p,a,_),f.node.active=!1):this.showCardContent(f.node,a,_):f.node.active=!1,p.active=!0,this.addGangIcon(p,n,1);else if(D){if(g<4)if(3==g){if(e.uid==GameData.player.uid)this.showCardContent(p,a,_);else{var G=this.getCardBackImgName(e.uid);this.showCardContent(p,G.img1,G.img2)}f.node.active=!1}else{G=this.getCardBackImgName(e.uid);this.showCardContent(f.node,G.img1,G.img2)}else f.node.active=!1;p.active=!0,this.addGangIcon(p,n,2)}else if(l[o].cardType&&l.type!=HuaDian.OPERATION.OPERATION_ANGANG&&l.type!=HuaDian.OPERATION.OPERATION_MINGGANG&&l.type!=HuaDian.OPERATION.OPERATION_GONGGANG){var w=[].concat(l[o].cards);w.splice(3,w.length);var S=[].concat(l[o].cards),T=profileChangChun.guolv(w,S),N=[].concat(w,T),b=N.length>g,R=1,P=3;for(3<=g&&(P=l[o].cards.indexOf(N[g])+1);P<l[o].cards.length;P++)if(N[g]==l[o].cards[P]){if(l[o].cards.indexOf(N[g])==P)continue;if(1==g&&(l[o].cards[0]==l[o].cards[1]||l[o].cards[1]==l[o].cards[2]))continue;R++}b?(2<=R&&this.addBuGangIcon(f.node,n,R),this.showCardContent(f.node,a,N[g]),f.node.active=!0):f.node.active=!1}else this.showCardContent(f.node,a,_)}else 6!=g&&(f.node.active=!1)}m.active=!0}else m.active=!1}}},autoDisCard:function(e){var t=this,a=[];a.push(e),this.scheduleOnce(function(){MjHandler_CC.getInstance().requestDisCard_CC(a,function(e){e.result==s.Success&&(t.selectedCard=-1,t.moveBackMyCards())})},.5)},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/icon/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},addBuGangIcon:function(e,t,a){var n,i=e.getChildByName(e.name+"_bugangIcon");null==i&&((i=cc.instantiate(this.cardBugangPre)).name=e.name+"_bugangIcon",e.addChild(i)),i.active=!0;var o="";"right"==t?o="1":"down"==t?o="0":"left"==t?o="3":"up"==t&&(o="2");for(var r=0;r<i.childrenCount;r++)if(t==i.children[r].name){i.children[r].active=!0,n=cc.url.raw("resources/changchun/UI/icon/bugang_"+o+"_"+a+".png");var s=cc.textureCache.addImage(n);i.children[r].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)}else i.children[r].active=!1},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),e.active=!0,this.setMaskVisible(e,!1)},showOperations:function(){this.operationsArry=[],this.gangOperations=[],this.actions=[];var e=this.isPass1=!0;if(this.operationsArry=profileChangChun.getPlayerOperationsByUid(GameData.player.uid),this.hideOperationBtn(),0<this.operationsArry.length){this.actionLayer.active=!0;for(var t=0,a=0;a<this.operationsArry.length;a++){var n=this.getOperAction(this.operationsArry[a]);this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_ANGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_MINGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_ANGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_MINGGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_XUAN_FENG_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_XI_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_YAO_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_JIU_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_XI_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_YAO_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_JIU_GANG||this.gangOperations.push(this.operationsArry[a]),e=!0;for(var i=0;i<this.actions.length;i++)if(this.actions[i].act==n.substring(0,n.length-4)){e=!1,t--;break}e&&(this.actions[t]={act:n.substring(0,n.length-4),card:this.getOperCard(n,this.operationsArry[a]),type:this.operationsArry[a]},this.createActionBtn(t+1,n)),t++}if(GameData.player[GameData.player.uid].gangTing){for(a=0;a<this.actions.length;a++)if("dan"==this.actions[a].act){this.actions[a].type=[];for(i=0;i<GameData.player[GameData.player.uid].gangTing.gangCards.length;i++)this.actions[a].type.push(GameData.player[GameData.player.uid].gangTing.gangCards[i].operation)}}else for(i=0;i<this.actions.length;i++)if("dan"==this.actions[i].act){if(1<this.gangOperations.length){this.actions[i].card=[],this.actions[i].type=[];for(a=0;a<this.gangOperations.length;a++)this.actions[i].card.push(this.getOperCard("dan.png",this.gangOperations[a])),this.actions[i].type.push(this.gangOperations[a])}else this.actions[i].card=[],this.actions[i].type=[],this.actions[i].card.push(this.getOperCard("dan.png",this.gangOperations[0])),this.actions[i].type.push(this.gangOperations[0]);break}for(a=0;a<this.actions.length;a++){if(!GameData.player[GameData.player.uid].isCanPass){this.passBtn.interactable=!1;break}this.passBtn.interactable=!0}this.removeCardMask();for(t=0;t<this.actions.length;t++)if("ting"==this.actions[t].act){if(GameData.getTingData(GameData.player.uid)){var o=GameData.getTingData(GameData.player.uid).outCards;this.showTingMask(o,1)}break}}else this.actionLayer.active=!1},getOperCard:function(e,t){var a=[],n=e.substring(0,e.length-4);if("dan"==n){if(GameData.game.dataInfo.isQiangBuGang)return a;if(GameData.player[GameData.player.uid].gangTing){for(var i=GameData.player[GameData.player.uid].gangTing.gangCards,o=0;o<i.length;o++)a.push(i[o].gangCards);return a}if(GameData.player[GameData.player.uid].buGangInfo)for(o=0;o<this.gangOperations.length;o++){for(var r in GameData.player[GameData.player.uid].buGangInfo)r==parseInt(this.gangOperations[o])&&a.push(GameData.player[GameData.player.uid].buGangInfo[r].outCards);break}else{var s=profileChangChun.getGangCardByUid(GameData.player.uid,t);if(s)if(0==s.type){var c=[];for(o=0;o<3;o++)c.push(s.card);a=c}else if(1==s.type){for(c=[],o=0;o<4;o++)c.push(s.card);a=c}else a=s.card}return a}if(GameData.game.lastdisCard){var d=GameData.game.lastdisCard;if("cha"==n){if(GameData.game.dataInfo.isQiangBuGang)return a;for(o=0;o<2;o++)a.push(d);return a}return"chi"==n?GameData.game.dataInfo.isQiangBuGang?a:a=h.instance.canChi(GameData.player.uid,d):void 0}},getOperAction:function(e){return e==HuaDian.OPERATION.OPERATION_PASS?"pass.png":e==HuaDian.OPERATION.OPERATION_PENG||e==HuaDian.OPERATION.OPERATION_PENG_TING?"cha.png":e==HuaDian.OPERATION.OPERATION_GONGGANG||e==HuaDian.OPERATION.OPERATION_ANGANG||e==HuaDian.OPERATION.OPERATION_MINGGANG||e==HuaDian.OPERATION.OPERATION_GONGGANG_TING||e==HuaDian.OPERATION.OPERATION_ANGANG_TING||e==HuaDian.OPERATION.OPERATION_MINGGANG_TING||e==HuaDian.OPERATION.OPERATION_XUAN_FENG_GANG||e==HuaDian.OPERATION.OPERATION_XI_GANG||e==HuaDian.OPERATION.OPERATION_YAO_GANG||e==HuaDian.OPERATION.OPERATION_JIU_GANG||e==HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG||e==HuaDian.OPERATION.OPERATION_BU_XI_GANG||e==HuaDian.OPERATION.OPERATION_BU_YAO_GANG||e==HuaDian.OPERATION.OPERATION_BU_JIU_GANG?"dan.png":e==HuaDian.OPERATION.OPERATION_CHI||e==HuaDian.OPERATION.OPERATION_CHI_TING?"chi.png":e==HuaDian.OPERATION.OPERATION_DIANPAO_HU||e==HuaDian.OPERATION.OPERATION_HU||e==HuaDian.OPERATION.OPERATION_QIANGGANG_HU?"hu.png":e==HuaDian.OPERATION.OPERATION_TING?"ting.png":null},setMyHandButton:function(e,t,a){if(e){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)}},setMyHuierVisible:function(e,t){var a=!1;h.instance.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");null==n?1==a&&(n=cc.instantiate(this.cardHuierPrefab),e.addChild(n),n.name=e.name+"_huier"):n.active=a},setMyTingVisible:function(e,t){for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,GameData.game.turn!=GameData.player.uid&&null!=i&&(i.active=!1)},setHandCardDisable:function(e,t){var a=e.getChildByName(e.name+"_button");a&&a.removeFromParent(!0);var n=e.getChildByName("mask");if(null==n){var i=(n=new cc.Node("mask")).addComponent(cc.Sprite),o=cc.textureCache.addImage(cc.url.raw("resources/table/majiangmengbai.png"));i.spriteFrame=new cc.SpriteFrame(o),e.addChild(n)}n.active=t},showPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:3==e?t=0:2==e?t=270:1==e&&(t=180),this.direction_pos.node.rotation=t},showTurn:function(){var e,t=profileChangChun.getTurnByUid(),a=GameData.getPlayerIndex(t);e=0==a?"dong":3==a?"nan":2==a?"xi":1==a?"bei":"dong";var n=cc.textureCache.addImage(cc.url.raw("resources/table/"+e+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(n),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1;var i=cc.find(GameData.tablePos[t],this.direction_turn);i&&(i.active=!0)},showCardNum:function(){GameData.game.cardleft<0||(this.leftCardNumLabel.string=GameData.game.cardleft)},showBaoCardImg:function(){var e=GameData.game.cardHuier1,t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e+".png"));(this.huiercard1.spriteFrame=new cc.SpriteFrame(t),GameData.room.opts)&&((1==GameData.cards[GameData.player.uid].tingState||2==GameData.cards[GameData.player.uid].tingState)&&0==GameData.room.opts.anBao?this.huiercard1.node.active=!0:1==GameData.room.opts.anBao&&(this.huiercard1.node.active=!1))},showBaoCardNode:function(e){this.baoCardNode.active=e;var t=cc.find("anbao",this.baoCardNode),a=cc.find("mingbao",this.baoCardNode);GameData.room.opts&&(t.active=1==GameData.room.opts.anBao,a.active=0==GameData.room.opts.anBao)},showEffect:function(e){var t="",n="";switch(e){case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":t="spine/table/hu",n="a";break;case"chi":t="spine/table/chi",n="a";break;case"dianpao":t="spine/table/hu",n="a"}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},playBaoAnimation:function(i,e){var t="spine/table/"+e;cc.loader.loadResDir(t,function(e,t){if(e)cc.log(e);else if(t.length<=0)cc.log("assets length: ",t.length);else{var a;for(var n in i.getComponent(dragonBones.ArmatureDisplay)?(cc.log("dragonBones get"),a=i.getComponent(dragonBones.ArmatureDisplay)):(cc.log("dragonBones add"),a=i.addComponent(dragonBones.ArmatureDisplay)),t)t[n]instanceof dragonBones.DragonBonesAsset&&a.dragonAsset!=t[n]&&(a.dragonAsset=t[n]),t[n]instanceof dragonBones.DragonBonesAtlasAsset&&a.dragonAtlasAsset!=t[n]&&(a.dragonAtlasAsset=t[n]);a.armatureName="armature",a.playAnimation("newAnimation",1)}})},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down),i=[];if(i.push(t),this.selectedCard==a){var o=this,r=!1;GameData.getTingData(GameData.player.uid)&&(r=GameData.getTingData(GameData.player.uid).canTing,0==GameData.getTingData(GameData.player.uid).outCards.length?this.isTing=!1:this.isTing=!0),-1==profileChangChun.getPlayerOperationsByUid(GameData.player.uid).indexOf(10)?this.isTing=!1:this.isTing=!0,r&&this.isPass&&this.isTing?(this.isPass=!0,this.isTing=!1,GameData.getTingData(GameData.player.uid).canTing=!1,MjHandler_CC.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_TING,i,this.isZiMoHuOnly,function(e){})):GameData.game.turn==GameData.player.uid&&MjHandler_CC.getInstance().requestDisCard_CC(i,function(e){e.result==s.Success&&(n.stopAllActions(),o.selectedCard=-1,this.moveBackMyCards())});a=this._handCardArry.indexOf(t);this._handCardArry.splice(a,1),this._handCardArry.sort(function(e,t){return e-t}),this._disCardArry.push(t),GameData.game.turn=0,this.showCards(),this.tingTip.hide()}else{if(0<=this.selectedCard)cc.find("cardHand/cardHand"+this.selectedCard,this.play_layer_down).runAction(cc.moveTo(.01,this.myHandsInitPosition[this.selectedCard]));n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))}},showTingState:function(){for(var e in this.tingStateNode.children)this.tingStateNode.children[e].active=!1;for(var t,a,n=0;n<GameData.joiners.length;n++){var i=GameData.tablePos[GameData.joiners[n].uid];t=cc.find(i,this.tingStateNode);var o=cc.find("text",t),r=GameData.cards[GameData.joiners[n].uid].tingState;if(1==r){a=cc.url.raw("resources/huadian/UI/artword/loupaizhong.png");var s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else if(2==r){a=cc.url.raw("resources/huadian/UI/artword/tingpaizhong.png");s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else t.active=!1}},showMask:function(e){var t=GameData.getPlayerByPos("down");t&&(this.showPengCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_down,"down")),(t=GameData.getPlayerByPos("up"))&&(this.showPengCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_up,"up")),(t=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_left,"left")),(t=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,t,a)}}},showDisCardMask:function(e,t,a){for(var n=1;n<=this.discardMax;n++){var i=cc.find("cardDis_"+GameData.room.opts.joinermax+"/card_face"+n,t);i.active&&this.gotoMask(i,e,t,a)}},gotoMask:function(e,t,a,n){var i=e.getComponent("Card");if(null!=i){var o=t==i.id,r=this.setMaskVisible(e,o);null!=r&&(cc.find("tipMask/up",r).active=!1,cc.find("tipMask/down",r).active=!1,cc.find("tipMask/right",r).active=!1,cc.find("tipMask/left",r).active=!1,cc.find("tipMask/"+n,r).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask",cc.find("tipMask",a).active=!0,cc.find("chipaiMask",a).active=!1):cc.find("tipMask",a).active=t,a},onGameScore:function(){this.tingTip.hide(),this.unschedule(this.runCountDown)},startCoundDown:function(e){this.PLayerUID=GameData.game.turn,this._countdown_index=10,this.schedule(this.runCountDown,1)},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t,a,n=e.split("");if(0!=n.length){if(1==n.length)t=cc.url.raw("resources/number/jinzi0.png"),a=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=n.length)return;t=cc.url.raw("resources/number/jinzi"+n[0]+".png"),a=cc.url.raw("resources/number/jinzi"+n[1]+".png")}var i=cc.textureCache.addImage(t);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i);var o=cc.textureCache.addImage(a);this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},showScoreLayer:function(){this.getComponent("roomScore").ShowPlayerScoreItem(),this.scoreLayer.active=!0},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e),this.tingTip.hide();break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){this.tingTip.hide()},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},showPiaoLayer:function(){this.PiaoLayer.active=!0},getCardBackImgName:function(e){var t="",a="";switch(GameData.getPlayerPosByUid(e)){case"down":t="mj_back0",a="chu";break;case"up":t="mj_back2",a="chu";break;case"right":t="mj_back1",a="chu";break;case"left":t="mj_back3",a="chu"}return{img1:t,img2:a}},saveMyHandCard:function(){if(this._handCardArry=[],this._disCardArry=[],0!=Object.keys(GameData.cards).length)if(this._handCardArry=GameData.getHandCards(GameData.player.uid),this._disCardArry=GameData.getDisCards(GameData.player.uid),GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned){var e=this._handCardArry[this._handCardArry.length-1];this._handCardArry.pop(),this._handCardArry.sort(function(e,t){return e-t}),this._handCardArry.push(e)}else this._handCardArry.sort(function(e,t){return e-t})}});t.exports=o,cc._RF.pop()},{SoundMngr:"SoundMngr",errorCode:"errorCode",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomTable_heb:[function(e,t,a){"use strict";cc._RF.push(t,"b56391qmQVN2KNpYsJUk/5A","roomTable_heb");var n=e("SoundMngr"),h=e("ruleHandler"),i=e("gameDefine"),s=e("errorCode"),o=cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,baoCardNode:cc.Node,huiercard1:cc.Sprite,leftCardNumLabel:cc.Label,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,cardsNode:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,cardTemplate:cc.Prefab,playerTemplate:cc.Prefab,cardBugangPre:cc.Prefab,selectedCard:-1,HuType:null,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,disCardArrow:cc.Prefab,_cardArrow:cc.Node,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,lastRoundLabel:cc.RichText,scoreLayer:cc.Node,baoAnimationNode:cc.Node,tingStateNode:cc.Node,passBtn:cc.Button,PiaoLayer:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.handleGameStart),registEvent("onGameReady",this,this.handleGameReady),registEvent("onGameTurn",this,this.handleTurn),registEvent("onMahjongStartRun",this,this.onShow),registEvent("onRegularCircle",this,this.onShow),registEvent("onHuaDianMahjongReconnecet",this,this.onShow),registEvent("onMahjongRunEnd",this,this.onGameScore),registEvent("onCardHu",this,this.handleHuCard),registEvent("onCardChi",this,this.handleChiCard),registEvent("onCardDis",this,this.handleDisCard),registEvent("onCardPeng",this,this.handlePengCard),registEvent("onCardGang",this,this.handleGangCard),registEvent("onCardTing",this,this.handleTingCard),registEvent("onCardBao",this,this.handleBao),registEvent("dianPao",this,this.handleDianPao),registEvent("onPushErrorMsg",this,this.showErrorMsg),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),this.actions=new Array,this._handCardArry=new Array,this._disCardArry=new Array,this.gangOperations=[],this.cardsNode.active=!1,this.tingData=[],this.tingTip=this.node.getComponent("TingTip"),this.playerSex=1,this.isZiMoHuOnly=0,this.isPass=!0,this.isTing=!0,GameData.room&&(4==GameData.room.opts.joinermax&&(this.discardMax=24),3==GameData.room.opts.joinermax&&(this.discardMax=36),2==GameData.room.opts.joinermax&&(this.discardMax=60)),this._cardArrow=cc.instantiate(this.disCardArrow),this.cardsNode.addChild(this._cardArrow),this._cardArrow.active=!1,this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),GameData.game.gameStart&&0<GameData.game.zhuangUid&&(this.handleGameStart(),this.onShow(),this.handleTurn())},onDestroy:function(){unregistEvent("onGameStart",this,this.handleGameStart),unregistEvent("onGameTurn",this,this.handleTurn),unregistEvent("onMahjongStartRun",this,this.onShow),unregistEvent("onRegularCircle",this,this.onShow),unregistEvent("onHuaDianMahjongReconnecet",this,this.onShow),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onCardHu",this,this.handleHuCard),unregistEvent("onCardChi",this,this.handleChiCard),unregistEvent("onCardDis",this,this.handleDisCard),unregistEvent("onCardPeng",this,this.handlePengCard),unregistEvent("onCardGang",this,this.handleGangCard),unregistEvent("onCardBao",this,this.handleBao),unregistEvent("dianPao",this,this.handleDianPao),unregistEvent("onPushErrorMsg",this,this.showErrorMsg),unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel)},handleGameStart:function(){this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.showBaoCardNode(!1)},handleGameReady:function(){for(var e in this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.tingStateNode.children)this.tingStateNode.children[e].active=!1;GameData.game.cardHuier1=0,this.showBaoCardNode(!1),this.huiercard1.spriteFrame=null,this.huiercard1.node.active=!1},onShow:function(){this.cardsNode.active=!0,this.saveMyHandCard(),this.showCards(),this.showOperations(),GameData.room.status>=i.RoomState.GAMEING&&this.showTingState(),GameData.game.dataInfo.bao&&(profileHuaDian.checkIsTingPlayer()?this.showBaoCardNode(!0):this.showBaoCardNode(!1)),cc.log("~~~~~~~~~~~~~~~this.cardsNode.active~~~~~~~~~~~~~~~"+this.cardsNode.active);var e=GameData.room.roundNum>GameData.room.opts.roundMax?GameData.room.opts.roundMax:GameData.room.roundNum;this.lastRoundLabel.string=e+"/"+GameData.room.opts.roundMax},handleTurn:function(e){this.showTurn(),this.startCoundDown(e)},handleDisCard:function(e){console.log("this.playerSex =  GameData.player.sex",e.detail.player,GameData.player.sex),this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),null!=e.detail.card&&(n.instance.playAudioCC("dis",e.detail.card,this.playerSex),n.instance.playAudioOther("out"))},handlePengCard:function(e){if(this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("cha",null,this.playerSex),e.detail.userId==GameData.player.uid){var t=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(t,"cha")}else this.playActionAnimation(e.detail.userId,"cha")},handleChiCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("chi",null,this.playerSex),e.detail.userId==GameData.player.uid?this.showEffect("chi"):this.playActionAnimation(e.detail.userId,"chi")},handleGangCard:function(e){if(this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),e.detail.operation==HuaDian.OPERATION.OPERATION_ANGANG?n.instance.playAudioCC("andan",null,this.playerSex):e.detail.operation==HuaDian.OPERATION.OPERATION_MINGGANG||e.detail.operation==HuaDian.OPERATION.OPERATION_GONGGANG?n.instance.playAudioCC("mingdan",null,this.playerSex):n.instance.playAudioCC("dan",null,this.playerSex),e.detail.userId==GameData.player.uid){var t=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(t,"dan")}else this.playActionAnimation(e.detail.userId,"dan")},handleTingCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("ting",null,this.playerSex)},handleHuCard:function(e){cc.log("=...........................",e.detail),this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioCC("hu",e.detail,this.playerSex),e.detail.userId==GameData.player.uid?this.showEffect("hu"):this.playActionAnimation(e.detail.userId,"hu"),this.actionLayer.active=!1},handleBao:function(e){GameData.tablePos[e.detail.uid];var t=cc.find("up",this.baoAnimationNode),a=e.detail.type;1==a?this.playBaoAnimation(t,"huanbao"):2==a&&this.playBaoAnimation(t,"dabao"),this.showBaoCardNode(!0)},handleDianPao:function(e){e.detail==GameData.player.uid&&this.playActionAnimation(e.detail,"dianpao")},showErrorMsg:function(e){301==e.detail.errorCode&&createMoveMessage("定宝牌库没牌了!")},playActionAnimation:function(e,t){if(null!=GameData.joiners){var a=GameData.tablePos[e],n=cc.find("layer_ui/layer_ui_table/actionAnimations/"+a,this.node);cc.log("---\x3e animationNode : "+n),null!=n&&(cc.log("---\x3e playActionAnimation : "+t),n.getComponent(cc.Animation).play(t))}},handlePass:function(e){if(GameData.game.dataInfo.onGoingUserId){var t=GameData.game.dataInfo.onGoingUserId,a=GameData.game.dataInfo.showCard[0];this.showPassActions(t,a)||MjHandler_Heb.getInstance().requestPass_CC(function(e){}),GameData.game.dataInfo={}}},hideOperationBtn:function(){for(var e=0;e<4;e++)cc.find("btnAct"+(e+1),this.actionLayer).active=!1},createActionBtn:function(e,t){cc.log("show btn:"+t);var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/btn/"+t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){cc.log("onBtnActionClicked, index : "+t);for(var a=0;a<this.actions.length;a++)cc.log(this.actions[a].act+","+this.actions[a].card);var n=this.actions[t];if(cc.log("ActionData:"+JSON.stringify(n)),"hu"==n.act)cc.log("------------------\x3e click hu, should open hu ui,"),MjHandler_Heb.getInstance().requestOperation_CC(n.type,null,null,function(e){});else if("cha"==n.act)cc.log("------------------\x3e click cha, should open cha ui,"),MjHandler_Heb.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_PENG,n.card,null,function(e){e.code,s.Success});else if("ting"==n.act)cc.log("------------------\x3e click ting, should open ting ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=0;else if("lou"==n.act){cc.log("------------------\x3e click lou, should open lou ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=1;for(a=0;a<this.actions.length;a++){if("lou"==this.actions[a].act)this.actions.splice(a,1),cc.find("btnAct"+a,this.actionLayer).active=!1}}else if("chi"==n.act)if(cc.log("------------------\x3e click chi, should open chi ui,"),n.card.length<=1){var i=[];for(a=0;a<n.card[0].length;a++)i.push(n.card[0][a]);MjHandler_Heb.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_CHI,i,null,function(e){e.code,s.Success})}else this.refreshChiActionType(n);else if("dan"==n.act){var o=n.type;o instanceof Array&&(o=n.type[0]),n.card.length<=1?n.card[0][0]instanceof Array&&1<n.card[0].length?this.refreshGangActionBar(n):n.card[0][0]instanceof Array&&1==n.card[0].length?MjHandler_Heb.getInstance().requestOperation_CC(o,n.card[0][0],null,function(e){}):MjHandler_Heb.getInstance().requestOperation_CC(o,n.card[0],null,function(e){}):this.refreshGangActionBar(n)}this.moveBackMyCards(),this.actionLayer.active=!1},refreshChiActionType:function(e){this.chiActionList=[],this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0;for(var n=0;n<e.card.length;n++){var i=e.card[n];this.chiActionList.push(i);var o=GameData.game.lastdisCard,r=cc.instantiate(a);contains(i,o)||i.push(o),i=i.sort(),r.name=n+"";for(var s=0;s<i.length;s++){var c=cc.find("card_"+s,r);c.getComponent(cc.Sprite).spriteFrame=null;var d="resources/mjcard2d/mj_face_xia_shou_"+i[s]+".png",h=cc.textureCache.addImage(cc.url.raw(d));if(c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h),i[s]==o){var l=c.getChildByName(c.name+"_biao");null==l&&((l=cc.instantiate(this.cardTingPrefab)).y=l.y-10,c.addChild(l),l.name=c.name+"_biao")}c.active=!0}r.getComponent(cc.Sprite).spriteFrame=null,r.on(cc.Node.EventType.TOUCH_START,this.onClickChiActionBtn,this),t.addChild(r),r.width=252}a.active=!1},onClickChiActionBtn:function(e){for(var t=e.target.name,a=this.chiActionList[t],n=GameData.game.lastdisCard,i=0;i<a.length;i++)a[i]==n&&a.splice(i,1);null!=a&&MjHandler_Heb.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_CHI,a,null,function(e){e.code,s.Success}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},refreshGangActionBar:function(e){this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer),n=cc.find("bucard",this.actionSecondaryLayer);n.active=!0,a.active=!0,this.gangActionList=new Array;for(var i=0;i<e.card.length;i++){var o=e.card[i],r={card:e.card[i],type:e.type[i]};this.gangActionList.push(r);var s=cc.instantiate(a);if(s.name=i+"_",s.getComponent(cc.Sprite).spriteFrame=null,e.type[i]==HuaDian.OPERATION.OPERATION_GONGGANG||e.type[i]==HuaDian.OPERATION.OPERATION_ANGANG||e.type[i]==HuaDian.OPERATION.OPERATION_MINGGANG){if((m=cc.find("card_2",s))&&o[0]){m.active=!0;var c="resources/mjcard2d/mj_face_xia_shou_"+o[0]+".png",d=cc.textureCache.addImage(cc.url.raw(c));m.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d)}s.width=252,s.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(s)}else if(3!=o.length||o[0]instanceof Array)for(var h=0;h<o.length;h++){var l=cc.instantiate(n);l.name=i+"_"+o[h][0],l.getComponent(cc.Sprite).spriteFrame=null;c="resources/mjcard2d/mj_face_xia_shou_"+o[h][0]+".png",d=cc.textureCache.addImage(cc.url.raw(c));l.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d),l.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(l)}else{for(var u=0;u<s.childrenCount;u++){var m;if((m=cc.find("card_"+u,s))&&o[u]){m.active=!0;var c="resources/mjcard2d/mj_face_xia_shou_"+o[u]+".png",d=cc.textureCache.addImage(cc.url.raw(c));m.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(d)}}s.width=252,s.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(s)}}a.active=!1,n.active=!1},showTingMask:function(e,t){this.removeCardMask();var a=cc.find("cardHand",this.play_layer_down);for(var n in a.children){for(var i=a.children[n].getComponent("Card").id,o=0,r=0;r<e.length;r++)i!=e[r]&&o++;o==e.length&&this.setHandCardDisable(a.children[n],!0)}},removeCardMask:function(){var e=cc.find("cardHand",this.play_layer_down);for(var t in e.children)e.children[t].getChildByName("mask")&&e.children[t].getChildByName("mask").removeFromParent(!0)},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){var t,a=[],n=(t=e.target.name.split("_"))[0],i=this.gangActionList[n];i.type==HuaDian.OPERATION.OPERATION_BU_JIU_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_XI_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG||i.type==HuaDian.OPERATION.OPERATION_BU_YAO_GANG?a.push(parseInt(t[1])):a=i.card,null!=i&&MjHandler_Heb.getInstance().requestOperation_CC(i.type,a,null,function(e){}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},onBtnPassClicked:function(e){MjHandler_Heb.getInstance().requestPass_CC(HuaDian.OPERATION.OPERATION_PASS,[],function(e){}),this.isPass=!1;for(var t=GameData.getMyHandCards(),a=0;a<t.length;a++){var n=cc.find("cardHand/cardHand"+a,this.play_layer_down);n.active=!0,this.setMyHandButton(n,t[a],a)}this.removeCardMask(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},showCards:function(){cc.log("~~~~~~~~~~~~~~~function_showcards~~~~~~~~~~~~~~~~~~~~~~");var e=GameData.getPlayerByPos("down");e&&GameData.cards[e.uid]?(this.showMyHandCards(e,this.play_layer_down),this.showDisCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showPengCards(e,this.play_layer_down,"mj_face_xia_chu","down")):this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_right),this.showDisCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showPengCards(e,this.play_layer_right,"mj_face_you_chu","right")):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("up"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_up),this.showDisCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showPengCards(e,this.play_layer_up,"mj_face_shang_shou","up")):this.play_layer_up.active=!1,(e=GameData.getPlayerByPos("left"))&&GameData.cards[e.uid]?(this.showHandCards(e,this.play_layer_left),this.showDisCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showPengCards(e,this.play_layer_left,"mj_face_zuo_chu","left")):this.play_layer_left.active=!1,this.showCardNum(),1e3!=GameData.game.cardHuier1&&-1!=GameData.game.cardHuier1&&0!=GameData.game.cardHuier1&&this.showBaoCardImg()},showHandCards:function(e,t){if(e)for(var a=e.uid,n=GameData.getHandCardNum(a)+3*(GameData.getChiCards(a).length+GameData.getPengCards(a).length+GameData.getGangCards(a).length)>GameData.client.handsize?0:1,i=1,o=0;o<=GameData.client.handsize;o++){var r=cc.find("cardHand/cardHand"+o,t);o==n&&i<=GameData.getHandCardNum(a)?(r.active=!0,n++,i++):r.active=!1}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=43,t<=++a))return}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},showMyHandCards:function(e,t){var a,n=this._handCardArry;n.reverse(),this.moveBackMyCards();var i=cc.find("cardHand",t);for(var o in i.children)i.children[o].getComponent(cc.Sprite).spriteFrame=null,i.children[o].active=!1;var r=3*GameData.getPengCards(GameData.player.uid).length+3*GameData.getGangCards(GameData.player.uid).length+3*GameData.getChiCards(GameData.player.uid).length;if(14==n.length)for(var s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned)for(s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&!GameData.player[GameData.player.uid].cardLastAssigned&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++){if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else if(n.length<GameData.client.handsize&&GameData.player[GameData.player.uid].fenZhangCard&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++){var c;if(a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s)a.active=!(GameData.player[GameData.player.uid].isWin==HuaDian.WINTYPE.DIANPAOWIN),(c=a.getChildByName(a.name+"_huier"))&&c.removeFromParent(!0),(1==GameData.cards[e.uid].tingState||2==GameData.cards[e.uid].tingState)&&this.setMyHuierVisible(a,n[s])}else for(s=1;s<n.length+1;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s-1],s),this.showCardContent(a,"mj_face_xia_shou",n[s-1]);var d=profileHeb.getTingStateByUid(GameData.player.uid);if(this.removeCardMask(),d){var h=GameData.getTingData(GameData.player.uid).outCards;this.showTingMask(h,1);var l=profileHeb.canGang();profileHeb.canHu()||GameData.game.turn!=GameData.player.uid||l||this.autoDisCard(GameData.game.obtain)}else this.removeCardMask()},showDisCards:function(e,t,a,n){var i=cc.find("cardDis_4",t);i&&(i.active=!1);var o=cc.find("cardDis_3",t);o&&(o.active=!1);var r=cc.find("cardDis_2",t);r&&(r.active=!1);var s=cc.find("cardDis_"+GameData.room.opts.joinermax,t);s.active=!0;var c=GameData.getDisCards(e.uid);e.uid==GameData.player.uid&&(c=this._disCardArry);for(var d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,s);if(d<=c.length){var l=c[d-1];h.active=!0,this.showCardContent(h,a,l),e.uid==GameData.game.lastdisUid&&l==GameData.game.lastdisCard&&null!=h&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==n,cc.find("down",this._cardArrow).active="down"==n,cc.find("right",this._cardArrow).active="right"==n,cc.find("up",this._cardArrow).active="up"==n)}else h.active=!1}},showPengCards:function(e,t,a,n){if(e){for(var i=GameData.getChiCards(e.uid),o=0;o<i.length;o++){var r=i[o].otherPlayerCard;if(1!=(P=i[o].cards.indexOf(r))){var s=[i[o].cards[P],i[o].cards[1]];i[o].cards[1]=s[0],i[o].cards[P]=s[1]}}for(var c=GameData.getGangCards(e.uid),d=0;d<c.length;d++)c[d].cardType=-1;var h=GameData.getPengCards(e.uid),l=c.concat(h,i),u=parseInt(GameData.client.handsize/3);for(o=0;o<u;o++){var m=cc.find("cardPeng/cardPeng"+(o+1),t),p=cc.find("card_face7",m);if(p.active=!1,o<l.length){for(var g=0;g<7;g++){var f=m.getChildByName("card_face"+(g+1)).getComponent("cc.Sprite"),y=f.node.getChildByName(f.node.name+"_bugangIcon");y&&(y.active=!1);var v=!1;l[o].cards.length<4&&profileHeb.isAllEqual(l[o].cards)&&!l[o].cardType&&(v=!0);var C=!1;4==l[o].cards.length&&profileHeb.isAllEqual(l[o].cards)&&(C=!0);var D=!1;if(5==l[o].cards.length&&profileHeb.isAllEqual(l[o].cards)&&(D=!0),g<l[o].cards.length){f.node.active=!0;var _=l[o].cards[g];if(v)this.showCardContent(f.node,a,_);else if(C)g<4?3==g?(this.showCardContent(p,a,_),f.node.active=!1):this.showCardContent(f.node,a,_):f.node.active=!1,p.active=!0,this.addGangIcon(p,n,1);else if(D){if(g<4)if(3==g){if(e.uid==GameData.player.uid)this.showCardContent(p,a,_);else{var G=this.getCardBackImgName(e.uid);this.showCardContent(p,G.img1,G.img2)}f.node.active=!1}else{G=this.getCardBackImgName(e.uid);this.showCardContent(f.node,G.img1,G.img2)}else f.node.active=!1;p.active=!0,this.addGangIcon(p,n,2)}else if(l[o].cardType&&l.type!=HuaDian.OPERATION.OPERATION_ANGANG&&l.type!=HuaDian.OPERATION.OPERATION_MINGGANG&&l.type!=HuaDian.OPERATION.OPERATION_GONGGANG){var w=[].concat(l[o].cards);w.splice(3,w.length);var S=[].concat(l[o].cards),T=profileHeb.guolv(w,S),N=[].concat(w,T),b=N.length>g,R=1,P=3;for(3<=g&&(P=l[o].cards.indexOf(N[g])+1);P<l[o].cards.length;P++)if(N[g]==l[o].cards[P]){if(0!=g&&l[o].cards.indexOf(N[g])==P)continue;R++}b?(2<=R&&this.addBuGangIcon(f.node,n,R),this.showCardContent(f.node,a,N[g]),f.node.active=!0):f.node.active=!1}else this.showCardContent(f.node,a,_)}else 6!=g&&(f.node.active=!1)}m.active=!0}else m.active=!1}}},autoDisCard:function(e){var t=this,a=[];a.push(e),this.scheduleOnce(function(){MjHandler_Heb.getInstance().requestDisCard_CC(a,function(e){e.result==s.Success&&(t.selectedCard=-1,t.moveBackMyCards())})},.5)},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/icon/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},addBuGangIcon:function(e,t,a){var n,i=e.getChildByName(e.name+"_bugangIcon");null==i&&((i=cc.instantiate(this.cardBugangPre)).name=e.name+"_bugangIcon",e.addChild(i)),i.active=!0;var o="";"right"==t?o="1":"down"==t?o="0":"left"==t?o="3":"up"==t&&(o="2");for(var r=0;r<i.childrenCount;r++)if(t==i.children[r].name){i.children[r].active=!0,n=cc.url.raw("resources/changchun/UI/icon/bugang_"+o+"_"+a+".png");var s=cc.textureCache.addImage(n);i.children[r].getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)}else i.children[r].active=!1},showCardContent:function(e,t,a){if(null!=e){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),e.active=!0,this.setMaskVisible(e,!1)}},showOperations:function(){this.operationsArry=[],this.gangOperations=[],this.actions=[];var e=this.isPass1=!0;if(this.operationsArry=profileHeb.getPlayerOperationsByUid(GameData.player.uid),this.hideOperationBtn(),0<this.operationsArry.length){this.actionLayer.active=!0;for(var t=0,a=0;a<this.operationsArry.length;a++){var n=this.getOperAction(this.operationsArry[a]);this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_ANGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_MINGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_ANGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_MINGGANG_TING&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_XUAN_FENG_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_XI_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_YAO_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_JIU_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_XI_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_YAO_GANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_BU_JIU_GANG||this.gangOperations.push(this.operationsArry[a]),e=!0;for(var i=0;i<this.actions.length;i++)if(this.actions[i].act==n.substring(0,n.length-4)){e=!1,t--;break}e&&(this.actions[t]={act:n.substring(0,n.length-4),card:this.getOperCard(n,this.operationsArry[a]),type:this.operationsArry[a]},this.createActionBtn(t+1,n)),t++}if(GameData.player[GameData.player.uid].gangTing){for(a=0;a<this.actions.length;a++)if("dan"==this.actions[a].act){this.actions[a].type=[];for(i=0;i<GameData.player[GameData.player.uid].gangTing.gangCards.length;i++)this.actions[a].type.push(GameData.player[GameData.player.uid].gangTing.gangCards[i].operation)}}else for(i=0;i<this.actions.length;i++)if("dan"==this.actions[i].act){if(1<this.gangOperations.length){this.actions[i].card=[],this.actions[i].type=[];for(a=0;a<this.gangOperations.length;a++)this.actions[i].card.push(this.getOperCard("dan.png",this.gangOperations[a])),this.actions[i].type.push(this.gangOperations[a])}else this.actions[i].card=[],this.actions[i].type=[],this.actions[i].card.push(this.getOperCard("dan.png",this.gangOperations[0])),this.actions[i].type.push(this.gangOperations[0]);break}for(a=0;a<this.actions.length;a++){if(!GameData.player[GameData.player.uid].isCanPass){this.passBtn.interactable=!1;break}this.passBtn.interactable=!0}this.removeCardMask();for(t=0;t<this.actions.length;t++)if("ting"==this.actions[t].act){if(GameData.getTingData(GameData.player.uid)){var o=GameData.getTingData(GameData.player.uid).outCards;this.showTingMask(o,1)}break}}else this.actionLayer.active=!1},getOperCard:function(e,t){var a=[],n=e.substring(0,e.length-4);if("dan"==n){if(GameData.game.dataInfo.isQiangBuGang)return a;if(GameData.player[GameData.player.uid].gangTing){for(var i=GameData.player[GameData.player.uid].gangTing.gangCards,o=0;o<i.length;o++)a.push(i[o].gangCards);return a}if(GameData.player[GameData.player.uid].buGangInfo)for(o=0;o<this.gangOperations.length;o++){for(var r in GameData.player[GameData.player.uid].buGangInfo)r==parseInt(this.gangOperations[o])&&a.push(GameData.player[GameData.player.uid].buGangInfo[r].outCards);break}else{var s=profileHeb.getGangCardByUid(GameData.player.uid,t);if(s)if(0==s.type){var c=[];for(o=0;o<3;o++)c.push(s.card);a=c}else if(1==s.type){for(c=[],o=0;o<4;o++)c.push(s.card);a=c}else a=s.card}return a}if(GameData.game.dataInfo.showCard){var d=GameData.game.lastdisCard;if("cha"==n){if(GameData.game.dataInfo.isQiangBuGang)return a;for(o=0;o<2;o++)a.push(d);return a}return"chi"==n?a=h.instance.canChi(GameData.player.uid,d):void 0}},getOperAction:function(e){return e==HuaDian.OPERATION.OPERATION_PASS?"pass.png":e==HuaDian.OPERATION.OPERATION_PENG||e==HuaDian.OPERATION.OPERATION_PENG_TING?"cha.png":e==HuaDian.OPERATION.OPERATION_GONGGANG||e==HuaDian.OPERATION.OPERATION_ANGANG||e==HuaDian.OPERATION.OPERATION_MINGGANG||e==HuaDian.OPERATION.OPERATION_GONGGANG_TING||e==HuaDian.OPERATION.OPERATION_ANGANG_TING||e==HuaDian.OPERATION.OPERATION_MINGGANG_TING||e==HuaDian.OPERATION.OPERATION_XUAN_FENG_GANG||e==HuaDian.OPERATION.OPERATION_XI_GANG||e==HuaDian.OPERATION.OPERATION_YAO_GANG||e==HuaDian.OPERATION.OPERATION_JIU_GANG||e==HuaDian.OPERATION.OPERATION_BU_XUAN_FENG_GANG||e==HuaDian.OPERATION.OPERATION_BU_XI_GANG||e==HuaDian.OPERATION.OPERATION_BU_YAO_GANG||e==HuaDian.OPERATION.OPERATION_BU_JIU_GANG?"dan.png":e==HuaDian.OPERATION.OPERATION_CHI||e==HuaDian.OPERATION.OPERATION_CHI_TING?"chi.png":e==HuaDian.OPERATION.OPERATION_DIANPAO_HU||e==HuaDian.OPERATION.OPERATION_HU||e==HuaDian.OPERATION.OPERATION_QIANGGANG_HU?"hu.png":e==HuaDian.OPERATION.OPERATION_TING?"ting.png":null},setMyHandButton:function(e,t,a){if(e){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)}},setMyHuierVisible:function(e,t){var a=!1;h.instance.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");null==n?1==a&&(n=cc.instantiate(this.cardHuierPrefab),e.addChild(n),n.name=e.name+"_huier"):n.active=a},setMyTingVisible:function(e,t){for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,GameData.game.turn!=GameData.player.uid&&null!=i&&(i.active=!1)},setHandCardDisable:function(e,t){var a=e.getChildByName(e.name+"_button");a&&a.removeFromParent(!0);var n=e.getChildByName("mask");if(null==n){var i=(n=new cc.Node("mask")).addComponent(cc.Sprite),o=cc.textureCache.addImage(cc.url.raw("resources/table/majiangmengbai.png"));i.spriteFrame=new cc.SpriteFrame(o),e.addChild(n)}n.active=t},showPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:3==e?t=0:2==e?t=270:1==e&&(t=180),this.direction_pos.node.rotation=t},showTurn:function(){var e,t=profileHeb.getTurnByUid(),a=GameData.getPlayerIndex(t);e=0==a?"dong":3==a?"nan":2==a?"xi":1==a?"bei":"dong";var n=cc.textureCache.addImage(cc.url.raw("resources/table/"+e+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(n),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1;var i=cc.find(GameData.tablePos[t],this.direction_turn);i&&(i.active=!0)},showCardNum:function(){GameData.game.cardleft<0||(this.leftCardNumLabel.string=GameData.game.cardleft)},showBaoCardImg:function(){var e=GameData.game.cardHuier1,t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e+".png"));(this.huiercard1.spriteFrame=new cc.SpriteFrame(t),GameData.room.opts)&&((1==GameData.cards[GameData.player.uid].tingState||2==GameData.cards[GameData.player.uid].tingState)&&0==GameData.room.opts.anBao?this.huiercard1.node.active=!0:1==GameData.room.opts.anBao&&(this.huiercard1.node.active=!1))},showBaoCardNode:function(e){this.baoCardNode.active=e;var t=cc.find("anbao",this.baoCardNode),a=cc.find("mingbao",this.baoCardNode);GameData.room.opts&&(t.active=1==GameData.room.opts.anBao,a.active=0==GameData.room.opts.anBao)},showEffect:function(e){var t="",n="";switch(e){case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":t="spine/table/hu",n="a";break;case"chi":t="spine/table/chi",n="a";break;case"dianpao":t="spine/table/hu",n="a"}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},playBaoAnimation:function(i,e){var t="spine/table/"+e;cc.loader.loadResDir(t,function(e,t){if(e)cc.log(e);else if(t.length<=0)cc.log("assets length: ",t.length);else{var a;for(var n in i.getComponent(dragonBones.ArmatureDisplay)?(cc.log("dragonBones get"),a=i.getComponent(dragonBones.ArmatureDisplay)):(cc.log("dragonBones add"),a=i.addComponent(dragonBones.ArmatureDisplay)),t)t[n]instanceof dragonBones.DragonBonesAsset&&a.dragonAsset!=t[n]&&(a.dragonAsset=t[n]),t[n]instanceof dragonBones.DragonBonesAtlasAsset&&a.dragonAtlasAsset!=t[n]&&(a.dragonAtlasAsset=t[n]);a.armatureName="armature",a.playAnimation("newAnimation",1)}})},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down),i=[];if(i.push(t),this.selectedCard==a){var o=this,r=!1;GameData.getTingData(GameData.player.uid)&&(r=GameData.getTingData(GameData.player.uid).canTing,0==GameData.getTingData(GameData.player.uid).outCards.length?this.isTing=!1:this.isTing=!0),r&&this.isPass&&this.isTing?(this.isPass=!0,this.isTing=!1,GameData.getTingData(GameData.player.uid).canTing=!1,MjHandler_Heb.getInstance().requestOperation_CC(HuaDian.OPERATION.OPERATION_TING,i,this.isZiMoHuOnly,function(e){})):GameData.game.turn==GameData.player.uid&&MjHandler_Heb.getInstance().requestDisCard_CC(i,function(e){e.result==s.Success&&(n.stopAllActions(),o.selectedCard=-1,this.moveBackMyCards())});a=this._handCardArry.indexOf(t);this._handCardArry.splice(a,1),this._handCardArry.sort(function(e,t){return e-t}),this._disCardArry.push(t),GameData.game.turn=0,this.showCards(),this.tingTip.hide()}else{if(0<=this.selectedCard)cc.find("cardHand/cardHand"+this.selectedCard,this.play_layer_down).runAction(cc.moveTo(.01,this.myHandsInitPosition[this.selectedCard]));n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))}},showTingState:function(){for(var e in this.tingStateNode.children)this.tingStateNode.children[e].active=!1;for(var t,a,n=0;n<GameData.joiners.length;n++){var i=GameData.tablePos[GameData.joiners[n].uid];t=cc.find(i,this.tingStateNode);var o=cc.find("text",t),r=GameData.cards[GameData.joiners[n].uid].tingState;if(1==r){a=cc.url.raw("resources/huadian/UI/artword/loupaizhong.png");var s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else if(2==r){a=cc.url.raw("resources/huadian/UI/artword/tingpaizhong.png");s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else t.active=!1}},showMask:function(e){var t=GameData.getPlayerByPos("down");t&&(this.showPengCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_down,"down")),(t=GameData.getPlayerByPos("up"))&&(this.showPengCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_up,"up")),(t=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_left,"left")),(t=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,t,a)}}},showDisCardMask:function(e,t,a){for(var n=1;n<=this.discardMax;n++){var i=cc.find("cardDis_"+GameData.room.opts.joinermax+"/card_face"+n,t);i.active&&this.gotoMask(i,e,t,a)}},gotoMask:function(e,t,a,n){var i=e.getComponent("Card");if(null!=i){var o=t==i.id,r=this.setMaskVisible(e,o);null!=r&&(cc.find("tipMask/up",r).active=!1,cc.find("tipMask/down",r).active=!1,cc.find("tipMask/right",r).active=!1,cc.find("tipMask/left",r).active=!1,cc.find("tipMask/"+n,r).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask",cc.find("tipMask",a).active=!0,cc.find("chipaiMask",a).active=!1):cc.find("tipMask",a).active=t,a},onGameScore:function(){this.tingTip.hide(),this.unschedule(this.runCountDown)},startCoundDown:function(e){this.PLayerUID=GameData.game.turn,this._countdown_index=10,this.schedule(this.runCountDown,1)},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t,a,n=e.split("");if(0!=n.length){if(1==n.length)t=cc.url.raw("resources/number/jinzi0.png"),a=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=n.length)return;t=cc.url.raw("resources/number/jinzi"+n[0]+".png"),a=cc.url.raw("resources/number/jinzi"+n[1]+".png")}var i=cc.textureCache.addImage(t);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i);var o=cc.textureCache.addImage(a);this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},showScoreLayer:function(){this.getComponent("roomScore").ShowPlayerScoreItem(),this.scoreLayer.active=!0},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e),this.tingTip.hide();break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){this.tingTip.hide()},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},showPiaoLayer:function(){this.PiaoLayer.active=!0},getCardBackImgName:function(e){var t="",a="";switch(GameData.getPlayerPosByUid(e)){case"down":t="mj_back0",a="chu";break;case"up":t="mj_back2",a="chu";break;case"right":t="mj_back1",a="chu";break;case"left":t="mj_back3",a="chu"}return{img1:t,img2:a}},saveMyHandCard:function(){if(this._handCardArry=[],this._disCardArry=[],0!=Object.keys(GameData.cards).length)if(this._handCardArry=GameData.getHandCards(GameData.player.uid),this._disCardArry=GameData.getDisCards(GameData.player.uid),GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned){var e=this._handCardArry[this._handCardArry.length-1];this._handCardArry.pop(),this._handCardArry.sort(function(e,t){return e-t}),this._handCardArry.push(e)}else this._handCardArry.sort(function(e,t){return e-t})}});t.exports=o,cc._RF.pop()},{SoundMngr:"SoundMngr",errorCode:"errorCode",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomTable_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"243b9lFj6pG4YkhRGD/VVp+","roomTable_huadian");var n=e("SoundMngr"),i=e("gameDefine"),s=e("errorCode"),o=e("ruleHandler"),r=cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,baoCardNode:cc.Node,huiercard1:cc.Sprite,leftCardNumLabel:cc.Label,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,cardsNode:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,cardTemplate:cc.Prefab,playerTemplate:cc.Prefab,selectedCard:-1,HuType:null,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,disCardArrow:cc.Prefab,_cardArrow:cc.Node,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,lastRoundLabel:cc.RichText,scoreLayer:cc.Node,baoAnimationNode:cc.Node,tingStateNode:cc.Node,passBtn:cc.Button,PiaoLayer:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.handleGameStart),registEvent("onGameReady",this,this.handleGameReady),registEvent("onGameTurn",this,this.handleTurn),registEvent("onStarPiao",this,this.showPiaoLayer),registEvent("onMahjongStartRun",this,this.onShow),registEvent("onRegularCircle",this,this.onShow),registEvent("onMahjongRunEnd",this,this.onGameScore),registEvent("onHuaDianMahjongReconnecet",this,this.onShow),registEvent("onCardHu",this,this.handleHuCard),registEvent("onCardChi",this,this.handleChiCard),registEvent("onCardDis",this,this.handleDisCard),registEvent("onCardPeng",this,this.handlePengCard),registEvent("onCardGang",this,this.handleGangCard),registEvent("onCardTing",this,this.handleTingCard),registEvent("onCardBao",this,this.handleBao),registEvent("dianPao",this,this.handleDianPao),registEvent("onPushErrorMsg",this,this.showErrorMsg),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),this.actions=new Array,this._handCardArry=new Array,this._disCardArry=new Array,this.gangOperations=[],this.cardsNode.active=!1,this.PiaoLayer.active=!1,this.tingData=[],this.tingTip=this.node.getComponent("TingTip"),this.playerSex=1,this.isZiMoHuOnly=0,this.isPass=!0,GameData.room&&(4==GameData.room.opts.joinermax&&(this.discardMax=24),3==GameData.room.opts.joinermax&&(this.discardMax=36),2==GameData.room.opts.joinermax&&(this.discardMax=60)),this._cardArrow=cc.instantiate(this.disCardArrow),this.cardsNode.addChild(this._cardArrow),this._cardArrow.active=!1,this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),GameData.game.gameStart&&(this.handleGameStart(),this.onShow(),this.handleTurn()),0<Object.keys(profileHuaDian.PiaoInfo).length&&profileHuaDian.PiaoInfo.runState==HuaDian.RunStateEmnum.PIAO&&this.showPiaoLayer()},onDestroy:function(){unregistEvent("onGameStart",this,this.handleGameStart),unregistEvent("onGameReady",this,this.handleGameReady),unregistEvent("onGameTurn",this,this.handleTurn),unregistEvent("onStarPiao",this,this.showPiaoLayer),unregistEvent("onMahjongStartRun",this,this.onShow),unregistEvent("onRegularCircle",this,this.onShow),unregistEvent("onMahjongRunEnd",this,this.showResultLayer),unregistEvent("onHuaDianMahjongReconnecet",this,this.onShow),unregistEvent("onCardHu",this,this.handleHuCard),unregistEvent("onCardDis",this,this.handleDisCard),unregistEvent("onCardPeng",this,this.handlePengCard),unregistEvent("onCardGang",this,this.handleGangCard),unregistEvent("onCardBao",this,this.handleBao),unregistEvent("dianPao",this,this.handleDianPao),unregistEvent("onPushErrorMsg",this,this.showErrorMsg),unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel)},handleGameStart:function(){this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.showBaoCardNode(!1)},handleGameReady:function(){for(var e in this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.tingStateNode.children)this.tingStateNode.children[e].active=!1;GameData.game.cardHuier1=0,this.showBaoCardNode(!1),this.huiercard1.spriteFrame=null,this.huiercard1.node.active=!1},onShow:function(){this.cardsNode.active=!0,this.saveMyHandCard(),this.showCards(),this.showOperations(),GameData.room.status==i.RoomState.GAMEING&&this.showTingState(),profileHuaDian.checkIsTingPlayer()?this.showBaoCardNode(!0):this.showBaoCardNode(!1);var e=GameData.room.roundNum>GameData.room.opts.roundMax?GameData.room.roundmax:GameData.room.roundNum;this.lastRoundLabel.string=e+"/"+GameData.room.opts.roundMax},handleTurn:function(e){this.showTurn(),this.startCoundDown(e)},handleDisCard:function(e){console.log("this.playerSex =  GameData.player.sex",e.detail.player,GameData.player.sex),this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),null!=e.detail.card&&(n.instance.playAudioHD("dis",e.detail.card,this.playerSex),n.instance.playAudioOther("out"))},handlePengCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioHD("cha",null,this.playerSex),this.playActionAnimation(e.detail.userId,"cha")},handleChiCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioHD("chi",null,this.playerSex),this.playActionAnimation(e.detail.userId,"chi")},handleGangCard:function(e){if(this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),3==e.detail.operation?n.instance.playAudioHD("andan",null,this.playerSex):n.instance.playAudioHD("mingdan",null,this.playerSex),e.detail.userId==GameData.player.uid){var t=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(t,"dan")}else this.playActionAnimation(e.detail.userId,"dan")},handleTingCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioHD("ting",null,this.playerSex)},handleHuCard:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.userId),n.instance.playAudioHD("hu",e.detail,this.playerSex),e.detail.userId==GameData.player.uid?this.showEffect("hu"):this.playActionAnimation(e.detail.userId,"hu"),this.actionLayer.active=!1},handleBao:function(e){var t=cc.find("up",this.baoAnimationNode),a=e.detail.type;1==a?this.playBaoAnimation(t,"huanbao"):2==a&&this.playBaoAnimation(t,"dabao"),this.showBaoCardNode(!0)},handleDianPao:function(e){e.detail==GameData.player.uid&&this.playActionAnimation(e.detail,"dianpao")},showErrorMsg:function(e){301==e.detail.errorCode&&createMoveMessage("定宝牌库没牌了!")},playActionAnimation:function(e,t){if(null!=GameData.joiners){var a=GameData.tablePos[e],n=cc.find("layer_ui/layer_ui_table/actionAnimations/"+a,this.node);null!=n&&n.getComponent(cc.Animation).play(t)}},handlePass:function(e){if(GameData.game.checkPass.onGoingUserId){var t=GameData.game.checkPass.onGoingUserId,a=GameData.game.checkPass.showCard[0];this.showPassActions(t,a)||MjHandler.getInstance().requestPass_HD(function(e){}),GameData.game.checkPass={}}},showGangAction:function(e,t){},checkGangAction:function(e,t){},hideOperationBtn:function(){for(var e=0;e<4;e++)cc.find("btnAct"+(e+1),this.actionLayer).active=!1},createActionBtn:function(e,t){var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/btn/"+t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){for(var a=0;a<this.actions.length;a++)cc.log(this.actions[a].act+","+this.actions[a].card);var n=this.actions[t];if("hu"==n.act)MjHandler.getInstance().requestOperation(n.type,null,null,function(e){}),this.showEffect("hu");else if("cha"==n.act){cc.log("------------------\x3e click cha, should open cha ui,"),MjHandler.getInstance().requestOperation(HuaDian.OPERATION.OPERATION_PENG,n.card,null,function(e){});var i=cc.find("down",this.baoAnimationNode);this.playBaoAnimation(i,"cha")}else if("ting"==n.act)cc.log("------------------\x3e click ting, should open ting ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=0;else if("lou"==n.act){cc.log("------------------\x3e click lou, should open lou ui,"),this.actionLayer.actvie=!1,this.isPass=!0,this.isZiMoHuOnly=1;for(a=0;a<this.actions.length;a++){if("lou"==this.actions[a].act)this.actions.splice(a,1),cc.find("btnAct"+a,this.actionLayer).active=!1}}else if("chi"==n.act)if(cc.log("------------------\x3e click chi, should open chi ui,"),n.card.length<=1){var o=[];for(a=0;a<n.card[0].length;a++)o.push(n.card[0][a]);MjHandler.getInstance().requestOperation(HuaDian.OPERATION.OPERATION_CHI,o,null,function(e){}),this.showEffect("chi")}else this.refreshChiActionType(n);else if("dan"==n.act)if(n.card.length<=1){var r=n.type;r instanceof Array&&(r=n.type[0]),MjHandler.getInstance().requestOperation(r,n.card[0],null,function(e){})}else this.refreshGangActionBar(n);this.moveBackMyCards(),this.actionLayer.active=!1},refreshChiActionType:function(e){this.chiActionList=[],this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0;for(var n=0;n<e.card.length;n++){var i=e.card[n];this.chiActionList.push(i);var o=GameData.game.lastdisCard,r=cc.instantiate(a);contains(i,o)||i.push(o),i=i.sort(),r.name=n+"";for(var s=0;s<i.length;s++){var c=cc.find("card_"+s,r);c.getComponent(cc.Sprite).spriteFrame=null;var d="resources/mjcard2d/mj_face_xia_shou_"+i[s]+".png",h=cc.textureCache.addImage(cc.url.raw(d));if(c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h),i[s]==o){var l=c.getChildByName(c.name+"_biao");null==l&&((l=cc.instantiate(this.cardTingPrefab)).y=l.y-10,c.addChild(l),l.name=c.name+"_biao")}c.active=!0}r.getComponent(cc.Sprite).spriteFrame=null,r.on(cc.Node.EventType.TOUCH_START,this.onClickChiActionBtn,this),t.addChild(r),r.width=252}a.active=!1},onClickChiActionBtn:function(e){for(var t=e.target.name,a=this.chiActionList[t],n=GameData.game.lastdisCard,i=0;i<a.length;i++)a[i]==n&&a.splice(i,1);null!=a&&(MjHandler.getInstance().requestOperation(HuaDian.OPERATION.OPERATION_CHI,a,null,function(e){}),this.showEffect("chi")),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},refreshGangActionBar:function(e){this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0,this.gangActionList=new Array;for(var n=0;n<e.card.length;n++){var i=e.card[n],o={card:e.card[n],type:e.type[n]};this.gangActionList.push(o);var r=cc.instantiate(a);r.name=n+"",r.getComponent(cc.Sprite).spriteFrame=null;var s="resources/mjcard2d/mj_face_xia_shou_"+i[0]+".png",c=cc.textureCache.addImage(cc.url.raw(s));r.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(c),r.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(r)}a.active=!1},showTingMask:function(e,t){this.removeCardMask();var a=cc.find("cardHand",this.play_layer_down);for(var n in a.children){for(var i=a.children[n].getComponent("Card").id,o=0,r=0;r<e.length;r++)i!=e[r]&&o++;o==e.length&&this.setHandCardDisable(a.children[n],!0)}},removeCardMask:function(){var e=cc.find("cardHand",this.play_layer_down);for(var t in e.children)e.children[t].getChildByName("mask")&&e.children[t].getChildByName("mask").removeFromParent(!0)},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){cc.log(e.target.name);var t=e.target.name,a=this.gangActionList[t];null!=a&&MjHandler.getInstance().requestOperation(a.type,a.card,null,function(e){}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},onBtnPassClicked:function(e){GameData.game.turn==GameData.player.uid&&(MjHandler.getInstance().requestPass_HD(HuaDian.OPERATION.OPERATION_PASS,[],function(e){}),this.isPass=!1);for(var t=GameData.getMyHandCards(),a=0;a<t.length;a++){var n=cc.find("cardHand/cardHand"+a,this.play_layer_down);n.active=!0,this.setMyHandButton(n,t[a],a)}this.removeCardMask(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},showCards:function(){cc.log("~~~~~~~~~~~~~~~function_showcards~~~~~~~~~~~~~~~~~~~~~~");var e=GameData.getPlayerByPos("down");e&&GameData.cards[e.uid]?(this.play_layer_down.active=!0,this.showMyHandCards(e,this.play_layer_down),this.showDisCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showPengCards(e,this.play_layer_down,"mj_face_xia_chu","down")):this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameData.cards[e.uid]?(this.play_layer_right.active=!0,this.showHandCards(e,this.play_layer_right),this.showDisCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showPengCards(e,this.play_layer_right,"mj_face_you_chu","right")):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("up"))&&GameData.cards[e.uid]?(this.play_layer_up.active=!0,this.showHandCards(e,this.play_layer_up),this.showDisCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showPengCards(e,this.play_layer_up,"mj_face_shang_shou","up")):this.play_layer_up.active=!1,(e=GameData.getPlayerByPos("left"))&&GameData.cards[e.uid]?(this.play_layer_left.active=!0,this.showHandCards(e,this.play_layer_left),this.showDisCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showPengCards(e,this.play_layer_left,"mj_face_zuo_chu","left")):this.play_layer_left.active=!1,this.showCardNum(),1e3!=GameData.game.cardHuier1&&-1!=GameData.game.cardHuier1&&0!=GameData.game.cardHuier1?this.showBaoCardImg():(this.huiercard1.spriteFrame=null,this.huiercard1.node.active=!1)},showHandCards:function(e,t){if(e)for(var a=e.uid,n=GameData.getHandCardNum(a)+3*(GameData.getChiCards(a).length+GameData.getPengCards(a).length+GameData.getGangCards(a).length)>GameData.client.handsize?0:1,i=1,o=0;o<=GameData.client.handsize;o++){var r=cc.find("cardHand/cardHand"+o,t);o==n&&i<=GameData.getHandCardNum(a)?(r.active=!0,n++,i++):r.active=!1}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=43,t<=++a))return}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},showMyHandCards:function(e,t){var a,n=this._handCardArry;n.reverse(),this.moveBackMyCards();var i=cc.find("cardHand",t);for(var o in i.children)i.children[o].getComponent(cc.Sprite).spriteFrame=null,i.children[o].active=!1;var r=3*GameData.getPengCards(GameData.player.uid).length+3*GameData.getGangCards(GameData.player.uid).length+3*GameData.getChiCards(GameData.player.uid).length;if(14==n.length)for(var s=0;s<n.length;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s&&(this.removeBaoIcon(a),this.setMyHuierVisible(a,n[s]));else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned)for(s=0;s<n.length;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s&&(this.removeBaoIcon(a),this.setMyHuierVisible(a,n[s]));else if(n.length<GameData.client.handsize&&GameData.game.turn==GameData.player.uid&&!GameData.player[GameData.player.uid].cardLastAssigned&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s&&(this.removeBaoIcon(a),this.setMyHuierVisible(a,n[s]));else if(n.length<GameData.client.handsize&&GameData.player[GameData.player.uid].fenZhangCard&&n.length>GameData.client.handsize-r)for(s=0;s<n.length;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s],s),this.showCardContent(a,"mj_face_xia_shou",n[s]),0==s&&(this.removeBaoIcon(a),this.setMyHuierVisible(a,n[s]));else for(s=1;s<n.length+1;s++)a=cc.find("cardHand/cardHand"+s,t),this.setMyHandButton(a,n[s-1],s),this.showCardContent(a,"mj_face_xia_shou",n[s-1]);var c=profileHuaDian.getTingStateByUid(GameData.player.uid);if(this.removeCardMask(),c){var d=GameData.getTingData(GameData.player.uid).outCards;this.showTingMask(d,1);var h=profileHuaDian.canGang();profileHuaDian.canHu()||GameData.game.turn!=GameData.player.uid||h||this.autoDisCard(GameData.game.obtain)}else this.removeCardMask()},removeBaoIcon:function(e){e.active=GameData.player[GameData.player.uid].isWin!=HuaDian.WINTYPE.DIANPAOWIN;var t=e.getChildByName(e.name+"_huier");t&&t.removeFromParent(!0)},showDisCards:function(e,t,a,n){var i=cc.find("cardDis_4",t);i&&(i.active=!1);var o=cc.find("cardDis_3",t);o&&(o.active=!1);var r=cc.find("cardDis_2",t);r&&(r.active=!1),console.log("22222"+GameData.room.opts.joinermax);var s=cc.find("cardDis_"+GameData.room.opts.joinermax,t);s.active=!0;var c=GameData.getDisCards(e.uid);e.uid==GameData.player.uid&&(c=this._disCardArry);for(var d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,s);if(d<=c.length){var l=c[d-1];h.active=!0,this.showCardContent(h,a,l),e.uid==GameData.game.lastdisUid&&l==GameData.game.lastdisCard&&null!=h&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==n,cc.find("down",this._cardArrow).active="down"==n,cc.find("right",this._cardArrow).active="right"==n,cc.find("up",this._cardArrow).active="up"==n)}else h.active=!1}},showPengCards:function(e,t,a,n){if(e){for(var i=GameData.getChiCards(e.uid),o=(GameData.getSelfChiCards(e.uid),0);o<i.length;o++){var r=i[o].otherPlayerCard;if(1!=(_=i[o].cards.indexOf(r))){var s=[i[o].cards[_],i[o].cards[1]];i[o].cards[1]=s[0],i[o].cards[_]=s[1]}}var c=GameData.getGangCards(e.uid),d=GameData.getPengCards(e.uid),h=c.concat(d,i),l=parseInt(GameData.client.handsize/3);for(o=0;o<l;o++){var u=cc.find("cardPeng/cardPeng"+(o+1),t),m=cc.find("card_face4",u);if(o<h.length){for(var p=0;p<4;p++){var g=u.getChildByName("card_face"+(p+1)).getComponent("cc.Sprite"),f=!1;h[o].cards.length<4&&h[o].cards[0]==h[o].cards[1]&&(f=!0);var y=!1;if(4==h[o].cards.length&&(y=!0),p<h[o].cards.length){g.node.active=!0;var v=h[o].cards[p];if(4==h[o].cards.length&&this.addGangIcon(m,n,1),5==h[o].cards.length&&this.addGangIcon(m,n,2),f){var C=h[o].pengFromUserId;if(p+1==(_=profileHuaDian.getCardIndexByUid(e.uid,C))){var D=this.getCardBackImgName(e.uid);this.showCardContent(g.node,D.img1,D.img2)}else this.showCardContent(g.node,a,v)}else if(y){var _;C=h[o].gangFromUserId;if(p+1==(_=profileHuaDian.getCardIndexByUid(e.uid,C))){D=this.getCardBackImgName(e.uid);this.showCardContent(g.node,D.img1,D.img2)}else this.showCardContent(g.node,a,v)}else this.showCardContent(g.node,a,v)}else g.node.active=!1}u.active=!0}else u.active=!1}}},autoDisCard:function(e){cc.log("自动出牌！");var t=this,a=[];a.push(e),this.scheduleOnce(function(){MjHandler.getInstance().requestDisCard_HD(a,function(e){e.result==s.Success&&(t.selectedCard=-1,t.moveBackMyCards())})},.5)},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/huadian/UI/icon/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},addGangIcon:function(e,t,a){var n,i=cc.find("gangType",e),o="",r="";"right"==t?(o=1==a?"ming":"an",r="1"):"down"==t?(o=1==a?"ming":"an",r="0"):"left"==t?(o=1==a?"ming":"an",r="3"):"up"==t&&(o=1==a?"ming":"an",r="2"),n=cc.url.raw("resources/huadian/UI/icon/"+o+r+"_icon.png");var s=cc.textureCache.addImage(n);i.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s)},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),e.active=!0,this.setMaskVisible(e,!1)},showOperations:function(){this.operationsArry=[],this.gangOperations=[],this.actions=[];var e=this.isPass1=!0;if(this.operationsArry=profileHuaDian.getPlayerOperationsByUid(GameData.player.uid),this.operationsArry){if(WriteLog("this.operationsArry:"+this.operationsArry),this.hideOperationBtn(),0<this.operationsArry.length&&GameData.game.turn==GameData.player.uid){this.actionLayer.active=!0;for(var t=0,a=0;a<this.operationsArry.length;a++){var n=this.getOperAction(this.operationsArry[a]);this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_GONGGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_ANGANG&&this.operationsArry[a]!=HuaDian.OPERATION.OPERATION_MINGGANG||this.gangOperations.push(this.operationsArry[a]),WriteLog("operActionBtnIcon:"+n),e=!0;for(var i=0;i<this.actions.length;i++)if(this.actions[i].act==n.substring(0,n.length-4)){e=!1,t--;break}e&&(this.actions[t]={act:n.substring(0,n.length-4),card:this.getOperCard(n,this.operationsArry[a]),type:this.operationsArry[a]},this.createActionBtn(t+1,n)),t++}for(t=0;t<this.actions.length;t++)if("ting"==this.actions[t].act){this.actions[t+1]={act:"lou",card:null},this.createActionBtn(t+2,"lou.png");break}if(GameData.player[GameData.player.uid].gangTing)for(a=0;a<this.actions.length;a++)if("dan"==this.actions[a].act){this.actions[a].type=[];for(i=0;i<GameData.player[GameData.player.uid].gangTing.gangCards.length;i++)this.actions[a].type.push(GameData.player[GameData.player.uid].gangTing.gangCards[i].operation)}for(a=0;a<this.actions.length;a++){if(!GameData.player[GameData.player.uid].isCanPass){this.passBtn.interactable=!1;break}this.passBtn.interactable=!0}this.removeCardMask();for(t=0;t<this.actions.length;t++)if("ting"==this.actions[t].act){if(GameData.getTingData(GameData.player.uid)){var o=GameData.getTingData(GameData.player.uid).outCards;WriteLog("tingCards:"+o),this.showTingMask(o,1)}break}}else this.actionLayer.active=!1;WriteLog("this.actions:"+JSON.stringify(this.actions)),WriteLog("this.operationsArry:"+profileHuaDian.getPlayerOperationsByUid(GameData.player.uid))}},getOperCard:function(e,t){var a=[];if(GameData.game.checkPass.onGoingUserId){GameData.game.checkPass.onGoingUserId;if("dan.png"==e){if(GameData.player[GameData.player.uid].gangTing){for(var n=GameData.player[GameData.player.uid].gangTing.gangCards,i=0;i<n.length;i++)a.push(n[i].gangCards);return a}for(i=0;i<this.gangOperations.length;i++){var o=profileHuaDian.getGangCardByUid(GameData.player.uid,this.gangOperations[i]);if(0==o.type){var r=[];for(i=0;i<3;i++)r.push(o.card);a.push(r)}else{for(r=[],i=0;i<4;i++)r.push(o.card);a.push(r)}}return a}if(GameData.game.checkPass.showCard){var s=GameData.game.lastdisCard;if("cha.png"==e){for(i=0;i<2;i++)a.push(s);return a}if("chi.png"==e){var c=GameData.player[GameData.player.uid].chiTing.chiCases;for(i=0;i<c.length;i++)a.push(c[i].chiCards);return a}}}},getOperAction:function(e){return e==HuaDian.OPERATION.OPERATION_PASS?"pass.png":e==HuaDian.OPERATION.OPERATION_PENG||e==HuaDian.OPERATION.OPERATION_PENG_TING?"cha.png":e==HuaDian.OPERATION.OPERATION_GONGGANG||e==HuaDian.OPERATION.OPERATION_ANGANG||e==HuaDian.OPERATION.OPERATION_MINGGANG||e==HuaDian.OPERATION.OPERATION_GONGGANG_TING||e==HuaDian.OPERATION.OPERATION_ANGANG_TING||e==HuaDian.OPERATION.OPERATION_MINGGANG_TING?"dan.png":e==HuaDian.OPERATION.OPERATION_CHI||e==HuaDian.OPERATION.OPERATION_CHI_TING?"chi.png":e==HuaDian.OPERATION.OPERATION_DIANPAO_HU||e==HuaDian.OPERATION.OPERATION_HU||e==HuaDian.OPERATION.OPERATION_QIANGGANG_HU?"hu.png":e==HuaDian.OPERATION.OPERATION_TING?"ting.png":null},setMyHandButton:function(e,t,a){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)},setMyHuierVisible:function(e,t){var a=!1;o.instance.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");null==n?1==a&&(n=cc.instantiate(this.cardHuierPrefab),e.addChild(n),n.name=e.name+"_huier"):n.active=a},setMyTingVisible:function(e,t){for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,GameData.game.turn!=GameData.player.uid&&null!=i&&(i.active=!1)},setHandCardDisable:function(e,t){var a=e.getChildByName(e.name+"_button");a&&a.removeFromParent(!0);var n=e.getChildByName("mask");if(null==n){var i=(n=new cc.Node("mask")).addComponent(cc.Sprite),o=cc.textureCache.addImage(cc.url.raw("resources/table/majiangmengbai.png"));i.spriteFrame=new cc.SpriteFrame(o),e.addChild(n)}n.active=t},showPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:3==e?t=0:2==e?t=270:1==e&&(t=180),this.direction_pos.node.rotation=t},showTurn:function(){var e=profileHuaDian.getTurnByUid();if(!(e<=0)){var t,a=GameData.getPlayerIndex(e);WriteLog("turnPlayerUid:"+e),t=0==a?"dong":3==a?"nan":2==a?"xi":1==a?"bei":"dong";var n=cc.textureCache.addImage(cc.url.raw("resources/table/"+t+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(n),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1,cc.find(GameData.tablePos[e],this.direction_turn).active=!0}},showCardNum:function(){GameData.game.cardleft<0||(this.leftCardNumLabel.string=GameData.game.cardleft)},showBaoCardImg:function(){var e=GameData.game.cardHuier1,t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e+".png"));this.huiercard1.node.active=!0,this.huiercard1.spriteFrame=new cc.SpriteFrame(t)},showBaoCardNode:function(e){this.baoCardNode.active=e},showEffect:function(e){WriteLog("show effect: "+e);var t="",n="";switch(e){case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":t="spine/table/hu",n="a";break;case"chi":t="spine/table/chi",n="a";break;case"dianpao":t="spine/table/hu",n="a"}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},playBaoAnimation:function(i,e){var o="spine/table/"+e;cc.loader.loadResDir(o,function(e,t){if(WriteLog("loadResArray ",o),e)WriteLog(e);else if(t.length<=0)WriteLog("assets length: ",t.length);else{var a;for(var n in i.getComponent(dragonBones.ArmatureDisplay)?(WriteLog("dragonBones get"),a=i.getComponent(dragonBones.ArmatureDisplay)):(WriteLog("dragonBones add"),a=i.addComponent(dragonBones.ArmatureDisplay)),t)t[n]instanceof dragonBones.DragonBonesAsset&&a.dragonAsset!=t[n]&&(a.dragonAsset=t[n]),t[n]instanceof dragonBones.DragonBonesAtlasAsset&&a.dragonAtlasAsset!=t[n]&&(a.dragonAtlasAsset=t[n]);a.armatureName="armature",a.playAnimation("newAnimation",1)}})},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down),i=[];if(i.push(t),this.selectedCard==a){var o=this,r=!1;GameData.getTingData(GameData.player.uid)&&(r=GameData.getTingData(GameData.player.uid).canTing),r&&this.isPass&&this.isPass1?(this.isPass=!0,this.isPass1=!1,GameData.getTingData(GameData.player.uid).canTing=!1,MjHandler.getInstance().requestOperation(HuaDian.OPERATION.OPERATION_TING,i,this.isZiMoHuOnly,function(e){})):GameData.game.turn==GameData.player.uid&&MjHandler.getInstance().requestDisCard_HD(i,function(e){e.result==s.Success&&(n.stopAllActions(),o.selectedCard=-1,o.moveBackMyCards())});a=this._handCardArry.indexOf(t);this._handCardArry.splice(a,1),this._handCardArry.sort(function(e,t){return e-t}),this._disCardArry.push(t),GameData.game.turn=0,this.showCards(),this.tingTip.hide()}else 0<=this.selectedCard&&this.moveBackMyCards(),n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))},showTingState:function(){for(var e in this.tingStateNode.children)this.tingStateNode.children[e].active=!1;for(var t,a,n=0;n<GameData.joiners.length;n++){var i=GameData.tablePos[GameData.joiners[n].uid];t=cc.find(i,this.tingStateNode);var o=cc.find("text",t);if(0==Object.keys(GameData.cards).length)return;var r=GameData.cards[GameData.joiners[n].uid].tingState;if(null==r)return;if(1==r){a=cc.url.raw("resources/huadian/UI/artword/loupaizhong.png");var s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else if(2==r){a=cc.url.raw("resources/huadian/UI/artword/tingpaizhong.png");s=cc.textureCache.addImage(a);o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),t.active=!0}else t.active=!1}},showMask:function(e){var t=GameData.getPlayerByPos("down");t&&(this.showPengCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_down,"down")),(t=GameData.getPlayerByPos("up"))&&(this.showPengCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_up,"up")),(t=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_left,"left")),(t=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,t,a)}}},showDisCardMask:function(e,t,a){for(var n=1;n<=this.discardMax;n++){var i=cc.find("cardDis_"+GameData.room.opts.joinermax+"/card_face"+n,t);i.active&&this.gotoMask(i,e,t,a)}},gotoMask:function(e,t,a,n){var i=e.getComponent("Card");if(null!=i){var o=t==i.id,r=this.setMaskVisible(e,o);null!=r&&(cc.find("tipMask/up",r).active=!1,cc.find("tipMask/down",r).active=!1,cc.find("tipMask/right",r).active=!1,cc.find("tipMask/left",r).active=!1,cc.find("tipMask/"+n,r).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask",cc.find("tipMask",a).active=!0,cc.find("chipaiMask",a).active=!1):cc.find("tipMask",a).active=t,a},onGameScore:function(){this.tingTip.hide(),this.unschedule(this.runCountDown)},startCoundDown:function(e){this.PLayerUID=GameData.game.turn,this._countdown_index=10,this.schedule(this.runCountDown,1)},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t,a,n=e.split("");if(0!=n.length){if(1==n.length)t=cc.url.raw("resources/number/jinzi0.png"),a=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=n.length)return;t=cc.url.raw("resources/number/jinzi"+n[0]+".png"),a=cc.url.raw("resources/number/jinzi"+n[1]+".png")}var i=cc.textureCache.addImage(t);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i);var o=cc.textureCache.addImage(a);this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},showScoreLayer:function(){this.getComponent("roomScore").ShowPlayerScoreItem(),this.scoreLayer.active=!0},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e),this.tingTip.hide();break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){this.tingTip.hide()},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},showPiaoLayer:function(){this.PiaoLayer.active=!0},getCardBackImgName:function(e){var t="",a="";switch(GameData.getPlayerPosByUid(e)){case"down":t="mj_back0",a="chu";break;case"up":t="mj_back2",a="chu";break;case"right":t="mj_back1",a="chu";break;case"left":t="mj_back3",a="chu"}return{img1:t,img2:a}},saveMyHandCard:function(){if(this._handCardArry=[],this._disCardArry=[],0!=Object.keys(GameData.cards).length)if(this._handCardArry=GameData.getHandCards(GameData.player.uid),this._disCardArry=GameData.getDisCards(GameData.player.uid),GameData.game.turn==GameData.player.uid&&GameData.player[GameData.player.uid].cardLastAssigned){var e=this._handCardArry[this._handCardArry.length-1];this._handCardArry.pop(),this._handCardArry.sort(function(e,t){return e-t}),this._handCardArry.push(e)}else this._handCardArry.sort(function(e,t){return e-t})}});t.exports=r,cc._RF.pop()},{SoundMngr:"SoundMngr",errorCode:"errorCode",gameDefine:"gameDefine",ruleHandler:"ruleHandler"}],roomTable_shishi:[function(e,t,a){"use strict";cc._RF.push(t,"317cfsppoVJi4h6xJw2LQHy","roomTable_shishi");var n=e("SoundMngr"),v=e("ruleHandler"),i=cc.Class({extends:cc.Component,properties:{direction_turn:cc.Node,huiercard1:cc.Sprite,huiercard2:cc.Sprite,leftCardNumLabel:cc.Label,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,cardsNode:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,chashuiLayer:cc.Node,cardTemplate:cc.Prefab,playerTemplate:cc.Prefab,selectedCard:-1,HuType:null,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,disCardArrow:cc.Prefab,_cardArrow:cc.Node,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,lastRoundLabel:cc.RichText,scoreLayer:cc.Node,chaShuiLayer:cc.Node,chiActionList:[],mapNode:cc.Node,mapLayer:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.handleGameStart),registEvent("onGameTurn",this,this.handleTurn),registEvent("onGamePass",this,this.handlePass),registEvent("initCards",this,this.onShow),registEvent("initCardHua",this,this.showHuaAction),registEvent("onCardObtain",this,this.handleObtain),registEvent("onCardDis",this,this.handleDisCard),registEvent("onCardHu",this,this.handleHuCard),registEvent("onCardChi",this,this.handleChiCard),registEvent("onCardPeng",this,this.handlePengCard),registEvent("onCardGang",this,this.handleGangCard),registEvent("onYoujin",this,this.showCards),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),registEvent("onGameScore",this,this.onGameScore),registEvent("allYoujinInfo",this,this.allYouJinShow),registEvent("startWater",this,this.showChaShuiLayer()),v.instance.setGameType(GameData.client.gameType),this.actions=new Array,this.cardsNode.active=!1,this.tingData=[],this.tingTip=this.node.getComponent("TingTip-shishi"),this.playerSex=1,this.huBtnIsShow=!0,4==GameData.room.joinermax&&(this.discardMax=24),3==GameData.room.joinermax&&(this.discardMax=36),2==GameData.room.joinermax&&(this.discardMax=60),this._cardArrow=cc.instantiate(this.disCardArrow),this.cardsNode.addChild(this._cardArrow),this._cardArrow.active=!1,cc.log("roomTable onLoad, gameStart="+GameData.game.gameStart+" initcards="+GameData.game.initcards+" checkPass="+GameData.game.checkPass.uid+" obtain="+GameData.game.obtain),this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),GameData.game.gameStart&&this.handleGameStart(),GameData.game.initcards&&this.onShow(),GameData.game.checkPass.uid&&this.handlePass(),0<GameData.game.obtain&&this.handleObtain(),cc.log("GameData.cards "+JSON.stringify(GameData.cards))},onDestroy:function(){unregistEvent("onGameStart",this,this.handleGameStart),unregistEvent("onGameTurn",this,this.handleTurn),unregistEvent("onGamePass",this,this.handlePass),unregistEvent("initCards",this,this.onShow),unregistEvent("initCardHua",this,this.showHuaAction),unregistEvent("onCardObtain",this,this.handleObtain),unregistEvent("onCardDis",this,this.handleDisCard),unregistEvent("onCardHu",this,this.handleHuCard),unregistEvent("onCardChi",this,this.handleChiCard),unregistEvent("onCardPeng",this,this.handlePengCard),unregistEvent("onCardGang",this,this.handleGangCard),unregistEvent("onYoujin",this,this.showCards),unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel),unregistEvent("onGameScore",this,this.onGameScore),unregistEvent("allYoujinInfo",this,this.allYouJinShow),unregistEvent("startWater",this,this.showChaShuiLayer)},handleGameStart:function(){this.tingData=[],this.cardsNode.active=!1,this.spineNode.active=!1,this.tingTip.hide(),this.onGameStartHandler()},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},onShow:function(e){this.moveBackMyCards(),this.showCards(),this.allYouJinShow(),this.cardsNode.active=!0,console.log("GameData.game.roundNum + '/' + GameData.game.roundmax",GameData.game.roundNum,GameData.game.roundmax,GameData.room.opts.scoreBase);var t=GameData.game.roundNum>GameData.game.roundmax?GameData.game.roundmax:GameData.game.roundNum;0<GameData.room.opts.scoreBase?this.lastRoundLabel.string=GameData.game.roundNum+1+"":(this.lastRoundLabel.string=t+1+"/"+GameData.game.roundmax,GameData.game.roundNum==GameData.game.roundmax&&(this.lastRoundLabel.string=GameData.game.roundmax+"/"+GameData.game.roundmax))},showHuaAction:function(e){this.playerSex=GameData.getPlayerSexByUid(e.detail.player),0!=e.detail.hua.length&&e.detail.effect&&(e.detail.uid==GameData.player.uid?this.showEffect("bu"):this.playActionAnimation(e.detail.uid,"buhua"),n.instance.playAudioShiShi("buhua",null,this.playerSex))},handleTurn:function(e){this.showTurn(),this.startCoundDown(e),GameData.game.turn==GameData.player.uid&&this.showObtainActions(GameData.player.uid,GameData.game.obtain)},handleObtain:function(e){if(this.playerSex=GameData.getPlayerSexByUid(GameData.game.turn),GameData.game.turn==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=v.instance.discardTip(t),n.instance.playAudioOther("click"),this.showObtainActions(GameData.player.uid,GameData.game.obtain)}var a=GameData.game.obtainHua;a instanceof Array&&0<a.length&&(GameData.game.turn==GameData.player.uid?this.showEffect("bu"):this.playActionAnimation(GameData.game.turn,"buhua"),n.instance.playAudioShiShi("buhua",null,this.playerSex)),this.showCards()},handleDisCard:function(e){console.log("this.playerSex =  GameData.player.sex",e.detail.player,GameData.player.sex),this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudioShiShi("dis",e.detail.card,this.playerSex),n.instance.playAudioOther("out"),this.showCards()},handleChiCard:function(e){if(e.detail.player==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=v.instance.discardTip(t)}this.showCards(),this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudioShiShi("chi",null,this.playerSex),this.playActionAnimation(e.detail.player,"chi"),this.moveBackMyCards(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.showYoujinActin()},handlePengCard:function(e){if(e.detail.player==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=v.instance.discardTip(t)}this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudioShiShi("peng",null,this.playerSex),this.showCards(),this.playActionAnimation(e.detail.player,"peng"),this.moveBackMyCards(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.showYoujinActin()},handleGangCard:function(e){if(e.detail.player==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=v.instance.discardTip(t)}this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudioShiShi("gang",null,this.playerSex),this.showCards(),this.playActionAnimation(e.detail.player,"gang"),this.moveBackMyCards(),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.showYoujinActin()},showYoujin:function(e,t){var a,n="",i=GameData.tablePos[e.uid],o=GameData.cards[e.uid].youNum;if("down"==i?(a=cc.find("youjin",t),o==YoujinType.Ming?n="resources/shishi/image/youjinzhong.png":o==YoujinType.An1?n="resources/shishi/image/youjinzhong.png":o==YoujinType.An2?n="resources/shishi/image/eryouzhong.png":o==YoujinType.An3&&(n="resources/shishi/image/sanyouzhong.png")):"left"==i?(a=cc.find("youjin",t),o==YoujinType.Ming?n="resources/shishi/image/youjinzhong2.png":o==YoujinType.An2?n="resources/shishi/image/eryouzhong2.png":o==YoujinType.An3&&(n="resources/shishi/image/sanyouzhong2.png")):"up"==i?(a=cc.find("youjin",t),o==YoujinType.Ming?n="resources/shishi/image/youjinzhong.png":o==YoujinType.An2?n="resources/shishi/image/eryouzhong.png":o==YoujinType.An3&&(n="resources/shishi/image/sanyouzhong.png")):"right"==i&&(a=cc.find("youjin",t),o==YoujinType.Ming?n="resources/shishi/image/youjinzhong2.png":o==YoujinType.An2?n="resources/shishi/image/eryouzhong2.png":o==YoujinType.An3&&(n="resources/shishi/image/sanyouzhong2.png")),""!=n){var r=cc.textureCache.addImage(cc.url.raw(n));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(r),a.active=!0}else a.active=!1},handleHuCard:function(e){cc.log("=...........................",e.detail),this.HuType=e.detail,this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudioShiShi("hu",null,this.playerSex),this.playActionAnimation(e.detail.player,"hu"),this.moveBackMyCards(),this.huiercard1.node.active=!1,this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1},playActionAnimation:function(e,t){if(null!=GameData.joiners){var a=GameData.tablePos[e],n=cc.find("layer_ui/layer_ui_table/actionAnimations/"+a,this.node);cc.log("---\x3e animationNode : "+n),null!=n&&(cc.log("---\x3e playActionAnimation : "+t),n.getComponent(cc.Animation).play(t))}},handlePass:function(e){if(GameData.game.checkPass.uid){var t=GameData.game.checkPass.uid,a=GameData.game.checkPass.card;this.showPassActions(t,a)||MjHandler.getInstance().requestPass(function(e){}),GameData.game.checkPass={}}},showYoujinActin:function(){var e=0;this.actions=[];var t=GameData.getMyHandCards(),a=v.instance.canZimo(t,0);if(0<a.length&&0<a[0].length&&a[3]){var n=GameData.cards[GameData.player.uid].youNum;cc.log("showYoujinActin youNum:"+n),10!=n&&(this.actions[e]={act:"youjin",deck:a[4],zimo:!0},this.createActionBtn(++e,"youjin.png"))}if(GameData.game.turn==GameData.player.uid){var i=0;for(var o in GameData.cards){var r=GameData.cards[o].youNum;if(10==r||3==r){i=o;break}}if(i<=0){var s=this.checkGangAction(GameData.player.uid,GameData.game.obtain,!0);0<s.length&&this.showGangAction(++e,s)}}if(0<e){for(;++e<=4;){cc.find("btnAct"+e,this.actionLayer).active=!1}cc.find("btnPass",this.actionLayer).active=!0,this.actionLayer.active=!this.actionSecondaryLayer.active}else this.actionLayer.active=!1},showPassActions:function(e,t){var a=0,n=this;n.actions=[];var i=GameData.game.checkPass.qiang,o=v.instance.canChi(e,t);i<=0&&0<o.length&&this.showChiAction(++a,t,o);var r=this.checkGangAction(e,t,!1);if(i<=0&&0<r.length&&this.showGangAction(++a,r),i<=0&&v.instance.canPeng(e,t)&&(n.actions[a]={act:"peng",card:t},n.createActionBtn(++a,"peng.png"),2<=a||(n.moveBackMyCards(),n.moveUpMyCards(t,2))),2<=a);else if(1==o.length){this.moveBackMyCards();for(var s=0;s<o.length;s++)for(var c=o[s],d=0;d<c.length;d++)this.moveUpMyCards(c[d],1)}var h=v.instance.canDianPao(e,t);if(cc.log("client test canDianPao:"+JSON.stringify(h)),0<h.length&&0<h[0].length&&(n.actions[a]={act:"dianpao",type:h[0],deck:h[1],obtain:h[2]},n.createActionBtn(++a,"hu.png")),cc.find("btnPass",n.actionLayer).active=!0,0<a){for(;++a<=4;){cc.find("btnAct"+a,n.actionLayer).active=!1}n.actionLayer.active=!this.actionSecondaryLayer.active}else n.actionLayer.active=!1;return 0<a},showObtainActions:function(e,t){var a=0,n=this;n.actions=[];var i=0;for(var o in GameData.cards){var r=GameData.cards[o].youNum;if(10==r||3==r){i=o;break}}var s=GameData.getMyHandCards(),c=(GameData.cards[GameData.player.uid].youNum,v.instance.canZimo(s,t,!0));(cc.log("canZimo huData:"+JSON.stringify(c)),0<c.length&&0<c[0].length)&&(1==this.huBtnIsShow&&(n.actions[a]={act:"hu",type:c[0],deck:c[1],obtain:c[2]},n.createActionBtn(++a,"hu.png")),c[3]&&GameData.cards[GameData.player.uid].youRound!=GameData.game.cardleft&&0==i&&(n.actions[a]={act:"youjin",deck:c[4],zimo:!0},n.createActionBtn(++a,"youjin.png")));if(i<=0){var d=this.checkGangAction(e,t,!0);0<d.length&&this.showGangAction(++a,d),cc.find("btnPass",n.actionLayer).active=!0}else{cc.find("btnPass",n.actionLayer).active=!1}if(a<=0){if(0<i&&i!=GameData.player.uid)return void MjHandler.getInstance().requestDisCard(0,function(){});n.actionLayer.active=!1}else{for(;++a<=4;){cc.find("btnAct"+a,n.actionLayer).active=!1}n.actionLayer.active=!this.actionSecondaryLayer.active}return 0<a},showGangAction:function(e,t){if(this.actionSecondaryLayer.active)this.actions[e-1]={act:"manygang",card:t},this.createActionBtn(e,"gang.png"),this.refreshGangActionBar({act:"manygang",card:t});else if(1==t.length){var a=t[0].card;this.actions[e-1]={act:t[0].act,card:a},this.createActionBtn(e,"gang.png"),2<=e||(this.moveBackMyCards(),this.moveUpMyCards(a,4))}else 1<t.length&&(this.actions[e-1]={act:"manygang",card:t},this.createActionBtn(e,"gang.png"))},checkGangAction:function(e,t,a){var n=new Array;if(a){var i=v.instance.canMingGangSelf();if(0<i&&n.push({act:"selfgang",card:i}),0!=GameData.game.cardleft&&e==GameData.player.uid){var o=GameData.getMyHandCards();for(var r in o)4<=o[r]&&n.push({act:"angang",card:r})}}else{var s=v.instance.canMingGang(e,t);0<s&&n.push({act:"minggang",card:s})}return n},showChiAction:function(e,t,a){1==a.length?(this.actions[e-1]={act:"chi",card:t,myCards:a},this.createActionBtn(e,"chi.png")):1<a.length&&(this.actions[e-1]={act:"chi",card:t,myCards:a},this.createActionBtn(e,"chi.png"))},refreshChiActionType:function(e){this.chiActionList=[],this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0;for(var n=0;n<e.myCards.length;n++){var i=e.myCards[n];this.chiActionList.push(i);var o=GameData.game.lastdisCard,r=cc.instantiate(a);contains(i,o)||i.push(o),i=i.sort(),r.name=n+"";for(var s=0;s<i.length;s++){var c=cc.find("card_"+s,r);c.getComponent(cc.Sprite).spriteFrame=null;var d="resources/mjcard2d/mj_face_xia_shou_"+i[s]+".png",h=cc.textureCache.addImage(cc.url.raw(d));if(c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h),i[s]==o){var l=c.getChildByName(c.name+"_biao");null==l&&((l=cc.instantiate(this.cardTingPrefab)).y=l.y-10,c.addChild(l),l.name=c.name+"_biao")}c.active=!0}r.getComponent(cc.Sprite).spriteFrame=null,r.on(cc.Node.EventType.TOUCH_START,this.onClickChiActionBtn,this),t.addChild(r),r.width=252}a.active=!1},onClickChiActionBtn:function(e){for(var t=e.target.name,a=this.chiActionList[t],n=GameData.game.lastdisCard,i=0;i<a.length;i++)a[i]==n&&a.splice(i,1);var o=this;null!=a&&MjHandler.getInstance().requestChiCard(n,a,function(e){0==e.result&&o.showEffect("chi")}),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},createActionBtn:function(e,t){cc.log("show btn:"+t);var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw("resources/table/action/"+t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){var a=this,n=this.actions[t];"hu"==n.act&&MjHandler.getInstance().requestHu(n.type,n.deck,n.obtain,function(e){0==e.result&&a.showEffect("hu")}),"dianpao"==n.act?MjHandler.getInstance().requestDianPao(n.type,n.deck,n.obtain,function(e){0==e.result&&a.showEffect("hu")}):"youjin"==n.act?GameData.game.cardleft<=16+GameData.joiners.length+GameData.getAllGangNumber()?createMessageBox("如果继续游金，可能会荒庄",function(){MjHandler.getInstance().requestYoujin(n.deck,n.zimo,function(e){if(0==e.result){a.showEffect("youjin");GameData.cards[GameData.player.uid].youNum}})},function(){a.actionLayer.active=!0}):MjHandler.getInstance().requestYoujin(n.deck,n.zimo,function(e){if(0==e.result){a.showEffect("youjin");var t=GameData.cards[GameData.player.uid].youNum;2!=t&&3!=t||MjHandler.getInstance().requestDisCard(GameData.game.cardHuier1,function(e){})}}):"chi"==n.act?(this.huBtnIsShow=!1,n.myCards.length<=1?MjHandler.getInstance().requestChiCard(n.card,n.myCards[0],function(e){0==e.result&&a.showEffect("chi")}):this.refreshChiActionType(n)):"peng"==n.act?(this.huBtnIsShow=!1,MjHandler.getInstance().requestPengCard(n.card,function(e){0==e.result&&a.showEffect("peng")})):"manygang"==n.act?(cc.log("------------------\x3e click gang, should open gang ui, data.card "+n.card),this.refreshGangActionBar(n)):"minggang"==n.act?(this.huBtnIsShow=!0,MjHandler.getInstance().requestGangMingCard(n.card,function(e){0==e.result&&a.showEffect("gang")})):"selfgang"==n.act?(this.huBtnIsShow=!0,MjHandler.getInstance().requestGangMingSelfCard(n.card,function(e){0==e.result&&a.showEffect("gang")})):"angang"==n.act&&(this.huBtnIsShow=!0,MjHandler.getInstance().requestGangAnCard(n.card,function(e){0==e.result&&a.showEffect("gang")})),this.moveBackMyCards(),a.actionLayer.active=!1},refreshGangActionBar:function(e){this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0,this.gangActionList=new Array;for(var n=0;n<e.card.length;n++){var i=e.card[n];this.gangActionList.push(i);var o=cc.instantiate(a);o.name=n+"",o.getComponent(cc.Sprite).spriteFrame=null;var r="resources/mjcard2d/mj_face_xia_shou_"+i.card+".png",s=cc.textureCache.addImage(cc.url.raw(r));o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),o.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(o)}a.active=!1},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){cc.log(e.target.name);var t=e.target.name,a=this.gangActionList[t],n=this;null!=a&&("minggang"==a.act?MjHandler.getInstance().requestGangMingCard(a.card,function(e){0==e.result&&n.showEffect("gang")}):"selfgang"==a.act?MjHandler.getInstance().requestGangMingSelfCard(a.card,function(e){0==e.result&&n.showEffect("gang")}):"angang"==a.act&&MjHandler.getInstance().requestGangAnCard(a.card,function(e){0==e.result&&n.showEffect("gang")})),this.gangActionList.length<=1&&(this.actionSecondaryLayer.active=!1),this.moveBackMyCards()},onBtnPassClicked:function(e){cc.log("onBtnPassClicked"),cc.log("GameData.cards "+JSON.stringify(GameData.cards));var t=this,a=0;for(var n in GameData.cards){var i=GameData.cards[n].youNum;if(10==i||3==i){a=n;break}}var o=this.actions,r=!1;for(var s in cc.log("data "+JSON.stringify(o)),o)if("hu"==o[s].act||"youjin"==o[s].act||"dianpao"==o[s].act){r=!0;break}r?createMessageBox("确定要过牌吗？",function(){0<a?a==GameData.player.uid?MjHandler.getInstance().requestCancelYoujin(function(e){}):(MjHandler.getInstance().requestDisCard(0,function(){}),MjHandler.getInstance().requestPass(function(e){})):MjHandler.getInstance().requestPass(function(e){}),t.actionLayer.active=!1,t.actionSecondaryLayer.active=!1,t.moveBackMyCards(),t.selectedCard=-1},function(){}):(0<a?a==GameData.player.uid?MjHandler.getInstance().requestCancelYoujin(function(e){}):MjHandler.getInstance().requestPass(function(e){}):MjHandler.getInstance().requestPass(function(e){}),t.actionLayer.active=!1,t.actionSecondaryLayer.active=!1,t.moveBackMyCards(),t.selectedCard=-1),cc.log("onBtnPassClicked turn:"+GameData.game.turn+" uid:"+GameData.player.uid)},allYouJinShow:function(){if(GameData.allYouJinInfo){if(console.log("-------allYoujin data---------  "+JSON.stringify(GameData.allYouJinInfo.length)),0==GameData.allYouJinInfo.length)return void this.showYoujinActin();for(var e=0;e<GameData.allYouJinInfo.length;e++)if(GameData.allYouJinInfo[e].uid==GameData.player.uid){var t=GameData.allYouJinInfo[e];return 0==t.youNum?(this.showYoujinActin(),t.isSelectYou1?this.actionLayer.active=!1:this.showYoujinActin()):10==t.youNum?this.actionLayer.active=!1:1==t.youNum?t.isSelectYou2?this.actionLayer.active=!1:this.showYoujinActin():2==t.youNum&&(t.isSelectYou3?this.actionLayer.active=!1:this.showYoujinActin()),void(GameData.allYouJinInfo=null)}}},showCards:function(){var e=GameData.getPlayerByPos("down");e&&GameData.cards[e.uid]?(this.play_layer_down.active=!0,this.showMyHandCards(e,this.play_layer_down),this.showDisCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showPengCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showHua(e,this.play_layer_down,"down"),this.showYoujin(e,this.play_layer_down)):this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameData.cards[e.uid]?(this.play_layer_right.active=!0,this.showHandCards(e,this.play_layer_right),this.showDisCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showPengCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showHua(e,this.play_layer_right,"right"),this.showYoujin(e,this.play_layer_right)):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("up"))&&GameData.cards[e.uid]?(this.play_layer_up.active=!0,this.showHandCards(e,this.play_layer_up),this.showDisCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showPengCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showHua(e,this.play_layer_up,"up"),this.showYoujin(e,this.play_layer_up)):this.play_layer_up.active=!1,(e=GameData.getPlayerByPos("left"))&&GameData.cards[e.uid]?(this.play_layer_left.active=!0,this.showHandCards(e,this.play_layer_left),this.showDisCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showPengCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showHua(e,this.play_layer_left,"left"),this.showYoujin(e,this.play_layer_left)):this.play_layer_left.active=!1,this.showCardNum(),this.showHuierCard()},showHua:function(e,t,a){if(e){var n=e.uid,i=GameData.cards[n].hua.sort();console.log("huacard = "+JSON.stringify(i));for(var o=cc.find("cardhua",t).children,r=0;r<o.length;r++)o[r].active=!1;for(r=0;r<i.length;r++){var s=r+1,c=cc.find("cardhua/"+s,t);c.getComponent(cc.Sprite).spriteFrame=null;var d=this.showHuaTexture(i[r],a),h=cc.textureCache.addImage(cc.url.raw(d));c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h),c.active=!0}}},showHuaTexture:function(e,t){var a="resources/shishi/image/",n="";111==e?n="chun":112==e?n="xia":113==e?n="qiu":114==e?n="dong":121==e?n="mei":122==e?n="lan":123==e?n="zhu":124==e&&(n="ju");var i="";return"down"==t?i="":"right"==t?i="4":"up"==t?i="3":"left"==t&&(i="2"),a=a+n+i+".png"},showHandCards:function(e,t){if(e)for(var a=e.uid,n=GameData.getHandCardNum(a)+3*(GameData.getChiCards(a).length+GameData.getPengCards(a).length+GameData.getGangCards(a).length)>GameData.client.handsize?0:1,i=1,o=0;o<=GameData.client.handsize;o++){var r=cc.find("cardHand/cardHand"+o,t);o==n&&i<=GameData.getHandCardNum(a)?(r.active=!0,n++,i++):r.active=!1}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=30,t<=++a))return}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},showMyHandCards:function(e,t){var a=[],n=!1,i=GameData.getMyHandCards(),o=GameData.getHandCardNum(e.uid),r=o+3*(GameData.getChiCards(e.uid).length+GameData.getPengCards(e.uid).length+GameData.getGangCards(e.uid).length),s=r>GameData.client.handsize?o-1:o;for(var c in cc.log("handNum:"+o+", cardNum:"+r+", nodeIdx:"+s),i)for(var d=0;d<i[c];d++)if(n||c!=GameData.game.obtain)if(v.instance.isHuier(c)){cc.log("showMyHandCards "+s+" "+c);var h=cc.find("cardHand/cardHand"+s,t),l=this.setHandCardDisable(h,c);this.showCardContent(h,"mj_face_xia_shou",c),this.setMyHandButton(h,c,s),this.setMyHuierVisible(h,c),l||this.setMyTingVisible(h,c),h.active=!0,s--}else a.push(c);else n=!0;for(d=0;d<a.length;d++){c=a[d],h=cc.find("cardHand/cardHand"+s,t),l=this.setHandCardDisable(h,c);this.showCardContent(h,"mj_face_xia_shou",c),this.setMyHandButton(h,c,s),this.setMyHuierVisible(h,c),l||this.setMyTingVisible(h,c),h.active=!0,s--}if(n){var u=GameData.game.obtain;h=cc.find("cardHand/cardHand0",t),l=this.setHandCardDisable(h,u);this.showCardContent(h,"mj_face_xia_shou",u),this.setMyHandButton(h,u,0),this.setMyHuierVisible(h,u),l||this.setMyTingVisible(h,u),h.active=!0}else{cc.log("showMyHandCards disable cardHand0"),(h=cc.find("cardHand/cardHand0",t)).active=r>GameData.client.handsize}for(d=r>GameData.client.handsize?o:o+1;d<=GameData.client.handsize;d++){(h=cc.find("cardHand/cardHand"+d,t)).active=!1,cc.log("showMyHandCards disable cardHand"+d)}},setHandCardDisable:function(e,t){var a=!1;if(GameData.game.turn==GameData.player.uid){var n=GameData.cards[GameData.player.uid].youNum;10==n||1==n||2==n?a=!v.instance.checkYoujin(t):3==n&&(a=!v.instance.isHuier(t))}var i=e.getChildByName("mask");if(null==i){var o=(i=new cc.Node("mask")).addComponent(cc.Sprite),r=cc.textureCache.addImage(cc.url.raw("resources/table/majiangmengbai.png"));o.spriteFrame=new cc.SpriteFrame(r),e.addChild(i)}return i.active=a},showDisCards:function(e,t,a,n){var i=cc.find("cardDis_4",t);i&&(i.active=!1);var o=cc.find("cardDis_3",t);o&&(o.active=!1);var r=cc.find("cardDis_2",t);r&&(r.active=!1);var s=cc.find("cardDis_"+GameData.room.joinermax,t);s.active=!0;for(var c=GameData.getDisCards(e.uid),d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,s);if(d<=c.length){var l=c[d-1];h.active=!0,this.showCardContent(h,a,l),e.uid==GameData.game.lastdisUid&&l==GameData.game.lastdisCard&&null!=h&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==n,cc.find("down",this._cardArrow).active="down"==n,cc.find("right",this._cardArrow).active="right"==n,cc.find("up",this._cardArrow).active="up"==n)}else h.active=!1}},checkIsChiArray:function(e){return null!=e&&3==e.length&&parseInt(e[0])!=parseInt(e[1])},checkIsChiDePai:function(e,t){if(null==e||null==t)return-1;for(var a in t){var n=t[a][0];if(0!=this.checkArrayIsSame(e,n))return t[a][1]}return-1},checkArrayIsSame:function(e,t){if(null==e||null==t||e.length!=t.length)return!1;e.sort(function(e,t){return e-t}),t.sort(function(e,t){return e-t});for(var a=0,n=0;n<e.length;n++)e[n]==t[n]&&a++;return a==e.length},removeUsedChiArray:function(e,t){if(null!=e)for(var a in t){var n=t[a][0];if(0!=this.checkArrayIsSame(e,n))return void t.splice(a,1)}},showPengCards:function(e,t,a,n){if(e){for(var i=GameData.getChiCards(e.uid),o=GameData.getSelfChiCards(e.uid),r=0;r<i.length;r++)i[r].sort(function(e,t){return e-t});var s=GameData.getGangCards(e.uid),c=GameData.getPengCards(e.uid),d=s.concat(c,i),h=parseInt(GameData.client.handsize/3),l=[];for(var u in o)l.push(o[u]);for(r=0;r<h;r++){var m=cc.find("cardPeng/cardPeng"+(r+1),t),p=!1;if(r<d.length){for(var g=0;g<4;g++){var f=m.getChildByName("card_face"+(g+1)).getComponent("cc.Sprite");if(g<d[r].length){console.log("n and cards[i].length"+g,d[r].length),f.node.active=!0;var y=d[r][g];if(this.showCardContent(f.node,a,y),1==this.checkIsChiArray(d[r]))if(0==p)this.checkIsChiDePai(d[r],l)==y&&(this.removeUsedChiArray(d[r],l),this.showChiPaiMask(f.node,y,n),p=!0);3==g&&1==v.instance.isHuier(y)&&this.addHuierIcon(f.node,n)}else f.node.active=!1}if(5==d[r].length)if(e.uid!=GameData.player.uid)m.getChildByName("card_back1").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_back2").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_back3").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_back4").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_face1").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_face2").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_face3").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_face4").getComponent("cc.Sprite").node.active=!1;else m.getChildByName("card_back1").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back2").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back3").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back4").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_face1").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_face2").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_face3").getComponent("cc.Sprite").node.active=!0,m.getChildByName("card_face4").getComponent("cc.Sprite").node.active=!1;else m.getChildByName("card_back1").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back2").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back3").getComponent("cc.Sprite").node.active=!1,m.getChildByName("card_back4").getComponent("cc.Sprite").node.active=!1;m.active=!0}else m.active=!1}}},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/shishi/image/youjinbiao_big.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCardContent:function(e,t,a){cc.log("showCardContent:"+a+" "+t);var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1),this.setChiPaiMaskVisible(e,!1)},setMyHandButton:function(e,t,a){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)},setMyHuierVisible:function(e,t){var a=!1;v.instance.isHuier(t)&&(a=!0);var n=e.getChildByName(e.name+"_huier");if(null==n){if(1==a){n=cc.instantiate(this.cardHuierPrefab),e.addChild(n),n.name=e.name+"_huier";var i=cc.textureCache.addImage(cc.url.raw("resources/shishi/image/youjinbiao_big.png"));cc.find("huier_icon",n).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)}}else n.active=a},setMyTingVisible:function(e,t){cc.log("setMyTingVisible card:"+t);for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,GameData.game.turn!=GameData.player.uid&&null!=i&&(i.active=!1)},showTurn:function(){cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1,cc.find("downArrow",this.direction_turn).active=!1,cc.find("rightArrow",this.direction_turn).active=!1,cc.find("upArrow",this.direction_turn).active=!1,cc.find("leftArrow",this.direction_turn).active=!1,console.log("GameData.game.turn = "+GameData.game.turn),console.log("GameData.tablePos[GameData.game.turn] = "+GameData.tablePos[GameData.game.turn]),cc.find(GameData.tablePos[GameData.game.turn],this.direction_turn).active=!0,cc.find(GameData.tablePos[GameData.game.turn]+"Arrow",this.direction_turn).active=!0},showCardNum:function(){GameData.game.cardleft<0||(this.leftCardNumLabel.string=GameData.game.cardleft)},showHuierCard:function(){var e=GameData.game.cardHuier1;if(0<e){var t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e+".png"));this.huiercard1.node.active=!0,this.huiercard1.spriteFrame=new cc.SpriteFrame(t)}},showEffect:function(e){cc.log("show effect: "+e);var t="",n="";switch(e){case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":case"dianpao":t="spine/table/hu",n="a";break;case"chi":t="spine/table/chi",n="a";break;case"bu":t="shishi/animation/bu/bu",n="animation";break;default:return}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},setAllHandCardsBack:function(e){for(var t=0;t<e.parent.childrenCount;t++){var a=cc.find("cardHand/cardHand"+t,this.play_layer_down);a&&a.setPosition(this.myHandsInitPosition[t])}},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;GameData.game.turn==GameData.player.uid&&(0!=this.tingTip.getTingNodeActive()&&this.tingTip.getTingSelectCard()==t||(this.tingTip.show(t,this.tingData),this.showMask(t)))},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e),this.tingTip.hide();break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){this.tingTip.hide()},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down),i=n.getChildByName("mask"),o=!!i&&i.active,r=this;if(this.selectedCard==a)this.selectedCard=-1,this.tingTip.hide(),o?this.moveBackMyCards():MjHandler.getInstance().requestDisCard(t,function(e){n.stopAllActions(),r.moveBackMyCards(),r.huBtnIsShow=!0});else{if(0<=this.selectedCard)cc.find("cardHand/cardHand"+this.selectedCard,this.play_layer_down).runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[this.selectedCard].x,0))),this.tingTip.hide();n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,GameData.game.turn!=GameData.player.uid||o||0!=this.tingTip.getTingNodeActive()&&this.tingTip.getTingSelectCard()==t||(this.tingTip.show(t,this.tingData),this.showMask(t))}},showMask:function(e){var t=GameData.getPlayerByPos("up");t&&(this.showPengCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_up,"up")),(t=GameData.getPlayerByPos("down"))&&(this.showPengCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_down,"down")),(t=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_left,"left")),(t=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,t,a)}}},showDisCardMask:function(e,t,a){for(var n=1;n<=this.discardMax;n++){var i=cc.find("cardDis_"+GameData.room.joinermax+"/card_face"+n,t);i.active&&this.gotoMask(i,e,t,a)}},gotoMask:function(e,t,a,n){var i=e.getComponent("Card");if(null!=i){var o=t==i.id,r=this.setMaskVisible(e,o);null!=r&&(cc.find("tipMask/up",r).active=!1,cc.find("tipMask/down",r).active=!1,cc.find("tipMask/right",r).active=!1,cc.find("tipMask/left",r).active=!1,cc.find("tipMask/"+n,r).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask",cc.find("tipMask",a).active=!0,cc.find("chipaiMask",a).active=!1):cc.find("tipMask",a).active=t,a},setChiPaiMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask",cc.find("tipMask",a).active=!1,cc.find("chipaiMask",a).active=!0):cc.find("chipaiMask",a).active=t,a},showChiPaiMask:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i=t==n.id,o=this.setChiPaiMaskVisible(e,i);null!=o&&(cc.find("chipaiMask/up",o).active=!1,cc.find("chipaiMask/down",o).active=!1,cc.find("chipaiMask/right",o).active=!1,cc.find("chipaiMask/left",o).active=!1,cc.find("chipaiMask/"+a,o).active=!0)}},onGameScore:function(){this.tingTip.hide(),this.unschedule(this.runCountDown),this.PLayerUID=null},startCoundDown:function(e){this.PLayerUID=e.detail,this._countdown_index=10,this.schedule(this.runCountDown,1)},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t,a,n=e.split("");if(0!=n.length){if(1==n.length)t=cc.url.raw("resources/number/jinzi0.png"),a=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=n.length)return;t=cc.url.raw("resources/number/jinzi"+n[0]+".png"),a=cc.url.raw("resources/number/jinzi"+n[1]+".png")}var i=cc.textureCache.addImage(t);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i);var o=cc.textureCache.addImage(a);this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},onGameStartHandler:function(){this.mapNode.active=!1},showScoreLayer:function(){this.getComponent("roomScore-shishi").ShowPlayerScoreItem(),this.scoreLayer.active=!0},mapCondition:function(){},showMap:function(e){},showChaShuiLayer:function(){this.chashuiLayer.active=!0,cc.log("showChaShuiLayer")}});t.exports=i,cc._RF.pop()},{SoundMngr:"SoundMngr",ruleHandler:"ruleHandler"}],roomTable:[function(e,t,a){"use strict";cc._RF.push(t,"cd33aLVCSlAKp/kIHh/+3BJ","roomTable");var n=e("SoundMngr"),i=e("gameDefine"),o=e("roomHandler"),p=e("ruleHandler"),r=e("errorCode"),s=cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,huiercard1:cc.Sprite,huiercard2:cc.Sprite,leftCardNumLabel:cc.Label,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,cardsNode:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,cardTemplate:cc.Prefab,playerTemplate:cc.Prefab,selectedCard:-1,HuType:null,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,disCardArrow:cc.Prefab,_cardArrow:cc.Node,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,lastRoundLabel:cc.RichText,scoreLayer:cc.Node,roundNowNum:0,mapNode:cc.Node,mapLayer:cc.Node},onLoad:function(){registEvent("onGameStart",this,this.handleGameStart),registEvent("onGameTurn",this,this.handleTurn),registEvent("onGamePass",this,this.handlePass),registEvent("initCards",this,this.onShow),registEvent("onCardObtain",this,this.handleObtain),registEvent("onCardDis",this,this.handleDisCard),registEvent("onCardHu",this,this.handleHuCard),registEvent("onCardPeng",this,this.handlePengCard),registEvent("onCardGang",this,this.handleGangCard),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),registEvent("onGameScore",this,this.onGameScore),this.actions=new Array,this.cardsNode.active=!1,this.tingData=[],this.tingTip=this.node.getComponent("TingTip"),this.playerSex=1,4==GameData.room.joinermax&&(this.discardMax=24),3==GameData.room.joinermax&&(this.discardMax=36),2==GameData.room.joinermax&&(this.discardMax=60),this._cardArrow=cc.instantiate(this.disCardArrow),this.cardsNode.addChild(this._cardArrow),this._cardArrow.active=!1,this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),GameData.game.gameStart&&this.handleGameStart(),GameData.game.initcards&&this.onShow(),GameData.game.checkPass.uid&&this.handlePass(),0<GameData.game.obtain&&this.handleObtain()},onDestroy:function(){unregistEvent("onGameStart",this,this.handleGameStart),unregistEvent("onGameTurn",this,this.handleTurn),unregistEvent("onGamePass",this,this.handlePass),unregistEvent("initCards",this,this.onShow),unregistEvent("onCardObtain",this,this.handleObtain),unregistEvent("onCardDis",this,this.handleDisCard),unregistEvent("onCardHu",this,this.handleHuCard),unregistEvent("onCardPeng",this,this.handlePengCard),unregistEvent("onCardGang",this,this.handleGangCard),unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel),unregistEvent("onGameScore",this,this.onGameScore)},handleGameStart:function(){this.showPosition(),this.cardsNode.active=!1,this.spineNode.active=!1,this.tingTip.hide(),this.onGameStartHandler()},onShow:function(e){this.moveBackMyCards(),this.showCards(),this.cardsNode.active=!0,console.log("GameData.game.roundNum + '/' + GameData.game.roundmax",GameData.game.roundNum,GameData.game.roundmax);var t=GameData.game.roundNum>GameData.game.roundmax?GameData.game.roundmax:GameData.game.roundNum;this.lastRoundLabel.string=t+"/"+GameData.game.roundmax},handleTurn:function(e){this.showTurn(),this.startCoundDown(e)},handleObtain:function(e){if(GameData.game.turn==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=p.instance.discardTip(t),n.instance.playAudioOther("click")}this.showCards(),GameData.game.turn==GameData.player.uid&&this.showObtainActions(GameData.player.uid,GameData.game.obtain)},handleDisCard:function(e){console.log("this.playerSex =  GameData.player.sex",e.detail.player,GameData.player.sex),this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudio("dis",e.detail.card,this.playerSex),n.instance.playAudioOther("out"),this.tingTip.hide(),this.showCards()},handlePengCard:function(e){if(e.detail.player==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=p.instance.discardTip(t)}this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudio("peng",null,this.playerSex),this.showCards(),this.playActionAnimation(e.detail.player,"peng")},handleGangCard:function(e){if(e.detail.player==GameData.player.uid){var t=GameData.getMyHandCards();this.tingData=p.instance.discardTip(t)}this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudio("gang",null,this.playerSex),this.showCards(),this.playActionAnimation(e.detail.player,"gang")},handleHuCard:function(e){cc.log("=...........................",e.detail),null!=e.detail.player&&(this.HuType=e.detail,this.playerSex=GameData.getPlayerSexByUid(e.detail.player),n.instance.playAudio("hu",e.detail,this.playerSex),this.scheduleOnce(function(){n.instance.playAudioHu(this.HuType,this.playerSex)},1),this.playActionAnimation(e.detail.player,"hu"),this.actionLayer.active=!1,this.lastRoundLabel.string=this.roundNowNum+"/"+GameData.game.roundmax)},playActionAnimation:function(e,t){if(null!=GameData.joiners){var a=GameData.tablePos[e],n=cc.find("layer_ui/layer_ui_table/actionAnimations/"+a,this.node);cc.log("---\x3e animationNode : "+n),null!=n&&(cc.log("---\x3e playActionAnimation : "+t),n.getComponent(cc.Animation).play(t))}},handlePass:function(e){if(GameData.game.checkPass.uid){var t=GameData.game.checkPass.uid,a=GameData.game.checkPass.card;this.showPassActions(t,a)||MjHandler.getInstance().requestPass(function(e){}),GameData.game.checkPass={}}},showPassActions:function(e,t){var a=0;this.actions=[],p.instance.canPeng(e,t)&&(this.actions[a]={act:"peng",card:t},this.createActionBtn(++a,"peng.png"),this.moveBackMyCards(),this.moveUpMyCards(t,2));var n=this.checkGangAction(e,t,!1);if(0<n.length&&this.showGangAction(++a,n),0<a){for(;++a<=4;){cc.find("btnAct"+a,this.actionLayer).active=!1}this.actionLayer.active=!this.actionSecondaryLayer.active}else this.actionLayer.active=!1;return 0<a},showObtainActions:function(e,t){var a=0;this.actions=[],cc.log("GameData.myCardObj: "+JSON.stringify(GameData.getMyHandCards()));var n=GameData.getMyHandCards(),i=p.instance.canZimo(n,t,!0);0!=i&&i[0]&&0<i[0].length&&(cc.log("client test canZimo"),this.actions[a]={act:"hu",type:i[0],deck:i[1],obtain:i[2]},this.createActionBtn(++a,"hu.png"));var o=this.checkGangAction(e,t,!0);if(0<o.length&&this.showGangAction(++a,o),0<a){for(;++a<=4;){cc.find("btnAct"+a,this.actionLayer).active=!1}this.actionLayer.active=!this.actionSecondaryLayer.active}else this.actionLayer.active=!1;return 0<a},showGangAction:function(e,t){if(this.actionSecondaryLayer.active)this.actions[e-1]={act:"manygang",card:t},this.createActionBtn(e,"gang.png"),this.refreshGangActionBar({act:"manygang",card:t});else if(1==t.length){var a=t[0].card;this.actions[e-1]={act:t[0].act,card:a},this.createActionBtn(e,"gang.png"),this.moveBackMyCards(),this.moveUpMyCards(a,4)}else 1<t.length&&(this.actions[e-1]={act:"manygang",card:t},this.createActionBtn(e,"gang.png"))},checkGangAction:function(e,t,a){var n=new Array;if(a){for(var i=p.instance.canMingGangSelf(),o=0;o<i.length;o++)0<i[o]&&n.push({act:"selfgang",card:i[o]});if(0!=GameData.game.cardleft&&e==GameData.player.uid){var r=GameData.getMyHandCards();for(var s in r)4<=r[s]&&n.push({act:"angang",card:s})}}else{var c=p.instance.canMingGang(e,t);0<c&&n.push({act:"minggang",card:c})}return n},createActionBtn:function(e,t){cc.log("show btn:"+t);var a=cc.find("btnAct"+e,this.actionLayer),n=cc.textureCache.addImage(cc.url.raw("resources/table/action/"+t));a.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(n),a.active=!0},onBtnActionClicked:function(e,t){cc.log("onBtnActionClicked, index : "+t);for(var a=0;a<this.actions.length;a++)cc.log(this.actions[a].act+","+this.actions[a].card);var n=this,i=this.actions[t];"hu"==i.act?MjHandler.getInstance().requestHu(i.type,i.deck,i.obtain,function(e){0==e.result&&n.showEffect("hu")}):"peng"==i.act?MjHandler.getInstance().requestPengCard(i.card,function(e){0==e.result&&n.showEffect("peng")}):"manygang"==i.act?(cc.log("------------------\x3e click gang, should open gang ui, data.card "+i.card),this.refreshGangActionBar(i)):"minggang"==i.act?MjHandler.getInstance().requestGangMingCard(i.card,function(e){0==e.result&&n.showEffect("gang")}):"selfgang"==i.act?MjHandler.getInstance().requestGangMingSelfCard(i.card,function(e){0==e.result&&n.showEffect("gang")}):"angang"==i.act&&MjHandler.getInstance().requestGangAnCard(i.card,function(e){0==e.result&&n.showEffect("gang")}),this.moveBackMyCards(),n.actionLayer.active=!1},refreshGangActionBar:function(e){this.actionSecondaryLayer.active=!0;var t=cc.find("cardLayout",this.actionSecondaryLayer);t.removeAllChildren();var a=cc.find("card",this.actionSecondaryLayer);a.active=!0,this.gangActionList=new Array;for(var n=0;n<e.card.length;n++){var i=e.card[n];this.gangActionList.push(i);var o=cc.instantiate(a);o.name=n+"",o.getComponent(cc.Sprite).spriteFrame=null;var r="resources/mjcard2d/mj_face_xia_shou_"+i.card+".png",s=cc.textureCache.addImage(cc.url.raw(r));o.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(s),o.on(cc.Node.EventType.TOUCH_START,this.onClickActionSecondaryBtn,this),t.addChild(o)}a.active=!1},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},onClickActionSecondaryBtn:function(e){cc.log(e.target.name);var t=e.target.name,a=this.gangActionList[t],n=this;null!=a&&("minggang"==a.act?MjHandler.getInstance().requestGangMingCard(a.card,function(e){0==e.result&&n.showEffect("gang")}):"selfgang"==a.act?MjHandler.getInstance().requestGangMingSelfCard(a.card,function(e){0==e.result&&n.showEffect("gang")}):"angang"==a.act&&MjHandler.getInstance().requestGangAnCard(a.card,function(e){0==e.result&&n.showEffect("gang")})),this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},onBtnPassClicked:function(e){GameData.game.turn!=GameData.player.uid&&MjHandler.getInstance().requestPass(function(e){});for(var t=0;t<this.actions.length;t++)"peng"==this.actions[t].act&&MjHandler.getInstance().requestPass(function(e){}),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.moveBackMyCards()},showCards:function(){var e=GameData.getPlayerByPos("down");e&&GameData.cards[e.uid]?(this.play_layer_down.active=!0,this.showMyHandCards(e,this.play_layer_down),this.showDisCards(e,this.play_layer_down,"mj_face_xia_chu","down"),this.showPengCards(e,this.play_layer_down,"mj_face_xia_chu","down")):this.play_layer_down.active=!1,(e=GameData.getPlayerByPos("right"))&&GameData.cards[e.uid]?(this.play_layer_right.active=!0,this.showHandCards(e,this.play_layer_right),this.showDisCards(e,this.play_layer_right,"mj_face_you_chu","right"),this.showPengCards(e,this.play_layer_right,"mj_face_you_chu","right")):this.play_layer_right.active=!1,(e=GameData.getPlayerByPos("up"))&&GameData.cards[e.uid]?(this.play_layer_up.active=!0,this.showHandCards(e,this.play_layer_up),this.showDisCards(e,this.play_layer_up,"mj_face_shang_shou","up"),this.showPengCards(e,this.play_layer_up,"mj_face_shang_shou","up")):this.play_layer_up.active=!1,(e=GameData.getPlayerByPos("left"))&&GameData.cards[e.uid]?(this.play_layer_left.active=!0,this.showHandCards(e,this.play_layer_left),this.showDisCards(e,this.play_layer_left,"mj_face_zuo_chu","left"),this.showPengCards(e,this.play_layer_left,"mj_face_zuo_chu","left")):this.play_layer_left.active=!1,this.showCardNum(),this.showHuierCard()},showHandCards:function(e,t){if(e)for(var a=e.uid,n=GameData.getHandCardNum(a)+3*(GameData.getChiCards(a).length+GameData.getPengCards(a).length+GameData.getGangCards(a).length)>GameData.client.handsize?0:1,i=1,o=0;o<=GameData.client.handsize;o++){var r=cc.find("cardHand/cardHand"+o,t);o==n&&i<=GameData.getHandCardNum(a)?(r.active=!0,n++,i++):r.active=!1}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=43,t<=++a))return}},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},showMyHandCards:function(e,t){var a=GameData.getHandCardNum(e.uid),n=cc.find("cardHand/cardHand0",t),i=GameData.getMyHandCards(),o=[];if(GameData.game.turn==e.uid){if(0<GameData.game.obtain){var r=GameData.game.obtain;this.showCardContent(n,"mj_face_xia_shou",r),this.setMyHandButton(n,r,0),this.setMyHuierVisible(n,r,"down"),this.setMyTingVisible(n,r),n.active=!0}else for(var s in i)s==GameData.game.lastdisCard&&2<=i[s]&&o.push(s);0<o.length?(n.active=!1,o=[]):a--}else n.active=!1;var c=[],d=(i=GameData.getMyHandCards(),a),h=!1;for(var s in i)for(var l=0;l<i[s];l++)if(h||s!=GameData.game.obtain)if(p.instance.isHuier(s)){n=cc.find("cardHand/cardHand"+d,t);this.showCardContent(n,"mj_face_xia_shou",s),this.setMyHandButton(n,s,d),this.setMyHuierVisible(n,s,"down"),this.setMyTingVisible(n,s),n.active=!0,d--}else c.push(s);else h=!0;for(l=0;l<c.length;l++){s=c[l],n=cc.find("cardHand/cardHand"+d,t);this.showCardContent(n,"mj_face_xia_shou",s),this.setMyHandButton(n,s,d),this.setMyHuierVisible(n,s,"down"),this.setMyTingVisible(n,s),n.active=!0,d--}for(l=a+1;l<=GameData.client.handsize;l++){(n=cc.find("cardHand/cardHand"+l,t)).active=!1}},showDisCards:function(e,t,a,n){var i=cc.find("cardDis_4",t);i&&(i.active=!1);var o=cc.find("cardDis_3",t);o&&(o.active=!1);var r=cc.find("cardDis_2",t);r&&(r.active=!1),console.log("22222"+GameData.room.joinermax);var s=cc.find("cardDis_"+GameData.room.joinermax,t);s.active=!0;for(var c=GameData.getDisCards(e.uid),d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,s);if(d<=c.length){var l=c[d-1];h.active=!0,this.showCardContent(h,a,l),e.uid==GameData.game.lastdisUid&&l==GameData.game.lastdisCard&&null!=h&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==n,cc.find("down",this._cardArrow).active="down"==n,cc.find("right",this._cardArrow).active="right"==n,cc.find("up",this._cardArrow).active="up"==n)}else h.active=!1}},showPengCards:function(e,t,a,n){if(e)for(var i=GameData.getGangCards(e.uid),o=GameData.getPengCards(e.uid),r=i.concat(o),s=parseInt(GameData.client.handsize/3),c=0;c<s;c++){var d=cc.find("cardPeng/cardPeng"+(c+1),t);if(c<r.length){for(var h=0;h<4;h++){var l=d.getChildByName("card_face"+(h+1)).getComponent("cc.Sprite");if(h<r[c].length){l.node.active=!0;var u=r[c][h];this.showCardContent(l.node,a,u);u=r[c][h];3==h&&1==p.instance.isHuier(u)&&this.addHuierIcon(l.node,n)}else l.node.active=!1}if(5==r[c].length){l=d.getChildByName("card_face4").getComponent("cc.Sprite");var m=d.getChildByName("card_back4").getComponent("cc.Sprite");l.node.active=!1,m.node.active=!0}else{(m=d.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1}d.active=!0}else d.active=!1}},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/table/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)},setMyHandButton:function(e,t,a){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)},setMyHuierVisible:function(e,t,a){var n=!1;p.instance.isHuier(t)&&(n=!0);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&(i=cc.instantiate(this.cardHuierPrefab),cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0,i.y=i.y-18,e.addChild(i),i.name=e.name+"_huier"):i.active=n},setMyTingVisible:function(e,t){for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,GameData.game.turn!=GameData.player.uid&&null!=i&&(i.active=!1)},showPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:3==e?t=0:2==e?t=270:1==e&&(t=180),this.direction_pos.node.rotation=t},showTurn:function(){var e,t=GameData.getPlayerIndex(GameData.game.turn);e=0==t?"dong":3==t?"nan":2==t?"xi":1==t?"bei":"dong";var a=cc.textureCache.addImage(cc.url.raw("resources/table/"+e+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(a),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1,cc.find(GameData.tablePos[GameData.game.turn],this.direction_turn).active=!0},showCardNum:function(){GameData.game.cardleft<0||(this.leftCardNumLabel.string=GameData.game.cardleft)},showHuierCard:function(){var e=GameData.game.cardHuier1;if(0<e){var t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e+".png"));this.huiercard1.spriteFrame=new cc.SpriteFrame(t)}var a=GameData.game.cardHuier2;if(0<a){t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+a+".png"));this.huiercard2.spriteFrame=new cc.SpriteFrame(t)}},showEffect:function(e){cc.log("show effect: "+e);var t="",n="";switch(e){case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":t="spine/table/hu",n="a"}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e),this.tingTip.hide();break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){this.tingTip.hide()},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down),i=this;if(this.selectedCard==a)p.instance.isHuier(t)?createMessageBox("您是否确认将混儿牌打出，若打出将不能胡任何牌型，请谨慎选择。",function(){MjHandler.getInstance().requestDisCard(t,function(e){e.result==r.Success&&(n.stopAllActions(),i.selectedCard=-1,i.moveBackMyCards(),sendEvent("onCardHand"),p.instance.isHuier(t)&&(GameData.player.isXiangGong=!0))})},function(){i.selectedCard=-1,i.moveBackMyCards()}):MjHandler.getInstance().requestDisCard(t,function(e){e.result==r.Success&&(n.stopAllActions(),i.selectedCard=-1,i.moveBackMyCards(),sendEvent("onCardHand"),p.instance.isHuier(t)&&(GameData.player.isXiangGong=!0))}),this.tingTip.hide();else{if(0<=this.selectedCard)cc.find("cardHand/cardHand"+this.selectedCard,this.play_layer_down).runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[this.selectedCard].x,0)));n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,GameData.game.turn==GameData.player.uid&&(this.tingTip.show(t,this.tingData),this.showMask(t))}},showMask:function(e){var t=GameData.getPlayerByPos("up");t&&(this.showPengCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_up,"up")),(t=GameData.getPlayerByPos("down"))&&(this.showPengCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_down,"down")),(t=GameData.getPlayerByPos("left"))&&(this.showPengCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_left,"left")),(t=GameData.getPlayerByPos("right"))&&(this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_right,"right"))},showPengCardMask:function(e,t,a){for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,t,a)}}},showDisCardMask:function(e,t,a){for(var n=1;n<=this.discardMax;n++){var i=cc.find("cardDis_"+GameData.room.joinermax+"/card_face"+n,t);i.active&&this.gotoMask(i,e,t,a)}},gotoMask:function(e,t,a,n){var i=e.getComponent("Card");if(null!=i){var o=t==i.id,r=this.setMaskVisible(e,o);null!=r&&(cc.find("up",r).active=!1,cc.find("down",r).active=!1,cc.find("right",r).active=!1,cc.find("left",r).active=!1,cc.find(n,r).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},onGameScore:function(){this.tingTip.hide(),this.unschedule(this.runCountDown)},startCoundDown:function(e){this.PLayerUID=e.detail,this._countdown_index=10,this.schedule(this.runCountDown,1),this.roundNowNum=GameData.game.roundNum},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.PLayerUID==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t,a,n=e.split("");if(0!=n.length){if(1==n.length)t=cc.url.raw("resources/number/jinzi0.png"),a=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=n.length)return;t=cc.url.raw("resources/number/jinzi"+n[0]+".png"),a=cc.url.raw("resources/number/jinzi"+n[1]+".png")}var i=cc.textureCache.addImage(t);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i);var o=cc.textureCache.addImage(a);this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},showScoreLayer:function(){this.getComponent("roomScore").ShowPlayerScoreItem(),this.scoreLayer.active=!0},mapCondition:function(){var e;if(o.room.opts.roomType!=i.roomType.Room_Match&&(this.getComponent("AMapPanel").showPlayers(),""!=(e=GameData.danger?"resources/table/map/weixian.png":"resources/table/map/anquan.png"))){console.log("iconUrl = "+e);var t=cc.textureCache.addImage(cc.url.raw(e));this.mapNode.getComponent(cc.Sprite).spriteFrame=null,this.mapNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t),this.mapNode.active=!0}},showMap:function(e){this.getComponent("AMapPanel").showPlayers(),this.mapLayer.active=!0},onGameStartHandler:function(){GameData.room.opts.roomType!=i.roomType.Room_Match&&(this.mapCondition(),2==GameData.room.opts.joinermax?this.mapNode.active=!1:this.mapNode.active=!0)}});t.exports=s,cc._RF.pop()},{SoundMngr:"SoundMngr",errorCode:"errorCode",gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],roomUtil:[function(e,t,a){"use strict";cc._RF.push(t,"948b5yrT+FJKZu3JBgBKuDC","roomUtil");var n=t.exports;n.getRoomString=function(e){return 1e5<=GameData.room.id?e.toString():1e4<=GameData.room.id?"0"+GameData.room.id:1e3<=GameData.room.id?"00"+GameData.room.id:100<=GameData.room.id?"000"+GameData.room.id:10<=GameData.room.id?"0000"+GameData.room.id:1<=GameData.room.id?"00000"+GameData.room.id:"000000"},n.getTimeString=function(){var e=new Date,t=e.getHours(),a=e.getMinutes();return(t=t<10?"0"+t:t)+":"+(a=a<10?"0"+a:a)},n.getPower=function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity")}catch(e){WriteLog("Get energy error:"+JSON.stringify(e))}},cc._RF.pop()},{}],"roomWait-shishi":[function(e,t,a){"use strict";cc._RF.push(t,"80f5c7wP1VE3J1s+YWNRx/f","roomWait-shishi");var y=e("SoundMngr"),n=e("roomHandler");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,quanNode:cc.Node,juNode:cc.Node,btnRule:cc.Button,lostInfo:[],playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomMsg",this,this.showPlayers),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("initZhuangInfo",this,this.showPlayers),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onGameAllScore",this,this.onGameAllScoreHandler),registEvent("onNotDiscard",this,this.onNotDiscardHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onGameTurn",this,this.onGameTurnHandler),registEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),registEvent("onGameScore",this,this.onGameScoreHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("dynChat",this,this.dynChatHandler),MjHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation()},onEnable:function(){this.readyNode.active=!GameData.game.gameStart,GameData.game.onRoomReadyInfo.data&&sendEvent("onRoomReadyInfo",GameData.game.onRoomReadyInfo.data)},onDestroy:function(){unregistEvent("onRoomMsg",this,this.showPlayers),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("initZhuangInfo",this,this.showPlayers),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("onNotDiscard",this,this.onNotDiscardHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onGameTurn",this,this.onGameTurnHandler),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(){var e=this;this.scheduleOnce(function(){e.readyNode.active=!0},2)},onNotDiscardHandler:function(e){GameData.player.uid==e.detail.uid&&GameData.game.turn==GameData.player.uid&&1==GameData.room.opts.fengtou&&createMoveMessage("请注意风头跟打")},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("playerTemplate"),n=a.uid,i=null==GameData.allScores[n]?0:GameData.allScores[n];a.setCoin(i,1)}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},showPlayers:function(){this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;this.deleteRoomBtn.active=e},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(GameData.room.opts){var t=getRuleStrShiShi(GameData.room.opts);console.log("GameData.createRoomOpts:"+GameData.createRoomOpts);var a=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+"contentNode : "+a),a.getComponent(cc.Label).string=t}},showPlayer:function(e,t){t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl);var i=null==GameData.allScores[a.uid]?0:GameData.allScores[a.uid];console.log(" score: "+i),n.getComponent("playerTemplate").setCoin(i,1);var o=GameData.game.zhuangUid==a.uid;cc.log("showPlayer uid:"+a.uid+" zhuang:"+GameData.game.zhuangUid),n.getComponent("playerTemplate").showZhuang(o);var r=GameData.game.zhuangNum[a.uid];n.getComponent("playerTemplate").showZhuangNum(o,r),n.getComponent("playerTemplate").setChaShuiIconShow(e),t.addChild(n),t.active=!0,this.headers.push(n),n.setTag(a.uid),this.showReadyIcon(e,!0,!1),cc.find("Disconnect",n).active=2==a.status,2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}else t.active=!1,this.showReadyIcon(e,!1,!1)},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("up",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.joinermax?(0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.joinermax?0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t):(0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameData.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;null==a[i]||0==a[i]?(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0):(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1)}cc.find("lost_"+e,this.lostNode).active=n}},onGameTurnHandler:function(e){this.scheduleOnce(this.showTurnEffect,.1)},showTurnEffect:function(){this.gotoShowTurnEffect(GameData.game.turn)},gotoShowTurnEffect:function(e){if(null!=this.headers)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];cc.find("liuguang",a).active=a.getComponent("playerTemplate").uid==e}else cc.log("this.headers null")},setRoomNum:function(){1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(GameData.room.id)},wxInviteBtnClicked:function(){var e="石狮麻将 房间号:"+GameData.room.id;4==GameData.room.opts.costType&&(e="石狮麻将 (代开)房间号:"+GameData.room.id);var t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e=getRuleStrShiShi(GameData.room.opts);GameData.room.opts.joinermax&&(e+=","+GameData.joiners.length+"等"+(GameData.room.opts.joinermax-GameData.joiners.length));var t="玩法:"+e+",请您快速加入对局.";return console.log("des = "+t),t},onShareResult:function(){wxShareTimeline("石狮麻将","我在石狮麻将等你!")},onShareFriend:function(){wxShareWeb("石狮麻将","我在石狮麻将等你!")},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){n.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="石狮麻将,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){this.readyNode.active=!GameData.game.gameStart},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",roomHandler:"roomHandler"}],roomWait_changchun:[function(e,t,a){"use strict";cc._RF.push(t,"bb499wTyu9N47MDz8murX0y","roomWait_changchun");var l=e("roomHandler"),y=e("SoundMngr"),u=e("gameDefine");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,quanNode:cc.Node,juNode:cc.Node,btnRule:cc.Button,lostInfo:[],playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomInfo",this,this.showPlayers),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("initZhuangInfo",this,this.showPlayers),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onGameAllScore",this,this.onGameAllScoreHandler),registEvent("onNotDiscard",this,this.onNotDiscardHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onGameTurn",this,this.onGameTurnHandler),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("onMahjongRunEnd",this,this.onGameScoreHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),registEvent("dynChat",this,this.dynChatHandler),MjHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation()},onEnable:function(){this.readyNode.active=0<!GameData.game.zhuangUid,0<GameData.game.turn&&this.onGameTurnHandler()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("initZhuangInfo",this,this.showPlayers),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("onNotDiscard",this,this.onNotDiscardHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onGameTurn",this,this.onGameTurnHandler),unregistEvent("onMahjongRunEnd",this,this.onGameScoreHandler),unregistEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(){var e=this;this.scheduleOnce(function(){e.readyNode.active=!0},2)},onNotDiscardHandler:function(e){GameData.player.uid==e.detail.uid&&GameData.game.turn==GameData.player.uid&&1==GameData.room.opts.fengtou&&createMoveMessage("请注意风头跟打")},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("playerTemplate"),n=a.uid;if(u.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameData.allScores[n]?0:GameData.allScores[n];a.setCoin(i,1)}}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},showPlayers:function(){this.headers=[],cc.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!showPlayers"),this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;if(this.deleteRoomBtn.active=e,this.quitRoomBtn.active=!e,GameData.room){var t=2==GameData.room.opts.roundType;this.quanNode.active=t,this.juNode.active=!t}0<GameData.game.turn&&this.onGameTurnHandler()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(GameData.room.opts){var t=getRuleStrCC(GameData.room.opts);console.log("GameData.createRoomOpts:"+GameData.createRoomOpts);var a=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+"contentNode : "+a),a.getComponent(cc.Label).string=t}},showPlayer:function(e,t){t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);if(n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl),u.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players.uid&&n.getComponent("playerTemplate").setGold(a.coin);else{var i=null==l.scores[a.uid]?0:l.scores[a.uid];n.getComponent("playerTemplate").setCoin(i,1),console.log(" score: "+i)}var o=GameData.game.zhuangUid==a.uid;cc.log("showPlayer uid:"+a.uid+" zhuang:"+GameData.game.zhuangUid),n.getComponent("playerTemplate").showZhuang(o);var r=GameData.room.creator==a.uid;n.getComponent("playerTemplate").showCreator(r),t.addChild(n),t.active=!0,this.headers.push(n);var s=!0;for(var c in n.setTag(a.uid),l.readyData)c==a.uid&&(s=l.readyData[c]);cc.log("readyState:"+JSON.stringify(s)),s?this.showReadyIcon(e,!0,!1):this.showReadyIcon(e,!1,!0);var d=cc.find("Disconnect",n),h=l.isPlayerOnline(a.uid);d.active=!h,cc.find("lost_"+e,this.lostNode).active=!h}else t.active=!1,this.showReadyIcon(e,!1,!1)},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("up",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!0),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),e.detail.uid==GameData.player.uid&&MjHandler.getInstance().requestReady(),GameData.room.status==u.RoomState.READY?this.readyNode.active=!0:this.readyNode.active=!1,sendEvent("playerConnect"),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.opts.joinermax?0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameData.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;null==a[i]||0==a[i]?(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1):(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0)}cc.find("lost_"+e,this.lostNode).active=n}},onGameTurnHandler:function(e){this.scheduleOnce(this.showTurnEffect,.1)},showTurnEffect:function(){var e=profileHuaDian.getTurnByUid();this.gotoShowTurnEffect(e)},gotoShowTurnEffect:function(e){if(null!=this.headers)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];cc.find("liuguang",a).active=a.getComponent("playerTemplate").uid==e}else cc.log("this.headers null")},setRoomNum:function(){cc.log("~~~~~~~~~~~设置房间号~~~~~~~~~~~~~");1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){inCD(2e3)||(GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitRoom(GameData.room.id))},wxInviteBtnClicked:function(){var e="长春麻将 房间号:"+GameData.room.id;4==GameData.room.opts.costType&&(e="长春麻将 (代开)房间号:"+GameData.room.id);var t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e=getRuleStrCC(GameData.room.opts);GameData.room.opts.joinermax&&(e+=","+GameData.joiners.length+"等"+(GameData.room.opts.joinermax-GameData.joiners.length));var t="玩法:"+e+",请您快速加入对局.";return console.log("des = "+t),t},onShareResult:function(){wxShareTimeline("长春麻将","我在长春麻将等你!")},onShareFriend:function(){wxShareWeb("长春麻将","我在长春麻将等你!")},onDeleteRoom:function(){inCD(2e3)||createMessageBox("解散房间不扣房卡，是否确定解散？",function(){l.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="长春麻将,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){GameData.room.status==u.RoomState.READY?this.readyNode.active=!0:this.readyNode.active=!1,this.showPlayers()},onGamePiaoHandler:function(){this.readyNode.active=!1},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomWait_heb:[function(e,t,a){"use strict";cc._RF.push(t,"1905dPciw1PVZRTQKkiW8M0","roomWait_heb");var l=e("roomHandler"),y=e("SoundMngr"),u=e("gameDefine");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,quanNode:cc.Node,juNode:cc.Node,btnRule:cc.Button,lostInfo:[],playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomInfo",this,this.showPlayers),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("initZhuangInfo",this,this.showPlayers),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onGameAllScore",this,this.onGameAllScoreHandler),registEvent("onNotDiscard",this,this.onNotDiscardHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onGameTurn",this,this.onGameTurnHandler),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("onMahjongRunEnd",this,this.onGameScoreHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),registEvent("dynChat",this,this.dynChatHandler),MjHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation()},onEnable:function(){this.readyNode.active=0<!GameData.game.zhuangUid,0<GameData.game.turn&&this.onGameTurnHandler()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("initZhuangInfo",this,this.showPlayers),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("onNotDiscard",this,this.onNotDiscardHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onGameTurn",this,this.onGameTurnHandler),unregistEvent("onMahjongRunEnd",this,this.onGameScoreHandler),unregistEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(){var e=this;this.scheduleOnce(function(){e.readyNode.active=!0},2)},onNotDiscardHandler:function(e){GameData.player.uid==e.detail.uid&&GameData.game.turn==GameData.player.uid&&1==GameData.room.opts.fengtou&&createMoveMessage("请注意风头跟打")},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("playerTemplate"),n=a.uid;if(u.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameData.allScores[n]?0:GameData.allScores[n];a.setCoin(i,1)}}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},showPlayers:function(){this.headers=[],cc.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!showPlayers"),this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;if(this.deleteRoomBtn.active=e,this.quitRoomBtn.active=!e,GameData.room){var t=2==GameData.room.opts.roundType;this.quanNode.active=t,this.juNode.active=!t}0<GameData.game.turn&&this.onGameTurnHandler()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(GameData.room.opts){var t=getRuleStrCC(GameData.room.opts);console.log("GameData.createRoomOpts:"+GameData.createRoomOpts);var a=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+"contentNode : "+a),a.getComponent(cc.Label).string=t}},showPlayer:function(e,t){t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);if(n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl),u.currencyType.Currency_Coin==GameData.room.opts.currencyType)a.coin&&n.getComponent("playerTemplate").setGold(a.coin);else{var i=null==l.scores[a.uid]?0:l.scores[a.uid];n.getComponent("playerTemplate").setCoin(i,1),console.log(" score: "+i)}var o=GameData.game.zhuangUid==a.uid;cc.log("showPlayer uid:"+a.uid+" zhuang:"+GameData.game.zhuangUid),n.getComponent("playerTemplate").showZhuang(o);var r=GameData.room.creator==a.uid;n.getComponent("playerTemplate").showCreator(r),t.addChild(n),t.active=!0,this.headers.push(n);var s=!0;for(var c in n.setTag(a.uid),l.readyData)c==a.uid&&(s=l.readyData[c]);cc.log("readyState:"+JSON.stringify(s)),s?this.showReadyIcon(e,!0,!1):this.showReadyIcon(e,!1,!0);var d=cc.find("Disconnect",n),h=l.isPlayerOnline(a.uid);d.active=!h,cc.find("lost_"+e,this.lostNode).active=!h}else t.active=!1,this.showReadyIcon(e,!1,!1)},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("up",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!0),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.opts.joinermax?0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameData.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;null==a[i]||0==a[i]?(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1):(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0)}cc.find("lost_"+e,this.lostNode).active=n}},onGameTurnHandler:function(e){this.scheduleOnce(this.showTurnEffect,.1)},showTurnEffect:function(){var e=profileHuaDian.getTurnByUid();this.gotoShowTurnEffect(e)},gotoShowTurnEffect:function(e){if(null!=this.headers)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];cc.find("liuguang",a).active=a.getComponent("playerTemplate").uid==e}else cc.log("this.headers null")},setRoomNum:function(){cc.log("~~~~~~~~~~~设置房间号~~~~~~~~~~~~~");1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){inCD(2e3)||(GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitRoom(GameData.room.id))},wxInviteBtnClicked:function(){var e="哈尔滨麻将 房间号:"+GameData.room.id;4==GameData.room.opts.costType&&(e="哈尔滨麻将 (代开)房间号:"+GameData.room.id);var t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e=getRuleStrCC(GameData.room.opts);GameData.room.opts.joinermax&&(e+=","+GameData.joiners.length+"等"+(GameData.room.opts.joinermax-GameData.joiners.length));var t="玩法:"+e+",请您快速加入对局.";return console.log("des = "+t),t},onShareResult:function(){wxShareTimeline("哈尔滨麻将","我在哈尔滨麻将等你!")},onShareFriend:function(){wxShareWeb("哈尔滨麻将","我在哈尔滨麻将等你!")},onDeleteRoom:function(){inCD(2e3)||createMessageBox("解散房间不扣房卡，是否确定解散？",function(){l.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):l.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="哈尔滨麻将,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){GameData.room.status==u.RoomState.READY?this.readyNode.active=!0:this.readyNode.active=!1,this.showPlayers()},onGamePiaoHandler:function(){this.readyNode.active=!1},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomWait_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"82ef9BvfEBFzpwpOyVXPYuJ","roomWait_huadian");var y=e("SoundMngr"),d=e("gameDefine"),h=e("roomHandler");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,quanNode:cc.Node,juNode:cc.Node,btnRule:cc.Button,lostInfo:[],playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.RuleBtnBool=!1,this.isReconnect=!1,this.showPlayers(this),registEvent("onRoomInfo",this,this.showPlayers),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("initZhuangInfo",this,this.showPlayers),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onGameAllScore",this,this.onGameAllScoreHandler),registEvent("onNotDiscard",this,this.onNotDiscardHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onStarPiao",this,this.onGamePiaoHandler),registEvent("onGameTurn",this,this.onGameTurnHandler),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("onMahjongRunEnd",this,this.onGameScoreHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),registEvent("dynChat",this,this.dynChatHandler),MjHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.addDynAnimation()},onEnable:function(){cc.log("roomWait enable"),GameData.room.status>=d.RoomState.GAMEING?this.readyNode.active=!1:this.readyNode.active=!0,0<Object.keys(profileHuaDian.PiaoInfo).length&&this.onGamePiaoHandler(),0<GameData.game.turn&&this.onGameTurnHandler()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("initZhuangInfo",this,this.showPlayers),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("onNotDiscard",this,this.onNotDiscardHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onStarPiao",this,this.onGamePiaoHandler),unregistEvent("onGameTurn",this,this.onGameTurnHandler),unregistEvent("onMahjongRunEnd",this,this.onGameScoreHandler),unregistEvent("onHuaDianMahjongReconnecet",this,this.onGameStartHandler),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(){var e=this;this.scheduleOnce(function(){e.readyNode.active=!0},2)},onNotDiscardHandler:function(e){GameData.player.uid==e.detail.uid&&GameData.game.turn==GameData.player.uid&&1==GameData.room.opts.fengtou&&createMoveMessage("请注意风头跟打")},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("playerTemplate"),n=a.uid;if(d.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameData.allScores[n]?0:GameData.allScores[n];a.setCoin(i,1)}}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,10);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a},showPlayers:function(){this.headers=[],cc.log("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!showPlayers"),this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;if(this.deleteRoomBtn.active=e,this.quitRoomBtn.active=!e,GameData.room){var t=2==GameData.room.opts.roundType;this.quanNode.active=t,this.juNode.active=!t}0<GameData.game.turn&&this.onGameTurnHandler()},ruleClick:function(){1!=this.playintrNode.active&&(this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(GameData.room.opts){var t=getRuleStrHd(GameData.room.opts);console.log("GameData.createRoomOpts:"+GameData.createRoomOpts);var a=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+"contentNode : "+a),a.getComponent(cc.Label).string=t}},showPlayer:function(e,t){t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);if(n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl),d.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players.uid&&n.getComponent("playerTemplate").setGold(a.coin);else{var i=null==h.scores[a.uid]?0:h.scores[a.uid];n.getComponent("playerTemplate").setCoin(i,1),console.log(" score: "+i)}var o=GameData.game.zhuangUid==a.uid;cc.log("showPlayer uid:"+a.uid+" zhuang:"+GameData.game.zhuangUid),n.getComponent("playerTemplate").showZhuang(o);var r=GameData.room.creator==a.uid;n.getComponent("playerTemplate").showCreator(r),n.getComponent("playerTemplate").setPiaoIconShow(e),t.addChild(n),t.active=!0,this.headers.push(n),n.setTag(a.uid),this.showReadyIcon(e,!0,!1);var s=cc.find("Disconnect",n),c=h.isPlayerOnline(a.uid);s.active=!c,cc.find("lost_"+e,this.lostNode).active=!c}else t.active=!1,this.showReadyIcon(e,!1,!1)},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("up",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了"),GameData.player.uid==e.detail.uid&&(this.isReconnect=!0)},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);cc.log("GameData.room.opts.joinermax :"+GameData.room.opts.joinermax+"index:"+a),2==GameData.room.opts.joinermax?(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.opts.joinermax?0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t):(0<=a&&a<GameData.room.opts.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t),(++a<GameData.room.opts.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameData.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;null==a[i]||0==a[i]?(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1):(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0)}cc.find("lost_"+e,this.lostNode).active=n}},onGameTurnHandler:function(e){this.scheduleOnce(this.showTurnEffect,.01)},showTurnEffect:function(){var e=profileHuaDian.getTurnByUid();this.gotoShowTurnEffect(e)},gotoShowTurnEffect:function(e){if(null!=this.headers)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];cc.find("liuguang",a).active=a.getComponent("playerTemplate").uid==e}else cc.log("this.headers null")},setRoomNum:function(){cc.log("~~~~~~~~~~~设置房间号~~~~~~~~~~~~~");1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){inCD(2e3)||(GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):h.quitRoom(GameData.room.id))},wxInviteBtnClicked:function(){var e="桦甸麻将 房间号:"+GameData.room.id;4==GameData.room.opts.costType&&(e="桦甸麻将 (代开)房间号:"+GameData.room.id);var t=this.getInviteStr();wxShareText(e,t)},getInviteStr:function(){var e=getRuleStrHd(GameData.room.opts);GameData.room.opts.joinermax&&(e+=","+GameData.joiners.length+"等"+(GameData.room.opts.joinermax-GameData.joiners.length));var t="玩法:"+e+",请您快速加入对局.";return console.log("des = "+t),t},onShareResult:function(){wxShareTimeline("桦甸麻将","我在桦甸麻将等你!")},onShareFriend:function(){wxShareWeb("桦甸麻将","我在桦甸麻将等你!")},onDeleteRoom:function(){inCD(2e3)||createMessageBox("解散房间不扣房卡，是否确定解散？",function(){h.deleteRoom(GameData.room.id)},function(){})},onQuitRoom:function(){GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):h.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){if(0<GameData.room.id){var e="桦甸麻将,房间号:"+GameData.room.id+",",t=this.getInviteStr();wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){WriteLog("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){cc.log("测试"),GameData.room.status==d.RoomState.READY?this.readyNode.active=!0:this.readyNode.active=!1},onGamePiaoHandler:function(){this.readyNode.active=!1},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomWait:[function(e,t,a){"use strict";cc._RF.push(t,"076edPKvU9KtoQjaENzflbk","roomWait");var y=e("SoundMngr"),n=e("roomHandler"),r=e("configMgr"),s=e("gameDefine");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label,roomNum:cc.Label,play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,roomRule:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,wifiNode:cc.Node,playintrNode:cc.Node,dianchiNode:cc.Node,quanNode:cc.Node,juNode:cc.Node,btnRule:cc.Button,lostInfo:[],huiercard1:cc.Node,huiercard2:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){this.playIntrSize="small",this.playerSex=1,this.headers=new Array,this.showPlayers(this),registEvent("onRoomMsg",this,this.showPlayers),registEvent("initCards",this,this.showPlayers),registEvent("onCreatorQuit",this,this.onCreatorQuit),registEvent("initZhuangInfo",this,this.showPlayers),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("nativePower",this,this.onNativePowerHandler),registEvent("onGameAllScore",this,this.onGameAllScoreHandler),registEvent("onNotDiscard",this,this.onNotDiscardHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onGameTurn",this,this.onGameTurnHandler),registEvent("onRoomReadyInfo",this,this.onRoomReadyInfoHandler),registEvent("onGameScore",this,this.onGameScoreHandler),registEvent("yunwaUploaded",this,this.onYunwaUploaded),registEvent("dynChat",this,this.dynChatHandler),MjHandler.getInstance().requestReady(),this.handTimeLabel(),this.updateTime(),this.updataWifi(),this.electricQuantity(),this.initHuierUI(),this.addDynAnimation()},onEnable:function(){this.readyNode.active=!GameData.game.gameStart,GameData.game.onRoomReadyInfo.data&&sendEvent("onRoomReadyInfo",GameData.game.onRoomReadyInfo.data)},onDestroy:function(){unregistEvent("onRoomMsg",this,this.showPlayers),unregistEvent("initCards",this,this.showPlayers),unregistEvent("onCreatorQuit",this,this.onCreatorQuit),unregistEvent("initZhuangInfo",this,this.showPlayers),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("nativePower",this,this.onNativePowerHandler),unregistEvent("onGameAllScore",this,this.onGameAllScoreHandler),unregistEvent("onNotDiscard",this,this.onNotDiscardHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onGameTurn",this,this.onGameTurnHandler),unregistEvent("dynChat",this,this.dynChatHandler)},onGameScoreHandler:function(){var e=this;this.scheduleOnce(function(){e.readyNode.active=!GameData.game.gameStart},2)},onNotDiscardHandler:function(e){GameData.player.uid==e.detail.uid&&GameData.game.turn==GameData.player.uid&&1==GameData.room.opts.disfeng&&createMoveMessage("请优先打单张风牌")},onGameAllScoreHandler:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t].getComponent("playerTemplate"),n=a.uid;if(s.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[n]&&a.setGold(GameData.players[n].coin);else{var i=null==GameData.allScores[n]?0:GameData.allScores[n];a.setCoin(i)}}},onYunwaUploaded:function(e){var t=e.detail;WriteLog("soundurl ："+t),ChatHandler.getInstance().sendRecord(t)},onRoomChatHandler:function(e){var t=e.detail.uid,a=e.detail.msg.type;this.playerSex=GameData.getPlayerSexByUid(e.detail.uid);for(var n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o=GameData.tablePos[t],r=cc.find("chat_"+o,i);if(null!=r){var s=cc.find("word",r),c=cc.find("emo",r),d=cc.find("yuyinNode",r);if("word"==a){var h=e.detail.msg.data,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=h;l.width=20+24*m.length,s.getComponent("HideComponent").show(3),u.string=m}else if("fast"==a){var p=e.detail.msg.data.sound;h=e.detail.msg.data.content,l=cc.find("word/bg",r),u=cc.find("word/Label",r).getComponent(cc.Label),m=getShortStr(h,20);l.width=30*m.length,s.getComponent("HideComponent").show(3),u.string=m,y.instance.playAudioChat(p,this.playerSex)}else if("emo"==a){var g=e.detail.msg.data;c.getComponent(cc.Animation).play(g),c.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var f=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",f):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(f)),cc.find("yuyinAnimNode/yuyinAnim",d).getComponent(cc.Animation).play("yuyinduihua"),d.getComponent("HideComponent").show(3)}}}}},showReadyIcon:function(e,t,a){cc.find("ready_hand_"+e,this.readyNode).active=t,cc.find("readying_"+e,this.readyNode).active=a,cc.log("showReadyIcon:"+e+" "+t+" "+a)},showPlayers:function(){this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player),this.roomRule.getComponent("cc.Label").string=getRoomRuleStr(GameData.room.opts),this.showPlayIntroduce(this.playIntrSize),this.setRoomNum();var e=GameData.room.creator==GameData.player.uid;this.deleteRoomBtn.active=e,GameData.room.opts&&(4<=GameData.room.opts.roundRule?(this.quanNode.active=!0,this.juNode.active=!1):(this.quanNode.active=!1,this.juNode.active=!0))},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},ruleClick:function(){1!=this.playintrNode.active&&(y.instance.playAudioOther("button"),this.playintrNode.active=!0,this.playintrNode.runAction(cc.sequence(cc.moveTo(.5,cc.p(30,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(30,434)),cc.callFunc(this.isRuleBtn,this))))},isRuleBtn:function(){this.playintrNode.active=!1},onShowPlayIntrClick:function(){y.instance.playAudioOther("button"),this.playIntrSize="small"==this.playIntrSize?"big":"small",this.showPlayIntroduce(this.playIntrSize),cc.find("openBtn",this.playintrNode).rotation="small"==this.playIntrSize?0:180},showPlayIntroduce:function(e){if(GameData.room.opts){var t=getRoomRuleStr(GameData.room.opts),a=cc.find(e+"/content",this.playintrNode);cc.log("size : "+e+"contentNode : "+a),a.getComponent(cc.Label).string=t}},showPlayer:function(e,t){t.removeAllChildren();var a=GameData.getPlayerByPos(e);if(null!=a){var n=cc.instantiate(this.playerTemplate);if(n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl),s.currencyType.Currency_Coin==GameData.room.opts.currencyType)GameData.players[a.uid]&&n.getComponent("playerTemplate").setGold(GameData.players[a.uid].coin);else{var i=null==GameData.allScores[a.uid]?0:GameData.allScores[a.uid];n.getComponent("playerTemplate").setCoin(i)}var o=GameData.game.zhuangUid==a.uid;cc.log("showPlayer uid:"+a.uid+" zhuang:"+GameData.game.zhuangUid),n.getComponent("playerTemplate").showZhuang(o);var r=GameData.game.zhuangNum[a.uid];n.getComponent("playerTemplate").showZhuangNum(o,r),t.addChild(n),t.active=!0,this.headers.push(n),this.showReadyIcon(e,!0,!1),cc.find("Disconnect",n).active=2==a.status,2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}else t.active=!1,this.showReadyIcon(e,!1,!1)},onRoomReadyInfoHandler:function(e){this.gotoShowReady("down",e.detail),this.gotoShowReady("up",e.detail),this.gotoShowReady("left",e.detail),this.gotoShowReady("right",e.detail)},gotoShowReady:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=a.uid,i=!0;if(null!=t[n]&&0!=t[n]||(i=!1),this.showReadyIcon(e,i,!i),null!=this.lostInfo&&null!=this.lostInfo){for(var o=0;o<this.lostInfo.length;o++)n==this.lostInfo[o]&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0);2==a.status&&(this.showReadyIcon(e,!1,!1),cc.find("lost_"+e,this.lostNode).active=!0)}}},showJoinerLost:function(e){this.lostInfo.push(e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0),this.showDisconnectInfo(e.detail,!0);var t=GameData.getPlayerByUid(e.detail.uid).name;createMoveMessage("玩家["+t+"]掉线了")},showJoinerConnect:function(e){if(cc.log("connect uid : "+e.detail.uid),null!=this.lostInfo&&null!=this.lostInfo){for(var t=0;t<this.lostInfo.length;t++)e.detail.uid==this.lostInfo[t]&&this.lostInfo.splice(t,1);this.showDisconnectInfo(e.detail,!1),this.showHeaderDisconnect(e.detail.uid,!1)}},showHeaderDisconnect:function(e,t){if(null!=this.headers)for(var a=0;a<this.headers.length;a++){var n=this.headers[a];if(n.getComponent("playerTemplate").uid==e)return void(cc.find("Disconnect",n).active=t)}else cc.log("this.headers null")},showDisconnectInfo:function(e,t){var a=GameData.getPlayerIndex(GameData.player.uid);2==GameData.room.joinermax?(0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t)):(3==GameData.room.joinermax?0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t):(0<=a&&a<GameData.room.joinermax&&this.showDisconnectUI("down",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("right",a,e,t)),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("up",a,e,t),(++a<GameData.room.joinermax||0<=(a=0))&&this.showDisconnectUI("left",a,e,t))},showDisconnectUI:function(e,t,a,n){if(GameData.joiners[t]&&GameData.joiners[t].uid==a.uid){if(n)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else if(GameData.game.gameStart)cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!1;else{var i=GameData.joiners[t].uid;null==a[i]||0==a[i]?(cc.find("ready_hand_"+e,this.readyNode).active=!1,cc.find("readying_"+e,this.readyNode).active=!0):(cc.find("ready_hand_"+e,this.readyNode).active=!0,cc.find("readying_"+e,this.readyNode).active=!1)}cc.find("lost_"+e,this.lostNode).active=n}},onGameTurnHandler:function(e){this.scheduleOnce(this.showTurnEffect,.1)},showTurnEffect:function(){this.gotoShowTurnEffect(GameData.game.turn)},gotoShowTurnEffect:function(e){if(null!=this.headers)for(var t=0;t<this.headers.length;t++){var a=this.headers[t];cc.find("liuguang",a).active=a.getComponent("playerTemplate").uid==e}else cc.log("this.headers null")},setRoomNum:function(){1e5<=GameData.room.id?this.roomNum.string=""+GameData.room.id:1e4<=GameData.room.id?this.roomNum.string="0"+GameData.room.id:1e3<=GameData.room.id?this.roomNum.string="00"+GameData.room.id:100<=GameData.room.id?this.roomNum.string="000"+GameData.room.id:10<=GameData.room.id?this.roomNum.string="0000"+GameData.room.id:1<=GameData.room.id?this.roomNum.string="00000"+GameData.room.id:this.roomNum.string="000000"},backBtnClicked:function(){y.instance.playAudioOther("button"),GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(GameData.room.id)},wxInviteBtnClicked:function(){y.instance.playAudioOther("button");var e="天津攒局麻将 房间号:"+GameData.room.id;4==GameData.room.opts.costType&&(e="天津攒局麻将 (代开)房间号:"+GameData.room.id);var t=this.getInviteStr();wxShareWeb(e,t)},getInviteStr:function(){var e="",t="";if(GameData.room.opts.currencyType==s.currencyType.Currency_Coin){e="金币场 ";var a=r.getServerConfig();if(a&&a.roomCoin){var n=a.roomCoin[s.GameType.Game_Mj_Tianjin];if(n){var i=GameData.room.opts.roundRule-1;if(n[i]){var o=n[i].enter[GameData.room.opts.joinermax];o&&(t="进入条件："+o[GameData.room.opts.scorelv])}}}}return e+t+"玩法:"+getRoomRuleStr(GameData.room.opts)+",请您快速加入对局."},onShareResult:function(){y.instance.playAudioOther("button"),wxShareTimeline("天津攒局麻将","还等嘛!我在天津攒局麻将等你!")},onShareFriend:function(){y.instance.playAudioOther("button"),wxShareWeb("天津攒局麻将","还等嘛!我在天津攒局麻将等你!")},onDeleteRoom:function(){y.instance.playAudioOther("button"),createMessageBox("解散房间不扣房卡，是否确定解散？",function(){n.deleteRoom(GameData.room.id,"close")},function(){})},onQuitRoom:function(){y.instance.playAudioOther("button"),GameData.room.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(GameData.room.id)},onCreatorQuit:function(){GameData.player.roomid=void 0,GameData.room.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home")},onCopyRoomInfo:function(){if(y.instance.playAudioOther("button"),0<GameData.room.id){var e="天津攒局麻将,房间号:"+GameData.room.id+",",t=this.getInviteStr();WriteLog("复制内容："+e+t),wxShareCommond(e+t)}},electricQuantity:function(){try{cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","electricQuantity","()V"):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","electricQuantity"),this.schedule(this.electricQuantity,60)}catch(e){jsclient.native.HelloOC("electricQuantity throw: "+JSON.stringify(e))}},onNativePowerHandler:function(e){this.dianchiNode.getChildByName("dianchi2").scaleX=e.detail/100},initHuierUI:function(){var e=cc.find("huier_bg",this.huiercard2.parent);1==GameData.room.opts.huierModel?(e.width=37,this.huiercard2.active=!1,cc.find("huier_icon2",this.huiercard2.parent).active=!1):(e.width=74,this.huiercard2.active=!0,cc.find("huier_icon2",this.huiercard2.parent).active=!0)},updataWifi:function(){this.callBackForWifiUI(),this.schedule(this.callBackForWifiUI,5)},callBackForWifiUI:function(){var e=GameNet.getInstance().getPingPong()/1e3;e<.3?this.showWifi(3):e<.6?this.showWifi(2):e<1?this.showWifi(1):this.showWifi(0)},showWifi:function(e){for(var t=0;t<4;t++){cc.find("WiFi-"+(t+1),this.wifiNode).active=t==e}},updateTime:function(){this.schedule(this.handTimeLabel,1)},handTimeLabel:function(){var e=new Date,t=e.getHours()+"",a=e.getMinutes()+"";t=1==t.length?"0"+t:t,a=1==a.length?"0"+a:a,this.timeLabel.string=t+":"+a},onGameStartHandler:function(e){this.readyNode.active=!GameData.game.gameStart},hasName:function(e,t){for(var a=0;a<t.length;a++){if(t[a]==e)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],roomZhuang_huadian:[function(e,t,a){"use strict";cc._RF.push(t,"50476K+sUlCy50AuvkfjEld","roomZhuang_huadian"),cc.Class({extends:cc.Component,properties:{layer_zhuang:cc.Node,title_zz:cc.Sprite,title_lz:cc.Sprite,button_zz:cc.Button,button_la:cc.Button,button_cancel:cc.Button,button_la_1:cc.Button,button_la_2:cc.Button,button_cancel_2:cc.Button,waiting_text:cc.Sprite,headerNode:cc.Node,infoLabel:cc.Label},onLoad:function(){registEvent("onRoomInfo",this,this.showPlayers),registEvent("onZhuang",this,this.onZhuangHandler),registEvent("onSelectZhuang",this,this.showZuoZhuang),registEvent("onSelectLazhuang",this,this.showLaZhuang),registEvent("onSelectZhuangAgain",this,this.showZhuangAgain),registEvent("onSelectLazhuangAgain",this,this.showLaZhuangAgain),registEvent("initZhuangInfo",this,this.close),registEvent("onSelectZhuangInfo",this,this.onSelectZhuangInfo),registEvent("initCards",this,this.onCloseZhuang),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),this.initHeaderUI()},onEnable:function(){null!=GameData.joiners&&this.showPlayers(),console.log("sendEventLater"),GameData.game.onSelectZhuang.data&&sendEvent("onSelectZhuang",GameData.game.onSelectZhuang.data),GameData.game.onSelectLazhuang.data&&sendEvent("onSelectLazhuang",GameData.game.onSelectLazhuang.data),GameData.game.onSelectZhuangInfo.data&&sendEvent("onSelectZhuangInfo",GameData.game.onSelectZhuangInfo.data),GameData.game.onZhuangInfo.data&&sendEvent("onZhuang",GameData.game.onZhuangInfo.data),GameData.game.onSelectZhuangAgain.data&&sendEvent("onSelectZhuangAgain",GameData.game.onSelectZhuangAgain.data),GameData.game.initcards&&this.onCloseZhuang()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showPlayers),unregistEvent("onZhuang",this,this.onZhuangHandler),unregistEvent("onSelectZhuang",this,this.showZuoZhuang),unregistEvent("onSelectLazhuang",this,this.showLaZhuang),unregistEvent("onSelectZhuangAgain",this,this.showZhuangAgain),unregistEvent("initZhuangInfo",this,this.close),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.opts.joinermax-1;e++){var t=e+1,a=cc.instantiate(this.headerNode);a.parent=this.headerNode.parent,a.name="header_"+(e+2),a.x=this.headerNode.x+230*(e+1),this.showHeaderZhuang(t,!1),this.hideHeaderButtom(t)}},onCloseZhuang:function(){this.close()},close:function(){this.layer_zhuang.active=!1,this.waiting_text.node.active=!1},showPlayers:function(){for(var e=0;e<GameData.joiners.length;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){a.uid;var n=a.headimgurl;this.showHeaderIcon(t,n),this.showHeaderName(t,a.name),console.log("GameData.game.zhuangUid == joiner.uid",GameData.game.zhuangUid,a.uid),this.showHeaderZhuang(t,GameData.game.zhuangUid==a.uid)}this.hideHeaderButtom(t)}},_show:function(e){cc.log("GameData.room.opts.lazhuang == ",GameData.room.opts.lazhuang),1==GameData.room.opts.lazhuang?(this.button_zz.node.active=!0,this.button_la.node.active=!0,this.button_cancel.node.active=!0,this.button_la_1.node.active=!1,this.button_la_2.node.active=!1,this.button_cancel_2.node.active=!1,this.button_zz.node.active=e,this.button_la.node.active=!e):(cc.log("GameData.room.opts.lazhuang ==2 ",GameData.room.opts.lazhuang),this.button_zz.node.active=!1,this.button_la.node.active=!1,this.button_cancel.node.active=!1,this.button_la_1.node.active=!0,this.button_la_2.node.active=!0,this.button_cancel_2.node.active=!0,this.button_la_1.node.active=!e,this.button_la_2.node.active=!e,this.button_cancel_2.node.active=!e),this.layer_zhuang.active=!0,this.waiting_text.node.active=!1},onSelectZhuangInfo:function(e){cc.log("data.detail==============",e.detail);var t=e.detail.zhuangUid,a=e.detail.data;cc.log(JSON.stringify(a)),this.showPlayers(),this._show(t==GameData.player.uid);for(var n=!1,i=!0,o=0;o<GameData.joiners.length;o++){var r=o+1,s=GameData.joiners[o];if(null!=s){var c=0;c=null!=a[l=s.uid]?a[l]:-1;var d=s.headimgurl;this.showHeaderIcon(r,d),this.showHeaderName(r,s.name),this.showHeaderZhuang(r,t==s.uid),console.log("num=================",c),0<c?t==l&&1==GameData.room.opts.lazhuang?(n=!0,this.showHeaderButtom(r,"zuo"+c)):1==c?this.showHeaderButtom(r,"la"):2==c&&this.showHeaderButtom(r,"la2"):0==c?this.showHeaderButtom(r,"bula"):(i=!1,this.hideHeaderButtom(r))}}if(1!=i){if(0==n?1==GameData.room.opts.lazhuang?GameData.player.uid==t?(this.enableButton(!0),this.showInfo("您是否选择坐庄？")):(this.enableButton(!1),this.showInfo("请等待庄家坐庄...")):2==GameData.room.opts.lazhuang&&(this.enableButton(!0),this.showInfo("请等待玩家拉庄...")):null==a[GameData.player.uid]?(console.log("GameData.player.uid ,,,zhuangid",GameData.player.uid,t),this.enableButton(!0),GameData.player.uid!=t&&this.showInfo("您是否选择拉庄？")):(this.enableButton(!1),GameData.player.uid==t?this.showInfo("请等待闲家拉庄..."):n?this.showInfo("请等待闲家拉庄..."):this.showInfo("请等待庄家坐庄...")),2==GameData.room.opts.lazhuang){var h=!1;for(var l in a)l==GameData.player.uid&&(h=!0),console.log("uid  ,GameData.player.uid , hasSelect ",l,GameData.player.uid,h);this.enableButton(!h)}}else GameData.player.uid==t?(this.enableButton(!0),this.showInfo("您是否选择踢庄？")):(this.enableButton(!1),this.showInfo("请等待庄家踢庄..."))},onZhuangHandler:function(e){var t=e.detail.uid,a=e.detail.num;console.log("=========================",e.detail);for(var n=0,i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o&&o.uid==t){n=i+1;break}}0<a?GameData.game.zhuangUid==t?(this.showHeaderButtom(n,"zuo"+a),t==GameData.player.uid&&this.showInfo("请等待玩家拉庄...")):1==a?this.showHeaderButtom(n,"la"):2==a&&this.showHeaderButtom(n,"la2"):this.showHeaderButtom(n,"bula")},showZuoZhuang:function(e){this.showPlayers(),1==GameData.room.opts.lazhuang?GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择坐庄？")):(this._show(!1),this.enableButton(!1),this.showInfo("请等待庄家坐庄...")):2==GameData.room.opts.lazhuang&&(GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄...")))},showLaZhuang:function(e){if(cc.log("GameData.room.opts.lazhuang--------------",GameData.room.opts.lazhuang),1==GameData.room.opts.lazhuang)GameData.game.zhuangUid!=GameData.player.uid?(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄..."));else if(2==GameData.room.opts.lazhuang){if(null==e.detail.uid)return;GameData.game.zhuangUid!=GameData.player.uid?(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄..."))}this.showPlayers()},showLaZhuangAgain:function(e){cc.log("showLaZhuangAgain  data.detail.uid:"+e.detail.uid+"  data.uid:"+e.uid+"  zhuangUid:"+GameData.game.zhuangUid),null!=e.detail.uid&&GameData.game.zhuangUid!=GameData.player.uid&&(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择再次拉庄？"))},showZhuangAgain:function(e){GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择踢庄？")):this.showInfo("请等待庄家踢庄...")},showWaitText:function(e){if(!this.layer_zhuang.active){var t=cc.textureCache.addImage(cc.url.raw("resources/table/zhuang/waitzhuang"+e+".png"));this.waiting_text.spriteFrame=new cc.SpriteFrame(t),this.waiting_text.node.active=!0}},showHeaderIcon:function(a,e){if(!(null==e||""==e||e.length<=0)){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/default_headpic",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},showHeaderName:function(e,t){var a=cc.find("header_"+e+"/nameLabel",this.headerNode.parent);cc.log("nameStr:",t),a&&(a.getComponent(cc.Label).string=getShortStr(t,4))},showHeaderZhuang:function(e,t){var a=cc.find("header_"+e+"/zhuangbiaoshi",this.headerNode.parent);a&&(a.active=t)},hideHeaderButtom:function(e){var t=cc.find("header_"+e+"/zuo1",this.headerNode.parent);t&&(t.active=!1)},showHeaderButtom:function(e,t){cc.log("pngName==========",t);var a=cc.find("header_"+e+"/zuo1",this.headerNode.parent);if(a)if(null!=t&&""!=t&&null!=t){a.active=!0;var n=cc.textureCache.addImage(cc.url.raw("resources/table/"+t+".png"));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}else a.active=!1},showInfo:function(e){this.infoLabel.string=e},selectZ:function(e,t){cc.log("data= =====",t),MjHandler.getInstance().requestZhuang(t,function(e){}),this.enableButton(!1)},cancel:function(){MjHandler.getInstance().requestZhuang(0,function(e){}),this.enableButton(!1)},enableButton:function(e){this.button_la.interactable=e,this.button_zz.interactable=e,this.button_cancel.interactable=e,this.button_la_1.interactable=e,this.button_la_2.interactable=e,this.button_cancel_2.interactable=e},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(console.log("headerNode.uid and show",n.uid,t),n&&n.uid==e)return void(cc.find("header_"+i+"/tipLabel",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{}],roomZhuang:[function(e,t,a){"use strict";cc._RF.push(t,"40e0f7bhBdDT6WFvPaUVwoc","roomZhuang");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{layer_zhuang:cc.Node,title_zz:cc.Sprite,button_zz:cc.Button,button_la:cc.Button,button_cancel:cc.Button,button_la_1:cc.Button,button_la_2:cc.Button,button_cancel_2:cc.Button,waiting_text:cc.Sprite,headerNode:cc.Node,infoLabel:cc.Label},onLoad:function(){registEvent("onRoomMsg",this,this.showPlayers),registEvent("onZhuang",this,this.onZhuangHandler),registEvent("onSelectZhuang",this,this.showZuoZhuang),registEvent("onSelectLazhuang",this,this.showLaZhuang),registEvent("onSelectZhuangAgain",this,this.showZhuangAgain),registEvent("onSelectLazhuangAgain",this,this.showLaZhuangAgain),registEvent("initZhuangInfo",this,this.close),registEvent("onSelectZhuangInfo",this,this.onSelectZhuangInfo),registEvent("initCards",this,this.onCloseZhuang),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),this.initHeaderUI()},onEnable:function(){null!=GameData.joiners&&this.showPlayers(),console.log("sendEventLater"),GameData.game.onSelectZhuang.data&&sendEvent("onSelectZhuang",GameData.game.onSelectZhuang.data),GameData.game.onSelectLazhuang.data&&sendEvent("onSelectLazhuang",GameData.game.onSelectLazhuang.data),GameData.game.onSelectZhuangInfo.data&&sendEvent("onSelectZhuangInfo",GameData.game.onSelectZhuangInfo.data),GameData.game.onZhuangInfo.data&&sendEvent("onZhuang",GameData.game.onZhuangInfo.data),GameData.game.onSelectZhuangAgain.data&&sendEvent("onSelectZhuangAgain",GameData.game.onSelectZhuangAgain.data),GameData.game.initcards&&this.onCloseZhuang()},onDestroy:function(){unregistEvent("onRoomMsg",this,this.showPlayers),unregistEvent("onZhuang",this,this.onZhuangHandler),unregistEvent("onSelectZhuang",this,this.showZuoZhuang),unregistEvent("onSelectLazhuang",this,this.showLaZhuang),unregistEvent("onSelectZhuangAgain",this,this.showZhuangAgain),unregistEvent("initZhuangInfo",this,this.close),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect)},initHeaderUI:function(){for(var e=0;e<GameData.room.joinermax-1;e++){var t=e+1,a=cc.instantiate(this.headerNode);a.parent=this.headerNode.parent,a.name="header_"+(e+2),a.x=this.headerNode.x+230*(e+1),this.showHeaderZhuang(t,!1),this.hideHeaderButtom(t)}},onCloseZhuang:function(){this.close()},close:function(){this.layer_zhuang.active=!1,this.waiting_text.node.active=!1},showPlayers:function(){for(var e=0;e<GameData.joiners.length;e++){var t=e+1,a=GameData.joiners[e];if(null!=a){a.uid;var n=a.headimgurl;this.showHeaderIcon(t,n),this.showHeaderName(t,a.name),console.log("GameData.game.zhuangUid == joiner.uid",GameData.game.zhuangUid,a.uid),this.showHeaderZhuang(t,GameData.game.zhuangUid==a.uid)}this.connectId||this.hideHeaderButtom(t)}this.connectId&&(this.connectId=void 0)},_show:function(e){cc.log("GameData.room.lazhuang == ",GameData.room.opts.lazhuang),1==GameData.room.opts.lazhuang?(this.button_zz.node.active=!0,this.button_la.node.active=!0,this.button_cancel.node.active=!0,this.button_la_1.node.active=!1,this.button_cancel_2.node.active=!1,this.button_zz.node.active=e,this.button_la.node.active=!e):(cc.log("GameData.room.lazhuang ==2 ",GameData.room.opts.lazhuang),this.button_zz.node.active=!1,this.button_la.node.active=!1,this.button_cancel.node.active=!1,this.button_la_1.node.active=!0,this.button_cancel_2.node.active=!0,this.button_la_1.node.active=!e,this.button_cancel_2.node.active=!e),this.layer_zhuang.active=!0,this.waiting_text.node.active=!1},onSelectZhuangInfo:function(e){cc.log("data.detail==============",e.detail);var t=e.detail.zhuangUid,a=e.detail.data;cc.log(JSON.stringify(a)),this.showPlayers(),this._show(t==GameData.player.uid);for(var n=!1,i=!0,o=0;o<GameData.joiners.length;o++){var r=o+1,s=GameData.joiners[o];if(null!=s){var c=0;c=null!=a[l=s.uid]?a[l]:-1;var d=s.headimgurl;if(this.showHeaderIcon(r,d),this.showHeaderName(r,s.name),this.showHeaderZhuang(r,t==s.uid),console.log("num=================",c),0<c)t==l&&1==GameData.room.opts.lazhuang?(n=!0,this.showHeaderButtom(r,"zuo"+c)):1==c?this.showHeaderButtom(r,"la1"):2==c&&this.showHeaderButtom(r,"la2");else if(0==c){0==cc.find("header_"+r+"/zuo1",this.headerNode.parent).active&&this.showHeaderButtom(r,"bulazhuang")}else i=!1,this.hideHeaderButtom(r)}}if(1!=i){if(0==n?1==GameData.room.opts.lazhuang?GameData.player.uid==t?(this.enableButton(!0),this.showInfo("您是否选择坐庄？")):(this.enableButton(!1),this.showInfo("请等待庄家坐庄...")):2==GameData.room.opts.lazhuang&&(this.enableButton(!0),this.showInfo("请等待玩家拉庄...")):null==a[GameData.player.uid]?(console.log("GameData.player.uid ,,,zhuangid",GameData.player.uid,t),this.enableButton(!0),GameData.player.uid!=t&&this.showInfo("您是否选择拉庄？")):(this.enableButton(!1),GameData.player.uid==t?this.showInfo("请等待闲家拉庄..."):n?this.showInfo("请等待闲家拉庄..."):this.showInfo("请等待庄家坐庄...")),2==GameData.room.opts.lazhuang){var h=!1;for(var l in a)l==GameData.player.uid&&(h=!0),console.log("uid  ,GameData.player.uid , hasSelect ",l,GameData.player.uid,h);this.enableButton(!h)}}else GameData.player.uid==t?(this.enableButton(!0),this.showInfo("您是否选择踢庄？")):(this.enableButton(!1),this.showInfo("请等待庄家踢庄..."))},onZhuangHandler:function(e){var t=e.detail.uid,a=e.detail.num;console.log("=========================",e.detail);for(var n=0,i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o&&o.uid==t){n=i+1;break}}0<a?GameData.game.zhuangUid==t?(this.showHeaderButtom(n,"zuo"+a),t==GameData.player.uid&&this.showInfo("请等待玩家拉庄...")):1==a?this.showHeaderButtom(n,"la1"):2==a&&this.showHeaderButtom(n,"la2"):0==cc.find("header_"+n+"/zuo1",this.headerNode.parent).active&&this.showHeaderButtom(n,"bulazhuang")},showZuoZhuang:function(e){this.showPlayers(),1==GameData.room.opts.lazhuang?GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择坐庄？")):(this._show(!1),this.enableButton(!1),this.showInfo("请等待庄家坐庄...")):2==GameData.room.opts.lazhuang&&(GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄...")))},showLaZhuang:function(e){if(cc.log("GameData.room.lazhuang--------------",GameData.room.opts.lazhuang),1==GameData.room.opts.lazhuang)GameData.game.zhuangUid!=GameData.player.uid?(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄..."));else if(2==GameData.room.opts.lazhuang){if(null==e.detail.uid)return;GameData.game.zhuangUid!=GameData.player.uid?(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择拉庄？")):(this._show(!0),this.enableButton(!1),this.showInfo("请等待玩家拉庄..."))}this.showPlayers()},showLaZhuangAgain:function(e){cc.log("showLaZhuangAgain  data.detail.uid:"+e.detail.uid+"  data.uid:"+e.uid+"  zhuangUid:"+GameData.game.zhuangUid),null!=e.detail.uid&&GameData.game.zhuangUid!=GameData.player.uid&&(this.enableButton(!0),this._show(!1),this.showInfo("您是否选择再次拉庄？"))},showZhuangAgain:function(e){GameData.game.zhuangUid==GameData.player.uid?(this.enableButton(!0),this._show(!0),this.showInfo("您是否选择踢庄？")):this.showInfo("请等待庄家踢庄...")},showWaitText:function(e){if(!this.layer_zhuang.active){var t=cc.textureCache.addImage(cc.url.raw("resources/table/zhuang/waitzhuang"+e+".png"));this.waiting_text.spriteFrame=new cc.SpriteFrame(t),this.waiting_text.node.active=!0}},showHeaderIcon:function(a,e){if(null!=e&&""!=e){var n=this;cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(cc.find("header_"+a+"/default_headpic",n.headerNode.parent).getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))})}},showHeaderName:function(e,t){var a=cc.find("header_"+e+"/nameLabel",this.headerNode.parent);cc.log("nameStr:",t),a&&(a.getComponent(cc.Label).string=getShortStr(t,4))},showHeaderZhuang:function(e,t){cc.find("header_"+e+"/zhuangbiaoshi",this.headerNode.parent).active=t},hideHeaderButtom:function(e){cc.find("header_"+e+"/zuo1",this.headerNode.parent).active=!1},showHeaderButtom:function(e,t){cc.log("pngName==========",t);var a=cc.find("header_"+e+"/zuo1",this.headerNode.parent);if(null!=t&&""!=t&&null!=t){a.active=!0;var n=cc.textureCache.addImage(cc.url.raw("resources/newui/"+t+".png"));a.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n)}else a.active=!1},showInfo:function(e){this.infoLabel.string=e},selectZ:function(e,t){n.instance.playAudioOther("button"),cc.log("data= =====",t),MjHandler.getInstance().requestZhuang(t,function(e){}),this.enableButton(!1)},cancel:function(){n.instance.playAudioOther("button"),MjHandler.getInstance().requestZhuang(0,function(e){}),this.enableButton(!1)},enableButton:function(e){this.button_la.interactable=e,this.button_zz.interactable=e,this.button_cancel.interactable=e,this.button_la_1.interactable=e,this.button_cancel_2.interactable=e},showJoinerLost:function(e){cc.log("disconnect uid : "+e.detail.uid),this.showHeaderDisconnect(e.detail.uid,!0)},showJoinerConnect:function(e){cc.log("connect uid : "+e.detail.uid),this.connectId=e.detail.uid,this.showHeaderDisconnect(e.detail.uid,!1)},showHeaderDisconnect:function(e,t){for(var a=0;a<GameData.joiners.length;a++){var n=GameData.joiners[a],i=a+1;if(console.log("headerNode.uid and show",n.uid,t),n&&n.uid==e)return void(cc.find("header_"+i+"/tipLabel",this.headerNode.parent).active=t)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],roundDetail:[function(e,t,a){"use strict";cc._RF.push(t,"e2ed6hl5NZN6oRDnIWffFia","roundDetail");var n=cc.Class({extends:cc.Component,properties:{roundDetailPanel:{default:null,type:cc.Node},roundNum:{default:null,type:cc.Label},scoreNode:{default:null,type:cc.Node},allScore:{default:null,type:cc.Node},fonts:{default:[],type:cc.Font},id:0},onLoad:function(){},setRoundNumString:function(e){this.roundNum.getComponent("cc.Label").string=e},setScoreNodeString:function(e){0<e?(this.scoreNode.getComponent("cc.Label").font=this.fonts[0],this.scoreNode.getComponent("cc.Label").string="+"+e):(this.scoreNode.getComponent("cc.Label").font=e<0?this.fonts[1]:this.fonts[2],this.scoreNode.getComponent("cc.Label").string=e)},setAllScoreNodeString:function(e){0<e?(this.allScore.getComponent("cc.Label").font=this.fonts[0],this.allScore.getComponent("cc.Label").string="+"+e):(this.allScore.getComponent("cc.Label").font=e<0?this.fonts[1]:this.fonts[2],this.allScore.getComponent("cc.Label").string=e)}});t.exports=n,cc._RF.pop()},{}],ruleHandler:[function(e,t,a){"use strict";cc._RF.push(t,"db053tfOx9EgIT17OUMGdq7","ruleHandler");var n=e("mahjong_tianjin"),i=e("mahjong_shishi"),o=e("mahjong_huadian"),r=e("mahjong_changchun"),s=e("mahjong_hz"),c=e("gameDefine"),d=cc.Class({extends:cc.Component,statics:{instance:null},properties:{rule:null},onLoad:function(){cc.game.addPersistRootNode(this.node),d.instance=this},setGameType:function(e){switch(e){case c.GameType.Game_Mj_Tianjin:this.rule=new n;break;case c.GameType.Game_Mj_Shishi:this.rule=new i;break;case c.GameType.Game_MJ_HuaDian:this.rule=new o;break;case c.GameType.Game_Mj_HZ:this.rule=new s;break;case c.GameType.Game_Mj_CC:case c.GameType.Game_Mj_Heb:this.rule=new r}},isHuier:function(e){return this.rule.isHuier(e)},canChi:function(e,t){return this.rule.canChi(e,t)},canPeng:function(e,t){return this.rule.canPeng(e,t)},canAnGang:function(e){return this.rule.canAnGang(e)},canBuGang:function(e){return this.rule.canBuGang(e)},canMingGang:function(e,t){return this.rule.canMingGang(e,t)},canMingGangSelf:function(){return this.rule.canMingGangSelf()},canDianPao:function(e,t){return this.rule.canDianPao(e,t)},canZimo:function(e,t,a){return this.rule.canZimo(e,t,a)},canTing:function(e){return this.rule.canTing(e)},discardTip:function(e){return this.rule.discardTip(e)},getHuType:function(e,t,a,n){return this.rule.getHuType(e,t,a,n)},calcHuScore:function(e){return this.rule.calcHuScore(e)},getHuTypeString:function(){return this.rule.getHuTypeString()},isJinGang:function(e,t){return this.rule.isJinGang(e,t)},getHuTypeArry:function(e){return this.rule.getHuTypeArry(e)},checkYoujin:function(e){return this.rule.checkYoujin(e)},calcHuaScore:function(e){return this.rule.calcHuaScore(e)}});cc._RF.pop()},{gameDefine:"gameDefine",mahjong_changchun:"mahjong_changchun",mahjong_huadian:"mahjong_huadian",mahjong_hz:"mahjong_hz",mahjong_shishi:"mahjong_shishi",mahjong_tianjin:"mahjong_tianjin"}],ruleTipsView:[function(e,t,a){"use strict";cc._RF.push(t,"15eabQFM3lAlK5PodoOlnR5","ruleTipsView");var n=e("gameConfig");cc.Class({extends:cc.Component,properties:{},onEnable:function(){this.showRuleTips()},showRuleTips:function(){var e=cc.find("small/content",this.node);if(e){e.getComponent(cc.Label).string=n.getRuleStr();var t=this;this.node.active=!0,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(.5,cc.p(0,334)),cc.delayTime(10),cc.moveTo(.5,cc.p(0,434)),cc.callFunc(function(){t.node.active=!1})))}}}),cc._RF.pop()},{gameConfig:"gameConfig"}],ruleView:[function(e,t,a){"use strict";cc._RF.push(t,"b1151vGK0xLYLm5K8IbA+kY","ruleView");var n=e("gameConfig");cc.Class({extends:cc.Component,properties:{roomRule:cc.Label},onEnable:function(){this.showRoomRule()},showRoomRule:function(){this.roomRule.string=n.getRuleStr()}}),cc._RF.pop()},{gameConfig:"gameConfig"}],scene_mahjong:[function(e,t,a){"use strict";cc._RF.push(t,"6abf0PKGPJPs5yvfYIhkQU/","scene_mahjong");var r=e("gameConfig"),n=e("configMgr"),i=e("gameDefine"),o=e("roomHandler"),s=e("stateMachine");cc.Class({extends:s,properties:{debugBtn:cc.Button,talkViewNode:cc.Node,timeViewNode:cc.Node,wifiViewNode:cc.Node,powerViewNode:cc.Node,roomNumViewNode:cc.Node,wildCard1ViewNode:cc.Node},onLoad:function(){registEvent("onRoomInfo",this,this.showStateViews),registEvent("onRoomDissolve",this,this.onShowDissolve),registEvent("onShowView",this,this.onShowView),registEvent("onCloseView",this,this.onCloseView)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.showStateViews),unregistEvent("onRoomDissolve",this,this.onShowDissolve),unregistEvent("onShowView",this,this.onShowView),unregistEvent("onCloseView",this,this.onCloseView)},onEnable:function(){this.viewState="",this.loadViews("base"),this.showStateViews(),this.debugBtn.active=n.getSetCardsOpen()},loadViews:function(e){if(""!=e){this.viewState=e;var s=this,c=r.getViews(e),t=cc.director.getScene().getChildByName("Canvas"),d=t.getChildByTag(e);if(null!=d)d.active=!0;else{var a=[];(d=new cc.Node).setTag(e),t.addChild(d);for(var n=0,i=c.length;n<i;++n){var o=r.getView(c[n]);o&&a.push(o)}cc.loader.loadResArray(a,function(e,t){for(var a=0,n=t.length;a<n;++a){var i=t[a];if(null!=i){var o=cc.instantiate(i),r=s[c[a]+"Node"];null!=r&&(o.position=r.position),o.setTag(c[a]),d.addChild(o),cc.log("loadView: "+c[a])}}})}}},closeViews:function(e){if(""!=e){var t=cc.director.getScene().getChildByName("Canvas").getChildByTag(e);null!=t&&(t.active=!1)}},onShowView:function(e){var t=e.detail,a=cc.director.getScene().getChildByName("Canvas"),n=a.getChildByTag(t);if(null!=n)n.active=!0;else{var i=r.getView(t);i&&openPrefabView(i,a,t)}},onCloseView:function(e){var t=e.detail,a=cc.director.getScene().getChildByName("Canvas").getChildByTag(t);null!=a&&(a.active=!1)},showStateViews:function(e){switch(o.room.status){case i.RoomState.WAIT:this.loadViews("wait");break;case i.RoomState.GAMEING:this.closeViews(this.viewState),this.loadViews("game");break;case i.RoomState.READY:(e.detail.force||"game"!=this.viewState)&&(this.closeViews(this.viewState),this.loadViews("ready"))}},onShowDissolve:function(e){sendEvent("onShowView","dissolveView")},onSettingClicked:function(e){sendEvent("onShowView","settingView")},onRuleClicked:function(e){sendEvent("onShowView","ruleTipsView")},onChatClicked:function(e){sendEvent("onShowView","chatView")},onDebugClicked:function(e){sendEvent("onShowView","debugView")}}),cc._RF.pop()},{configMgr:"configMgr",gameConfig:"gameConfig",gameDefine:"gameDefine",roomHandler:"roomHandler",stateMachine:"stateMachine"}],selectGameItem:[function(e,t,a){"use strict";cc._RF.push(t,"798bfyfgJZKZZCT5cqeSdC1","selectGameItem");var h=e("gameDefine"),n=e("configMgr"),l=e("competitionHandler");cc.Class({extends:cc.Component,properties:{gameName:cc.Label,peopleNum:cc.Label,rewardNum:cc.Label,rewardIcon:cc.Sprite,baoMingBtn:cc.Node,cancelBtn:cc.Node},onLoad:function(){registEvent("onActivityList",this,this.refreshUI)},onDestroy:function(){unregistEvent("onActivityList",this,this.refreshUI)},initUI:function(e,t){this.config=n.getServerConfig(),this.setGameType(t),this.setGameIcon(e),this.setGameName(t),this.setPoepleNum(t),this.setBaoMingBtn(t)},refreshUI:function(){this.setPoepleNum(this.gameType),this.setBaoMingBtn(this.gameType)},setGameIcon:function(e){var t=this.getGameImgIcon(e);this.addTextureImg(this.node,t)},setGameName:function(e){this.gameName.string=this.config.fight[e].name},setGameType:function(e){this.gameType=e},setBaoMingBtn:function(e){var t=0<GameData.player.freeActivityNum,a=l.isApply(e,GameData.player.uid),n=cc.find("free",this.baoMingBtn),i=cc.find("cost",this.baoMingBtn);if(n.active=t,i.active=!t,this.baoMingBtn.active=!a,this.cancelBtn.active=a,t){cc.find("freeNum",n).getComponent(cc.Label).string="免费"+GameData.player.freeActivityNum+"次"}else{var o=cc.find("costIcon",i),r=this.config.fight[e].signCosts,s="",c="";for(var d in r)d==h.currencyType.Currency_Card&&(s="resources/home/replace/fangka.png"),c=r[d];cc.find("costNum",i).getComponent(cc.Label).string="*"+c,this.addTextureImg(o,s)}},setPoepleNum:function(){var e=l.getPeopleNum(this.gameType);this.peopleNum.string=e+"/100"},getGameImgIcon:function(e){var t="";switch(e){case"addBtn":t="resources/home/match/btn-home-add.png";break;case h.GameType.Game_Mj_Tianjin:t="resources/home/match/btn-home-tjmj.png";break;case h.GameType.Game_Mj_Shishi:t="resources/home/match/btn-home-ssmj.png";break;case h.GameType.Game_MJ_HuaDian:t="resources/home/match/btn-home-hdmj.png";break;case h.GameType.Game_Mj_HZ:t="resources/home/match/btn-home-hzmj.png";break;case h.GameType.Game_Mj_CC:t="resources/home/match/btn-home-ccmj.png";break;case h.GameType.Game_Mj_Heb:t="resources/home/match/btn-home-hebmj.png";break;case h.GameType.Game_Poker_TianjinDDZ:case h.GameType.Game_Poker_DDZ:t="resources/home/match/doudizhu01.png";break;case h.GameType.Game_niu_niu:t="resources/home/match/niuniu01.png";break;case h.GameType.Game_Niu_Hundred:t="resources/home/match/home_btn_2.png";break;case h.GameType.Game_TDK:t="resources/home/match/tiandaken01.png";break;case h.GameType.Game_Poker_13shui:t="resources/home/match/shisanshui01.png";break;case h.GameType.Game_Poker_paodekuai:t="resources/home/match/paodekuaianniu01.png";break;case h.GameType.Game_Poker_ZJH:t="resources/home/match/btn-home-szp.png";break;case h.GameType.Game_Poker_HHDZ:t="resources/home/match/btn-home-hhdz.png"}return t},requestApply:function(){l.apply(this.gameType+"")},requestCancel:function(){l.cancel(this.gameType+"")},addTextureImg:function(e,t){var a=cc.textureCache.addImage(cc.url.raw(t));e.getComponent(cc.Sprite).spriteFrame=null,e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a)}}),cc._RF.pop()},{competitionHandler:"competitionHandler",configMgr:"configMgr",gameDefine:"gameDefine"}],selectclubPanel:[function(e,t,a){"use strict";cc._RF.push(t,"33fc7n5S7pNn7nn+FhO5pjV","selectclubPanel");var n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{selectCloseBtn:cc.Button,joinCloseBtn:cc.Button,clubScorllItem:cc.Node},onLoad:function(){this.registerListener(),this.initUI()},onEnable:function(){},registerListener:function(){registEvent("onClubData",this,this.refreshUI)},initUI:function(){var e=1;for(var t in this.clubScorllItem.getParent().height=Object.keys(GameData.player.club).length*this.clubScorllItem.height,GameData.player.club){var a=cc.instantiate(this.clubScorllItem);a.parent=this.clubScorllItem.parent,a.name="clubItem_"+(e+1),a.setTag(e),a.y=this.clubScorllItem.y-this.clubScorllItem.height*e;var n=cc.find("clubItem_"+e+"/clubName",this.clubScorllItem.parent),i=cc.find("clubItem_"+e+"/selectClubBtn",this.clubScorllItem.parent),o=GameData.player.club[t].club_id;i.setTag(o),i.on(cc.Node.EventType.TOUCH_END,this.selectClubClick,this),n.getComponent("cc.Label").string=GameData.player.club[t].clubName,e++}this.clubScorllItem.parent.removeChildByTag(e-1,!0)},refreshUI:function(){var e=1;for(var t in GameData.player.club){var a=cc.find("clubItem_"+(e+1),this.clubScorllItem.parent);a||((a=cc.instantiate(this.clubScorllItem)).parent=this.clubScorllItem.parent,a.name="clubItem_"+(e+1),a.setTag(e),a.y=this.clubScorllItem.y-this.clubScorllItem.height*e);var n=cc.find("clubItem_"+e+"/clubName",this.clubScorllItem.parent),i=cc.find("clubItem_"+e+"/selectClubBtn",this.clubScorllItem.parent),o=GameData.player.club[t].club_id;i.setTag(o),i.on(cc.Node.EventType.TOUCH_END,this.selectClubClick,this),n.getComponent("cc.Label").string=GameData.player.club[t].clubName,e++}this.clubScorllItem.parent.removeChildByTag(e-1,!0)},onDestroy:function(){unregistEvent("onClubData",this,this.refreshUI)},selectClubClick:function(e){n.instance.playAudioOther("button");var t=e.target.tag;console.log("clubid  "+t),GameData.playerCurrClubId=t,GameData.savePlayerCurrClubData(),sendEvent("refreshUIClubData"),this.close()},close:function(){n.instance.playAudioOther("button"),closeView("selectclubPanel")}}),cc._RF.pop()},{SoundMngr:"SoundMngr"}],settingView:[function(e,t,a){"use strict";cc._RF.push(t,"115107nO5lCXpwPV69l5gLv","settingView");var n=e("gameConfig"),i=e("SoundMngr"),o=e("roomHandler"),r=e("loginHandler"),s=e("gameDefine");cc.Class({extends:cc.Component,properties:{musicSlider:cc.Slider,soundSlider:cc.Slider,musicBtn:cc.Node,soundBtn:cc.Node,musicProgressbar:cc.ProgressBar,soundProgressbar:cc.ProgressBar,_musicOpen:!0,_soundOpen:!0,_LanguageTypeOpen:!0,byeRoomBtn:cc.Node,quitRoomBtn:cc.Node,toggle_tianjin:cc.Toggle,toggle_putong:cc.Toggle,musicKuang1:cc.Node,musicKuang2:cc.Node,soundKuang1:cc.Node,soundKuang2:cc.Node,areaLb:cc.Label},onEnable:function(){this._LanguageTypeOpen=cc.sys.localStorage.getItem("languageType"+GameData.player.uid)||GameData.language_tianjin,cc.log("language_type ==============",cc.sys.localStorage.getItem("languageType"+GameData.player.uid)),this.musicBtn.getChildByName("guan").active=!1,this.musicKuang1.active=!1,this.soundBtn.getChildByName("guan").active=!1,this.soundKuang1.active=!1,this.soundSlider.node.on("slide",this.adjustSound,this),this.musicSlider.node.on("slide",this.adjustMusic,this),this.musicBtn.on(cc.Node.EventType.TOUCH_START,this.musicClick,this),this.soundBtn.on(cc.Node.EventType.TOUCH_START,this.soundClick,this),this.toggle_tianjin.node.on("toggle",this.selectLanguageTypeClick,this),this.toggle_putong.node.on("toggle",this.selectLanguageTypeClick,this),"home"!=cc.director.getScene().name?(s.roomType.Room_Match!=GameData.room.opts.roomType?this.byeRoomBtn.active=!0:this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!1):(this.byeRoomBtn.active=!1,this.quitRoomBtn.active=!0),this._soundOpen=GameData.SetLayerData.soundOpen,this._musicOpen=GameData.SetLayerData.musicOpen,this.areaLb.string=n.getLanguage().name,this.selectLanguageTypeOpen(),this.refreshUI()},musicClick:function(e){i.instance.playAudioOther("button"),this._musicOpen=!this._musicOpen,this.setMusicOpen(),GameData.SetLayerData.musicOpen=this._musicOpen;var t=1==this._musicOpen?GameData.SetLayerData.musicVolume:0;i.instance.bgmVolume(t),GameData.saveSetLayerData()},soundClick:function(e){i.instance.playAudioOther("button"),this._soundOpen=!this._soundOpen,this.setSoundOpen(),GameData.SetLayerData.soundOpen=this._soundOpen,GameData.saveSetLayerData()},selectLanguageTypeClick:function(e){i.instance.playAudioOther("button");var t=GameData.language_tianjin;this.toggle_tianjin.isChecked&&(t=GameData.language_tianjin),this.toggle_putong.isChecked&&(t=GameData.language_putong),cc.sys.localStorage.setItem("languageType"+GameData.player.uid,t),cc.log(t),cc.log("languageType= ",cc.sys.localStorage.getItem("languageType"+GameData.player.uid))},selectLanguageTypeOpen:function(){cc.log("=============================>",this._LanguageTypeOpen),this._LanguageTypeOpen==GameData.language_tianjin?(this.toggle_tianjin.isChecked=!0,this.toggle_putong.isChecked=!1):(this.toggle_tianjin.isChecked=!1,this.toggle_putong.isChecked=!0)},setMusicOpen:function(){this.musicBtn.getChildByName("kai").active=this._musicOpen,this.musicKuang2.active=this._musicOpen,this.musicBtn.getChildByName("guan").active=!this._musicOpen,this.musicKuang1.active=!this._musicOpen},setSoundOpen:function(){this.soundBtn.getChildByName("kai").active=this._soundOpen,this.soundKuang2.active=this._soundOpen,this.soundBtn.getChildByName("guan").active=!this._soundOpen,this.soundKuang1.active=!this._soundOpen},adjustSound:function(e){var t=e.detail;GameData.SetLayerData.soundVolume=t.progress,GameData.SetLayerData.soundOpen=!0,this._soundOpen=!0,this.soundProgressbar.progress=t.progress,0==t.progress&&(this._soundOpen=!1,GameData.SetLayerData.soundOpen=!1),this.setSoundOpen(),GameData.saveSetLayerData()},adjustMusic:function(e){var t=e.detail;GameData.SetLayerData.musicVolume=t.progress,i.instance.bgmVolume(GameData.musicVolume),this.musicProgressbar.progress=t.progress,GameData.SetLayerData.musicOpen=!0,this._musicOpen=!0,0==t.progress&&(this._musicOpen=!1,GameData.SetLayerData.musicOpen=!1);var a=t.progress;i.instance.bgmVolume(a),this.setMusicOpen(),GameData.saveSetLayerData()},onClose:function(){i.instance.playAudioOther("button"),closeView(this.node.name)},requestDissolve:function(){GameData.room.opts&&(GameData.player.uid!=GameData.joiners[0].uid&&GameData.joiners.length<GameData.room.opts.joinermax?createMoveMessage("牌局开始后才允许解散房间"):o.deleteRoom(GameData.room.id,"apply"),closeView(this.node.name))},logout:function(e){i.instance.playAudioOther("button"),r.logout()},refreshUI:function(){this.musicSlider.progress=GameData.SetLayerData.musicVolume,this.soundSlider.progress=GameData.SetLayerData.soundVolume,this.soundBtn.getChildByName("kai").active=GameData.SetLayerData.soundOpen,this.soundBtn.getChildByName("guan").active=!GameData.SetLayerData.soundOpen,this.soundKuang1.active=!GameData.SetLayerData.soundOpen,this.soundKuang2.active=GameData.SetLayerData.soundOpen,this.musicBtn.getChildByName("kai").active=GameData.SetLayerData.musicOpen,this.musicBtn.getChildByName("guan").active=!GameData.SetLayerData.musicOpen,this.musicProgressbar.progress=GameData.SetLayerData.musicVolume,this.soundProgressbar.progress=GameData.SetLayerData.soundVolume,this.musicKuang2.active=GameData.SetLayerData.musicOpen,this.musicKuang1.active=!GameData.SetLayerData.musicOpen}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameConfig:"gameConfig",gameDefine:"gameDefine",loginHandler:"loginHandler",roomHandler:"roomHandler"}],shishi:[function(e,t,a){"use strict";cc._RF.push(t,"2616fCkLINGabqC6tTcQ7eg","shishi");var n=e("gameDefine"),i={areaType:n.AreaType.Area_HuaDian,serverIP:"192.168.1.1",gameName:"摸摸桦甸麻将",versionText:"",Poster:["resources/poster/huandian/poster_HD_1.png"],GameVisible:[n.GameType.Game_MJ_HuaDian,n.GameType.Game_Poker_DDZ,n.GameType.Game_TDK],ModeType:{Game_Mj_Tianjin:{CurrencyType:n.currencyType.Currency_Coin,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Mj_Shishi:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Mj_HZ:{CurrencyType:n.currencyType.Currency_Coin,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Poker_TianjinDDZ:{CurrencyType:n.currencyType.Currency_Coin,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Poker_DDZ:{CurrencyType:n.currencyType.Currency_Coin,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Poker_13shui:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_niu_niu:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_TDK:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]},Game_Poker_paodekuai:{CurrencyType:n.currencyType.Currency_Card,SettleType:[n.settleType.Settle_Coin,n.settleType.Settle_Point]}},SetCardsOpen:!1,MatchGameType:[n.GameType.Game_Mj_Tianjin,n.GameType.Game_MJ_HuaDian,n.GameType.Game_TDK,n.GameType.Game_Poker_TianjinDDZ,n.GameType.Game_Mj_CC,n.GameType.Game_Poker_DDZ],serverConfig:{roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:1,enter:[20,50,100],perround:5},{name:"8局",roundType:1,roundMax:8,cost:2,enter:[40,100,200],perround:5},{name:"16局",roundType:1,roundMax:16,cost:4,enter:[80,200,400],perround:5},{name:"1圈",roundType:2,roundMax:1,cost:1,enter:[20,50,100],perround:5},{name:"2圈",roundType:2,roundMax:2,cost:2,enter:[40,100,200],perround:5},{name:"4圈",roundType:2,roundMax:4,cost:4,enter:[80,200,400],perround:5}],8:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}],102:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}]},roomCard:{1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:10},3:{final:15},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},8:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}},11:{10:{name:"10",cost:{2:{final:0},3:{final:0}}},20:{name:"20",cost:{2:{final:0},3:{final:0}}},30:{name:"30",cost:{2:{final:0},3:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}}}}};t.exports=i,cc._RF.pop()},{gameDefine:"gameDefine"}],shopConfig:[function(e,t,a){"use strict";cc._RF.push(t,"940dc8uSNxHlK/vDiGgMF8f","shopConfig");t.exports={10001:{desc:"9000金币",costType:1,costNum:1,getType:0,getNum:9e3,icon:"jinbi2"},10002:{desc:"100000金币",costType:1,costNum:10,getType:0,getNum:1e5,icon:"jinbi3"},10003:{desc:"1050000金币",costType:1,costNum:100,getType:0,getNum:105e4,icon:"jinbi4"},10004:{desc:"10元话费",costType:3,costNum:12500,getType:1,getNum:1500001,icon:"shoptemp"},10005:{desc:"30元话费",costType:3,costNum:36e3,getType:1,getNum:1500002,icon:"shoptemp"},10006:{desc:"50元话费",costType:3,costNum:57500,getType:1,getNum:1500003,icon:"shoptemp"},10007:{desc:"100元话费",costType:3,costNum:11e4,getType:1,getNum:1500004,icon:"shoptemp"},10008:{desc:"500元话费",costType:3,costNum:525e3,getType:1,getNum:1500005,icon:"shoptemp"},10009:{desc:"1000元话费",costType:3,costNum:1e6,getType:1,getNum:1500006,icon:"shoptemp"},10010:{desc:"1房卡",costType:0,costNum:.1,getType:2,getNum:1,icon:"shoptemp"}},cc._RF.pop()},{}],shopHandler:[function(e,t,a){"use strict";cc._RF.push(t,"54767wc+LtI87RCRpkNsPHY","shopHandler");var o=e("errorCode"),r=e("shopConfig"),s=e("gameDefine"),n={};(t.exports=n).exchange=function(e){var t=r[e];if(t){var a=0,n=null;switch(t.costType){case s.shopCostType.Shop_Cost_Card:a=GameData.player.card,n="房卡不足";break;case s.shopCostType.Shop_Cost_Coin:a=GameData.player.coin,n="金币不足";break;case s.shopCostType.Shop_Cost_Point:a=GameData.player.point,n="积分不足";break;case s.shopCostType.Shop_Cost_Cash:var i="http://test-wx-cb.ry-play.com/WeChat/clientPay?token=clientPayment&uid="+GameData.player.uid+"&goods="+e+"&ip="+GameData.player.remoteAddr;return void openWebView(i)}a<t.costNum&&t.costType!=s.shopCostType.Shop_Cost_Cash?createMoveMessage(n):GameNet.getInstance().request("game.shopHandler.exchange",{exchangeId:e},function(e){switch(e.result){case o.notEnoughCard:n="房卡不足";break;case o.notEnoughCoin:n="金币不足";break;case o.notEnoughPoint:n="积分不足";break;case o.Fail:n="兑换失败";break;case o.notHaveWXOpenId:n="请点击退出游戏按钮,重新登录游戏";break;case o.Success:n="兑换成功"}n&&createMoveMessage(n)})}},cc._RF.pop()},{errorCode:"errorCode",gameDefine:"gameDefine",shopConfig:"shopConfig"}],shoppingPanel:[function(e,t,a){"use strict";cc._RF.push(t,"714b0JqGExOuLepcriWYgA5","shoppingPanel");var s=e("shopConfig"),c=e("gameDefine"),n=e("SoundMngr");cc.Class({extends:cc.Component,properties:{clickBtns:{default:[],type:[cc.Node]},panelViews:{default:[],type:[cc.Node]},leftArray:[],jifenStr:cc.Label,coinStr:cc.Label,commodityPrefab:cc.Prefab,jifenScollView:cc.ScrollView,cardScollView:cc.ScrollView,cashScollView:cc.ScrollView,coinScollView:cc.ScrollView},onLoad:function(){this.initGoodsType(),this.getLeftLenArray(),registEvent("onPlayerUpdate",this,this.showNumber)},onEnable:function(){this.showPanel(1),this.showNumber()},onDestroy:function(){unregistEvent("onPlayerUpdate",this,this.showNumber)},getLeftLenArray:function(){for(var e in s){var t=s[e].costType;contains(this.leftArray,t)||this.leftArray.push(t)}},clickShowView:function(e){n.instance.playAudioOther("button"),this.showPanel(e.target.name.split("_")[1])},showPanel:function(e){for(var t=0;t<this.clickBtns.length;t++){var a=this.clickBtns[t];if(t<this.leftArray.length){var n=a.getComponent(cc.Button),i="btn_"+e;a.name==i?n.interactable=!1:n.interactable=!0,a.active=!0}else a.active=!1}this.showView(e)},showView:function(e){for(var t=0;t<this.panelViews.length;t++){var a=this.panelViews[t],n="View_"+e;a.name==n?a.active=!0:a.active=!1}},initGoodsType:function(){for(var e in s){var t=s[e];if(t.costType==c.shopCostType.Shop_Cost_Point){var a=cc.instantiate(this.commodityPrefab);this.jifenScollView.content.addChild(a),a.getComponent("goodsType").getButtonId(e),a.getComponent("goodsType").initUI(t);var n=this.jifenScollView.content.childrenCount-1;a.x=n%4*230-354,a.y=-98-197*parseInt(n/4),this.jifenScollView.content.height=197*parseInt(this.jifenScollView.content.childrenCount/4)}else if(t.costType==c.shopCostType.Shop_Cost_Card){var i=cc.instantiate(this.commodityPrefab);this.cardScollView.content.addChild(i),i.getComponent("goodsType").getButtonId(e),i.getComponent("goodsType").initUI(t);n=this.cardScollView.content.childrenCount-1;i.x=n%4*230-354,i.y=-98-197*parseInt(n/4),this.cardScollView.content.height=197*parseInt(this.cardScollView.content.childrenCount/4)}else if(t.costType==c.shopCostType.Shop_Cost_Cash){var o=cc.instantiate(this.commodityPrefab);this.cashScollView.content.addChild(o),o.getComponent("goodsType").getButtonId(e),o.getComponent("goodsType").initUI(t);n=this.cashScollView.content.childrenCount-1;o.x=n%4*230-354,o.y=-98-197*parseInt(n/4),this.cashScollView.content.height=197*parseInt(this.cashScollView.content.childrenCount/4)}else if(t.costType==c.shopCostType.Shop_Cost_Coin){var r=cc.instantiate(this.commodityPrefab);this.coinScollView.content.addChild(r),r.getComponent("goodsType").getButtonId(e),r.getComponent("goodsType").initUI(t);n=this.coinScollView.content.childrenCount-1;r.x=n%4*230-354,r.y=-98-197*parseInt(n/4),this.coinScollView.content.height=197*parseInt(this.coinScollView.content.childrenCount/4)}}},showNumber:function(){var e=0,t=0;GameData.player.point&&(e=GameData.player.point),GameData.player.coin&&(t=GameData.player.coin),this.jifenStr.getComponent(cc.Label).string=ConversionCoinValue(e,0),this.coinStr.getComponent(cc.Label).string=ConversionCoinValue(t,0)},closeNode:function(){n.instance.playAudioOther("button"),closeView(this.node.name)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",shopConfig:"shopConfig"}],stateMachine:[function(e,t,a){"use strict";cc._RF.push(t,"71023BGPKRLZrpcUQYVbSZD","stateMachine");var n=e("es6-promise");cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.state=0,this.stateList={}},registState:function(e,t,a,n,i){this.stateList[e]={parent:t,before:a,run:n,after:i}},unregistState:function(e){delete this.stateList[e]},setState:function(t){if(this.state!=t){var a=this;n.resolve().then(function(){var e=a.stateList[a.state];null==e||"function"!=typeof e.after?n.resolve():e.after.call(e.parent,function(){n.resolve()})}).then(function(){var e=a.stateList[t];null==e||"function"!=typeof e.before?n.resolve():e.before.call(e.parent,function(){n.resolve()})}).then(function(){a.state=t,n.resolve()}).then(function(){var e=a.stateList[a.state];null==e||"function"!=typeof e.run?n.resolve():e.run.call(e.parent,function(){n.resolve()})}).catch(function(){console.log("Execute Promise error, state:"+t)})}}}),cc._RF.pop()},{"es6-promise":"es6-promise"}],summaryView:[function(e,t,a){"use strict";cc._RF.push(t,"40612/1fgtN6JQcESrtSvHg","summaryView");var g=e("roomHandler");cc.Class({extends:cc.Component,properties:{panel:cc.Node,font:{default:[],type:[cc.Font]}},onLoad:function(){},onDestroy:function(){},onEnable:function(){var e=g.getRoomData();if(null!=e){var t=0;this.showPlayer(GameData.player,++t);for(var a=0;a<GameData.joiners.length;a++)GameData.joiners[a].uid!=GameData.player.uid&&(this.showPlayer(GameData.joiners[a],++t),cc.find("player_"+(a+1),this.panel).active=!0);for(a=GameData.joiners.length;a<4;a++)cc.find("player_"+(a+1),this.panel).active=!1;for(a=0;a<GameData.joiners.length;a++)2==GameData.joiners.length?cc.find("player_"+(a+1),this.panel).x=310*a-155:3==GameData.joiners.length&&(cc.find("player_"+(a+1),this.panel).x=310*a-310);var n=cc.find("strNode/roomid",this.panel),i=cc.find("strNode/time",this.panel);n.getComponent("cc.Label").string="房间号:"+e.id;var o=getTimeStr(e.createtime);i.getComponent("cc.Label").string=o[0]+"/"+o[1]+"/"+o[2]+"  "+o[3]+":"+o[4]+":"+o[5]}},showPlayer:function(e,t){var a=g.getRoomData();if(null!=a){var n=g.getScoreData();if(null!=n){var i=cc.find("player_"+t+"/head_bg/name",this.panel),o=cc.find("player_"+t+"/head_bg/id",this.panel),r=cc.find("player_"+t+"/field_num1",this.panel),s=cc.find("player_"+t+"/head_bg/head",this.panel);o.getComponent("cc.Label").string="ID:"+e.uid,isChinese(e.name)?i.getComponent("cc.Label").string=getShortStr(e.name,8):i.getComponent("cc.Label").string=getShortStr(e.name,10);var c=n[e.uid];0<c?(r.getComponent("cc.Label").font=this.font[0],r.getComponent("cc.Label").string="+"+c):(r.getComponent("cc.Label").font=c<0?this.font[1]:this.font[2],r.getComponent("cc.Label").string=c);var d=e.headimgurl,h=s.getComponent(cc.Sprite);this.setIcon(h,d);var l=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&n[GameData.joiners[t].uid]>n[e]&&(e=GameData.joiners[t].uid);return e},u=cc.find("player_"+t+"/win",this.panel);l()==e.uid?u.active=0<n[l()]-a.initScore:u.active=!1,cc.find("player_"+t+"/head_bg/Owner",this.panel).active=a.creator==e.uid;var m=cc.find("player_"+t+"/selfBg",this.panel),p=cc.find("player_"+t+"/playerBg",this.panel);e.uid==GameData.player.uid?(m.active=!0,p.active=!1):(m.active=!1,p.active=!0),this.recordInfoShow(e.uid,t)}}},setIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},recordInfoShow:function(e,t){var a=cc.find("player_"+t+"/tongji/hu",this.panel),n=cc.find("player_"+t+"/tongji/chan",this.panel),i=cc.find("player_"+t+"/tongji/ming",this.panel),o=cc.find("player_"+t+"/tongji/an",this.panel);a.getComponent("cc.Label").string="胡牌次数:  0",n.getComponent("cc.Label").string="被铲次数:  0",i.getComponent("cc.Label").string="明杠次数:  0",o.getComponent("cc.Label").string="暗杠次数:  0"},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{roomHandler:"roomHandler"}],tableCardControl:[function(e,t,a){"use strict";cc._RF.push(t,"e1f42oANWFO67F4cH+jhgw5","tableCardControl");var n=e("SoundMngr"),o=(e("gameDefine"),e("errorCode")),m=e("ruleHandler"),u=e("roomHandler");cc.Class({extends:cc.Component,properties:{huierPanel:cc.Node,huierCardNode:cc.Node,play_layer_up:cc.Node,play_layer_down:cc.Node,play_layer_left:cc.Node,play_layer_right:cc.Node,spineNode:cc.Node,actionLayer:cc.Node,actionSecondaryLayer:cc.Node,cardTemplate:cc.Prefab,disCardArrow:cc.Prefab,cardButtonPrefab:cc.Prefab,cardHuierPrefab:cc.Prefab,cardTingPrefab:cc.Prefab,cardMaskPrefab:cc.Prefab,_curGameData:void 0},onLoad:function(){cc.log("...table card node onLoad."),registEvent("onCardBtnStart",this,this.onCardBtnStart),registEvent("onCardBtnMove",this,this.onCardBtnMove),registEvent("onCardBtnEnd",this,this.onCardBtnEnd),registEvent("onCardBtnCancel",this,this.onCardBtnCancel),this.selectedCard=-1,this.turnUid=0,this.tingData=[],this.actions=[],this.wildCards=[],this.playersUid={up:0,down:0,right:0,left:0},this.lastDisObject={lastDisCard:-1,lastDisUid:-1},this.myHandObject={handCards:[],obtainCard:0},this.handCardsObject={up:0,right:0,left:0},this.disCardsObject={up:[],down:[],right:[],left:[]},this.usedCardsObject={up:{chi:[],peng:[],gang:[]},down:{chi:[],peng:[],gang:[]},right:{chi:[],peng:[],gang:[]},left:{chi:[],peng:[],gang:[]}},this.actionsObject={data:{},type:!1},this._cardArrow=cc.instantiate(this.disCardArrow),this.node.addChild(this._cardArrow),this._cardArrow.active=!1,this.spineNode.active=!1,this.huierPanel.active=!1,this.myHandsInitPosition=[],this.saveMyHandsInitPosition(),this.setDisCardMax(),this.showPassActions(),this.updateWildCards(),this.updateMyHandCards(),this.updatePlayerDisCards(),this.updatePlayerUsedCards(),this.updatePlayerHandCards()},onDestroy:function(){unregistEvent("onCardBtnStart",this,this.onCardBtnStart),unregistEvent("onCardBtnMove",this,this.onCardBtnMove),unregistEvent("onCardBtnEnd",this,this.onCardBtnEnd),unregistEvent("onCardBtnCancel",this,this.onCardBtnCancel)},setDisCardMax:function(){var e=u.getRoomData();null!=e&&(4==e.opts.joinermax&&(this.discardMax=24),3==e.opts.joinermax&&(this.discardMax=36),2==e.opts.joinermax&&(this.discardMax=60))},setPlayersUid:function(e,t,a,n){void 0===this.playersUid&&(this.playersUid={}),this.playersUid.up=e,this.playersUid.down=t,this.playersUid.right=a,this.playersUid.left=n},setTurnUid:function(e){this.turnUid=e,this.updateMyHandCards()},setWildCards:function(e){this.wildCards=e,this.updateWildCards()},setActionsObject:function(e,t){void 0===this.actionsObject&&(this.actionsObject={}),this.actionsObject.data=e,this.actionsObject.type=t,this.showPassActions()},setLastDisObject:function(e,t){void 0===this.lastDisObject&&(this.lastDisObject={}),this.lastDisObject.lastDisUid=e,this.lastDisObject.lastDisCard=t,this.updatePlayerDisCards()},setMyHandObject:function(e,t){void 0===this.myHandObject&&(this.myHandObject={}),this.myHandObject.handCards=e,this.myHandObject.obtainCard=t,this.updateMyHandCards()},setHandCardsObject:function(e,t,a){void 0===this.handCardsObject&&(this.handCardsObject={}),this.handCardsObject.up=e,this.handCardsObject.right=t,this.handCardsObject.left=a,this.updatePlayerHandCards()},setDisCardsObject:function(e,t,a,n){void 0===this.disCardsObject&&(this.disCardsObject={}),this.disCardsObject.up=e,this.disCardsObject.down=t,this.disCardsObject.right=a,this.disCardsObject.left=n,this.updatePlayerDisCards()},setUsedCardsObject:function(e,t,a,n){void 0===this.usedCardsObject&&(this.usedCardsObject={}),this.usedCardsObject.up=e,this.usedCardsObject.down=t,this.usedCardsObject.right=a,this.usedCardsObject.left=n,this.updatePlayerUsedCards()},showActionEffect:function(e,t,a){cc.log("...1sex:"+e),cc.log("...1pos:"+t),cc.log("...1action:"+a),this.playActionAnimation(t,a),this.playAudioEffect(a,null,e)},showDisAudioEffect:function(e,t,a){this.playAudioEffect(e,t,a)},updateMyHandCards:function(){for(var e=cc.find("cardHand",this.play_layer_down),t=0;t<e.getChildrenCount();t++){var a=e.getChildren()[t];a&&(a.active=!1)}if(null!=this.myHandObject){var n=this.myHandObject.handCards;if(null!=n){var i,o,r=n.length,s=this.myHandObject.obtainCard,c=!1,d=1;if(this.turnUid==GameData.player.uid&&(r=n.length-1,this.checkHandNumber(n.length)&&s<=0))for(var h=n.length-1;0<=h;h--)if(o=n[h],!m.instance.isHuier(o)){s=n[h];break}for(var l=n.length-1;0<=l;l--){o=n[l],this.turnUid==GameData.player.uid&&s==o&&0==c?c=!(i=0):m.instance.isHuier(o)?(i=r,r--):(i=d,d++);var u=cc.find("cardHand/cardHand"+i,this.play_layer_down);u&&(u.active=!0,this.showCardContent(u,"mj_face_xia_shou",o),this.setMyHandButton(u,o,i),this.setMyHuierVisible(u,o,"down"),this.setMyTingVisible(u,o))}}}},updatePlayerHandCards:function(){this.showHandCards("up",this.play_layer_up),this.showHandCards("right",this.play_layer_right),this.showHandCards("left",this.play_layer_left)},updatePlayerDisCards:function(){this.showDisCards(this.play_layer_up,"mj_face_shang_shou","up"),this.showDisCards(this.play_layer_down,"mj_face_xia_chu","down"),this.showDisCards(this.play_layer_right,"mj_face_you_chu","right"),this.showDisCards(this.play_layer_left,"mj_face_zuo_chu","left")},updatePlayerUsedCards:function(){this.showUsedCards(this.play_layer_up,"mj_face_shang_shou","up"),this.showUsedCards(this.play_layer_down,"mj_face_xia_chu","down"),this.showUsedCards(this.play_layer_right,"mj_face_you_chu","right"),this.showUsedCards(this.play_layer_left,"mj_face_zuo_chu","left")},showHandCards:function(e,t){var a=cc.find("cardHand",t);if(null!=a&&null!=this.handCardsObject&&null!=this.usedCardsObject)if(this.handCardsObject[e]<=0)a.active=!1;else{a.active=!0;var n=void 0,i=void 0,o=0,r=0;this.usedCardsObject[e]&&(n=this.usedCardsObject[e].peng,i=this.usedCardsObject[e].gang),n&&(o=n.length),i&&(r=i.length);for(var s=this.handCardsObject[e]+3*(o+r),c=this.checkHandNumber(s)?0:1,d=1,h=0;h<=GameData.client.handsize;h++){var l=cc.find("cardHand"+h,a);h==c&&d<=this.handCardsObject[e]?(l.active=!0,c++,d++):l.active=!1}}},showDisCards:function(e,t,a){var n=u.getRoomData();if(null!=n){var i=cc.find("cardDis_4",e);i&&(i.active=!1);var o=cc.find("cardDis_3",e);o&&(o.active=!1);var r=cc.find("cardDis_2",e);if(r&&(r.active=!1),null!=this.disCardsObject){var s=this.disCardsObject[a];if(!(null==s||s.length<=0)){var c=cc.find("cardDis_"+n.opts.joinermax,e);c.active=!0;for(var d=1;d<=this.discardMax;d++){var h=cc.find("card_face"+d,c);if(h&&d<=s.length){var l=s[d-1];h.active=!0,this.showCardContent(h,t,l),this.playersUid[a]==this.lastDisObject.lastDisUid&&l==this.lastDisObject.lastDisCard&&(this._cardArrow.active=!0,this._cardArrow.parent=h,this._cardArrow.position.x=0,this._cardArrow.position.y=0,cc.find("left",this._cardArrow).active="left"==a,cc.find("down",this._cardArrow).active="down"==a,cc.find("right",this._cardArrow).active="right"==a,cc.find("up",this._cardArrow).active="up"==a)}else h.active=!1}}}}},showUsedCards:function(e,t,a){for(var n=cc.find("cardPeng",e),i=0;i<n.getChildrenCount();i++){var o=n.getChildren()[i];o&&(o.active=!1)}if(null!=this.usedCardsObject&&null!=this.usedCardsObject[a]){var r=this.usedCardsObject[a].chi,s=this.usedCardsObject[a].peng,c=this.usedCardsObject[a].gang;if(null!=r&&null!=c&&null!=s){var d,h,l,u,m,p,g,f,y=s.concat(r),v=parseInt(GameData.client.handsize/3);for(d=0;d<y.length&&!(v<=d);d++)if(h=cc.find("cardPeng"+(d+1),n)){for(l=0;l<4&&(u=h.getChildByName("card_face"+(l+1)).getComponent("cc.Sprite"),null!=(p=y[d]))&&!(null==(g=p.cards)||g.length<=0);l++)1<=g.length&&g.sort(function(e,t){return e-t}),l<g.length?(u.node.active=!0,3==l&&((m=h.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1),f=g[l],this.showCardContent(u.node,t,f)):u.node.active=!1;h.active=!0}for(;d<c.length&&!(v<=d);d++)if(h=cc.find("cardPeng"+(d+1),n)){for(l=0;l<4&&(u=h.getChildByName("card_face"+(l+1)).getComponent("cc.Sprite"),null!=(p=c[d]))&&!(null==(g=p.cards)||g.length<=0);l++)l<g.length?(u.node.active=!0,3==l&&(m=h.getChildByName("card_back4").getComponent("cc.Sprite"),p.type==GangType.Gang_An?(u.node.active=!1,m.node.active=!0):m.node.active=!1),f=g[l],this.showCardContent(u.node,t,f)):u.node.active=!1;h.active=!0}}}},addHuierIcon:function(e,t){if(e.childrenCount<=0){var a=new cc.Node;e.addChild(a);var n=cc.textureCache.addImage(cc.url.raw("resources/table/huier_icon.png"));a.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(n),"right"==t?(a.x=-32.6,a.y=7.1,a.rotation=-101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=11):"down"==t?(a.x=0,a.y=60,a.skewX=10):"left"==t?(a.x=31,a.y=8.6,a.rotation=101.2,a.scaleX=.4,a.scaleY=.4,a.skewX=-11):"up"==t&&(a.x=3,a.y=-6.8,a.rotation=180,a.scaleX=.4,a.scaleY=.3)}},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)},setMyHandButton:function(e,t,a){var n=e.getChildByName(e.name+"_button");null==n&&(n=cc.instantiate(this.cardButtonPrefab),e.addChild(n),n.name=e.name+"_button");var i=n.getComponent("CardButton");i.setCardId(t),i.setIndex(a)},setMyHuierVisible:function(e,t,a){var n=!1;m.instance.isHuier(t)&&(n=!0);var i=e.getChildByName(e.name+"_huier");null==i?1==n&&(i=cc.instantiate(this.cardHuierPrefab),cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0,i.y=i.y-18,e.addChild(i),i.name=e.name+"_huier"):i.active=n},setMyTingVisible:function(e,t){if(null!=this.tingData){for(var a=!1,n=0;n<this.tingData.length;n++){if(this.tingData[n].discard==t){a=!0;break}}var i=e.getChildByName(e.name+"_ting");null==i?1==a&&((i=cc.instantiate(this.cardTingPrefab)).y=i.y-10,e.addChild(i),i.name=e.name+"_ting"):i.active=a,this.turnUid!=GameData.player.uid&&null!=i&&(i.active=!1)}},updateWildCards:function(){if(!(null==this.wildCards||this.wildCards.length<=0)){this.huierPanel.active=!0;for(var e=cc.find("huier_bg",this.huierPanel),t="",a=1,n="",i=null,o=0;o<this.wildCards.length;o++){var r=this.wildCards[o];if(null!=r){t="huier_card"+a;var s=this.huierPanel.getChildByName(t);null==s&&((s=cc.instantiate(this.huierCardNode)).parent=this.huierPanel,s.name=t),s.y=this.huierCardNode.y,s.x=parseInt(this.huierCardNode.x+(this.huierCardNode.width*this.huierCardNode.scaleX+5)*(a-1)),n="resources/mjcard2d/mj_face_xia_shou_"+r+".png",(i=cc.textureCache.addImage(cc.url.raw(n)))&&(s.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(i)),a++}}e.width=parseInt(this.huierCardNode.width*this.huierCardNode.scaleX*(a-1))}},showMask:function(e){this.showPengCardMask(e,this.play_layer_up,"up"),this.showPengCardMask(e,this.play_layer_down,"down"),this.showPengCardMask(e,this.play_layer_left,"left"),this.showPengCardMask(e,this.play_layer_right,"right"),this.showDisCardMask(e,this.play_layer_up,"up"),this.showDisCardMask(e,this.play_layer_down,"down"),this.showDisCardMask(e,this.play_layer_left,"left"),this.showDisCardMask(e,this.play_layer_right,"right")},showPengCardMask:function(e,t,a){if(null!=this.usedCardsObject[a])for(var n=1;n<5;n++){var i=cc.find("cardPeng/cardPeng"+n,t);if(null!=i&&i.active)for(var o=1;o<5;o++){var r=cc.find("card_face"+o,i);r.active&&this.gotoMask(r,e,a)}}},showDisCardMask:function(e,t,a){var n=u.getRoomData();if(null!=n){var i=this.disCardsObject[a];if(!(null==i||i.length<=0))for(var o=1;o<=this.discardMax;o++){var r=cc.find("cardDis_"+n.opts.joinermax+"/card_face"+o,t);r.active&&this.gotoMask(r,e,a)}}},gotoMask:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i=t==n.id,o=this.setMaskVisible(e,i);null!=o&&(cc.find("up",o).active=!1,cc.find("down",o).active=!1,cc.find("right",o).active=!1,cc.find("left",o).active=!1,cc.find(a,o).active=!0)}},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},onGameScore:function(){},onCardBtnStart:function(e){},onCardBtnMove:function(e){var t=e.detail.card;this.turnUid==GameData.player.uid&&this.showMask(t)},onCardBtnEnd:function(e){var t=e.detail.index;switch(e.detail.type){case-1:t==this.selectedCard&&(this.selectedCard=-1),this.onHandCardClicked(e);break;case 0:this.onHandCardClicked(e);break;case 1:this.selectedCard=t,this.onHandCardClicked(e)}},onCardBtnCancel:function(e){},onHandCardClicked:function(e){var t=e.detail.card,a=e.detail.index,n=cc.find("cardHand/cardHand"+a,this.play_layer_down);if(this.selectedCard==a){var i=this;this.turnUid==GameData.player.uid&&this._curGameData.requestDisCard(t,function(e){e.result==o.Success&&(n.stopAllActions(),i.selectedCard=-1,i.moveBackMyCards())})}else{if(0<=this.selectedCard)cc.find("cardHand/cardHand"+this.selectedCard,this.play_layer_down).runAction(cc.moveTo(.01,this.myHandsInitPosition[this.selectedCard]));n.runAction(cc.moveTo(.01,cc.p(this.myHandsInitPosition[a].x,30))),this.selectedCard=a,this.turnUid==GameData.player.uid&&this.showMask(t)}},moveUpMyCards:function(e,t){for(var a=0,n=1;n<=GameData.client.handsize;n++){var i=cc.find("cardHand/cardHand"+n,this.play_layer_down);if(i.getComponent("Card").id==e&&(i.y=30,t<=++a))return}},saveMyHandsInitPosition:function(){for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);this.myHandsInitPosition.push(t.getPosition())}},moveBackMyCards:function(){this.selectedCard=-1;for(var e=0;e<=GameData.client.handsize;e++){var t=cc.find("cardHand/cardHand"+e,this.play_layer_down);t.getComponent("Card").id;t.position=this.myHandsInitPosition[e]}},checkAnGangAndBuGang:function(){var e=0;this.actionGang=[];var t=m.instance.canAnGang(GameData.player.uid);if(null!=t||0<t.length)for(var a=0;a<t.length;a++)this.actionGang[e]={act:"angang",card:t[a]},e++;var n=m.instance.canBuGang(GameData.player.uid);if(null!=n||0<n.length)for(var i=0;i<n.length;i++)this.actionGang[e]={act:"bugang",card:n[i]},e++},showPassActions:function(){if(this.actionLayer.active=!1,null!=this.actionsObject){var e=this.actionsObject.data;if(null!=e)if(!(0==this.actionsObject.type&&e.fromCard<=0))if(!(null==e.action||e.action.length<=0))if(null!=this.myHandObject)if(null!=this.myHandObject.handCards){this.actionLayer.active=!0;for(var t=1;t<=4;t++){cc.find("btnAct"+t,this.actionLayer).active=!1}var a=0,n=!1;this.actions=[];for(var i=0;i<e.action.length;i++){var o=e.action[i];if(!(null==o||o.length<=0)){var r=[];switch(o){case"chi":if(null==(r=m.instance.canChi(GameData.player.uid,e.fromCard))||r.length<=0)continue;break;case"peng":case"minggang":break;case"angang":case"bugang":if(1==n)continue;n=!0;break;case"dianpao":break;case"zimo":e.fromCard=this.myHandObject.obtainCard}this.actions[a]={act:o,card:e.fromCard,checkCards:r},this.createActionBtn(++a,o)}}this.moveBackMyCards()}}},createActionBtn:function(e,t){var a=null;switch(t){case"chi":a="chi";break;case"peng":a="peng";break;case"minggang":case"angang":case"bugang":a="gang";break;case"dianpao":case"zimo":a="hu"}cc.log("..act:"+t+"..show btn:"+a);var n=cc.find("btnAct"+e,this.actionLayer),i="resources/table/action/"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));n.getComponent("cc.Sprite").spriteFrame=new cc.SpriteFrame(o),n.active=!0},onBtnPassClicked:function(e){cc.log("..onBtnPassClicked."),cc.log("..actions:"+JSON.stringify(this.actions)),Object.keys(this.actions).length<=0?cc.log("..actions is null.No Pass"):(this._curGameData.requestPass(function(e){}),this.actionLayer.active=!1,this.actionSecondaryLayer.active=!1,this.moveBackMyCards())},onBtnActionClicked:function(e,t){cc.log("..actionClicked, index : "+t),cc.log("..actions:"+JSON.stringify(this.actions));var a=this,n=this.actions[t];if(null==n||null==n.act||n.act.length<=0)cc.log("..action string is undefined.");else{switch(n.act){case"chi":1==n.checkCards.length?(cc.log("....requestChiCard:"+JSON.stringify(n.checkCards[0])),this._curGameData.requestChiCard(n.checkCards[0],function(e){0==e.result&&a.showEffect("chi")})):this.refreshActionType(n);break;case"peng":this._curGameData.requestPengCard(n.card,function(e){0==e.result&&a.showEffect("peng")});break;case"minggang":this._curGameData.requestMingGangCard(n.card,function(e){0==e.result&&a.showEffect("gang")});break;case"bugang":case"angang":if(this.checkAnGangAndBuGang(),null==this.actionGang||Object.keys(this.actionGang).length<=0)return void cc.log("..no An Gang. no Bu Gang.");1==Object.keys(this.actionGang).length?this.onBtnGangActionClicked(0):this.refreshGangActionType();break;case"dianpao":this._curGameData.requestDianPao(n.card,function(e){0==e.result&&a.showEffect("hu")});break;case"zimo":this._curGameData.requestHu(n.card,function(e){0==e.result&&a.showEffect("hu")})}this.moveBackMyCards(),this.actionLayer.active=!1}},refreshActionType:function(e){if(cc.log("....data:"+JSON.stringify(e)),null!=e){this.actionSecondaryLayer.active=!0,this.actionTypeData=e;var t=cc.find("card",this.actionSecondaryLayer),a=cc.find("cardLayout",this.actionSecondaryLayer);a.removeAllChildren();for(var n=0;n<e.checkCards.length;n++){var i=e.checkCards[n];if(null!=i){switch(e.act){case"chi":i.push(e.card)}i.sort(function(e,t){return e-t});for(var o=cc.instantiate(t),r=0;r<i.length;r++){var s=i[r],c=cc.find("card_"+r,o);if(!(s<=0||null==c)){var d="resources/mjcard2d/mj_face_xia_shou_"+s+".png",h=cc.textureCache.addImage(cc.url.raw(d));if(h&&(c.getComponent(cc.Sprite).spriteFrame=null,c.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(h)),s==e.card){var l=c.getChildByName(c.name+"_biao");null==l&&(l=cc.instantiate(this.cardTingPrefab),c.addChild(l),l.y-=10,l.name=c.name+"_biao")}c.active=!0}}a.addChild(o),o.active=!0,o.tag=n,o.width=252,o.getComponent(cc.Sprite).spriteFrame=null,o.on(cc.Node.EventType.TOUCH_START,this.onBtnChiActionClicked,this)}}}},refreshGangActionType:function(){var t=this;if(cc.log("....data:"+JSON.stringify(this.actionGang)),null!=this.actionGang){this.actionSecondaryLayer.active=!0;var a=this,n=cc.find("card",this.actionSecondaryLayer),i=cc.find("cardLayout",this.actionSecondaryLayer);i.removeAllChildren();for(var e=function(e){return null==(r=t.actionGang[e])?"continue":(s=cc.instantiate(n),c=r.card,d=cc.find("card_2",s),c<=0||null==d?"continue":(h="resources/mjcard2d/mj_face_xia_shou_"+c+".png",(l=cc.textureCache.addImage(cc.url.raw(h)))&&(d.getComponent(cc.Sprite).spriteFrame=null,d.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(l)),null==(u=d.getChildByName(d.name+"_biao"))&&(u=cc.instantiate(t.cardTingPrefab),d.addChild(u),u.y-=10,u.name=d.name+"_biao"),d.active=!0,i.addChild(s),s.active=!0,s.width=252,s.getComponent(cc.Sprite).spriteFrame=null,void s.on(cc.Node.EventType.TOUCH_START,function(){a.onBtnGangActionClicked(e)},t)))},o=0;o<this.actionGang.length;o++){var r,s,c,d,h,l,u;e(o)}}},onBtnChiActionClicked:function(e){var t=e.target.tag,a=this.actionTypeData.card,n=this.actionTypeData.checkCards[t];if(null!=n){var i=this;n=spliceArrayElementOne(n,a),cc.log("....requestChiCard:"+JSON.stringify(n)),this._curGameData.requestChiCard(n,function(e){0==e.result&&i.showEffect("chi")})}this.actionSecondaryLayer.active=!1},onBtnGangActionClicked:function(e){cc.log("..gangClicked, index : "+e),cc.log("..actionGang:"+JSON.stringify(this.actionGang));var t=this,a=this.actionGang[e];if(null==a||null==a.act||a.act.length<=0)cc.log("..actionGang string is undefined.");else{switch(a.act){case"angang":this._curGameData.requestAnGangCard(a.card,function(e){0==e.result&&t.showEffect("gang")});break;case"bugang":this._curGameData.requestBuGangCard(a.card,function(e){0==e.result&&t.showEffect("gang")})}this.actionSecondaryLayer.active=!1}},onBackToActionLayer:function(){this.actionLayer.active=!0,this.actionSecondaryLayer.active=!1},showEffect:function(e){cc.log("show effect: "+e);var t="",n="";switch(e){case"chi":t="spine/table/chi",n="a";break;case"peng":t="spine/table/peng",n="animation";break;case"gang":t="spine/table/gang",n="a";break;case"hu":t="spine/table/hu",n="a"}var i=this.spineNode;this.spineNode.active=!0;var a=i.getComponent("sp.Skeleton");a.skeletonData=null,a.animation=null,cc.loader.loadRes(t,sp.SkeletonData,function(e,t){var a=i.getComponent("sp.Skeleton");a.skeletonData=t,a.animation=n})},playActionAnimation:function(e,t){cc.log("...3pos: "+e),cc.log("...3action: "+t);var a=cc.find("actionAnimations/"+e,this.node);cc.log("---\x3e animationNode : "+a),null!=a&&(cc.log("---\x3e playActionAnimation : "+t),a.getComponent(cc.Animation).play(t))},playAudioEffect:function(e,t,a){cc.log("---\x3e action : "+e),cc.log("---\x3e card : "+t),cc.log("---\x3e sex : "+a),n.instance.playAudio(e,t,a)},checkHandNumber:function(e){for(var t=GameData.client.handsize,a=parseInt(t/3),n=0;n<=a;n++){if(e==t+1-3*n)return!0}return!1}}),cc._RF.pop()},{SoundMngr:"SoundMngr",errorCode:"errorCode",gameDefine:"gameDefine",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],tableDirectionControl:[function(e,t,a){"use strict";cc._RF.push(t,"aad93N8v31C7YeSh74EKc0a","tableDirectionControl");var n=e("SoundMngr"),i=e("gameDefine");cc.Class({extends:cc.Component,properties:{direction_pos:cc.Sprite,direction_turn:cc.Node,countdown_num1:cc.Sprite,countdown_num2:cc.Sprite,_countdown_index:0,leftCardNumLabel:cc.Label,lastRoundLabel:cc.RichText,quanNode:cc.Node,juNode:cc.Node},onLoad:function(){this.turnUid=0,this.roomState=-1,this.roundCur=0,this.roundMax=0,this.roundRule=0,this.leftNumber=0,this.showTurn(),this.updateRoundString(),this.updateLeftCardNumber()},onEnable:function(){},onDestroy:function(){},setRoomRoundCur:function(e,t){this.roundCur=e,this.roundMax=t,this.updateRoundString()},setRoundRule:function(e){this.roundRule=e,this.updateRoundRule()},setLeftCardNumber:function(e){this.leftNumber=e,this.updateLeftCardNumber()},setTurnUid:function(e){this.turnUid=e,this.showTurn()},setRoomState:function(e){this.roomState=e,this.roomState<i.RoomState.GAMEING&&this.stopCoundDown()},startCoundDown:function(){this._countdown_index=10,this.schedule(this.runCountDown,1)},stopCoundDown:function(){this.unschedule(this.runCountDown)},setPosition:function(){var e=GameData.getPlayerIndex(GameData.player.uid),t=0;0==e?t=90:3==e?t=0:2==e?t=270:1==e&&(t=180),this.direction_pos.node.rotation=t},showTurn:function(){var e=GameData.getPlayerIndex(this.turnUid);if(!(e<0)){var t;t=0==e?"dong":3==e?"nan":2==e?"xi":1==e?"bei":"dong";var a=cc.textureCache.addImage(cc.url.raw("resources/table/"+t+".png"));this.direction_pos.spriteFrame=new cc.SpriteFrame(a),cc.find("down",this.direction_turn).active=!1,cc.find("right",this.direction_turn).active=!1,cc.find("up",this.direction_turn).active=!1,cc.find("left",this.direction_turn).active=!1,null!=(t=GameData.getPlayerPosByUid(this.turnUid))&&(cc.find(t,this.direction_turn).active=!0)}},runCountDown:function(){this.showCountDown(this._countdown_index+""),this._countdown_index<=0?this._countdown_index=10:(3==this._countdown_index&&this.turnUid==GameData.player.uid&&n.instance.playAudioOther("countdown"),this._countdown_index--)},showCountDown:function(e){var t=e.split("");if(0!=t.length){var a,n;if(1==t.length)a=cc.url.raw("resources/number/jinzi0.png"),n=cc.url.raw("resources/number/jinzi"+e+".png");else{if(2!=t.length)return;a=cc.url.raw("resources/number/jinzi"+t[0]+".png"),n=cc.url.raw("resources/number/jinzi"+t[1]+".png")}var i=cc.textureCache.addImage(a),o=cc.textureCache.addImage(n);this.countdown_num1.spriteFrame=new cc.SpriteFrame(i),this.countdown_num2.spriteFrame=new cc.SpriteFrame(o)}},updateRoundString:function(){var e=this.roundCur>this.roundMax?this.roundMax:this.roundCur;this.lastRoundLabel.string=e+"/"+this.roundMax},updateLeftCardNumber:function(){this.leftNumber<0&&(this.leftNumber=0),this.leftCardNumLabel.string=this.leftNumber},updateRoundRule:function(){4<=this.roundRule?(this.quanNode.active=!0,this.juNode.active=!1):(this.quanNode.active=!1,this.juNode.active=!0)}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine"}],tableDynAnimation:[function(e,t,a){"use strict";cc._RF.push(t,"e4104PotCJBEoxRKR3raFbF","tableDynAnimation");var s=e("SoundMngr"),n=(e("gameDefine"),e("pokerAnimationBase"));cc.Class({extends:cc.Component,properties:{layer:cc.Node,animationList:{default:[],type:cc.Node}},onLoad:function(){this.AnimBase=new n},onDestroy:function(){},onEnable:function(){},playAnimation:function(t,e,a,n){var i=this.animationList[t];if(null!=i){n&&n.y&&(n.y+=10);var o=cc.instantiate(i);o.parent=this.layer,o.active=!0,o.scale=e;var r=this;this.AnimBase.playDragonBonesAnimation(o,"feixing",0,a,n,function(e){r.AnimBase.playDragonBonesAnimation(e,"touxiangxiaoguo",1,null,null,function(e){e.destroy()}),s.instance.playTableDynAudio(t,1)}),s.instance.playTableDynAudio(t,0)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",pokerAnimationBase:"pokerAnimationBase"}],tablePlayersControl:[function(e,t,a){"use strict";cc._RF.push(t,"6900fTMI0pO64ZRrdlxI80l","tablePlayersControl");var r=e("gameDefine"),v=e("SoundMngr"),o=e("roomHandler");cc.Class({extends:cc.Component,properties:{play_up_player:cc.Node,play_down_player:cc.Node,play_left_player:cc.Node,play_right_player:cc.Node,readyNode:cc.Node,lostNode:cc.Node,playerTemplate:cc.Prefab,dragonBonesNode:cc.Prefab},onLoad:function(){registEvent("onRoomChat",this,this.onRoomChatHandler),registEvent("dynChat",this,this.dynChatHandler),this.headers=[],this.zhuangUid=0,this.turnUid=0,this.roomState=-1,this.readyData={},this.scoreData={},this.onLineData={},this.addDynAnimation(),this.showPlayers(),this.updatePlayerZhuang(),this.updatePlayerReady(),this.updatePlayerTurn(),this.updatePlayerScore(),this.updatePlayerOnLine()},onEnable:function(){},onDestroy:function(){unregistEvent("onRoomChat",this,this.onRoomChatHandler),unregistEvent("dynChat",this,this.dynChatHandler)},setPlayerZhuang:function(e){this.zhuangUid=e,this.updatePlayerZhuang()},setRoomReadyData:function(e,t){this.roomState=e,this.readyData=t,this.updatePlayerReady()},setPlayerTurn:function(e){this.turnUid=e,this.updatePlayerTurn()},setPlayerScoreData:function(e){null!=e&&(this.scoreData=e,this.updatePlayerScore())},setPlayerOnLineData:function(e){null!=e&&(this.onLineData=e,this.updatePlayerOnLine())},dynChatHandler:function(e){if(null!=e&&null!=e.detail){var t=e.detail.chatId,a=e.detail.fromUid,n=e.detail.toUid,i=this.node.getChildByName("uiAnimationNode");if(i){var o=i.getComponent("tableDynAnimation");if(o){var r=this.getHeadPositionOnUid(a),s=this.getHeadPositionOnUid(n);o.playAnimation(t,.65,r,s)}}}},addDynAnimation:function(){var e=this.node.getChildByName("uiAnimationNode");null==e&&((e=cc.instantiate(this.dragonBonesNode)).parent=this.node,e.name="uiAnimationNode")},showPlayers:function(){this.headers=[],this.showPlayer("down",this.play_down_player),this.showPlayer("right",this.play_right_player),this.showPlayer("up",this.play_up_player),this.showPlayer("left",this.play_left_player)},showPlayer:function(e,t){var a=GameData.getPlayerByPos(e);if(null!=a){var n=t.getChildByName("playerNode");null==n&&((n=cc.instantiate(this.playerTemplate)).name="playerNode",n.parent=t),t.active=!0,n.getComponent("playerTemplate").setPlayer(a),n.getComponent("playerTemplate").setName(a.name),n.getComponent("playerTemplate").setHeadIcon(a.headimgurl),this.headers.push(n)}else t.active=!1},updatePlayerZhuang:function(){for(var e=0;e<this.headers.length;e++){var t=this.headers[e];if(t){var a=t.getComponent("playerTemplate"),n=this.zhuangUid==a.uid;a.showZhuang(n)}}},updatePlayerTurn:function(){for(var e=0;e<this.headers.length;e++){var t=this.headers[e];if(t){var a=t.getComponent("playerTemplate").uid,n=cc.find("liuguang",t);n&&(n.active=this.turnUid==a)}}},updatePlayerScore:function(){for(var e=0;e<this.headers.length;e++){var t=this.headers[e];if(t){var a=t.getComponent("playerTemplate").uid,n=null==this.scoreData[a]?0:this.scoreData[a];t.getComponent("playerTemplate").setCoin(n)}}},updatePlayerReady:function(){for(var e=0;e<this.headers.length;e++){var t=!1,a=!1,n=this.headers[e];if(n){var i=n.getComponent("playerTemplate");0<=this.roomState&&this.roomState<r.RoomState.GAMEING&&(1==this.readyData[i.uid]?a=!0:t=!0)}var o=GameData.getPlayerPosByUid(i.uid);this.showReadyIcon(o,a,t),cc.log("...ready:"+o,a,t)}},updatePlayerOnLine:function(){for(var e=0;e<this.headers.length;e++){var t=!1,a=this.headers[e];if(a){var n=a.getComponent("playerTemplate");t=o.isPlayerOnline(n.uid),n.setIsOnline(t)}var i=GameData.getPlayerPosByUid(n.uid);this.showLostIcon(i,t)}},showReadyIcon:function(e,t,a){var n=cc.find("ready_hand_"+e,this.readyNode);n&&(n.active=t);var i=cc.find("readying_"+e,this.readyNode);i&&(i.active=a)},showLostIcon:function(e,t){var a=cc.find("lost_"+e,this.lostNode);a&&(a.active=!t)},onRoomChatHandler:function(e){for(var t=e.detail.uid,a=e.detail.msg.type,n=0;n<this.headers.length;n++){var i=this.headers[n];if(i.getComponent("playerTemplate").uid==t){var o,r=GameData.tablePos[t],s=cc.find("chat_"+r,i);if(null!=s){var c=cc.find("word",s),d=cc.find("emo",s),h=cc.find("yuyinNode",s),l=cc.find("word/bg",s),u=cc.find("word/Label",s).getComponent(cc.Label);if("word"==a)o=e.detail.msg.data,u.string=o,l.width=20+24*o.length,c.getComponent("HideComponent").show(3);else if("fast"==a){var m=e.detail.msg.data.sound;o=e.detail.msg.data.content;var p=getShortStr(o,20);u.string=p,l.width=30*p.length;var g=GameData.getPlayerSexByUid(t);v.instance.playAudioChat(m,g),c.getComponent("HideComponent").show(3)}else if("emo"==a){var f=e.detail.msg.data;d.getComponent(cc.Animation).play(f),d.getComponent("HideComponent").show(3)}else if("yuyin"==a){if(!GameData.isPlayVioce)return;var y=e.detail.msg.data;cc.sys.OS_ANDROID==cc.sys.os?jsb.reflection.callStaticMethod("org.cocos2dx.javascript.AppActivity","playRecord","(Ljava/lang/String;)V",y):cc.sys.OS_IOS==cc.sys.os&&jsb.reflection.callStaticMethod("AppController","playRecord:",String(y)),cc.find("yuyinAnimNode/yuyinAnim",h).getComponent(cc.Animation).play("yuyinduihua"),h.getComponent("HideComponent").show(3)}}}}},getHeadPositionOnUid:function(e){for(var t=0;t<this.headers.length;t++){var a=this.headers[t];if(null!=a){var n=a.getComponent("playerTemplate");if(null!=n&&n.uid==e)return a.parent.position}}return 0}}),cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],talkView:[function(e,t,a){"use strict";cc._RF.push(t,"ffd49ngdldMuocTF5VeV5kJ","talkView"),cc.Class({extends:cc.Component,properties:{voiceBtnNode:cc.Node},onLoad:function(){registEvent("yunwaUploaded",this,this.handleVoice),registEvent("shortRecord",this,this.YVShortRecordCallback)},onDestroy:function(){unregistEvent("yunwaUploaded",this,this.handleVoice),unregistEvent("shortRecord",this,this.YVShortRecordCallback)},onEnable:function(){this.setVoiceBtn(),this.initTalkNode()},setVoiceBtn:function(){var i=this;this.voiceBtnNode.on(cc.Node.EventType.TOUCH_START,function(e){inCD(1e3)||i.startTalk()}),this.voiceBtnNode.on(cc.Node.EventType.TOUCH_MOVE,function(e){var t=e.touch.getLocation(),a=this.convertToWorldSpace(this.getPosition()),n={};n.x=a.x-this.getPosition().x+170,n.y=a.y-this.getPosition().y+50,cc.pDistance(t,n)>this.width&&i.cancelTalk()}),this.voiceBtnNode.on(cc.Node.EventType.TOUCH_END,function(){i.endTalk()}),this.voiceBtnNode.on(cc.Node.EventType.TOUCH_CANCEL,function(){i.endTalk()})},initTalkNode:function(){this.talkNode=new cc.Node,this.talkNode.setTag("talkNode");var e=cc.textureCache.addImage(cc.url.raw("resources/animation/yuyin/yuyinjingtan.png"));this.talkNode.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(e);var a=this.talkNode.addComponent(cc.Animation);cc.loader.loadRes("animation/yuyin/yuyin",function(e,t){a.addClip(t,"yuyin")}),cc.loader.loadRes("animation/yuyin/CancelSend",function(e,t){a.addClip(t,"CancelSend")}),cc.loader.loadRes("animation/yuyin/ShortRecoed",function(e,t){a.addClip(t,"ShortRecoed")})},startTalk:function(){yunwaStartTalk(),GameData.isPlayVioce=!0,cc.audioEngine.pauseAll(),cc.director.getScene().getChildByName("Canvas").addChild(this.talkNode),this.talkNode.getComponent(cc.Animation).play("yuyin")},endTalk:function(){yunwaStopTalk(),GameData.isPlayVioce=!1,cc.audioEngine.resumeAll(),cc.director.getScene().getChildByName("Canvas").removeChildByTag("talkNode")},cancelTalk:function(){GameData.isPlayVioce=!1,cc.audioEngine.resumeAll(),this.talkNode.getComponent(cc.Animation).play("CancelSend")},handleVoice:function(e){var t=e.detail;ChatHandler.getInstance().sendRecord(t)},YVShortRecordCallback:function(){cc.director.getScene().getChildByName("Canvas").addChild(this.talkNode),this.talkNode.getComponent(cc.Animation).play("ShortRecoed"),this.unschedule(this.goToHide),this.scheduleOnce(this.goToHide,1)},goToHide:function(){cc.director.getScene().getChildByName("Canvas").removeChildByTag("talkNode")}}),cc._RF.pop()},{}],"tdk-ResultRender":[function(e,t,a){"use strict";cc._RF.push(t,"80d00XDENdJsrwk6r6GnH1a","tdk-ResultRender");var o=e("tdkRoomData"),r=e("gameDefine"),s=e("roomHandler");cc.Class({extends:cc.Component,properties:{maxWinner:cc.Node,nameLbl:cc.Label,userIdLbl:cc.Label,winNumLbl:cc.Label,loseNumLbl:cc.Label,baoNumLbl:cc.Label,doubleKingLbl:cc.Label,fourSameLbl:cc.Label,creatorIcon:cc.Node,headIcon:cc.Node,roomScoreLbl:cc.Label,fonts:[cc.Font],_playerInfo:null,infoNode:cc.Node},onLoad:function(){},initUI:function(){var e=this._playerInfo;JSON.stringify("结算玩家数据  "+JSON.stringify(e)),this.nameLbl.string=getShortStr(e.name,10),this.userIdLbl.string="ID: "+e.uid;var a=this;(this.headIcon.getComponent(cc.Sprite).spriteFrame=null)!=e.headimgurl&&""!=e.headimgurl&&0<e.headimgurl.length&&cc.loader.load({url:e.headimgurl,type:"png"},function(e,t){!e&&t&&(a.headIcon.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t))}),this.winNumLbl.string=0,this.loseNumLbl.string=0,this.baoNumLbl.string=0,this.doubleKingLbl.string=0,this.fourSameLbl.string=0;var i,t=o.resultData;o.resultData.statis&&o.resultData.statis[e.uid]&&(this.winNumLbl.string=t.statis[e.uid].win,this.loseNumLbl.string=t.statis[e.uid].lost,this.baoNumLbl.string=t.statis[e.uid].baozi,this.doubleKingLbl.string=t.statis[e.uid].kings,this.fourSameLbl.string=t.statis[e.uid].zhadan);var n=0;GameData.room.opts.currencyType==r.currencyType.Currency_Coin?s.coinData.coins&&(n=(i=s.coinData.coins)[e.uid]):GameData.room.opts.currencyType==r.currencyType.Currency_Card&&o.resultData.score&&o.resultData.score[e.uid]&&(n=(i=t.score)[e.uid]),0<n?(this.roomScoreLbl.string="+"+n,this.roomScoreLbl.font=this.fonts[0]):n<0?(this.roomScoreLbl.string=n,this.roomScoreLbl.font=this.fonts[1]):0==n&&(this.roomScoreLbl.string=n,this.roomScoreLbl.font=this.fonts[2]);null!=i&&function(){var e=[];for(var t in i)e.push(i[t]);for(var a=0,n=1;n<e.length;n++)e[n]&&e[n]>e[a]&&(a=n);return e[a]}()==i[e.uid]&&(this.maxWinner.active=!0),this.creatorIcon.active=e.uid==GameData.room.creator},getActiveNode:function(){return this.infoNode},initData:function(e){e&&(this._playerInfo=e,cc.log("tdk_roomData.resultData = "+JSON.stringify(o.resultData)),0<Object.keys(o.resultData).length&&this.initUI())}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler",tdkRoomData:"tdkRoomData"}],"tdk-debug":[function(e,t,a){"use strict";cc._RF.push(t,"78b06ZrCApAV4ARVl5JucF8","tdk-debug");var n=e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,debugBtn:cc.Node},onLoad:function(){var e=n.getSetCardsOpen();this.debugBtn.active=e},onOkBtnClick:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){console.log("--- 调牌结果 "+JSON.stringify(e))})}}),cc._RF.pop()},{configMgr:"configMgr"}],"tdk-resultFlyScore":[function(e,t,a){"use strict";cc._RF.push(t,"5e944hpZtNEeYfE2Q5ji8P3","tdk-resultFlyScore"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,fonts:[cc.Font]},onLoad:function(){},getScoreColor:function(e){0<(this.scoreLabel.getComponent(cc.Label).string=e)?(this.scoreLabel.getComponent(cc.Label).string="+"+e,this.scoreLabel.getComponent(cc.Label).font=this.fonts[0]):e<0&&(this.scoreLabel.getComponent(cc.Label).string=e,this.scoreLabel.getComponent(cc.Label).font=this.fonts[1])}}),cc._RF.pop()},{}],tdkRoomData:[function(e,t,a){"use strict";cc._RF.push(t,"ccd21DbO1tHRoJO9zKPbbYG","tdkRoomData");var o={roundNum:0,roundmax:0,addpokersRight:!1,createRoomOpts:{},pokers:{},roomInfo:{},initScore:[],turn:0,score:[],maxScore:0,allInscore:0,actionBtn:{},turnerAction:{},close:0,gameResult:{},resultData:{},connectWin:0,presentScore:{},incPokerData:{},DropPlayerInfo:{},onRoomReadyInfo:{}};(t.exports=o).initCreateRoomOpts=function(){var e=cc.sys.localStorage.getItem("createRoomOpts_tdk");null==e?(o.createRoomOpts={},o.createRoomOpts.playType=2,o.createRoomOpts.king=!1,o.createRoomOpts.nextDouble=!1,o.createRoomOpts.roundMax=15,o.createRoomOpts.roundRule=71,o.createRoomOpts.quanya=0,o.createRoomOpts.costType=1,o.createRoomOpts.player=4):o.createRoomOpts=JSON.parse(e)},o.saveCreateRoomOpts=function(){null!=o.createRoomOpts&&null!=o.createRoomOpts&&cc.sys.localStorage.setItem("createRoomOpts_tdk",JSON.stringify(o.createRoomOpts))},o.getHandPokerByUid=function(e){for(var t in o.pokers)if(t==e)return o.pokers[t];return null},o.getPlayerSexByUid=function(e){for(var t=0;t<GameData.joiners.length;++t)if(GameData.joiners[t]&&GameData.joiners[t].uid==e)return GameData.joiners[t].sex;return null},o.getPlayerInfoByUid=function(e){for(var t=0;t<GameData.joiners.length;t++)if(GameData.joiners[t].uid==e)return GameData.joiners[t];return null},o.getPlayerPosByUid=function(e){for(var t=0;t<GameData.joiners.length;t++)if(GameData.joiners[t].uid==e)return t;return null},o.getLocalPosition=function(e){for(var t=[],a=0;a<GameData.joiners.length;a++)t.push(a);var n=o.getPlayerPosByUid(GameData.player.uid),i=t.slice(t.indexOf(n));return(i=i.concat(t.slice(0,t.indexOf(n)))).indexOf(e)},o.registMessage=function(){o.initCreateRoomOpts(),GameNet.getInstance().setCallBack("onPlayerIncScore",function(e){WriteLog("do event onPlayerIncScore  "+JSON.stringify(e));for(var t=e,a=0;a<t.length;a++){var n=t[a].uid,i=t[a].score;o.presentScore[n]||(o.presentScore[n]={}),o.presentScore[n]=i}sendEvent("onPlayerIncScore",e)}),GameNet.getInstance().setCallBack("onPlayerInitScore",function(e){WriteLog("do event onPlayerInitScore  "+JSON.stringify(e)),o.initScore=e;for(var t=0;t<o.initScore.length;t++){var a=o.initScore[t].uid,n=o.initScore[t].score;o.presentScore[a]||(o.presentScore[a]={}),o.presentScore[a]=n}sendEvent("onPlayerInitScore",e)}),GameNet.getInstance().setCallBack("onTurner",function(e){WriteLog("onTurner:"+JSON.stringify(e)),o.turn=e.uid,sendEvent("onTurner",e)}),GameNet.getInstance().setCallBack("onActionBtn",function(e){WriteLog("onActionBtn:"+JSON.stringify(e)),(o.actionBtn=e).allinScore&&(o.allInscore=e.allinScore),o.maxScore=e.score,sendEvent("onActionBtn",e)}),GameNet.getInstance().setCallBack("onPlayerCards",function(e){for(var t in WriteLog("onPlayerCards:"+JSON.stringify(e)),e)o.pokers[t]=e[t];for(var t in o.pokers)e[t]||delete o.pokers[t];o.addpokersRight=!0,sendEvent("onPlayerCards",e)}),GameNet.getInstance().setCallBack("onTurnerAction",function(e){WriteLog("onTurnerAction:"+JSON.stringify(e)),o.turnerAction=e,sendEvent("onTurnerAction",e)}),GameNet.getInstance().setCallBack("onGameResult",function(e){WriteLog("onGameResult:"+JSON.stringify(e)),o.gameResult=e,sendEvent("onGameResult",e)}),GameNet.getInstance().setCallBack("onGameAllResult",function(e){WriteLog("onGameAllResult:"+JSON.stringify(e)),o.close=!0,o.resultData=e,sendEvent("onGameAllResult",e)}),GameNet.getInstance().setCallBack("onIncScore",function(e){WriteLog("onIncScore:"+JSON.stringify(e)),o.incPokerData=e,sendEvent("onIncScore",e)}),GameNet.getInstance().setCallBack("onDropPlayerInfo",function(e){WriteLog("onDropPlayerInfo:"+JSON.stringify(e)),o.DropPlayerInfo=e,sendEvent("onDropPlayerInfo",e)}),GameNet.getInstance().setCallBack("onRotInfo",function(e){WriteLog("onRotInfo:"+JSON.stringify(e)),o.connectWin=e.winner,sendEvent("onRotInfo",e)})},o.unregistAllMessage=function(){GameNet.getInstance().removeAllListeners("onPlayerIncScore"),GameNet.getInstance().removeAllListeners("onPlayerInitScore"),GameNet.getInstance().removeAllListeners("onTurner"),GameNet.getInstance().removeAllListeners("onActionBtn"),GameNet.getInstance().removeAllListeners("onPlayerCards"),GameNet.getInstance().removeAllListeners("onTurnerAction"),GameNet.getInstance().removeAllListeners("onGameResult"),GameNet.getInstance().removeAllListeners("onGameAllResult"),GameNet.getInstance().removeAllListeners("onIncScore"),GameNet.getInstance().removeAllListeners("onDropPlayerInfo")},cc._RF.pop()},{}],"tenNN-createRoom":[function(e,t,a){"use strict";cc._RF.push(t,"e1e9bcaZVFF95QeX9lXa52i","tenNN-createRoom");e("roomHandler");var o=e("gameDefine"),r=e("configMgr");cc.Class({extends:cc.Component,properties:{spend:{default:[],type:[cc.Label]},drowArray:{default:[],type:[cc.Node]}},onLoad:function(){this.spendData=void 0,this.refreshNiuNiuUI()},createRoom:function(){this.saveNiuNiuRule(),profileNiuNiu.saveCreateRoomOpts(),GameData.setGameType(o.GameType.Game_Niu_Niu_10);var e=profileNiuNiu.createRoomOpts,t=r.getModeType();return null==t||null==t.Game_Niu_Niu_10||(e.currencyType=t.Game_Niu_Niu_10.CurrencyType,e.settleType=t.Game_Niu_Niu_10.SettleType),e},saveNiuNiuRule:function(){for(var e=this.node,t=[cc.find("/round/ToggleGroup/round10",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round20",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round30",e).getComponent(cc.Toggle)],a=10,n=0;n<t.length;n++)t[n].isChecked&&(a=10*(n+1));profileNiuNiu.createRoomOpts.roundMax=a,profileNiuNiu.createRoomOpts.roundRule=a/10;var i=0,o=[cc.find("/bossType/ToggleGroup/boss1",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss2",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss3",e).getComponent(cc.Toggle)];for(n=0;n<o.length;n++)o[n].isChecked&&(i=n+1);profileNiuNiu.createRoomOpts.bossType=i;var r=0,s=[cc.find("/baseScore/toggleGroup/score1",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score2",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score5",e).getComponent(cc.Toggle)];for(n=0;n<s.length;n++)s[n].isChecked&&(r=this.getScoreBeseNum(s[n].node));profileNiuNiu.createRoomOpts.scoreBase=r;var c=0,d=[cc.find("/multipleType/ToggleGroup/multiple1",e).getComponent(cc.Toggle),cc.find("/multipleType/ToggleGroup/multiple2",e).getComponent(cc.Toggle)];for(n=0;n<d.length;n++)d[n].isChecked&&(c=n);profileNiuNiu.createRoomOpts.multipleType=c;var h=0,l=[cc.find("/rule_roomPay/toggleGroup/roomOwner",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/AA",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/winPlayer",e).getComponent(cc.Toggle)];for(n=0;n<l.length;n++)l[n].isChecked&&(h=n+1);profileNiuNiu.createRoomOpts.costType=h,profileNiuNiu.createRoomOpts.joinermax=10,profileNiuNiu.createRoomOpts.gameType=104,this.showSpendUI()},refreshNiuNiuUI:function(){for(var e=this.node,t=[cc.find("/round/ToggleGroup/round10",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round20",e).getComponent(cc.Toggle),cc.find("/round/ToggleGroup/round30",e).getComponent(cc.Toggle)],a=0;a<t.length;a++)t[a].isChecked=a+1==profileNiuNiu.createRoomOpts.roundMax/10;var n=[cc.find("/bossType/ToggleGroup/boss1",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss2",e).getComponent(cc.Toggle),cc.find("/bossType/ToggleGroup/boss3",e).getComponent(cc.Toggle)];for(a=0;a<n.length;a++)n[a].isChecked=a+1==profileNiuNiu.createRoomOpts.bossType;var i=[cc.find("/baseScore/toggleGroup/score1",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score2",e).getComponent(cc.Toggle),cc.find("/baseScore/toggleGroup/score5",e).getComponent(cc.Toggle)];for(a=0;a<i.length;a++)i[a].isChecked=this.getScoreBeseNum(i[a].node)==profileNiuNiu.createRoomOpts.scoreBase;var o=[cc.find("/multipleType/ToggleGroup/multiple1",e).getComponent(cc.Toggle),cc.find("/multipleType/ToggleGroup/multiple2",e).getComponent(cc.Toggle)];for(a=0;a<o.length;a++)o[a].isChecked=a==profileNiuNiu.createRoomOpts.multipleType;3<profileNiuNiu.createRoomOpts.costType&&(profileNiuNiu.createRoomOpts.costType=1);var r=[cc.find("/rule_roomPay/toggleGroup/roomOwner",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/AA",e).getComponent(cc.Toggle),cc.find("/rule_roomPay/toggleGroup/winPlayer",e).getComponent(cc.Toggle)];for(a=0;a<r.length;a++)r[a].isChecked=a+1==profileNiuNiu.createRoomOpts.costType;this.showSpendUI()},showSpendUI:function(){cc.log("..mode..niuniu10");var e="",t=r.getModeType();if(null!=t&&null!=t.Game_Niu_Niu_10){var a=r.getServerConfig();if(null!=a){switch(this.modeType=t.Game_Niu_Niu_10.CurrencyType,this.modeType){case o.currencyType.Currency_Card:e="房卡",this.spendData=a.roomCard[o.GameType.Game_Niu_Niu_10];break;case o.currencyType.Currency_Coin:e="金",this.spendData=a.roomCoin[o.GameType.Game_Niu_Niu_10]}if(this.spendData)for(var n=0;n<Object.keys(this.spendData).length;n++){var i=0;this.modeType==o.currencyType.Currency_Card?(i=this.spendData[n+1].cost[10].final,this.spend[n].string="（"+e+"*"+i+"）"):(i=this.spendData[n].cost[10].final,"/局",this.spend[n].string=""),this.drowArray[n].active=0==i}else cc.log("..spendData is undefined")}}},getScoreBeseNum:function(e){var t=e.name,a=t.substring(5,t.length);return parseInt(a)}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine",roomHandler:"roomHandler"}],test:[function(e,t,a){"use strict";var n;function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}cc._RF.push(t,"09c9bRJQjdIq7sJQm1QX3zG","test");var o=e("gameDefine"),r={gameName:"若宇测试麻将",areaType:o.AreaType.Area_Test,serverIP:"140.143.204.242",serverPort:3010,versionText:"测试服版本",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rytianjinmajiang",wxWelcomeText:"还等嘛!我在天津攒局麻将等你!",loginLogo:"resources/login/cuanjumajiang.png",agentWeChat:{accounts:{number:123,type:"(微信号)"},agentConsult:{number:456,type:"(QQ号)"},gameProblem:{number:789,type:"(手机号)"}},Poster:["resources/poster/tianjin/poster_tianjin_1.png"],CompetitionPoster:["resources/poster/tianjin/poster_tianjin_1.png","resources/poster/tianjin/poster_tianjin_2.png","resources/poster/tianjin/poster_tianjin_1.png","resources/poster/tianjin/poster_tianjin_2.png"],GameVisible:[o.GameType.Game_MJ_HuaDian,o.GameType.Game_Mj_Tianjin,o.GameType.Game_Mj_HZ,o.GameType.Game_Mj_CC,o.GameType.Game_Mj_AS,o.GameType.Game_Poker_DDZ,o.GameType.Game_Poker_TianjinDDZ,o.GameType.Game_TDK,o.GameType.Game_niu_niu,o.GameType.Game_Niu_Niu_10,o.GameType.Game_Poker_paodekuai,o.GameType.Game_Poker_ZJH],SetCardsOpen:!0,MatchGameType:[o.GameType.Game_Poker_DDZ,o.GameType.Game_niu_niu,o.GameType.Game_Poker_ZJH,o.GameType.Game_Poker_HHDZ,o.GameType.Game_Niu_Hundred],FightGameType:[o.GameType.Game_Poker_ZJH,o.GameType.Game_Poker_ZJH],ModeType:{Game_Mj_Tianjin:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_TianjinDDZ:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_niu_niu:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Niu_Niu_10:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_TDK:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Mj_CC:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_MJ_HuaDian:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Mj_Heb:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:o.currencyType.Currency_Card,SettleType:[]}},serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",sumLv:3,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},5:{name:"牛牛匹配局",sumLv:3,cost:[50,300,2e3],enter:[2e3,15e3,1e5]},6:{name:"桦甸麻将匹配局",sumLv:3,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",sumLv:3,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},8:{name:"天津斗地主匹配局",sumLv:3,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},10:{name:"长春麻将匹配局",sumLv:3,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",sumLv:3,cost:[100,300,1e3],enter:[2e3,15e3,1e5]},102:{name:"经典斗地主匹配局",sumLv:3,cost:[100,500,2e3],enter:[2e3,1e4,5e4]},103:{name:"三张牌匹配局",sumLv:3,cost:[50,300,1e3],enter:[2e4,1e5,5e5]},105:{name:"牛牛匹配局",sumLv:3,cost:[0,0,0],enter:[1e3,1e4,1e5],zhuang:[1e6,2e6,5e6]},106:{name:"红黑大战匹配局",sumLv:1,cost:[66],enter:[666]}},fight:{1:{templateId:1,name:"炸金花16人比赛场",type:2,gameType:103,minPlayerNum:8,maxPlayerNum:16,signCosts:{1:1},rankGroups:[1,2,3,4,16],giftGroups:[[{1:10},{3:5}],[{1:5},{3:2}],[],[],[]],roundArray:[3,3,3,3],roundPlayers:[16,12,8,4]},2:{templateId:2,name:"炸金花32人比赛场",type:2,gameType:103,minPlayerNum:16,maxPlayerNum:32,signCosts:{1:1},rankGroups:[1,2,3,4,16],giftGroups:[[{1:10},{3:5}],[{1:5},{3:2}],[],[],[]],roundArray:[3,3,3,3],roundPlayers:[32,16,8,4]}},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:8,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"16局",roundType:1,roundMax:16,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}},{name:"1圈",roundType:2,roundMax:1,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],3:[2e4,4e4,1e5],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:2,roundMax:2,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[2e4,4e4,1e5],3:[4e4,8e4,2e5],4:[4e4,8e4,2e5]}},{name:"4圈",roundType:2,roundMax:4,cost:{2:[100,200,500],3:[100,200,500],4:[100,200,500]},enter:{2:[4e4,8e4,2e5],3:[8e4,16e4,4e5],4:[8e4,16e4,4e5]}}],6:[{name:"6局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,500],4:[200,400,1e3]}},{name:"12局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"24局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[100,200,5e4],4:[200,400,1e3]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[200,200,5e4],4:[200,400,1e3]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[300,300,6e4],4:[300,500,2e3]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[400,400,7e4],4:[400,600,3e3]}}],8:[{name:"6局",roundType:1,roundMax:6,cost:{3:[100,200,500]},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}}],10:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],13:[{name:"4局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"8局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"16局",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[1e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"1圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[2e4,2e4,5e4],4:[2e4,4e4,1e5]}},{name:"2圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[3e4,3e4,6e4],4:[3e4,5e4,2e5]}},{name:"4圈",roundType:1,roundMax:4,cost:{2:[100,200,500],4:[100,200,500]},enter:{2:[4e4,4e4,7e4],4:[4e4,6e4,3e5]}}],102:[{name:"6局",roundType:1,roundMax:6,cost:{3:[100,200,500]},enter:{3:[5e3,1e4,2e4]}},{name:"10局",roundType:1,roundMax:10,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}},{name:"20局",roundType:1,roundMax:20,cost:{3:[100,200,500]},enter:{3:[1e4,2e4,4e4]}}]},roomCard:(n={1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},2:{1:{name:"4局",cost:{2:{final:0},3:{final:0},4:{final:20}}},2:{name:"8局",cost:{2:{final:20},3:{final:30},4:{final:40}}},3:{name:"16局",cost:{2:{final:40},3:{final:60},4:{final:80}}},4:{name:"1课/50分",cost:{2:{final:20},3:{final:30},4:{final:40}}},5:{name:"1课/100分",cost:{2:{final:40},3:{final:60},4:{final:80}}}},3:{1:{name:"15局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},2:{name:"30局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},3:{name:"45局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},4:{name:"60局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}},5:{name:"75局",cost:{2:{final:0},3:{final:0},4:{final:0},5:{final:0}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},6:{61:{name:"6局",cost:{2:{final:1},4:{final:1}}},62:{name:"12局",cost:{2:{final:1},4:{final:1}}},63:{name:"24局",cost:{2:{final:2},4:{final:2}}},64:{name:"1圈",cost:{2:{final:1},4:{final:1}}},65:{name:"2圈",cost:{2:{final:1},4:{final:1}}},66:{name:"4圈",cost:{2:{final:2},4:{final:2}}}},7:{71:{name:"15局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}},72:{name:"30局",cost:{3:{final:0},4:{final:0},5:{final:0},6:{final:0}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},10:{61:{name:"4局",cost:{2:{final:0}}},62:{name:"8局",cost:{2:{final:0}}},63:{name:"16局",cost:{2:{final:0}}},64:{name:"1圈",cost:{4:{final:0}}},65:{name:"2圈",cost:{4:{final:0}}},66:{name:"4圈",cost:{4:{final:0}}}},11:{10:{name:"10",cost:{2:{final:0},3:{final:0}}},20:{name:"20",cost:{2:{final:0},3:{final:0}}},30:{name:"30",cost:{2:{final:0},3:{final:0}}}},13:{61:{name:"6局",cost:{2:{final:0},4:{final:0}}},62:{name:"12局",cost:{2:{final:0},4:{final:0}}},63:{name:"24局",cost:{2:{final:0},4:{final:0}}},64:{name:"1圈",cost:{2:{final:0},4:{final:0}}},65:{name:"2圈",cost:{2:{final:0},4:{final:0}}},66:{name:"4圈",cost:{2:{final:0},4:{final:0}}}},102:{6:{name:"6局",cost:{3:{final:0}}},10:{name:"10局",cost:{3:{final:0}}},20:{name:"20局",cost:{3:{final:0}}}}},i(n,"5",{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}}),i(n,"104",{1:{name:"10局",cost:{10:{final:0}}},2:{name:"20局",cost:{10:{final:0}}},3:{name:"30局",cost:{10:{final:0}}}}),n)}};t.exports=r,cc._RF.pop()},{gameDefine:"gameDefine"}],tianjin:[function(e,t,a){"use strict";cc._RF.push(t,"1d3d51MKiJGr56Zh9TmnjAH","tianjin");var n,i,o,r=e("gameDefine"),s={areaType:r.AreaType.Area_TianJin,serverIP:"mahjong.ry-tianjin.xyz",serverPort:3010,gameName:"天津攒局麻将",versionText:"审批文号：新广出审[2017]10415号  出版物号：ISBN978-7-498-03201-0  出版单位：天津电子出版社有限公司",notice:"抵制不良游戏，拒绝盗版游戏，注意自我保护，谨防受骗上当。适度游戏益脑，沉迷游戏伤身，合理安排时间，享受健康生活.",wxShareUrl:"https://fir.im/rytianjinmajiang",wxWelcomeText:"还等嘛!我在天津攒局麻将等你!",loginLogo:"resources/login/cuanjumajiang.png",agentWeChat:{accounts:{number:"",type:"cjmajiang"},agentConsult:{number:"",type:"mu141319"},gameProblem:{number:"",type:"mu141219"}},Poster:[],GameVisible:[r.GameType.Game_Mj_Tianjin,r.GameType.Game_Poker_DDZ,r.GameType.Game_Poker_TianjinDDZ,r.GameType.Game_Poker_paodekuai,r.GameType.Game_niu_niu,r.GameType.Game_Niu_Niu_10,r.GameType.Game_Poker_ZJH],ModeType:{Game_Mj_Tianjin:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]},Game_Poker_TianjinDDZ:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]},Game_Poker_DDZ:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]},Game_Poker_paodekuai:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]},Game_niu_niu:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]},Game_Niu_Niu_10:{CurrencyType:r.currencyType.Currency_Card,SettleType:[]}},SetCardsOpen:!1,MatchGameType:[],serverConfig:{matchCoin:{1:{name:"天津麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e4]},8:{name:"天津斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},102:{name:"经典斗地主匹配局",roundType:1,roundMax:1,joinerMax:3,cost:[100,300,1e3],enter:[2e3,15e3,1e4]},5:{name:"牛牛匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},6:{name:"桦甸麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},7:{name:"填大坑匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[300,1e3,5e3],enter:[3e4,1e5,5e5]},10:{name:"长春麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[5e3,15e3,1e5]},13:{name:"哈尔滨麻将匹配局",roundType:1,roundMax:1,joinerMax:4,cost:[100,300,1e3],enter:[2e3,15e3,1e5]}},roomCoin:{1:[{name:"4局",roundType:1,roundMax:4,cost:1,enter:[20,50,100],perround:5},{name:"8局",roundType:1,roundMax:8,cost:2,enter:[40,100,200],perround:5},{name:"16局",roundType:1,roundMax:16,cost:4,enter:[80,200,400],perround:5},{name:"1圈",roundType:2,roundMax:1,cost:1,enter:[20,50,100],perround:5},{name:"2圈",roundType:2,roundMax:2,cost:2,enter:[40,100,200],perround:5},{name:"4圈",roundType:2,roundMax:4,cost:4,enter:[80,200,400],perround:5}],8:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}],102:[{name:"6局",roundType:1,roundMax:6,cost:1,enter:[20,50,100],perround:5},{name:"10局",roundType:1,roundMax:10,cost:2,enter:[40,100,200],perround:5},{name:"20局",roundType:1,roundMax:20,cost:4,enter:[80,200,400],perround:5}]},roomCard:(n={1:{1:{name:"4局",cost:{2:{final:2},3:{final:3},4:{final:4}}},2:{name:"8局",cost:{2:{final:2},3:{final:3},4:{final:4}}},3:{name:"16局",cost:{2:{final:4},3:{final:6},4:{final:8}}},4:{name:"1圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},5:{name:"2圈",cost:{2:{final:2},3:{final:3},4:{final:4}}},6:{name:"4圈",cost:{2:{final:6},3:{final:9},4:{final:12}}}},8:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},11:{10:{name:"10",cost:{2:{final:2},3:{final:2}}},20:{name:"20",cost:{2:{final:3},3:{final:3}}},30:{name:"30",cost:{2:{final:6},3:{final:6}}}},102:{6:{name:"6局",cost:{3:{final:2}}},10:{name:"10局",cost:{3:{final:3}}},20:{name:"20局",cost:{3:{final:6}}}},5:{1:{name:"10局",cost:{6:{final:0}}},2:{name:"20局",cost:{6:{final:0}}},3:{name:"30局",cost:{6:{final:0}}}},104:{1:{name:"10局",cost:{10:{final:3}}},2:{name:"20局",cost:{10:{final:6}}},3:{name:"30局",cost:{10:{final:9}}}}},i="5",o={1:{name:"10局",cost:{6:{final:2}}},2:{name:"20局",cost:{6:{final:4}}},3:{name:"30局",cost:{6:{final:6}}}},i in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n)}};t.exports=s,cc._RF.pop()},{gameDefine:"gameDefine"}],timeView:[function(e,t,a){"use strict";cc._RF.push(t,"153eeBLUhlCR4RS0QNu0yfA","timeView");var n=e("roomUtil");cc.Class({extends:cc.Component,properties:{timeLabel:cc.Label},onEnable:function(){this.showTime(),this.schedule(this.showTime,1)},showTime:function(){this.timeLabel.string=n.getTimeString()}}),cc._RF.pop()},{roomUtil:"roomUtil"}],tingView:[function(e,t,a){"use strict";cc._RF.push(t,"a2146PdZOhGo6AG8oXKibvK","tingView"),cc.Class({extends:cc.Component,properties:{bg:cc.Node,nbg:cc.Node,cardTemplate:cc.Node},onLoad:function(){this.bgHeight=this.bg.height,this.nbgHeight=this.nbg.height,this.cardNodeList=[],this.cardTemplate.active=!1},show:function(e,t){for(var a=[],n=[],i={},o=0,r=0;r<t.length;r++){var s=t[r];if(s.discard==e){a=s.ting;break}}if(0<a.length){this.node.active=!0;for(r=0;r<this.cardNodeList.length;r++){(v=this.cardNodeList[r]).destroy()}this.cardNodeList.splice(0,this.cardNodeList.length);for(var c=0;c<a.length;c++){var d=(h=a[c]).type.toString();"4"===d&&(d="3"),i[d]=i[d]||[],i[d].push(h)}for(var r in i){var h;if(15<=(h=i[r]).length)n.push({obcard:-1,score:h[0].score});else for(var l in h)n.push({obcard:h[l].obcard,score:h[l].score})}n.sort(function(e,t){return t.score-e.score});var u=-1;for(r=0;r<n.length;r++)if(-1!=n[r].obcard){var m=n[r].obcard,p=n[r].score;o+=g=this.leftCard(m),this.showCardNode(m,p,g)}else u=r;if(0<=u){m="renyi",p=n[u].score;var g=GameData.game.cardleft-o;o=GameData.game.cardleft,this.showCardNode(m,p,g)}cc.find("totalLeftLabel",this.node).getComponent(cc.Label).string="剩余"+o+"张";var f=this.cardNodeList.length,y=4<f?Math.ceil(f/2):f;for(Math.ceil(f/y),r=0;r<this.cardNodeList.length;r++){var v;(v=this.cardNodeList[r]).x=this.cardTemplate.x+r%y*90,v.y=this.cardTemplate.y-154*Math.floor(r/y)}this.nbg.width=90*y,this.bg.width=220+this.nbg.width,4<f?(this.bg.height=370,this.nbg.height=300):(this.bg.height=this.bgHeight,this.nbg.height=this.nbgHeight)}else this.node.active=!1},hide:function(){this.node.active=!1},showCardNode:function(e,t,a){var n=cc.instantiate(this.cardTemplate),i="resources/mjcard2d/mj_face_xia_shou_"+e+".png",o=cc.textureCache.addImage(cc.url.raw(i));n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),cc.find("scoreLabel",n).getComponent(cc.Label).string=t+"分",cc.find("leftLabel",n).getComponent(cc.Label).string=a+"张",cc.find("mask",n).active=0==a,n.active=!0,this.node.addChild(n),this.cardNodeList.push(n)},leftCard:function(e){var t=0,a=GameData.getMyHandCards();for(var n in a)e==n&&(t+=a[n]);for(var i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o){var r=o.uid,s=GameData.getDisCards(r),c=GameData.getPengCards(r),d=GameData.getGangCards(r);for(var n in s)e==s[n]&&(t+=1);for(var n in c)e==c[n][0]&&(t+=3);for(var n in d)e==d[n][0]&&(t+=4)}}var h=4-t;return h=h<=0?0:h}}),cc._RF.pop()},{}],topHandler:[function(e,t,a){"use strict";cc._RF.push(t,"3e344Nxd8tBpaV3kERRw1bt","topHandler");e("gameDefine"),e("errorCode");var n={};(t.exports=n).getCoinTopList=function(){GameNet.getInstance().request("game.topHandler.getCoinlist",null,function(e){e&&sendEvent("updateCoinTopList",e)})},cc._RF.pop()},{errorCode:"errorCode",gameDefine:"gameDefine"}],uiCardTest:[function(e,t,a){"use strict";cc._RF.push(t,"01606fjUmpKMKq8oNCXlfKs","uiCardTest"),cc.Class({extends:cc.Component,properties:{parents:{default:[],type:cc.Node}},onLoad:function(){}}),cc._RF.pop()},{}],uiDebug:[function(e,t,a){"use strict";cc._RF.push(t,"21701FFR8hJErEuDQQXv2dl","uiDebug");e("gameDefine"),e("configMgr");cc.Class({extends:cc.Component,properties:{editCards:cc.EditBox,cardInput:cc.EditBox,wildCards:cc.EditBox,parents:{default:[],type:cc.Node}},onLoad:function(){},onClose:function(){this.node.active=!1},onSetCards:function(){for(var e=this.editCards.string.split(","),t=[],a=0;a<e.length;a++)t.push(parseInt(e[a]));var n={roomid:GameData.room.id,cards:t};GameNet.getInstance().request("game.debugHandler.setCards",n,function(e){cc.log("debug rtn: ",JSON.stringify(e))})},onSetWildcard:function(){var e=this.wildCards.string,t={roomid:GameData.room.id,cards:parseInt(e)};GameNet.getInstance().request("game.debugHandler.setWildCards",t,function(e){})},testAllCardShow:function(){for(var e=0;e<this.parents.length;e++){var t=this.parents[e];"layer_down"!=t.name&&(cc.find("cardHand",t).active=!1)}var a=this.cardInput.string;this.testHand(a),this.testPeng(a),this.testDis(a)},testHand:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];if("layer_down"==a.name)for(var n=cc.find("cardHand",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("cardHand"+i);this.showCardContent(o,"mj_card_xia_shou",e)}}},testDis:function(e){for(var t=0;t<this.parents.length;t++){var a=this.parents[t];a.active=!0;for(var n=cc.find("cardDis",a),i=0;i<n.childrenCount;i++){var o=n.getChildByName("card_face"+(i+1));o.active=!0,"layer_down"==a.name?this.showCardContent(o,"mj_card_xia_chu",e):"layer_right"==a.name?this.showCardContent(o,"mj_card_you_chu",e):"layer_left"==a.name?this.showCardContent(o,"mj_card_zuo_chu",e):"layer_up"==a.name&&this.showCardContent(o,"mj_card_shang_chu",e)}}},testPeng:function(e){for(var t=0;t<this.parents.length;t++)for(var a=this.parents[t],n=0;n<GameData.room.joinermax;n++){var i=cc.find("cardPeng/cardPeng"+(n+1),a);i.active=!0;for(var o=0;o<4;o++){var r=i.getChildByName("card_face"+(o+1));r.active=!0,"layer_down"==a.name?this.showCardContent(r,"mj_card_xia_peng",e):"layer_right"==a.name?this.showCardContent(r,"mj_card_you_peng",e):"layer_left"==a.name?this.showCardContent(r,"mj_card_zuo_peng",e):"layer_up"==a.name&&this.showCardContent(r,"mj_card_shang_chu",e)}}},showCardContent:function(e,t,a){var n=e.getComponent("Card");if(null!=n){var i="resources/mjcard/"+t+"_"+n.index+"_"+a+".png";cc.log("load Card URL :"+i);var o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o)}else cc.log("missing card Component, please add it")}}),cc._RF.pop()},{configMgr:"configMgr",gameDefine:"gameDefine"}],uiRoomDissolve:[function(e,t,a){"use strict";cc._RF.push(t,"58561UVV4JKO6ZrbzuJSNvN","uiRoomDissolve");var h=e("roomHandler");e("gameDefine");cc.Class({extends:cc.Component,properties:{headPanel:cc.Node,headerNode:cc.Node,agreeWaitNode:cc.Node,agreeBtn:cc.Node,disAgreeBtn:cc.Node,dissolvePerson:cc.Label,lastTimeLabel:cc.Label},onLoad:function(){registEvent("onRoomInfo",this,this.onRoomInfoHandler),registEvent("onRoomDissolve",this,this.onRoomDissolveHandler),registEvent("showDissolve",this,this.showDissolveLayer),this.lastTimeLabel.string="",this.openDisAgree=!1,this.initHeaderUI(),this.showDissolveText()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.onRoomInfoHandler),unregistEvent("onRoomDissolve",this,this.onRoomDissolveHandler),unregistEvent("showDissolve",this,this.showDissolveLayer)},onRoomInfoHandler:function(e){null!=e&&(h.onRoomInfoSetData(e.detail),this.initHeaderUI())},onRoomDissolveHandler:function(e){null!=e&&(h.onRoomDissolveSetData(e.detail),this.initHeaderUI(),this.showDissolveText())},showDissolveLayer:function(e){cc.log("..showDissolve:"+e.detail),this.node.active=e.detail},initHeaderUI:function(){var e=h.getRoomData();if(null!=e){for(var t=0;t<this.headPanel.getChildrenCount();t++){var a=this.headPanel.getChildren()[t];a&&(a.active=!1)}for(var n=0;n<e.opts.joinermax;n++){var i=GameData.joiners[n];if(null!=i){var o=this.headPanel.getChildren()[n];null==o&&((o=cc.instantiate(this.headerNode)).parent=this.headPanel,o.name="headNode"+n,o.y=this.headerNode.y,o.x=this.headerNode.x+n*(this.headerNode.width+50)),o.tag=i.uid,o.active=!0;var r=i.name;cc.find("nameLabel",o).getComponent(cc.Label).string=getShortStr(r,4);var s=i.headimgurl,c=cc.find("headimg",o).getComponent(cc.Sprite);this.showHeaderIcon(c,s);var d=h.isPlayerOnline(i.uid);this.showLostIcon(o,d)}}}},showHeaderIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},showLostIcon:function(e,t){cc.find("lost",e).active=!t},showAgreeIcon:function(e,t){cc.find("duigou",e).active=t},alreadyAgree:function(e){this.agreeWaitNode.active=!e,this.agreeBtn.active=e,this.disAgreeBtn.active=e},handleSomebodyDisagree:function(e){if(e!=GameData.player.uid&&!this.openDisAgree){var t=GameData.getPlayerByUid(e);if(t){var a=this,n=t.name;createMessageBox("因［"+n+"］拒绝解散房间，游戏需继续进行",function(){a.openDisAgree=!1}),this.openDisAgree=!0}}},showDissolveText:function(){var e=h.getRoomDissolveData();if(!(null==e||Object.keys(e).length<=0)){var t,a,n=!(GameData.showResult=!1);for(var i in e.select){var o=e.select[i];if("apply"==o)(t=GameData.getPlayerByUid(i))&&(this.dissolvePerson.string="["+t.name+"]发起投票解散对局",(a=this.headPanel.getChildByTag(parseInt(i)))&&this.showAgreeIcon(a,!0));else if("agree"==o)(a=this.headPanel.getChildByTag(parseInt(i)))&&this.showAgreeIcon(a,!0);else if("disagree"==o)return sendEvent("showDissolve",!1),void this.handleSomebodyDisagree(i);"agree"!=o&&"apply"!=o||i!=GameData.player.uid||(n=!1)}this.alreadyAgree(n),sendEvent("showDissolve",!0),this.handleVoteResult(),this.handleRoomDisbandTimer()}},handleVoteResult:function(){var e=h.getRoomDissolveData();null!=e&&0==e.isStart&&(sendEvent("showDissolve",!1),this.unschedule(this.updateLastTime),setTimeout(function(){GameData.roomClose&&sendEvent("showSummary")},100))},handleRoomDisbandTimer:function(){var e=h.getRoomDissolveData();null!=e&&(this.totalTime=e.startTime,this.lastTime=e.lastTime,this.schedule(this.updateLastTime,1))},updateLastTime:function(){var e=h.getRoomData();null!=e&&(this.lastTime--,this.lastTimeLabel.string="倒计时结束后自动解散牌局   "+formatSeconds(this.lastTime,1),this.lastTime<=0&&(h.deleteRoom(e.id,"close"),this.unschedule(this.updateLastTime)))},requestDissolveAgree:function(){var e=h.getRoomData();null!=e&&h.deleteRoom(e.id,"agree")},requestDissolveDisagree:function(){var e=h.getRoomData();null!=e&&h.deleteRoom(e.id,"disagree")}}),cc._RF.pop()},{gameDefine:"gameDefine",roomHandler:"roomHandler"}],uiRoomMain:[function(e,t,a){"use strict";cc._RF.push(t,"6ca0fwZMLlB4r7egPTIITcN","uiRoomMain");var n=e("SoundMngr"),i=e("gameDefine"),o=e("configMgr"),r=e("ruleHandler"),s=e("roomHandler"),c=e("hongzhongData");cc.Class({extends:cc.Component,properties:{uiWaitLayer:cc.Node,resultLayer:cc.Node,dissolveLayer:cc.Node,summaryLayer:cc.Node,scoreLayer:cc.Node,debugLayer:cc.Node,mapLayer:cc.Node,layerPlayer:cc.Node,debugBtn:cc.Node,mapBtnNode:cc.Node,deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node,uiResult:cc.Prefab,uiSummary:cc.Prefab,uiDissolve:cc.Prefab,uiScore:cc.Prefab,uiMap:cc.Prefab,uiDebug:cc.Prefab,uiPlayers:cc.Prefab,tableUI:{default:[],type:cc.Node}},onLoad:function(){cc.log("..uiMain onLoad."),registEvent("onRoomInfo",this,this.RoomInfoHandler),registEvent("onGameStart",this,this.GameStartHandler),registEvent("onGameScore",this,this.GameScoreHandler),registEvent("onJoinerLost",this,this.showJoinerLost),registEvent("onJoinerConnect",this,this.showJoinerConnect),registEvent("showSummary",this,this.showSummaryLayer),registEvent("onRoomInfo",this,this.onRoomInfoHandler),registEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),registEvent("onCreatorQuit",this,this.onCreatorQuit)},onDestroy:function(){unregistEvent("onRoomInfo",this,this.RoomInfoHandler),unregistEvent("onGameStart",this,this.GameStartHandler),unregistEvent("onGameScore",this,this.GameScoreHandler),unregistEvent("onJoinerLost",this,this.showJoinerLost),unregistEvent("onJoinerConnect",this,this.showJoinerConnect),unregistEvent("showSummary",this,this.showSummaryLayer),unregistEvent("onRoomInfo",this,this.onRoomInfoHandler),unregistEvent("onPrepareInfo",this,this.onRoomReadyInfoHandler),unregistEvent("onCreatorQuit",this,this.onCreatorQuit)},onEnable:function(){cc.log("..uiMain onEnable."),MjHandler.getInstance().requestReady(),scheduleLamp(this),this.initUIData(),this.initUIShow(),this.addPlayers(),this.addUIResult(),this.addUISummary(),this.addUIScore(),this.addUIDissolve(),this.addUIMap(),this.addUIDebug(),this.setUIBaseInfo()},onRoomInfoHandler:function(){this.updatePlayersWithRoom()},onRoomReadyInfoHandler:function(){this.updatePlayersReady()},initUIData:function(){cc.log("...room main init data."),r.instance.setGameType(GameData.client.gameType),this._curGameData=void 0,this.setCurGameData()},initUIShow:function(){this.debugBtn.active=o.getSetCardsOpen(),this.resultLayer.active=!1,this.summaryLayer.active=!1,this.setLayerShow()},setCurGameData:function(){var e=s.getRoomData();if(null!=e)switch(e.opts.gameType){case i.GameType.Game_Mj_HZ:this._curGameData=c}},setLayerShow:function(){var e=s.getRoomData();e&&(e.status>=i.RoomState.GAMEING?this.showTableLayer():this.showWaitLayer())},RoomInfoHandler:function(e){null!=e&&(s.onRoomInfoSetData(e.detail),this.setCurGameData(),this.setLayerShow(),this.addUIResult(),this.addUISummary(),this.addUIScore())},GameStartHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGameStartSetData(e.detail),this.showTableLayer(),this.mapCondition(),this.setMapBtnShow())},GameScoreHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGameScoreSetData(e.detail),this.showResultLayer())},addPlayers:function(){var e=this.layerPlayer.getChildByName("uiPlayers");null==e&&((e=cc.instantiate(this.uiPlayers)).parent=this.layerPlayer,e.name="uiPlayers"),this.updatePlayersWithRoom()},updatePlayersWithRoom:function(){var e=s.getScoreData(),t=s.getOnLinesData();if(null!=e&&null!=t){var a=this.layerPlayer.getChildByName("uiPlayers");if(a){var n=a.getComponent("tablePlayersControl");n.showPlayers(),n.setPlayerScoreData(e),n.setPlayerOnLineData(t),this.updatePlayersReady()}}},updatePlayersReady:function(){var e=s.getRoomData(),t=s.getRoomReadyData();if(null!=e&&null!=t){var a=this.layerPlayer.getChildByName("uiPlayers");if(a)a.getComponent("tablePlayersControl").setRoomReadyData(e.status,t)}},addUIResult:function(){var e=this.resultLayer.getChildByName("uiResult");null==e&&((e=cc.instantiate(this.uiResult)).parent=this.resultLayer,e.name="uiResult"),e.getComponent("uiRoomResult")._curGameData=this._curGameData},addUISummary:function(){var e=this.summaryLayer.getChildByName("uiSummary");null==e&&((e=cc.instantiate(this.uiSummary)).parent=this.summaryLayer,e.name="uiSummary"),e.getComponent("uiRoomSummary")._curGameData=this._curGameData},addUIScore:function(){var e=this.scoreLayer.getChildByName("uiScore");null==e&&((e=cc.instantiate(this.uiScore)).parent=this.scoreLayer,e.name="uiScore",e.active=!1),e.getComponent("uiRoomScore")._curGameData=this._curGameData},addUIDissolve:function(){var e=this.dissolveLayer.getChildByName("uiDissolve");null==e&&((e=cc.instantiate(this.uiDissolve)).parent=this.dissolveLayer,e.name="uiDissolve",e.active=!1)},addUIMap:function(){var e=this.mapLayer.getChildByName("uiMap");null==e&&((e=cc.instantiate(this.uiMap)).parent=this.mapLayer,e.name="uiMap",e.active=!1)},addUIDebug:function(){var e=this.debugLayer.getChildByName("uiDebug");null==e&&((e=cc.instantiate(this.uiDebug)).parent=this.debugLayer,e.name="uiDebug",e.active=!1)},showWaitLayer:function(){this.uiWaitLayer.active=!0,this.showTableUI(!1),this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableLayer:function(){this.showTableUI(!0),this.uiWaitLayer.active=!1,this.resultLayer.active=!1,n.instance.playMusic("sound/beijyingyue")},showTableUI:function(e){cc.log("...showTableUI:"+e);for(var t=0;t<this.tableUI.length;t++){this.tableUI[t].active=e}},showResultLayer:function(){var e=this;this.scheduleOnce(function(){e.showResultDirectly()},2)},showResultDirectly:function(){this.resultLayer.active=!0,this.uiWaitLayer.active=!1,this.showTableUI(!1);var e=this.resultLayer.getChildByName("uiResult");e&&e.getComponent("uiRoomResult").onShow()},showSettingLayer:function(e){sendEvent("runlamp"),openView("SettingsPanel")},showSummaryLayer:function(){var e=s.getRoomData();null!=e&&(this.summaryLayer.active=!0,sendEvent("onShowSummary"),GameData.player.uid==e.creator?cc.sys.localStorage.setItem("creatorIsCheckIp",!1):cc.sys.localStorage.setItem("isCheckIp",!1))},showScoreLayer:function(){var e=this.scoreLayer.getChildByName("uiScore");e&&(e.active=!0,e.getComponent("uiRoomScore").ShowPlayerScoreItem())},showDebugLayer:function(){var e=this.debugLayer.getChildByName("uiDebug");e&&(e.active=!0)},showChat:function(){inCD(3e3)||openView("ChatPanel")},showJoinerLost:function(e){var t=e.detail.uid,a=GameData.getPlayerByUid(t).name;createMoveMessage("玩家["+a+"]掉线了。")},showJoinerConnect:function(e){var t=e.detail.uid,a=GameData.getPlayerByUid(t).name;createMoveMessage("玩家["+a+"]已上线。")},mapCondition:function(){var e,t=this.mapLayer.getChildByName("uiMap");t&&t.getComponent("AMapPanel").showPlayers();if(""!=(e=GameData.danger?"resources/table/map/weixian.png":"resources/table/map/anquan.png")){console.log("iconUrl = "+e);var a=cc.textureCache.addImage(cc.url.raw(e));this.mapBtnNode.getComponent(cc.Sprite).spriteFrame=null,this.mapBtnNode.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a),this.mapBtnNode.active=!0}},showMap:function(e){var t=this.mapLayer.getChildByName("uiMap");t&&(t.active=!0,t.getComponent("AMapPanel").showPlayers())},setMapBtnShow:function(){var e=s.getRoomData();null!=e&&(2==e.opts.joinermax?this.mapBtnNode.active=!1:this.mapBtnNode.active=!0)},onCreatorQuit:function(){var e=s.getRoomData();null!=e&&(GameData.player.roomid=void 0,e.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home"))},setUIBaseInfo:function(){var e=s.getRoomData().creator==GameData.player.uid;this.deleteRoomBtn.active=e},backBtnClicked:function(){var e=s.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):s.quitRoom(e.id)},wxInviteBtnClicked:function(){var e=s.getRoomData();if(null!=e){var t=getGameTypeNameString(e.opts.gameType),a=t+"房间号:"+e.id;4==e.opts.costType&&(a=t+"(代开)房间号:"+e.id);var n=this.getInviteStr();wxShareText(a,n)}},getInviteStr:function(){var e=s.getRoomData();if(null!=e){return"玩法:"+getRuleStrHongZhong(e.opts)+",请您快速加入对局."}},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){var e=s.getRoomData();s.deleteRoom(e.id,"close")},function(){})},onQuitRoom:function(){var e=s.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):s.quitRoom(e.id)},onCopyRoomInfo:function(){var e=s.getRoomData();if(null!=e){var t=getGameTypeNameString(e.opts.gameType)+"房间号:"+e.id+",",a=this.getInviteStr();wxShareCommond(t+a)}}}),cc._RF.pop()},{SoundMngr:"SoundMngr",configMgr:"configMgr",gameDefine:"gameDefine",hongzhongData:"hongzhongData",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],uiRoomPlayerInfo:[function(e,t,a){"use strict";cc._RF.push(t,"6a4bdiUwzhOlpxzvj4PP9rM","uiRoomPlayerInfo"),cc.Class({extends:cc.Component,properties:{headNode:cc.Node,nameLabel:cc.Label,idLabel:cc.Label,winningLabel:cc.Label,roundLabel:cc.Label,winRateLabel:cc.Label,playerTemplate:cc.Prefab,_player:void 0},onLoad:function(){},onDestroy:function(){},onEnable:function(){},onShow:function(e){if(!(null==e||Object.keys(e).length<=0)){this._player=e;var t=this.headNode.getChildByName("playerHeadNode");null==t&&(t=cc.instantiate(this.playerTemplate),this.headNode.addChild(t));var a=t.getComponent("playerTemplate");a&&(a.setName(""),a.showZhuang(!1),a.enableHeadBtn(!1),a.setHeadIcon(e.headimgurl)),this.node.active=!0,isChinese(e.name)?this.nameLabel.string=getShortStr(e.name,8):this.nameLabel.string=getShortStr(e.name,16),this.idLabel.string=e.uid}},onSendMessage:function(e,t){inCD(1e3)||null!=t&&null!=this._player&&(this._player.uid!=GameData.player.uid?(cc.log("..playerUid:"+GameData.player.uid),cc.log("..toUid:"+this._player.uid),cc.log("..data:"+t),ChatHandler.getInstance().dynChat(GameData.player.uid,this._player.uid,t,function(e){}),this.onClose()):createMoveMessage("不能对自己使用道具哦！"))},onClose:function(){this.node.active=!1}}),cc._RF.pop()},{}],uiRoomResult:[function(e,t,a){"use strict";cc._RF.push(t,"8a63cHYVNdEvJmCrn0se/xJ","uiRoomResult");var v=e("ruleHandler"),D=e("roomHandler");cc.Class({extends:cc.Component,properties:{resultLayer:cc.Node,playerItem:cc.Node,winSprite:cc.Sprite,loseSprite:cc.Sprite,pingSprite:cc.Sprite,createTime:cc.Label,roomID:cc.Label,roundNumber:cc.Label,cardTemplate:cc.Prefab,cardHuier:cc.Prefab,playerTemplate:cc.Prefab,cardHuimage:cc.Prefab,shareBtn:cc.Button,readyBtn:cc.Button,font:{default:[],type:[cc.Font]},_curGameData:void 0},onLoad:function(){this.isMark=0},onDestroy:function(){},initResultData:function(){cc.log("initResultData"),this.isHuType=!1},onShow:function(){var e=D.getRoomData();if(null!=e&&(this.initResultData(),e.opts.joinermax)){this.showResultIcon();for(var t=0;t<e.opts.joinermax;t++)this.showPlayer(t),this.showCards(t),this.showScore(t),this.showDetail(t),this.showWinIcon(t);this.showRoundInfo()}},showPlayer:function(e){var t=D.getRoomData();if(null!=t){var a=this._curGameData;if(null!=a){var n=a.getGameInfoData();if(null!=n){var i=cc.find("player"+(e+1),this.resultLayer);null==i&&((i=cc.instantiate(this.playerItem)).parent=this.resultLayer,i.name="player"+(e+1),i.x=this.playerItem.x,i.y=this.playerItem.y-e*this.playerItem.height);var o=cc.find("/head/id",i),r=cc.find("/head/name",i),s=cc.find("/head/headpic",i),c=cc.find("/head/zhuang",i),d=cc.find("/head/creator",i),h=GameData.joiners[e],l=h.name.substring(0,6)+"...";r.getComponent(cc.Label).string=l,o.getComponent(cc.Label).string=h.uid,c.active=h.uid==n.zhuangUid,d.active=h.uid==t.creator;var u=s.getComponent(cc.Sprite);this.setIcon(u,h.headimgurl)}}}},showCards:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameInfoData();if(null!=a){var n=GameData.joiners[e],i=n.uid==a.winnerUid;i&&(this.isMark=0);var o=cc.find("player"+(e+1),this.resultLayer);if(null!=o){for(var r=cc.find("cards",o),s=cc.find("cardHand",r),c=0;c<s.getChildrenCount();c++){var d=s.getChildren()[c];d&&(d.active=!1)}var h=t.getHandCards(n.uid);if(null!=h){for(var l,u=h.length,m=1,p=1,g=u;0<=g;g--){var f=h[g];if(!(null==f||f<=0)){v.instance.isHuier(f)?(l=!0,p=u,u--):(l=!1,p=m,m++);var y=cc.find("cardHand"+p,s);y&&(y.active=!0,this.showCardContent(y,"mj_face_xia_shou",f),this.setMyHuierVisible(y,f,"down",l),this.setMyHuimageVisible(y,f,i))}}this.showPengCards(n,r,"mj_face_xia_chu")}}}}}},showScore:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameScoreData();if(null!=a){var n=cc.find("player"+(e+1),this.resultLayer);if(null!=n){var i=GameData.joiners[e].uid,o=cc.find("score",n);0<a[i]?(o.getComponent("cc.Label").font=this.font[0],o.getComponent("cc.Label").string="+"+a[i]):a[i]<0?(o.getComponent("cc.Label").font=this.font[1],o.getComponent("cc.Label").string=a[i]):0==a[i]&&(o.getComponent("cc.Label").font=this.font[2],o.getComponent("cc.Label").string=a[i])}}}}},showDetail:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t)if(null!=t.getGameInfoData()){var a=cc.find("player"+(e+1),this.resultLayer);if(null!=a)GameData.joiners[e],cc.find("term",a).getComponent(cc.Label)}}},setIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},setMyHuierVisible:function(e,t,a,n){var i=e.getChildByName(e.name+"_huier");null==i?1==n&&((i=cc.instantiate(this.cardHuier)).y=i.y-18,e.addChild(i),i.name=e.name+"_huier",cc.find("up",i).active=!1,cc.find("down",i).active=!1,cc.find("right",i).active=!1,cc.find("left",i).active=!1,cc.find(a,i).active=!0):i.active=n},setMyHuimageVisible:function(e,t,a){var n=!1;0==a?n=!1:0==this.isMark&&(n=!0);var i=e.getChildByName(e.name+"_hu");null==i?1==n&&((i=cc.instantiate(this.cardHuimage)).y=i.y-20,e.addChild(i),i.name=e.name+"_hu"):i.active=n,1==n&&(this.isMark=1)},showCardContent:function(e,t,a){var n=e.getComponent("Card");null!=n&&(n.id=a),e.getComponent(cc.Sprite).spriteFrame=null;var i="resources/mjcard2d/"+t+"_"+a+".png",o=cc.textureCache.addImage(cc.url.raw(i));e.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),this.setMaskVisible(e,!1)},setMaskVisible:function(e,t){var a=e.getChildByName(e.name+"_mask");return null==a?1==t&&(a=cc.instantiate(this.cardMaskPrefab),e.addChild(a),a.name=e.name+"_mask"):a.active=t,a},showPengCards:function(e,t,a){if(null!=D.getRoomData()){var n=this._curGameData;if(null!=n&&!(null==t||null==e||Object.keys(e).length<=0)){for(var i=cc.find("cardPeng",t),o=0;o<i.getChildrenCount();o++){var r=i.getChildren()[o];r&&(r.active=!1)}var s=n.getChiCards(e.uid),c=n.getPengCards(e.uid),d=n.getGangCards(e.uid);if(null!=s&&null!=d&&null!=c){var h,l,u,m,p,g,f,y,v=c.concat(s),C=parseInt(GameData.client.handsize/3);for(h=0;h<v.length&&!(C<=h);h++)if(l=cc.find("cardPeng"+(h+1),i)){for(u=0;u<4&&(m=l.getChildByName("card_face"+(u+1)).getComponent(cc.Sprite),null!=(g=v[h]))&&!(null==(f=g.cards)||f.length<=0);u++)1<=f.length&&f.sort(function(e,t){return e-t}),u<f.length?(m.node.active=!0,3==u&&((p=l.getChildByName("card_back4").getComponent("cc.Sprite")).node.active=!1),y=f[u],this.showCardContent(m.node,a,y)):m.node.active=!1;l.active=!0}for(;h<d.length&&!(C<=h);h++)if(l=cc.find("cardPeng"+(h+1),i)){for(u=0;u<4&&(m=l.getChildByName("card_face"+(u+1)).getComponent(cc.Sprite),null!=(g=d[h]))&&!(null==(f=g.cards)||f.length<=0);u++)u<f.length?(m.node.active=!0,3==u&&(p=l.getChildByName("card_back4").getComponent(cc.Sprite),g.type==GangType.Gang_An?(m.node.active=!1,p.node.active=!0):p.node.active=!1),y=f[u],this.showCardContent(m.node,a,y)):m.node.active=!1;l.active=!0}}}}},showWinIcon:function(e){if(null!=D.getRoomData()){var t=this._curGameData;if(null!=t){var a=t.getGameInfoData();if(null!=a){var n=cc.find("player"+(e+1),this.resultLayer);if(null!=n){var i=GameData.joiners[e].uid;cc.find("huIcon",n).active=i==a.winnerUid}}}}},showResultIcon:function(){var e=this._curGameData;if(null!=e){var t=e.getGameScoreData();if(!(null==t||Object.keys(t).length<=0)){var a=t[GameData.player.uid];0<a?(this.winSprite.node.active=!0,this.loseSprite.node.active=!1,this.pingSprite.node.active=!1):a<0?(this.winSprite.node.active=!1,this.loseSprite.node.active=!0,this.pingSprite.node.active=!1):(this.winSprite.node.active=!1,this.loseSprite.node.active=!1,this.pingSprite.node.active=!0)}}},showRoundInfo:function(){var e=D.getRoomData();if(null!=e){var t=this._curGameData;if(null!=t){var a=t.getGameInfoData();if(null!=a){this.roomID.string="房号："+e.id;var n=getTimeStr(e.createtime);this.createTime.string=n[0]+"/"+n[1]+"/"+n[2]+"  "+n[3]+":"+n[4]+":"+n[5];var i=a.roundNum;this.roundNumber.string="第"+i+"局"}}}},setReady:function(){GameData.roomClose?(this.resultLayer.active=!1,sendEvent("showSummary")):(MjHandler.getInstance().requestReady(function(e){}),sendEvent("onGameStart"))},shareRet:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],uiRoomScore:[function(e,t,a){"use strict";cc._RF.push(t,"3b8a7jAYKRIBoBJjpLtY62c","uiRoomScore");var m=e("roomHandler");cc.Class({extends:cc.Component,properties:{scoreScollView:cc.ScrollView,scoreLayer:cc.Node,headLayer:cc.Node,playerHeadNode:cc.Node,playerScoreItem:cc.Node,playerSumScore:cc.Node,_curGameData:null},onLoad:function(){registEvent("onRoomInfo",this,this.RoomInfoHandler),this.playerMax=0,this.ScoreList=[];var e=m.getRoomData();null!=e&&(this.playerMax=e.opts.joinermax,this.initPlayerHeadNode())},onDestroy:function(){unregistEvent("onRoomInfo",this,this.RoomInfoHandler)},RoomInfoHandler:function(e){null!=e&&(m.onRoomInfoSetData(e.detail),this.initPlayerHeadNode())},initPlayerHeadNode:function(){for(var e=0;e<this.headLayer.getChildrenCount();e++){var t=this.headLayer.getChildren()[e];t&&(t.active=!1)}var a=m.getRoomData();if(null!=a)for(var n=0,i=0;i<this.playerMax;i++){var o=GameData.joiners[i];if(null!=o){var r=this.headLayer.getChildren()[n];null==r&&((r=cc.instantiate(this.playerHeadNode)).parent=this.headLayer),r.active=!0,r.x=this.playerHeadNode.x+n*this.playerHeadNode.width;var s=o.headimgurl,c=cc.find("head",r).getComponent(cc.Sprite);this.setHeadIcon(s,c);var d=o.name;cc.find("nick_name",r).getComponent(cc.Label).string=getShortStr(d,4);var h=!1;a.creator==o.uid&&(h=!0),cc.find("owner",r).active=h,n++}}},setHeadIcon:function(e,a){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},ShowPlayerScoreItem:function(){if(null!=this._curGameData){var e=m.getScoreData();if(null!=e){var t=this._curGameData.getGameInfoData();if(null!=t){var a=t.roundNum-1;cc.log("...len:"+a);var n=this.scoreScollView.content;n.height=a*this.playerScoreItem.height;for(var i=0;i<n.getChildrenCount();i++){var o=n.getChildren()[i];o&&(o.active=!1)}for(var r=0;r<a;r++){var s=n.getChildren()[r];null==s&&((s=cc.instantiate(this.playerScoreItem)).parent=n),s.active=!0,s.x=this.playerScoreItem.x,s.y=this.playerScoreItem.y-r*this.playerScoreItem.height,cc.find("roundNum",s).getComponent(cc.Label).string="第"+(r+1)+"局：";for(var c=0;c<4;c++){cc.find("scoreNum_"+(c+1),s).active=!1}for(var d=0;d<this.playerMax;d++){var h=GameData.joiners[d];if(null!=h){var l=e[h.uid];null==l&&(l=0);var u=cc.find("scoreNum_"+(d+1),s);u.active=!0,u.getComponent("cc.Label").string=0<l?"+"+l+"分":0==l?"0 分":l+"分"}}}this.AddSumScore()}}}else cc.log("...gameData is undefined.")},AddSumScore:function(){var e=m.getScoreData();if(null!=e){for(var t=this.playerSumScore.children,a=0;a<t.length;a++)a>=this.playerMax&&(t[a].active=!1);for(var n=0;n<this.playerMax;n++){var i=cc.find("scoreNum_"+(n+1),this.playerSumScore),o=GameData.joiners[n].uid;0<e[o]?i.getComponent("cc.Label").string="+"+e[o]+"分":0==e[o]?i.getComponent("cc.Label").string="0 分":i.getComponent("cc.Label").string=e[o]+"分"}}},close:function(){this.node.active=!1}}),cc._RF.pop()},{roomHandler:"roomHandler"}],uiRoomSummary:[function(e,t,a){"use strict";cc._RF.push(t,"3b99eeur1xKDpGoXm7BPeIN","uiRoomSummary");var g=e("roomHandler");cc.Class({extends:cc.Component,properties:{panel:cc.Node,font:{default:[],type:[cc.Font]},_curGameData:void 0},onLoad:function(){registEvent("onShowSummary",this,this.onShow)},onDestroy:function(){unregistEvent("onShowSummary",this,this.onShow)},onShow:function(){var e=g.getRoomData();if(null!=e){var t=0;this.showPlayer(GameData.player,++t);for(var a=0;a<GameData.joiners.length;a++)GameData.joiners[a].uid!=GameData.player.uid&&(this.showPlayer(GameData.joiners[a],++t),cc.find("player_"+(a+1),this.panel).active=!0);for(a=GameData.joiners.length;a<4;a++)cc.find("player_"+(a+1),this.panel).active=!1;for(a=0;a<GameData.joiners.length;a++)2==GameData.joiners.length?cc.find("player_"+(a+1),this.panel).x=310*a-155:3==GameData.joiners.length&&(cc.find("player_"+(a+1),this.panel).x=310*a-310);var n=cc.find("strNode/roomid",this.panel),i=cc.find("strNode/time",this.panel);n.getComponent("cc.Label").string="房间号:"+e.id;var o=getTimeStr(e.createtime);i.getComponent("cc.Label").string=o[0]+"/"+o[1]+"/"+o[2]+"  "+o[3]+":"+o[4]+":"+o[5]}},showPlayer:function(e,t){var a=g.getRoomData();if(null!=a){var n=g.getScoreData();if(null!=n){var i=cc.find("player_"+t+"/head_bg/name",this.panel),o=cc.find("player_"+t+"/head_bg/id",this.panel),r=cc.find("player_"+t+"/field_num1",this.panel),s=cc.find("player_"+t+"/head_bg/head",this.panel);o.getComponent("cc.Label").string="ID:"+e.uid,isChinese(e.name)?i.getComponent("cc.Label").string=getShortStr(e.name,8):i.getComponent("cc.Label").string=getShortStr(e.name,10);var c=n[e.uid];0<c?(r.getComponent("cc.Label").font=this.font[0],r.getComponent("cc.Label").string="+"+c):(r.getComponent("cc.Label").font=c<0?this.font[1]:this.font[2],r.getComponent("cc.Label").string=c);var d=e.headimgurl,h=s.getComponent(cc.Sprite);this.setIcon(h,d);var l=function(){var e;e=GameData.joiners[0].uid;for(var t=1;t<GameData.joiners.length;t++)GameData.joiners[t]&&n[GameData.joiners[t].uid]>n[e]&&(e=GameData.joiners[t].uid);return e},u=cc.find("player_"+t+"/win",this.panel);l()==e.uid?u.active=0<n[l()]-a.initScore:u.active=!1,cc.find("player_"+t+"/head_bg/Owner",this.panel).active=a.creator==e.uid;var m=cc.find("player_"+t+"/selfBg",this.panel),p=cc.find("player_"+t+"/playerBg",this.panel);e.uid==GameData.player.uid?(m.active=!0,p.active=!1):(m.active=!1,p.active=!0),this.recordInfoShow(e.uid,t)}}},setIcon:function(a,e){null==a||null==e||e.length<=0||cc.loader.load({url:e,type:"png"},function(e,t){!e&&t&&(a.spriteFrame=new cc.SpriteFrame(t))})},btnBackOnClicked:function(e){GameData.player.roomid=void 0,cc.director.loadScene("home")},recordInfoShow:function(e,t){var a=cc.find("player_"+t+"/tongji/hu",this.panel),n=cc.find("player_"+t+"/tongji/chan",this.panel),i=cc.find("player_"+t+"/tongji/ming",this.panel),o=cc.find("player_"+t+"/tongji/an",this.panel);a.getComponent("cc.Label").string="胡牌次数:  0",n.getComponent("cc.Label").string="被铲次数:  0",i.getComponent("cc.Label").string="明杠次数:  0",o.getComponent("cc.Label").string="暗杠次数:  0"},btnShareOnClicked:function(){inCD(3e3)||screenShoot(wxShareTexture)}}),cc._RF.pop()},{roomHandler:"roomHandler"}],uiRoomTable:[function(e,t,a){"use strict";cc._RF.push(t,"01735Rf5ORBJppaW/MYGp3G","uiRoomTable");e("SoundMngr");var n=e("gameDefine"),s=(e("ruleHandler"),e("roomHandler")),i=e("hongzhongData"),o=cc.Class({extends:cc.Component,properties:{uiDirection:cc.Node,directionNode:cc.Prefab,uiCardNode:cc.Node,cardNode:cc.Prefab},onLoad:function(){registEvent("onRoomInfo",this,this.RoomInfoHandler),registEvent("onGameInfo",this,this.GameInfoHandler),registEvent("onGamePass",this,this.GamePassHandler),registEvent("onGameAction",this,this.GameActionHandler),registEvent("initCardHand",this,this.initCardHandHandler),registEvent("initCardHandNum",this,this.initCardHandNumHandler),registEvent("initCardChi",this,this.initCardChiHandler),registEvent("initCardPeng",this,this.initCardPengHandler),registEvent("initCardGang",this,this.initCardGangHandler),registEvent("initCardDis",this,this.initCardDisHandler),registEvent("onCardDis",this,this.onCardDisHandler),registEvent("onCardChi",this,this.onCardChiHandler),registEvent("onCardPeng",this,this.onCardPengHandler),registEvent("onCardGangAn",this,this.onCardGangAnHandler),registEvent("onCardGangMing",this,this.onCardGangMingHandler),registEvent("onCardGangBu",this,this.onCardGangBuHandler),registEvent("onCardHu",this,this.onCardHuHandler),registEvent("onGameStart",this,this.onGameStartHandler),registEvent("onGameScore",this,this.onGameScoreHandler),registEvent("onGameTurn",this,this.GameTurnHandler),registEvent("updateCards",this,this.updateCardsHandler),this.playerSex=1,this._curGameData=void 0,this.setCurGameData(),this.updateUIDirection(),this.updateUICardNode(),this.updateUICardNodeOnCards(),this.updateUICardWithGame(),this.GameTurnStart(),this.updateGamePassAction()},onDestroy:function(){unregistEvent("onRoomInfo",this,this.RoomInfoHandler),unregistEvent("onGameInfo",this,this.GameInfoHandler),unregistEvent("onGamePass",this,this.GamePassHandler),unregistEvent("onGameAction",this,this.GameActionHandler),unregistEvent("initCardHand",this,this.initCardHandHandler),unregistEvent("initCardHandNum",this,this.initCardHandNumHandler),unregistEvent("initCardChi",this,this.initCardChiHandler),unregistEvent("initCardPeng",this,this.initCardPengHandler),unregistEvent("initCardGang",this,this.initCardGangHandler),unregistEvent("initCardDis",this,this.initCardDisHandler),unregistEvent("onCardDis",this,this.onCardDisHandler),unregistEvent("onCardChi",this,this.onCardChiHandler),unregistEvent("onCardPeng",this,this.onCardPengHandler),unregistEvent("onCardGangAn",this,this.onCardGangAnHandler),unregistEvent("onCardGangMing",this,this.onCardGangMingHandler),unregistEvent("onCardGangBu",this,this.onCardGangBuHandler),unregistEvent("onCardHu",this,this.onCardHuHandler),unregistEvent("onGameStart",this,this.onGameStartHandler),unregistEvent("onGameScore",this,this.onGameScoreHandler),unregistEvent("onGameTurn",this,this.GameTurnHandler),unregistEvent("updateCards",this,this.updateCardsHandler)},setCurGameData:function(){var e=s.getRoomData();if(null!=e)switch(e.opts.gameType){case n.GameType.Game_Mj_HZ:this._curGameData=i}},RoomInfoHandler:function(e){null!=e&&(s.onRoomInfoSetData(e.detail),this.setCurGameData(),this.updateUIDirection(),this.updateUICardNode())},GameInfoHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGameInfoSetData(e.detail),this.updateUIDirection(),this.updateUICardWithGame())},onGameStartHandler:function(e){null!=e&&null!=this._curGameData&&this._curGameData.onGameStartSetData(e.detail)},GamePassHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGamePassSetData(e.detail),this.updateGamePassAction())},GameActionHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onGameActionSetData(e.detail),this.updateGamePassAction())},onGameScoreHandler:function(e){null!=e&&null!=this._curGameData&&this._curGameData.onGameScoreSetData(e.detail)},onCardDisHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardDisSetData(e.detail),this.ShowCardAction())},onCardChiHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardChiSetData(e.detail),this.ShowCardAction())},onCardPengHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardPengSetData(e.detail),this.ShowCardAction())},onCardGangMingHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardGangMingSetData(e.detail),this.ShowCardAction())},onCardGangAnHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardGangAnSetData(e.detail),this.ShowCardAction())},onCardGangBuHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardGangBuSetData(e.detail),this.ShowCardAction())},onCardHuHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.onCardHuSetData(e.detail),this.ShowCardAction())},initCardHandHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardHandSetData(e.detail),this.updateUICardNodeOnCards())},initCardHandNumHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardHandNumSetData(e.detail),this.updateUICardNodeOnCards())},initCardChiHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardChiSetData(e.detail),this.updateUICardNodeOnCards())},initCardPengHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardPengSetData(e.detail),this.updateUICardNodeOnCards())},initCardGangHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardGangSetData(e.detail),this.updateUICardNodeOnCards())},initCardDisHandler:function(e){null!=e&&null!=this._curGameData&&(this._curGameData.initCardDisSetData(e.detail),this.updateUICardNodeOnCards())},updateCardsHandler:function(){this.updateUICardNodeOnCards()},GameTurnHandler:function(){this.GameTurnStart()},updateUIDirection:function(){var e=this.uiDirection.getChildByName("uiDirection");null==e&&((e=cc.instantiate(this.directionNode)).parent=this.uiDirection,e.name="uiDirection");var t=e.getComponent("tableDirectionControl"),a=this._curGameData.getGameInfoData();a&&(t.setTurnUid(a.turn),cc.log("..gameInfoData:"+JSON.stringify(a)),t.setRoomRoundCur(a.roundNum,a.roundmax),t.setLeftCardNumber(a.cardleft));var n=s.getRoomData();n&&(t.setRoundRule(n.opts.roundRule),t.setRoomState(n.status))},updateUICardNode:function(){var e=this.uiCardNode.getChildByName("uiCardNode");null==e&&((e=cc.instantiate(this.cardNode)).parent=this.uiCardNode,e.name="uiCardNode");var t=e.getComponent("tableCardControl");if(t.setDisCardMax(),t._curGameData=this._curGameData,s.getRoomData()){var a=0,n=0,i=0,o=0,r=GameData.getPlayerByPos("up");r&&(a=r.uid),(r=GameData.getPlayerByPos("down"))&&(n=r.uid),(r=GameData.getPlayerByPos("right"))&&(i=r.uid),(r=GameData.getPlayerByPos("left"))&&(o=r.uid),t.setPlayersUid(a,n,i,o)}},updateUICardWithGame:function(){var e=this._curGameData.getGameInfoData();if(null!=e){var t=e.turn,a=e.wildcard,n=e.lastdisUid,i=e.lastdisCard,o=this.uiCardNode.getChildByName("uiCardNode");if(o){var r=o.getComponent("tableCardControl");r.setTurnUid(t),r.setWildCards(a),r.setLastDisObject(n,i)}}},updateUICardNodeOnCards:function(){var e=this._curGameData.getGameInfoData();if(null!=e){var t=GameData.getPlayerByPos("up"),a=GameData.getPlayerByPos("down"),n=GameData.getPlayerByPos("right"),i=GameData.getPlayerByPos("left"),o=this._curGameData.getHandCards(GameData.player.uid),r=e.obtain,s=0,c=0,d=0,h=[],l=[],u=[],m=[],p={chi:[],peng:[],gang:[]},g={chi:[],peng:[],gang:[]},f={chi:[],peng:[],gang:[]},y={chi:[],peng:[],gang:[]};t&&(s=this._curGameData.getHandCardNum(t.uid),h=this._curGameData.getDisCards(t.uid),p.chi=this._curGameData.getChiCards(t.uid),p.peng=this._curGameData.getPengCards(t.uid),p.gang=this._curGameData.getGangCards(t.uid)),a&&(l=this._curGameData.getDisCards(a.uid),g.chi=this._curGameData.getChiCards(a.uid),g.peng=this._curGameData.getPengCards(a.uid),g.gang=this._curGameData.getGangCards(a.uid)),n&&(c=this._curGameData.getHandCardNum(n.uid),u=this._curGameData.getDisCards(n.uid),f.chi=this._curGameData.getChiCards(n.uid),f.peng=this._curGameData.getPengCards(n.uid),f.gang=this._curGameData.getGangCards(n.uid)),i&&(d=this._curGameData.getHandCardNum(i.uid),m=this._curGameData.getDisCards(i.uid),y.chi=this._curGameData.getChiCards(i.uid),y.peng=this._curGameData.getPengCards(i.uid),y.gang=this._curGameData.getGangCards(i.uid));var v=this.uiCardNode.getChildByName("uiCardNode");if(v){var C=v.getComponent("tableCardControl");C.setMyHandObject(o,r),C.setHandCardsObject(s,c,d),C.setDisCardsObject(h,l,u,m),C.setUsedCardsObject(p,g,f,y)}}},updateGamePassAction:function(){if(null!=this._curGameData){var e=this._curGameData.getPassActionsData(),t=this._curGameData.getActionsType();if(null!=e&&null!=t){var a=this.uiCardNode.getChildByName("uiCardNode");if(a)a.getComponent("tableCardControl").setActionsObject(e,t)}}},GameTurnStart:function(){var e=this.uiDirection.getChildByName("uiDirection");e&&e.getComponent("tableDirectionControl").startCoundDown()},ShowCardAction:function(){var e=this._curGameData.getActionEffectData();if(null!=e){var t=this.uiCardNode.getChildByName("uiCardNode");if(t){var a=t.getComponent("tableCardControl"),n=GameData.getPlayerSexByUid(e.uid),i=GameData.getPlayerPosByUid(e.uid);switch(e.action){case"dis":a.showDisAudioEffect(e.action,e.card,n);break;case"chi":case"peng":case"gang":case"hu":cc.log("...sex:"+n),cc.log("...pos:"+i),cc.log("...action:"+e.action),a.showActionEffect(n,i,e.action)}}}}});t.exports=o,cc._RF.pop()},{SoundMngr:"SoundMngr",gameDefine:"gameDefine",hongzhongData:"hongzhongData",roomHandler:"roomHandler",ruleHandler:"ruleHandler"}],uiRoomWait:[function(e,t,a){"use strict";cc._RF.push(t,"ceef3WP6sRCE7poRf914B0+","uiRoomWait");e("gameDefine");var n=e("roomHandler");e("hongzhongData"),e("roomUtil");cc.Class({extends:cc.Component,properties:{deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node},onLoad:function(){},onDestroy:function(){},onEnable:function(){this.setUIBaseInfo()},setUIBaseInfo:function(){var e=n.getRoomData().creator==GameData.player.uid;this.deleteRoomBtn.active=e},backBtnClicked:function(){var e=n.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(e.id)},wxInviteBtnClicked:function(){var e=n.getRoomData(),t="红中麻将 房间号:"+e.id;4==e.opts.costType&&(t="红中麻将 (代开)房间号:"+e.id);var a=this.getInviteStr();wxShareText(t,a)},getInviteStr:function(){var e=n.getRoomData();return"玩法:"+getRuleStrHongZhong(e.opts)+",请您快速加入对局."},onShareResult:function(){wxShareTimeline("红中麻将","还等嘛!我在红中麻将等你!")},onShareFriend:function(){wxShareWeb("红中麻将","还等嘛!我在红中麻将等你!")},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){var e=n.getRoomData();n.deleteRoom(e.id,"close")},function(){})},onQuitRoom:function(){var e=n.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):n.quitRoom(e.id)},onCopyRoomInfo:function(){var e="红中麻将,房间号:"+n.getRoomData().id+",",t=this.getInviteStr();wxShareCommond(e+t)}}),cc._RF.pop()},{gameDefine:"gameDefine",hongzhongData:"hongzhongData",roomHandler:"roomHandler",roomUtil:"roomUtil"}],uiTingTip:[function(e,t,a){"use strict";cc._RF.push(t,"5596eAMW1BEH7beiHKn8mVV","uiTingTip");e("ruleHandler");cc.Class({extends:cc.Component,properties:{tingNode:cc.Node,bg:cc.Node,nbg:cc.Node,cardTemplate:cc.Node},onLoad:function(){this.bgHeight=this.bg.height,this.nbgHeight=this.nbg.height,this.cardNodeList=[],this.cardTemplate.active=!1},show:function(e,t){for(var a=[],n=[],i={},o=0,r=0;r<t.length;r++){var s=t[r];if(s.discard==e){a=s.ting;break}}if(0<a.length){this.tingNode.active=!0;for(r=0;r<this.cardNodeList.length;r++){(v=this.cardNodeList[r]).destroy()}this.cardNodeList.splice(0,this.cardNodeList.length);for(var c=0;c<a.length;c++){var d=(h=a[c]).type.toString();"4"===d&&(d="3"),i[d]=i[d]||[],i[d].push(h)}for(var r in i){var h;if(15<=(h=i[r]).length)n.push({obcard:-1,score:h[0].score});else for(var l in h)n.push({obcard:h[l].obcard,score:h[l].score})}n.sort(function(e,t){return t.score-e.score});var u=-1;for(r=0;r<n.length;r++)if(-1!=n[r].obcard){var m=n[r].obcard,p=n[r].score;o+=g=this.leftCard(m),this.showCardNode(m,p,g)}else u=r;if(0<=u){m="renyi",p=n[u].score;var g=GameData.game.cardleft-o;o=GameData.game.cardleft,this.showCardNode(m,p,g)}cc.find("totalLeftLabel",this.tingNode).getComponent(cc.Label).string="剩余"+o+"张";var f=this.cardNodeList.length,y=4<f?Math.ceil(f/2):f;for(Math.ceil(f/y),r=0;r<this.cardNodeList.length;r++){var v;(v=this.cardNodeList[r]).x=this.cardTemplate.x+r%y*90,v.y=this.cardTemplate.y-154*Math.floor(r/y)}this.nbg.width=90*y,this.bg.width=220+this.nbg.width,4<f?(this.bg.height=370,this.nbg.height=300):(this.bg.height=this.bgHeight,this.nbg.height=this.nbgHeight)}else this.tingNode.active=!1},hide:function(){this.tingNode.active=!1},showCardNode:function(e,t,a){var n=cc.instantiate(this.cardTemplate),i="resources/mjcard2d/mj_face_xia_shou_"+e+".png",o=cc.textureCache.addImage(cc.url.raw(i));n.getComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(o),cc.find("scoreLabel",n).getComponent(cc.Label).string=t+"分",cc.find("leftLabel",n).getComponent(cc.Label).string=a+"张",cc.find("mask",n).active=0==a,n.active=!0,this.tingNode.addChild(n),this.cardNodeList.push(n)},leftCard:function(e){var t=0,a=GameData.getMyHandCards();for(var n in a)e==n&&(t+=a[n]);for(var i=0;i<GameData.joiners.length;i++){var o=GameData.joiners[i];if(o){var r=o.uid,s=GameData.getDisCards(r),c=GameData.getPengCards(r),d=GameData.getGangCards(r);for(var n in s)e==s[n]&&(t+=1);for(var n in c)e==c[n][0]&&(t+=3);for(var n in d)e==d[n][0]&&(t+=4)}}var h=4-t;return h=h<=0?0:h}}),cc._RF.pop()},{ruleHandler:"ruleHandler"}],updateHandler:[function(e,t,a){"use strict";cc._RF.push(t,"68b51VnnRxBRJ7bUbHfkC+2","updateHandler");var d=e("md5"),n=t.exports,o=!0,r=!1,s=null,c=null;function i(){return WriteLog("updateHandler checkUpdate ..."),s.getLocalManifest().isLoaded()?(null==c&&(c=new jsb.EventListenerAssetsManager(s,function(e){var t=!1;switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:sendEvent("updateError","未找到本地文件列表");break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:sendEvent("updateError","下载更新列表失败");break;case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:sendEvent("updateError","解析更新列表失败");break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:sendEvent("updateStart"),s.update();break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:o=!1,sendEvent("updateFinish");break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:var a=e.getPercent();0<a&&sendEvent("updateProgress",a);break;case jsb.EventAssetsManager.ASSET_UPDATED:break;case jsb.EventAssetsManager.ERROR_UPDATING:WriteLog("updateHandler update error:"+e.getMessage()+" asset:"+e.getAssetId());break;case jsb.EventAssetsManager.UPDATE_FINISHED:t=!0;break;case jsb.EventAssetsManager.UPDATE_FAILED:sendEvent("updateError","更新失败"),r=!0;break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:sendEvent("updateError","解压文件失败:"+e.getAssetId()),r=!0;break;default:return}if(t){cc.eventManager.removeListener(c),c=null;var n=jsb.fileUtils.getSearchPaths(),i=s.getLocalManifest().getSearchPaths();console.log(JSON.stringify(i)),Array.prototype.unshift(n,i),cc.sys.localStorage.setItem("UpdateSearchPaths",JSON.stringify(n)),jsb.fileUtils.setSearchPaths(n),cc.game.restart()}}.bind(this)),cc.eventManager.addListener(c,1)),s.checkUpdate(),!0):(WriteLog("updateHandler Failed to load local manifest ..."),sendEvent("updateError","加载更新列表失败"),!1)}function h(e,t){WriteLog("updateHandler Version Compare: local version is "+e+", remote version is "+t);for(var a=e.split("."),n=t.split("."),i=0;i<a.length;++i){var o=parseInt(a[i]),r=parseInt(n[i]||0);if(o!==r)return o-r}return n.length>a.length?-1:0}function l(e,t){var a,n,i,o,r=(n=(a=e).lastIndexOf("/"),i=a.lastIndexOf("\\"),(o=Math.max(n,i))<0?a:a.substring(o+1));if("project.manifest"==r||"version.manifest"==r)return!0;if(t.compressed)return!0;var s=jsb.fileUtils.getDataFromFile(e);if(null==s)return WriteLog("updateHandler verify get file failed:"+s),!1;var c=d(s).toLowerCase();return c==t.md5||(WriteLog("updateHandler verify failed:"+e),WriteLog("updateHandler md5:"+c+" asset.md5:"+t.md5),!1)}n.checkUpdate=function(e){return cc.sys.isNative?o?(function(e){if(WriteLog("updateHandler init ..."),!s){var t=jsb.fileUtils.getWritablePath()+"com.mahjong.tianjin/";(s=new jsb.AssetsManager(e,t)).setVersionCompareHandle(h),s.setVerifyCallback(l);var a=s.getLocalManifest();WriteLog("updateHandler manifestUrl:"+JSON.stringify(a.getManifestFileUrl())),cc.sys.os===cc.sys.OS_ANDROID&&(s.setMaxConcurrentTask(2),WriteLog("updateHandler Max concurrent tasks count have been limited to 2"))}}(e),i()):(WriteLog("updateHandler noNeedUpdate"),sendEvent("updateFinish"),!1):(sendEvent("updateFinish"),!1)},n.retry=function(){WriteLog("updateHandler Retry failed Assets..."),r?(r=!1,s.downloadFailedAssets()):i()},n.getVersion=function(){if(s&&s.getLocalManifest().isLoaded()){var e=s.getLocalManifest();return WriteLog("updateHandler version: "+e.getVersion()),e.getVersion()}return"0.0.1"},cc._RF.pop()},{md5:"md5"}],utils:[function(e,t,a){"use strict";cc._RF.push(t,"567d6lNjzNAbLAQ1N0lyoji","utils"),a.inherits=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1}})},cc._RF.pop()},{}],waitView:[function(e,t,a){"use strict";cc._RF.push(t,"bd9c79f5y5Gq6nGTBXhwX5X","waitView");var i=e("gameConfig"),o=e("gameDefine"),r=e("roomHandler");cc.Class({extends:cc.Component,properties:{deleteRoomBtn:cc.Node,quitRoomBtn:cc.Node},onLoad:function(){registEvent("onCreatorQuit",this,this.onCreatorQuit)},onDestroy:function(){unregistEvent("onCreatorQuit",this,this.onCreatorQuit)},onEnable:function(){scheduleLamp(this),r.getRoomData().status==o.RoomState.WAIT&&r.setReady()},setUIBaseInfo:function(){var e=r.getRoomData().creator==GameData.player.uid;this.deleteRoomBtn.active=e},backBtnClicked:function(){var e=r.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):r.quitRoom(e.id)},wxInviteBtnClicked:function(){var e=r.getRoomData();if(null!=e){var t=i.getName(),a=e.opts.costType==o.CostType.Cost_Agent?t+"(代开)房间号:"+e.id:t+"房间号:"+e.id,n=this.getInviteStr();wxShareText(a,n)}},getInviteStr:function(){return"玩法:"+i.getRuleStr()+",请您快速加入对局."},onDeleteRoom:function(){createMessageBox("解散房间不扣房卡，是否确定解散？",function(){var e=r.getRoomData();r.deleteRoom(e.id,"close")},function(){})},onQuitRoom:function(){var e=r.getRoomData();e.creator==GameData.player.uid?cc.director.loadScene("home"):r.quitRoom(e.id)},onCreatorQuit:function(){var e=r.getRoomData();null!=e&&(GameData.player.roomid=void 0,e.creator!=GameData.player.uid?createMessageBox("房主已经解散房间",function(){cc.director.loadScene("home")}):cc.director.loadScene("home"))},onCopyRoomInfo:function(){var e=r.getRoomData();if(null!=e){var t=i.getName()+"房间号:"+e.id+",",a=this.getInviteStr();wxShareCommond(t+a)}}}),cc._RF.pop()},{gameConfig:"gameConfig",gameDefine:"gameDefine",roomHandler:"roomHandler"}],wifiView:[function(e,t,a){"use strict";cc._RF.push(t,"0265fkoOVlIFZee3V5b4LW5","wifiView"),cc.Class({extends:cc.Component,properties:{wifiNode:cc.Node},onEnable:function(){this.showWifi(),this.schedule(this.showWifi,5)},showWifi:function(){var e=0,t=GameNet.getInstance().getPingPong();t<300?e=3:t<600?e=2:t<1e3&&(e=1);for(var a=0;a<4;a++){cc.find("WiFi-"+(a+1),this.wifiNode).active=a==e}}}),cc._RF.pop()},{}],wildCard1View:[function(e,t,a){"use strict";cc._RF.push(t,"3c1b83XdBNHXaudcQFgS6vg","wildCard1View");var n=e("gameConfig");cc.Class({extends:cc.Component,properties:{wildCard:cc.Sprite,wildIcon:cc.Sprite},onLoad:function(){},onDestroy:function(){},onEnable:function(){var e=n.getGameData().game.wildcard;if(0<e.length){var t=cc.textureCache.addImage(cc.url.raw("resources/mjcard2d/mj_face_xia_shou_"+e[0]+".png"));this.wildCard.spriteFrame=new cc.SpriteFrame(t)}var a=n.getWildIcon();if(""!=a){t=cc.textureCache.addImage(cc.url.raw(a));this.wildIcon.spriteFrame=new cc.SpriteFrame(t)}}}),cc._RF.pop()},{gameConfig:"gameConfig"}]},{},["PDK-createRoom","PDK-handler","PDK-poker","PDK-roomDissolve","PDK-roomHandler","PDK-roomMain","PDK-roomResult","PDK-roomSummary","PDK-roomWait","PDK-roomtable","TDK-createRoom","TDK-playerTemplate","TDK-poker","TDK-roomDissolve","TDK-roomMain","TDK-roomSummary","TDK-roomWait","TDK-roomtable","TDK-setting","replayMain-tdk","tdk-ResultRender","tdk-debug","tdk-resultFlyScore","tdkRoomData","TJDDZ-createRoom","TJDDZ-poker","TJDDZ-roomDissolve","TJDDZ-roomMain","TJDDZ-roomResult","TJDDZ-roomSummary","TJDDZ-roomWait","TJDDZ-roomtable","pokerRoomBaseView","pokerRoomPlayer","roomUtil","tableCardControl","tableDirectionControl","tableDynAnimation","tablePlayersControl","uiCardTest","uiDebug","uiRoomDissolve","uiRoomMain","uiRoomPlayerInfo","uiRoomResult","uiRoomScore","uiRoomSummary","uiRoomTable","uiRoomWait","uiTingTip","createRoom_changchun","debug_changchun","roomDissolve_changchun","roomMain_changchun","roomPiao_changchun","roomResult_changchun","roomScore_changchun","roomSummary_changchun","roomTable_changchun","roomWait_changchun","appstore","changchun","codeString","coin","configMgr","dunhua","errorCode","gameDefine","haerbin","hebei","huadian","mission","shishi","shopConfig","test","tianjin","competitionHandler","es6-promise","matchHandler","md5","missionHandler","roomHandler","stateMachine","topHandler","utils","DDZ-coinEnd","DDZ-createRoom","DDZ-home","DDZ-playerTemplate","DDZ-poker","DDZ-ReplayCardController","DDZ-ReplayMain","DDZ-ReplayResultPanel","DDZ-roomDissolve","DDZ-roomMain","DDZ-roomSummary","DDZ-roomWait","DDZ-roomtable","TuiDaoHu-Data","TuiDaoHu-Protocol","TuiDaoHu-Rules","TuiDaoHu","gameConfig","createRoom_heb","debug_heb","roomDissolve_heb","roomMain_heb","roomResult_heb","roomSummary_heb","roomTable_heb","roomWait_heb","hhdz_bet","hhdz_data","hhdz_head","hhdz_roomHead","hhdz_roomMain","hhdz_roomUtil","hhdz_runChart","hhdz_table","createRoom-hz","hongzhongData","createRoom_huadian","debug_huadian","roomDissolve_huadian","roomMain_huadian","roomPiao_huadian","roomResult_huadian","roomScore_huadian","roomSummary_huadian","roomTable_huadian","roomWait_huadian","roomZhuang_huadian","hundredNiu-roomBase","hundredNiu-roomMain","hundredNiu-roomTable","hundredNiu-roomWait","hundredNiuHandler","hundred_backPanel","hundred_dealerPanel","hundred_fortunePanel","hundred_pokerPanel","hundred_rulePanel","hundred_runscorePanel","hundred_sankePanel","hundred_trendPanel","loginHandler","mahjong","mahjong_changchun","mahjong_huadian","mahjong_hz","mahjong_shishi","mahjong_tianjin","poker13","replayHandler","ruleHandler","shopHandler","updateHandler","LanguagerManager","SoundMngr","getLottery","NN-createRoom","niuNiuHandler","niuNiuPlayerInfo","niuNiuPoker","niuniuGmCard","niuniuMoveMessage","niuniuPokerHandler","pokerTypeAnimation","niuNiuProcessResult","niuNiuResultRender","niuNiuRoomDissolve","niuNiuRoomMain","niuNiuRoomPlay","niuNiuRoomResult","niuNiuRoomWait","niuNiuSetting","resultRunScore","tenNN-createRoom","chip_mask","poker_Mask","poker_ZJH_resultItemPrefab","poker_chipPrefab","poker_debugPrefab","poker_playerStateImgPrefab","poker_settingPrefab","poker_summaryPrefab","SSSCard","SSSChatPanel","SSSFastVoiceButton","SSSHideComponent","SSSCreateRoom","SSSDebug","SSSHome","SSSPromptCard","SSSRoomDissolve","SSSRoomMain","SSSRoomTable","SSSSetting","roomEndClear","SSSPlayerChat","SpecialTypeAnimatePanel","groupType","playerRoundDetail","roundDetail","ReplayMain-shishi","ReplayResultPanel-shishi","TingTip-shishi","createRoom_shishi","cardTest-shishi","roomChaShui-shishi","roomDissolve-shishi","roomMain-shishi","roomResult-shishi","roomScore-shishi","roomSummary-shishi","roomWait-shishi","roomTable_shishi","cardTemplate","messagebox","playerInfoTemplate","playerTemplate","AgreePanel","ButtonCD","EveryDayShare","MoveMessage","NoticePanel","PlayIntroPanel","PosterItemPrefab","PosterPanel","PosterPrefab","PreLoader","RunlampPanel","RunlampPanel1","SharePanel","TingTip","UIClub","UICoinRankingList","UIGroup","UIPushGame","UISuccour","UITask","WebPanel","agentPanel","Card","CardButton","ChatPanel","FastVoiceButton","HideComponent","clubPanel","CompetitionDetail","CompetitionRecord","UICompetition","selectGameItem","createControl","goodsType","home","joinControl","joinclubPanel","login","UIMatch","UISelectGame","UISelectGameLv","agentBindLayer","playerInformationLayer","RecordItem","RecordPanel","RecordPlayerInfo","RoundItem","RoundPanel","CardRef","DisCard","HandCard","PengCard","ReplayCardController","ReplayCardFace","ReplayEffectController","ReplayLayout","ReplayMain","ReplayResultPanel","replayData","cardTest","createRoom","debug","roomDissolve","roomMain","roomResult","roomScore","roomSummary","roomTable","roomWait","roomZhuang","selectclubPanel","SetWeixin","AMapPanel","SettingsPanel","shoppingPanel","settingView","chatView","dissolveView","locationView","powerView","roomNumView","ruleTipsView","ruleView","talkView","timeView","wifiView","cardActionView","cardBtnView","cardsView","debugView","directionView","headView","prepareView","resultView","summaryView","tingView","waitView","wildCard1View","scene_mahjong","ZJH-RoomData","ZJH-createRoom","ZJH-roomDissolve","ZJH-roomWait","ZJH-roomtable","ZJH_roomMain","pokerAnimationBase"]);